function qM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const c=Object.getOwnPropertyDescriptor(r,s);c&&Object.defineProperty(t,s,c.get?c:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&r(f)}).observe(document,{childList:!0,subtree:!0});function n(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(s){if(s.ep)return;s.ep=!0;const c=n(s);fetch(s.href,c)}})();var Bf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function c1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xI={exports:{}},Y_={},wI={exports:{}},Zn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rm=Symbol.for("react.element"),ZM=Symbol.for("react.portal"),XM=Symbol.for("react.fragment"),WM=Symbol.for("react.strict_mode"),HM=Symbol.for("react.profiler"),YM=Symbol.for("react.provider"),KM=Symbol.for("react.context"),JM=Symbol.for("react.forward_ref"),QM=Symbol.for("react.suspense"),tL=Symbol.for("react.memo"),eL=Symbol.for("react.lazy"),aE=Symbol.iterator;function nL(t){return t===null||typeof t!="object"?null:(t=aE&&t[aE]||t["@@iterator"],typeof t=="function"?t:null)}var bI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},EI=Object.assign,SI={};function zd(t,e,n){this.props=t,this.context=e,this.refs=SI,this.updater=n||bI}zd.prototype.isReactComponent={};zd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};zd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function II(){}II.prototype=zd.prototype;function h1(t,e,n){this.props=t,this.context=e,this.refs=SI,this.updater=n||bI}var p1=h1.prototype=new II;p1.constructor=h1;EI(p1,zd.prototype);p1.isPureReactComponent=!0;var lE=Array.isArray,CI=Object.prototype.hasOwnProperty,f1={current:null},TI={key:!0,ref:!0,__self:!0,__source:!0};function PI(t,e,n){var r,s={},c=null,f=null;if(e!=null)for(r in e.ref!==void 0&&(f=e.ref),e.key!==void 0&&(c=""+e.key),e)CI.call(e,r)&&!TI.hasOwnProperty(r)&&(s[r]=e[r]);var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){for(var w=Array(u),S=0;S<u;S++)w[S]=arguments[S+2];s.children=w}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)s[r]===void 0&&(s[r]=u[r]);return{$$typeof:Rm,type:t,key:c,ref:f,props:s,_owner:f1.current}}function rL(t,e){return{$$typeof:Rm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function d1(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rm}function iL(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var uE=/\/+/g;function _0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?iL(""+t.key):e.toString(36)}function Zy(t,e,n,r,s){var c=typeof t;(c==="undefined"||c==="boolean")&&(t=null);var f=!1;if(t===null)f=!0;else switch(c){case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case Rm:case ZM:f=!0}}if(f)return f=t,s=s(f),t=r===""?"."+_0(f,0):r,lE(s)?(n="",t!=null&&(n=t.replace(uE,"$&/")+"/"),Zy(s,e,n,"",function(S){return S})):s!=null&&(d1(s)&&(s=rL(s,n+(!s.key||f&&f.key===s.key?"":(""+s.key).replace(uE,"$&/")+"/")+t)),e.push(s)),1;if(f=0,r=r===""?".":r+":",lE(t))for(var u=0;u<t.length;u++){c=t[u];var w=r+_0(c,u);f+=Zy(c,e,n,w,s)}else if(w=nL(t),typeof w=="function")for(t=w.call(t),u=0;!(c=t.next()).done;)c=c.value,w=r+_0(c,u++),f+=Zy(c,e,n,w,s);else if(c==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return f}function by(t,e,n){if(t==null)return t;var r=[],s=0;return Zy(t,r,"","",function(c){return e.call(n,c,s++)}),r}function oL(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var sa={current:null},Xy={transition:null},sL={ReactCurrentDispatcher:sa,ReactCurrentBatchConfig:Xy,ReactCurrentOwner:f1};Zn.Children={map:by,forEach:function(t,e,n){by(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return by(t,function(){e++}),e},toArray:function(t){return by(t,function(e){return e})||[]},only:function(t){if(!d1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Zn.Component=zd;Zn.Fragment=XM;Zn.Profiler=HM;Zn.PureComponent=h1;Zn.StrictMode=WM;Zn.Suspense=QM;Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sL;Zn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=EI({},t.props),s=t.key,c=t.ref,f=t._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,f=f1.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(w in e)CI.call(e,w)&&!TI.hasOwnProperty(w)&&(r[w]=e[w]===void 0&&u!==void 0?u[w]:e[w])}var w=arguments.length-2;if(w===1)r.children=n;else if(1<w){u=Array(w);for(var S=0;S<w;S++)u[S]=arguments[S+2];r.children=u}return{$$typeof:Rm,type:t.type,key:s,ref:c,props:r,_owner:f}};Zn.createContext=function(t){return t={$$typeof:KM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:YM,_context:t},t.Consumer=t};Zn.createElement=PI;Zn.createFactory=function(t){var e=PI.bind(null,t);return e.type=t,e};Zn.createRef=function(){return{current:null}};Zn.forwardRef=function(t){return{$$typeof:JM,render:t}};Zn.isValidElement=d1;Zn.lazy=function(t){return{$$typeof:eL,_payload:{_status:-1,_result:t},_init:oL}};Zn.memo=function(t,e){return{$$typeof:tL,type:t,compare:e===void 0?null:e}};Zn.startTransition=function(t){var e=Xy.transition;Xy.transition={};try{t()}finally{Xy.transition=e}};Zn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Zn.useCallback=function(t,e){return sa.current.useCallback(t,e)};Zn.useContext=function(t){return sa.current.useContext(t)};Zn.useDebugValue=function(){};Zn.useDeferredValue=function(t){return sa.current.useDeferredValue(t)};Zn.useEffect=function(t,e){return sa.current.useEffect(t,e)};Zn.useId=function(){return sa.current.useId()};Zn.useImperativeHandle=function(t,e,n){return sa.current.useImperativeHandle(t,e,n)};Zn.useInsertionEffect=function(t,e){return sa.current.useInsertionEffect(t,e)};Zn.useLayoutEffect=function(t,e){return sa.current.useLayoutEffect(t,e)};Zn.useMemo=function(t,e){return sa.current.useMemo(t,e)};Zn.useReducer=function(t,e,n){return sa.current.useReducer(t,e,n)};Zn.useRef=function(t){return sa.current.useRef(t)};Zn.useState=function(t){return sa.current.useState(t)};Zn.useSyncExternalStore=function(t,e,n){return sa.current.useSyncExternalStore(t,e,n)};Zn.useTransition=function(){return sa.current.useTransition()};Zn.version="18.2.0";wI.exports=Zn;var Ml=wI.exports;const aL=c1(Ml);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lL=Ml,uL=Symbol.for("react.element"),cL=Symbol.for("react.fragment"),hL=Object.prototype.hasOwnProperty,pL=lL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fL={key:!0,ref:!0,__self:!0,__source:!0};function MI(t,e,n){var r,s={},c=null,f=null;n!==void 0&&(c=""+n),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(f=e.ref);for(r in e)hL.call(e,r)&&!fL.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:uL,type:t,key:c,ref:f,props:s,_owner:pL.current}}Y_.Fragment=cL;Y_.jsx=MI;Y_.jsxs=MI;xI.exports=Y_;var Io=xI.exports,K0={},LI={exports:{}},il={},AI={exports:{}},kI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(he,Fe){var Qe=he.length;he.push(Fe);t:for(;0<Qe;){var _n=Qe-1>>>1,mn=he[_n];if(0<s(mn,Fe))he[_n]=Fe,he[Qe]=mn,Qe=_n;else break t}}function n(he){return he.length===0?null:he[0]}function r(he){if(he.length===0)return null;var Fe=he[0],Qe=he.pop();if(Qe!==Fe){he[0]=Qe;t:for(var _n=0,mn=he.length,Ke=mn>>>1;_n<Ke;){var pn=2*(_n+1)-1,Xn=he[pn],Wn=pn+1,_o=he[Wn];if(0>s(Xn,Qe))Wn<mn&&0>s(_o,Xn)?(he[_n]=_o,he[Wn]=Qe,_n=Wn):(he[_n]=Xn,he[pn]=Qe,_n=pn);else if(Wn<mn&&0>s(_o,Qe))he[_n]=_o,he[Wn]=Qe,_n=Wn;else break t}}return Fe}function s(he,Fe){var Qe=he.sortIndex-Fe.sortIndex;return Qe!==0?Qe:he.id-Fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var f=Date,u=f.now();t.unstable_now=function(){return f.now()-u}}var w=[],S=[],A=1,N=null,O=3,j=!1,W=!1,nt=!1,pt=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,tt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Q(he){for(var Fe=n(S);Fe!==null;){if(Fe.callback===null)r(S);else if(Fe.startTime<=he)r(S),Fe.sortIndex=Fe.expirationTime,e(w,Fe);else break;Fe=n(S)}}function _t(he){if(nt=!1,Q(he),!W)if(n(w)!==null)W=!0,Ue(Ot);else{var Fe=n(S);Fe!==null&&hn(_t,Fe.startTime-he)}}function Ot(he,Fe){W=!1,nt&&(nt=!1,J(At),At=-1),j=!0;var Qe=O;try{for(Q(Fe),N=n(w);N!==null&&(!(N.expirationTime>Fe)||he&&!De());){var _n=N.callback;if(typeof _n=="function"){N.callback=null,O=N.priorityLevel;var mn=_n(N.expirationTime<=Fe);Fe=t.unstable_now(),typeof mn=="function"?N.callback=mn:N===n(w)&&r(w),Q(Fe)}else r(w);N=n(w)}if(N!==null)var Ke=!0;else{var pn=n(S);pn!==null&&hn(_t,pn.startTime-Fe),Ke=!1}return Ke}finally{N=null,O=Qe,j=!1}}var zt=!1,Rt=null,At=-1,Ht=5,Xt=-1;function De(){return!(t.unstable_now()-Xt<Ht)}function ue(){if(Rt!==null){var he=t.unstable_now();Xt=he;var Fe=!0;try{Fe=Rt(!0,he)}finally{Fe?on():(zt=!1,Rt=null)}}else zt=!1}var on;if(typeof tt=="function")on=function(){tt(ue)};else if(typeof MessageChannel<"u"){var Gt=new MessageChannel,ye=Gt.port2;Gt.port1.onmessage=ue,on=function(){ye.postMessage(null)}}else on=function(){pt(ue,0)};function Ue(he){Rt=he,zt||(zt=!0,on())}function hn(he,Fe){At=pt(function(){he(t.unstable_now())},Fe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(he){he.callback=null},t.unstable_continueExecution=function(){W||j||(W=!0,Ue(Ot))},t.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ht=0<he?Math.floor(1e3/he):5},t.unstable_getCurrentPriorityLevel=function(){return O},t.unstable_getFirstCallbackNode=function(){return n(w)},t.unstable_next=function(he){switch(O){case 1:case 2:case 3:var Fe=3;break;default:Fe=O}var Qe=O;O=Fe;try{return he()}finally{O=Qe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(he,Fe){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var Qe=O;O=he;try{return Fe()}finally{O=Qe}},t.unstable_scheduleCallback=function(he,Fe,Qe){var _n=t.unstable_now();switch(typeof Qe=="object"&&Qe!==null?(Qe=Qe.delay,Qe=typeof Qe=="number"&&0<Qe?_n+Qe:_n):Qe=_n,he){case 1:var mn=-1;break;case 2:mn=250;break;case 5:mn=1073741823;break;case 4:mn=1e4;break;default:mn=5e3}return mn=Qe+mn,he={id:A++,callback:Fe,priorityLevel:he,startTime:Qe,expirationTime:mn,sortIndex:-1},Qe>_n?(he.sortIndex=Qe,e(S,he),n(w)===null&&he===n(S)&&(nt?(J(At),At=-1):nt=!0,hn(_t,Qe-_n))):(he.sortIndex=mn,e(w,he),W||j||(W=!0,Ue(Ot))),he},t.unstable_shouldYield=De,t.unstable_wrapCallback=function(he){var Fe=O;return function(){var Qe=O;O=Fe;try{return he.apply(this,arguments)}finally{O=Qe}}}})(kI);AI.exports=kI;var dL=AI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NI=Ml,Ya=dL;function ve(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var DI=new Set,tm={};function cf(t,e){ud(t,e),ud(t+"Capture",e)}function ud(t,e){for(tm[t]=e,t=0;t<e.length;t++)DI.add(e[t])}var Fc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),J0=Object.prototype.hasOwnProperty,gL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cE={},hE={};function mL(t){return J0.call(hE,t)?!0:J0.call(cE,t)?!1:gL.test(t)?hE[t]=!0:(cE[t]=!0,!1)}function yL(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function _L(t,e,n,r){if(e===null||typeof e>"u"||yL(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function aa(t,e,n,r,s,c,f){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=c,this.removeEmptyString=f}var ds={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ds[t]=new aa(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ds[e]=new aa(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ds[t]=new aa(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ds[t]=new aa(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ds[t]=new aa(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ds[t]=new aa(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ds[t]=new aa(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ds[t]=new aa(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ds[t]=new aa(t,5,!1,t.toLowerCase(),null,!1,!1)});var g1=/[\-:]([a-z])/g;function m1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(g1,m1);ds[e]=new aa(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(g1,m1);ds[e]=new aa(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(g1,m1);ds[e]=new aa(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ds[t]=new aa(t,1,!1,t.toLowerCase(),null,!1,!1)});ds.xlinkHref=new aa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ds[t]=new aa(t,1,!1,t.toLowerCase(),null,!0,!0)});function y1(t,e,n,r){var s=ds.hasOwnProperty(e)?ds[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_L(e,n,s,r)&&(n=null),r||s===null?mL(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Qc=NI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ey=Symbol.for("react.element"),$f=Symbol.for("react.portal"),Gf=Symbol.for("react.fragment"),_1=Symbol.for("react.strict_mode"),Q0=Symbol.for("react.profiler"),RI=Symbol.for("react.provider"),OI=Symbol.for("react.context"),v1=Symbol.for("react.forward_ref"),tx=Symbol.for("react.suspense"),ex=Symbol.for("react.suspense_list"),x1=Symbol.for("react.memo"),Rh=Symbol.for("react.lazy"),zI=Symbol.for("react.offscreen"),pE=Symbol.iterator;function Cg(t){return t===null||typeof t!="object"?null:(t=pE&&t[pE]||t["@@iterator"],typeof t=="function"?t:null)}var Ai=Object.assign,v0;function zg(t){if(v0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);v0=e&&e[1]||""}return`
`+v0+t}var x0=!1;function w0(t,e){if(!t||x0)return"";x0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(S){var r=S}Reflect.construct(t,[],e)}else{try{e.call()}catch(S){r=S}t.call(e.prototype)}else{try{throw Error()}catch(S){r=S}t()}}catch(S){if(S&&r&&typeof S.stack=="string"){for(var s=S.stack.split(`
`),c=r.stack.split(`
`),f=s.length-1,u=c.length-1;1<=f&&0<=u&&s[f]!==c[u];)u--;for(;1<=f&&0<=u;f--,u--)if(s[f]!==c[u]){if(f!==1||u!==1)do if(f--,u--,0>u||s[f]!==c[u]){var w=`
`+s[f].replace(" at new "," at ");return t.displayName&&w.includes("<anonymous>")&&(w=w.replace("<anonymous>",t.displayName)),w}while(1<=f&&0<=u);break}}}finally{x0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?zg(t):""}function vL(t){switch(t.tag){case 5:return zg(t.type);case 16:return zg("Lazy");case 13:return zg("Suspense");case 19:return zg("SuspenseList");case 0:case 2:case 15:return t=w0(t.type,!1),t;case 11:return t=w0(t.type.render,!1),t;case 1:return t=w0(t.type,!0),t;default:return""}}function nx(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Gf:return"Fragment";case $f:return"Portal";case Q0:return"Profiler";case _1:return"StrictMode";case tx:return"Suspense";case ex:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case OI:return(t.displayName||"Context")+".Consumer";case RI:return(t._context.displayName||"Context")+".Provider";case v1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case x1:return e=t.displayName||null,e!==null?e:nx(t.type)||"Memo";case Rh:e=t._payload,t=t._init;try{return nx(t(e))}catch{}}return null}function xL(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nx(e);case 8:return e===_1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function FI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wL(t){var e=FI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,c=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(f){r=""+f,c.call(this,f)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(f){r=""+f},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Sy(t){t._valueTracker||(t._valueTracker=wL(t))}function BI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=FI(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function p_(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function rx(t,e){var n=e.checked;return Ai({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fE(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Qh(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function VI(t,e){e=e.checked,e!=null&&y1(t,"checked",e,!1)}function ix(t,e){VI(t,e);var n=Qh(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ox(t,e.type,n):e.hasOwnProperty("defaultValue")&&ox(t,e.type,Qh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function dE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ox(t,e,n){(e!=="number"||p_(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fg=Array.isArray;function nd(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Qh(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function sx(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ve(91));return Ai({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function gE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ve(92));if(Fg(n)){if(1<n.length)throw Error(ve(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Qh(n)}}function UI(t,e){var n=Qh(e.value),r=Qh(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function mE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $I(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ax(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$I(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Iy,GI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Iy=Iy||document.createElement("div"),Iy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Iy.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function em(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Gg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bL=["Webkit","ms","Moz","O"];Object.keys(Gg).forEach(function(t){bL.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gg[e]=Gg[t]})});function jI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Gg.hasOwnProperty(t)&&Gg[t]?(""+e).trim():e+"px"}function qI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=jI(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var EL=Ai({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lx(t,e){if(e){if(EL[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ve(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ve(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ve(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ve(62))}}function ux(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cx=null;function w1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var hx=null,rd=null,id=null;function yE(t){if(t=Fm(t)){if(typeof hx!="function")throw Error(ve(280));var e=t.stateNode;e&&(e=ev(e),hx(t.stateNode,t.type,e))}}function ZI(t){rd?id?id.push(t):id=[t]:rd=t}function XI(){if(rd){var t=rd,e=id;if(id=rd=null,yE(t),e)for(t=0;t<e.length;t++)yE(e[t])}}function WI(t,e){return t(e)}function HI(){}var b0=!1;function YI(t,e,n){if(b0)return t(e,n);b0=!0;try{return WI(t,e,n)}finally{b0=!1,(rd!==null||id!==null)&&(HI(),XI())}}function nm(t,e){var n=t.stateNode;if(n===null)return null;var r=ev(n);if(r===null)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break t;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ve(231,e,typeof n));return n}var px=!1;if(Fc)try{var Tg={};Object.defineProperty(Tg,"passive",{get:function(){px=!0}}),window.addEventListener("test",Tg,Tg),window.removeEventListener("test",Tg,Tg)}catch{px=!1}function SL(t,e,n,r,s,c,f,u,w){var S=Array.prototype.slice.call(arguments,3);try{e.apply(n,S)}catch(A){this.onError(A)}}var jg=!1,f_=null,d_=!1,fx=null,IL={onError:function(t){jg=!0,f_=t}};function CL(t,e,n,r,s,c,f,u,w){jg=!1,f_=null,SL.apply(IL,arguments)}function TL(t,e,n,r,s,c,f,u,w){if(CL.apply(this,arguments),jg){if(jg){var S=f_;jg=!1,f_=null}else throw Error(ve(198));d_||(d_=!0,fx=S)}}function hf(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function KI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _E(t){if(hf(t)!==t)throw Error(ve(188))}function PL(t){var e=t.alternate;if(!e){if(e=hf(t),e===null)throw Error(ve(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var c=s.alternate;if(c===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===c.child){for(c=s.child;c;){if(c===n)return _E(s),t;if(c===r)return _E(s),e;c=c.sibling}throw Error(ve(188))}if(n.return!==r.return)n=s,r=c;else{for(var f=!1,u=s.child;u;){if(u===n){f=!0,n=s,r=c;break}if(u===r){f=!0,r=s,n=c;break}u=u.sibling}if(!f){for(u=c.child;u;){if(u===n){f=!0,n=c,r=s;break}if(u===r){f=!0,r=c,n=s;break}u=u.sibling}if(!f)throw Error(ve(189))}}if(n.alternate!==r)throw Error(ve(190))}if(n.tag!==3)throw Error(ve(188));return n.stateNode.current===n?t:e}function JI(t){return t=PL(t),t!==null?QI(t):null}function QI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=QI(t);if(e!==null)return e;t=t.sibling}return null}var tC=Ya.unstable_scheduleCallback,vE=Ya.unstable_cancelCallback,ML=Ya.unstable_shouldYield,LL=Ya.unstable_requestPaint,ro=Ya.unstable_now,AL=Ya.unstable_getCurrentPriorityLevel,b1=Ya.unstable_ImmediatePriority,eC=Ya.unstable_UserBlockingPriority,g_=Ya.unstable_NormalPriority,kL=Ya.unstable_LowPriority,nC=Ya.unstable_IdlePriority,K_=null,Yu=null;function NL(t){if(Yu&&typeof Yu.onCommitFiberRoot=="function")try{Yu.onCommitFiberRoot(K_,t,void 0,(t.current.flags&128)===128)}catch{}}var fu=Math.clz32?Math.clz32:OL,DL=Math.log,RL=Math.LN2;function OL(t){return t>>>=0,t===0?32:31-(DL(t)/RL|0)|0}var Cy=64,Ty=4194304;function Bg(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function m_(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,c=t.pingedLanes,f=n&268435455;if(f!==0){var u=f&~s;u!==0?r=Bg(u):(c&=f,c!==0&&(r=Bg(c)))}else f=n&~s,f!==0?r=Bg(f):c!==0&&(r=Bg(c));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,c=e&-e,s>=c||s===16&&(c&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-fu(e),s=1<<n,r|=t[n],e&=~s;return r}function zL(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FL(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,c=t.pendingLanes;0<c;){var f=31-fu(c),u=1<<f,w=s[f];w===-1?(!(u&n)||u&r)&&(s[f]=zL(u,e)):w<=e&&(t.expiredLanes|=u),c&=~u}}function dx(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function rC(){var t=Cy;return Cy<<=1,!(Cy&4194240)&&(Cy=64),t}function E0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Om(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-fu(e),t[e]=n}function BL(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-fu(n),c=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~c}}function E1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-fu(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Er=0;function iC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var oC,S1,sC,aC,lC,gx=!1,Py=[],Gh=null,jh=null,qh=null,rm=new Map,im=new Map,zh=[],VL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xE(t,e){switch(t){case"focusin":case"focusout":Gh=null;break;case"dragenter":case"dragleave":jh=null;break;case"mouseover":case"mouseout":qh=null;break;case"pointerover":case"pointerout":rm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":im.delete(e.pointerId)}}function Pg(t,e,n,r,s,c){return t===null||t.nativeEvent!==c?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:c,targetContainers:[s]},e!==null&&(e=Fm(e),e!==null&&S1(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function UL(t,e,n,r,s){switch(e){case"focusin":return Gh=Pg(Gh,t,e,n,r,s),!0;case"dragenter":return jh=Pg(jh,t,e,n,r,s),!0;case"mouseover":return qh=Pg(qh,t,e,n,r,s),!0;case"pointerover":var c=s.pointerId;return rm.set(c,Pg(rm.get(c)||null,t,e,n,r,s)),!0;case"gotpointercapture":return c=s.pointerId,im.set(c,Pg(im.get(c)||null,t,e,n,r,s)),!0}return!1}function uC(t){var e=Bp(t.target);if(e!==null){var n=hf(e);if(n!==null){if(e=n.tag,e===13){if(e=KI(n),e!==null){t.blockedOn=e,lC(t.priority,function(){sC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wy(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=mx(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);cx=r,n.target.dispatchEvent(r),cx=null}else return e=Fm(n),e!==null&&S1(e),t.blockedOn=n,!1;e.shift()}return!0}function wE(t,e,n){Wy(t)&&n.delete(e)}function $L(){gx=!1,Gh!==null&&Wy(Gh)&&(Gh=null),jh!==null&&Wy(jh)&&(jh=null),qh!==null&&Wy(qh)&&(qh=null),rm.forEach(wE),im.forEach(wE)}function Mg(t,e){t.blockedOn===e&&(t.blockedOn=null,gx||(gx=!0,Ya.unstable_scheduleCallback(Ya.unstable_NormalPriority,$L)))}function om(t){function e(s){return Mg(s,t)}if(0<Py.length){Mg(Py[0],t);for(var n=1;n<Py.length;n++){var r=Py[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Gh!==null&&Mg(Gh,t),jh!==null&&Mg(jh,t),qh!==null&&Mg(qh,t),rm.forEach(e),im.forEach(e),n=0;n<zh.length;n++)r=zh[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<zh.length&&(n=zh[0],n.blockedOn===null);)uC(n),n.blockedOn===null&&zh.shift()}var od=Qc.ReactCurrentBatchConfig,y_=!0;function GL(t,e,n,r){var s=Er,c=od.transition;od.transition=null;try{Er=1,I1(t,e,n,r)}finally{Er=s,od.transition=c}}function jL(t,e,n,r){var s=Er,c=od.transition;od.transition=null;try{Er=4,I1(t,e,n,r)}finally{Er=s,od.transition=c}}function I1(t,e,n,r){if(y_){var s=mx(t,e,n,r);if(s===null)N0(t,e,r,__,n),xE(t,r);else if(UL(s,t,e,n,r))r.stopPropagation();else if(xE(t,r),e&4&&-1<VL.indexOf(t)){for(;s!==null;){var c=Fm(s);if(c!==null&&oC(c),c=mx(t,e,n,r),c===null&&N0(t,e,r,__,n),c===s)break;s=c}s!==null&&r.stopPropagation()}else N0(t,e,r,null,n)}}var __=null;function mx(t,e,n,r){if(__=null,t=w1(r),t=Bp(t),t!==null)if(e=hf(t),e===null)t=null;else if(n=e.tag,n===13){if(t=KI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return __=t,null}function cC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AL()){case b1:return 1;case eC:return 4;case g_:case kL:return 16;case nC:return 536870912;default:return 16}default:return 16}}var Vh=null,C1=null,Hy=null;function hC(){if(Hy)return Hy;var t,e=C1,n=e.length,r,s="value"in Vh?Vh.value:Vh.textContent,c=s.length;for(t=0;t<n&&e[t]===s[t];t++);var f=n-t;for(r=1;r<=f&&e[n-r]===s[c-r];r++);return Hy=s.slice(t,1<r?1-r:void 0)}function Yy(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function My(){return!0}function bE(){return!1}function ol(t){function e(n,r,s,c,f){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=c,this.target=f,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(c):c[u]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?My:bE,this.isPropagationStopped=bE,this}return Ai(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=My)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=My)},persist:function(){},isPersistent:My}),e}var Fd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},T1=ol(Fd),zm=Ai({},Fd,{view:0,detail:0}),qL=ol(zm),S0,I0,Lg,J_=Ai({},zm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:P1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Lg&&(Lg&&t.type==="mousemove"?(S0=t.screenX-Lg.screenX,I0=t.screenY-Lg.screenY):I0=S0=0,Lg=t),S0)},movementY:function(t){return"movementY"in t?t.movementY:I0}}),EE=ol(J_),ZL=Ai({},J_,{dataTransfer:0}),XL=ol(ZL),WL=Ai({},zm,{relatedTarget:0}),C0=ol(WL),HL=Ai({},Fd,{animationName:0,elapsedTime:0,pseudoElement:0}),YL=ol(HL),KL=Ai({},Fd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),JL=ol(KL),QL=Ai({},Fd,{data:0}),SE=ol(QL),tA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=nA[t])?!!e[t]:!1}function P1(){return rA}var iA=Ai({},zm,{key:function(t){if(t.key){var e=tA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Yy(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?eA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:P1,charCode:function(t){return t.type==="keypress"?Yy(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Yy(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),oA=ol(iA),sA=Ai({},J_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),IE=ol(sA),aA=Ai({},zm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:P1}),lA=ol(aA),uA=Ai({},Fd,{propertyName:0,elapsedTime:0,pseudoElement:0}),cA=ol(uA),hA=Ai({},J_,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),pA=ol(hA),fA=[9,13,27,32],M1=Fc&&"CompositionEvent"in window,qg=null;Fc&&"documentMode"in document&&(qg=document.documentMode);var dA=Fc&&"TextEvent"in window&&!qg,pC=Fc&&(!M1||qg&&8<qg&&11>=qg),CE=" ",TE=!1;function fC(t,e){switch(t){case"keyup":return fA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var jf=!1;function gA(t,e){switch(t){case"compositionend":return dC(e);case"keypress":return e.which!==32?null:(TE=!0,CE);case"textInput":return t=e.data,t===CE&&TE?null:t;default:return null}}function mA(t,e){if(jf)return t==="compositionend"||!M1&&fC(t,e)?(t=hC(),Hy=C1=Vh=null,jf=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return pC&&e.locale!=="ko"?null:e.data;default:return null}}var yA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function PE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!yA[t.type]:e==="textarea"}function gC(t,e,n,r){ZI(r),e=v_(e,"onChange"),0<e.length&&(n=new T1("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Zg=null,sm=null;function _A(t){CC(t,0)}function Q_(t){var e=Xf(t);if(BI(e))return t}function vA(t,e){if(t==="change")return e}var mC=!1;if(Fc){var T0;if(Fc){var P0="oninput"in document;if(!P0){var ME=document.createElement("div");ME.setAttribute("oninput","return;"),P0=typeof ME.oninput=="function"}T0=P0}else T0=!1;mC=T0&&(!document.documentMode||9<document.documentMode)}function LE(){Zg&&(Zg.detachEvent("onpropertychange",yC),sm=Zg=null)}function yC(t){if(t.propertyName==="value"&&Q_(sm)){var e=[];gC(e,sm,t,w1(t)),YI(_A,e)}}function xA(t,e,n){t==="focusin"?(LE(),Zg=e,sm=n,Zg.attachEvent("onpropertychange",yC)):t==="focusout"&&LE()}function wA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Q_(sm)}function bA(t,e){if(t==="click")return Q_(e)}function EA(t,e){if(t==="input"||t==="change")return Q_(e)}function SA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yu=typeof Object.is=="function"?Object.is:SA;function am(t,e){if(yu(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!J0.call(e,s)||!yu(t[s],e[s]))return!1}return!0}function AE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function kE(t,e){var n=AE(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=AE(n)}}function _C(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?_C(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function vC(){for(var t=window,e=p_();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=p_(t.document)}return e}function L1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function IA(t){var e=vC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&_C(n.ownerDocument.documentElement,n)){if(r!==null&&L1(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,c=Math.min(r.start,s);r=r.end===void 0?c:Math.min(r.end,s),!t.extend&&c>r&&(s=r,r=c,c=s),s=kE(n,c);var f=kE(n,r);s&&f&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==f.node||t.focusOffset!==f.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),c>r?(t.addRange(e),t.extend(f.node,f.offset)):(e.setEnd(f.node,f.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var CA=Fc&&"documentMode"in document&&11>=document.documentMode,qf=null,yx=null,Xg=null,_x=!1;function NE(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;_x||qf==null||qf!==p_(r)||(r=qf,"selectionStart"in r&&L1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xg&&am(Xg,r)||(Xg=r,r=v_(yx,"onSelect"),0<r.length&&(e=new T1("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=qf)))}function Ly(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zf={animationend:Ly("Animation","AnimationEnd"),animationiteration:Ly("Animation","AnimationIteration"),animationstart:Ly("Animation","AnimationStart"),transitionend:Ly("Transition","TransitionEnd")},M0={},xC={};Fc&&(xC=document.createElement("div").style,"AnimationEvent"in window||(delete Zf.animationend.animation,delete Zf.animationiteration.animation,delete Zf.animationstart.animation),"TransitionEvent"in window||delete Zf.transitionend.transition);function tv(t){if(M0[t])return M0[t];if(!Zf[t])return t;var e=Zf[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in xC)return M0[t]=e[n];return t}var wC=tv("animationend"),bC=tv("animationiteration"),EC=tv("animationstart"),SC=tv("transitionend"),IC=new Map,DE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fp(t,e){IC.set(t,e),cf(e,[t])}for(var L0=0;L0<DE.length;L0++){var A0=DE[L0],TA=A0.toLowerCase(),PA=A0[0].toUpperCase()+A0.slice(1);fp(TA,"on"+PA)}fp(wC,"onAnimationEnd");fp(bC,"onAnimationIteration");fp(EC,"onAnimationStart");fp("dblclick","onDoubleClick");fp("focusin","onFocus");fp("focusout","onBlur");fp(SC,"onTransitionEnd");ud("onMouseEnter",["mouseout","mouseover"]);ud("onMouseLeave",["mouseout","mouseover"]);ud("onPointerEnter",["pointerout","pointerover"]);ud("onPointerLeave",["pointerout","pointerover"]);cf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cf("onBeforeInput",["compositionend","keypress","textInput","paste"]);cf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vg));function RE(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,TL(r,e,void 0,t),t.currentTarget=null}function CC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;t:{var c=void 0;if(e)for(var f=r.length-1;0<=f;f--){var u=r[f],w=u.instance,S=u.currentTarget;if(u=u.listener,w!==c&&s.isPropagationStopped())break t;RE(s,u,S),c=w}else for(f=0;f<r.length;f++){if(u=r[f],w=u.instance,S=u.currentTarget,u=u.listener,w!==c&&s.isPropagationStopped())break t;RE(s,u,S),c=w}}}if(d_)throw t=fx,d_=!1,fx=null,t}function ei(t,e){var n=e[Ex];n===void 0&&(n=e[Ex]=new Set);var r=t+"__bubble";n.has(r)||(TC(e,t,2,!1),n.add(r))}function k0(t,e,n){var r=0;e&&(r|=4),TC(n,t,r,e)}var Ay="_reactListening"+Math.random().toString(36).slice(2);function lm(t){if(!t[Ay]){t[Ay]=!0,DI.forEach(function(n){n!=="selectionchange"&&(MA.has(n)||k0(n,!1,t),k0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ay]||(e[Ay]=!0,k0("selectionchange",!1,e))}}function TC(t,e,n,r){switch(cC(e)){case 1:var s=GL;break;case 4:s=jL;break;default:s=I1}n=s.bind(null,e,n,t),s=void 0,!px||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function N0(t,e,n,r,s){var c=r;if(!(e&1)&&!(e&2)&&r!==null)t:for(;;){if(r===null)return;var f=r.tag;if(f===3||f===4){var u=r.stateNode.containerInfo;if(u===s||u.nodeType===8&&u.parentNode===s)break;if(f===4)for(f=r.return;f!==null;){var w=f.tag;if((w===3||w===4)&&(w=f.stateNode.containerInfo,w===s||w.nodeType===8&&w.parentNode===s))return;f=f.return}for(;u!==null;){if(f=Bp(u),f===null)return;if(w=f.tag,w===5||w===6){r=c=f;continue t}u=u.parentNode}}r=r.return}YI(function(){var S=c,A=w1(n),N=[];t:{var O=IC.get(t);if(O!==void 0){var j=T1,W=t;switch(t){case"keypress":if(Yy(n)===0)break t;case"keydown":case"keyup":j=oA;break;case"focusin":W="focus",j=C0;break;case"focusout":W="blur",j=C0;break;case"beforeblur":case"afterblur":j=C0;break;case"click":if(n.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=EE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=XL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=lA;break;case wC:case bC:case EC:j=YL;break;case SC:j=cA;break;case"scroll":j=qL;break;case"wheel":j=pA;break;case"copy":case"cut":case"paste":j=JL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=IE}var nt=(e&4)!==0,pt=!nt&&t==="scroll",J=nt?O!==null?O+"Capture":null:O;nt=[];for(var tt=S,Q;tt!==null;){Q=tt;var _t=Q.stateNode;if(Q.tag===5&&_t!==null&&(Q=_t,J!==null&&(_t=nm(tt,J),_t!=null&&nt.push(um(tt,_t,Q)))),pt)break;tt=tt.return}0<nt.length&&(O=new j(O,W,null,n,A),N.push({event:O,listeners:nt}))}}if(!(e&7)){t:{if(O=t==="mouseover"||t==="pointerover",j=t==="mouseout"||t==="pointerout",O&&n!==cx&&(W=n.relatedTarget||n.fromElement)&&(Bp(W)||W[Bc]))break t;if((j||O)&&(O=A.window===A?A:(O=A.ownerDocument)?O.defaultView||O.parentWindow:window,j?(W=n.relatedTarget||n.toElement,j=S,W=W?Bp(W):null,W!==null&&(pt=hf(W),W!==pt||W.tag!==5&&W.tag!==6)&&(W=null)):(j=null,W=S),j!==W)){if(nt=EE,_t="onMouseLeave",J="onMouseEnter",tt="mouse",(t==="pointerout"||t==="pointerover")&&(nt=IE,_t="onPointerLeave",J="onPointerEnter",tt="pointer"),pt=j==null?O:Xf(j),Q=W==null?O:Xf(W),O=new nt(_t,tt+"leave",j,n,A),O.target=pt,O.relatedTarget=Q,_t=null,Bp(A)===S&&(nt=new nt(J,tt+"enter",W,n,A),nt.target=Q,nt.relatedTarget=pt,_t=nt),pt=_t,j&&W)e:{for(nt=j,J=W,tt=0,Q=nt;Q;Q=zf(Q))tt++;for(Q=0,_t=J;_t;_t=zf(_t))Q++;for(;0<tt-Q;)nt=zf(nt),tt--;for(;0<Q-tt;)J=zf(J),Q--;for(;tt--;){if(nt===J||J!==null&&nt===J.alternate)break e;nt=zf(nt),J=zf(J)}nt=null}else nt=null;j!==null&&OE(N,O,j,nt,!1),W!==null&&pt!==null&&OE(N,pt,W,nt,!0)}}t:{if(O=S?Xf(S):window,j=O.nodeName&&O.nodeName.toLowerCase(),j==="select"||j==="input"&&O.type==="file")var Ot=vA;else if(PE(O))if(mC)Ot=EA;else{Ot=wA;var zt=xA}else(j=O.nodeName)&&j.toLowerCase()==="input"&&(O.type==="checkbox"||O.type==="radio")&&(Ot=bA);if(Ot&&(Ot=Ot(t,S))){gC(N,Ot,n,A);break t}zt&&zt(t,O,S),t==="focusout"&&(zt=O._wrapperState)&&zt.controlled&&O.type==="number"&&ox(O,"number",O.value)}switch(zt=S?Xf(S):window,t){case"focusin":(PE(zt)||zt.contentEditable==="true")&&(qf=zt,yx=S,Xg=null);break;case"focusout":Xg=yx=qf=null;break;case"mousedown":_x=!0;break;case"contextmenu":case"mouseup":case"dragend":_x=!1,NE(N,n,A);break;case"selectionchange":if(CA)break;case"keydown":case"keyup":NE(N,n,A)}var Rt;if(M1)t:{switch(t){case"compositionstart":var At="onCompositionStart";break t;case"compositionend":At="onCompositionEnd";break t;case"compositionupdate":At="onCompositionUpdate";break t}At=void 0}else jf?fC(t,n)&&(At="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(At="onCompositionStart");At&&(pC&&n.locale!=="ko"&&(jf||At!=="onCompositionStart"?At==="onCompositionEnd"&&jf&&(Rt=hC()):(Vh=A,C1="value"in Vh?Vh.value:Vh.textContent,jf=!0)),zt=v_(S,At),0<zt.length&&(At=new SE(At,t,null,n,A),N.push({event:At,listeners:zt}),Rt?At.data=Rt:(Rt=dC(n),Rt!==null&&(At.data=Rt)))),(Rt=dA?gA(t,n):mA(t,n))&&(S=v_(S,"onBeforeInput"),0<S.length&&(A=new SE("onBeforeInput","beforeinput",null,n,A),N.push({event:A,listeners:S}),A.data=Rt))}CC(N,e)})}function um(t,e,n){return{instance:t,listener:e,currentTarget:n}}function v_(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,c=s.stateNode;s.tag===5&&c!==null&&(s=c,c=nm(t,n),c!=null&&r.unshift(um(t,c,s)),c=nm(t,e),c!=null&&r.push(um(t,c,s))),t=t.return}return r}function zf(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function OE(t,e,n,r,s){for(var c=e._reactName,f=[];n!==null&&n!==r;){var u=n,w=u.alternate,S=u.stateNode;if(w!==null&&w===r)break;u.tag===5&&S!==null&&(u=S,s?(w=nm(n,c),w!=null&&f.unshift(um(n,w,u))):s||(w=nm(n,c),w!=null&&f.push(um(n,w,u)))),n=n.return}f.length!==0&&t.push({event:e,listeners:f})}var LA=/\r\n?/g,AA=/\u0000|\uFFFD/g;function zE(t){return(typeof t=="string"?t:""+t).replace(LA,`
`).replace(AA,"")}function ky(t,e,n){if(e=zE(e),zE(t)!==e&&n)throw Error(ve(425))}function x_(){}var vx=null,xx=null;function wx(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bx=typeof setTimeout=="function"?setTimeout:void 0,kA=typeof clearTimeout=="function"?clearTimeout:void 0,FE=typeof Promise=="function"?Promise:void 0,NA=typeof queueMicrotask=="function"?queueMicrotask:typeof FE<"u"?function(t){return FE.resolve(null).then(t).catch(DA)}:bx;function DA(t){setTimeout(function(){throw t})}function D0(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),om(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);om(e)}function Zh(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function BE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Bd=Math.random().toString(36).slice(2),Wu="__reactFiber$"+Bd,cm="__reactProps$"+Bd,Bc="__reactContainer$"+Bd,Ex="__reactEvents$"+Bd,RA="__reactListeners$"+Bd,OA="__reactHandles$"+Bd;function Bp(t){var e=t[Wu];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Bc]||n[Wu]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=BE(t);t!==null;){if(n=t[Wu])return n;t=BE(t)}return e}t=n,n=t.parentNode}return null}function Fm(t){return t=t[Wu]||t[Bc],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Xf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ve(33))}function ev(t){return t[cm]||null}var Sx=[],Wf=-1;function dp(t){return{current:t}}function ni(t){0>Wf||(t.current=Sx[Wf],Sx[Wf]=null,Wf--)}function Wr(t,e){Wf++,Sx[Wf]=t.current,t.current=e}var tp={},Ls=dp(tp),ba=dp(!1),qp=tp;function cd(t,e){var n=t.type.contextTypes;if(!n)return tp;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},c;for(c in n)s[c]=e[c];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ea(t){return t=t.childContextTypes,t!=null}function w_(){ni(ba),ni(Ls)}function VE(t,e,n){if(Ls.current!==tp)throw Error(ve(168));Wr(Ls,e),Wr(ba,n)}function PC(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(ve(108,xL(t)||"Unknown",s));return Ai({},n,r)}function b_(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||tp,qp=Ls.current,Wr(Ls,t),Wr(ba,ba.current),!0}function UE(t,e,n){var r=t.stateNode;if(!r)throw Error(ve(169));n?(t=PC(t,e,qp),r.__reactInternalMemoizedMergedChildContext=t,ni(ba),ni(Ls),Wr(Ls,t)):ni(ba),Wr(ba,n)}var Ac=null,nv=!1,R0=!1;function MC(t){Ac===null?Ac=[t]:Ac.push(t)}function zA(t){nv=!0,MC(t)}function gp(){if(!R0&&Ac!==null){R0=!0;var t=0,e=Er;try{var n=Ac;for(Er=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ac=null,nv=!1}catch(s){throw Ac!==null&&(Ac=Ac.slice(t+1)),tC(b1,gp),s}finally{Er=e,R0=!1}}return null}var Hf=[],Yf=0,E_=null,S_=0,Cl=[],Tl=0,Zp=null,kc=1,Nc="";function zp(t,e){Hf[Yf++]=S_,Hf[Yf++]=E_,E_=t,S_=e}function LC(t,e,n){Cl[Tl++]=kc,Cl[Tl++]=Nc,Cl[Tl++]=Zp,Zp=t;var r=kc;t=Nc;var s=32-fu(r)-1;r&=~(1<<s),n+=1;var c=32-fu(e)+s;if(30<c){var f=s-s%5;c=(r&(1<<f)-1).toString(32),r>>=f,s-=f,kc=1<<32-fu(e)+s|n<<s|r,Nc=c+t}else kc=1<<c|n<<s|r,Nc=t}function A1(t){t.return!==null&&(zp(t,1),LC(t,1,0))}function k1(t){for(;t===E_;)E_=Hf[--Yf],Hf[Yf]=null,S_=Hf[--Yf],Hf[Yf]=null;for(;t===Zp;)Zp=Cl[--Tl],Cl[Tl]=null,Nc=Cl[--Tl],Cl[Tl]=null,kc=Cl[--Tl],Cl[Tl]=null}var Xa=null,Za=null,gi=!1,cu=null;function AC(t,e){var n=Ll(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function $E(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xa=t,Za=Zh(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xa=t,Za=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Zp!==null?{id:kc,overflow:Nc}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ll(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Xa=t,Za=null,!0):!1;default:return!1}}function Ix(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Cx(t){if(gi){var e=Za;if(e){var n=e;if(!$E(t,e)){if(Ix(t))throw Error(ve(418));e=Zh(n.nextSibling);var r=Xa;e&&$E(t,e)?AC(r,n):(t.flags=t.flags&-4097|2,gi=!1,Xa=t)}}else{if(Ix(t))throw Error(ve(418));t.flags=t.flags&-4097|2,gi=!1,Xa=t}}}function GE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xa=t}function Ny(t){if(t!==Xa)return!1;if(!gi)return GE(t),gi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!wx(t.type,t.memoizedProps)),e&&(e=Za)){if(Ix(t))throw kC(),Error(ve(418));for(;e;)AC(t,e),e=Zh(e.nextSibling)}if(GE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ve(317));t:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Za=Zh(t.nextSibling);break t}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Za=null}}else Za=Xa?Zh(t.stateNode.nextSibling):null;return!0}function kC(){for(var t=Za;t;)t=Zh(t.nextSibling)}function hd(){Za=Xa=null,gi=!1}function N1(t){cu===null?cu=[t]:cu.push(t)}var FA=Qc.ReactCurrentBatchConfig;function lu(t,e){if(t&&t.defaultProps){e=Ai({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var I_=dp(null),C_=null,Kf=null,D1=null;function R1(){D1=Kf=C_=null}function O1(t){var e=I_.current;ni(I_),t._currentValue=e}function Tx(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function sd(t,e){C_=t,D1=Kf=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wa=!0),t.firstContext=null)}function Rl(t){var e=t._currentValue;if(D1!==t)if(t={context:t,memoizedValue:e,next:null},Kf===null){if(C_===null)throw Error(ve(308));Kf=t,C_.dependencies={lanes:0,firstContext:t}}else Kf=Kf.next=t;return e}var Vp=null;function z1(t){Vp===null?Vp=[t]:Vp.push(t)}function NC(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,z1(e)):(n.next=s.next,s.next=n),e.interleaved=n,Vc(t,r)}function Vc(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Oh=!1;function F1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function DC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Rc(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xh(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,sr&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Vc(t,n)}return s=r.interleaved,s===null?(e.next=e,z1(r)):(e.next=s.next,s.next=e),r.interleaved=e,Vc(t,n)}function Ky(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,E1(t,n)}}function jE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var f={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};c===null?s=c=f:c=c.next=f,n=n.next}while(n!==null);c===null?s=c=e:c=c.next=e}else s=c=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:c,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function T_(t,e,n,r){var s=t.updateQueue;Oh=!1;var c=s.firstBaseUpdate,f=s.lastBaseUpdate,u=s.shared.pending;if(u!==null){s.shared.pending=null;var w=u,S=w.next;w.next=null,f===null?c=S:f.next=S,f=w;var A=t.alternate;A!==null&&(A=A.updateQueue,u=A.lastBaseUpdate,u!==f&&(u===null?A.firstBaseUpdate=S:u.next=S,A.lastBaseUpdate=w))}if(c!==null){var N=s.baseState;f=0,A=S=w=null,u=c;do{var O=u.lane,j=u.eventTime;if((r&O)===O){A!==null&&(A=A.next={eventTime:j,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});t:{var W=t,nt=u;switch(O=e,j=n,nt.tag){case 1:if(W=nt.payload,typeof W=="function"){N=W.call(j,N,O);break t}N=W;break t;case 3:W.flags=W.flags&-65537|128;case 0:if(W=nt.payload,O=typeof W=="function"?W.call(j,N,O):W,O==null)break t;N=Ai({},N,O);break t;case 2:Oh=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,O=s.effects,O===null?s.effects=[u]:O.push(u))}else j={eventTime:j,lane:O,tag:u.tag,payload:u.payload,callback:u.callback,next:null},A===null?(S=A=j,w=N):A=A.next=j,f|=O;if(u=u.next,u===null){if(u=s.shared.pending,u===null)break;O=u,u=O.next,O.next=null,s.lastBaseUpdate=O,s.shared.pending=null}}while(!0);if(A===null&&(w=N),s.baseState=w,s.firstBaseUpdate=S,s.lastBaseUpdate=A,e=s.shared.interleaved,e!==null){s=e;do f|=s.lane,s=s.next;while(s!==e)}else c===null&&(s.shared.lanes=0);Wp|=f,t.lanes=f,t.memoizedState=N}}function qE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ve(191,s));s.call(r)}}}var RC=new NI.Component().refs;function Px(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ai({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var rv={isMounted:function(t){return(t=t._reactInternals)?hf(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Js(),s=Hh(t),c=Rc(r,s);c.payload=e,n!=null&&(c.callback=n),e=Xh(t,c,s),e!==null&&(du(e,t,s,r),Ky(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Js(),s=Hh(t),c=Rc(r,s);c.tag=1,c.payload=e,n!=null&&(c.callback=n),e=Xh(t,c,s),e!==null&&(du(e,t,s,r),Ky(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Js(),r=Hh(t),s=Rc(n,r);s.tag=2,e!=null&&(s.callback=e),e=Xh(t,s,r),e!==null&&(du(e,t,r,n),Ky(e,t,r))}};function ZE(t,e,n,r,s,c,f){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,c,f):e.prototype&&e.prototype.isPureReactComponent?!am(n,r)||!am(s,c):!0}function OC(t,e,n){var r=!1,s=tp,c=e.contextType;return typeof c=="object"&&c!==null?c=Rl(c):(s=Ea(e)?qp:Ls.current,r=e.contextTypes,c=(r=r!=null)?cd(t,s):tp),e=new e(n,c),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=rv,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=c),e}function XE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&rv.enqueueReplaceState(e,e.state,null)}function Mx(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=RC,F1(t);var c=e.contextType;typeof c=="object"&&c!==null?s.context=Rl(c):(c=Ea(e)?qp:Ls.current,s.context=cd(t,c)),s.state=t.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(Px(t,e,c,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&rv.enqueueReplaceState(s,s.state,null),T_(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ag(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ve(309));var r=n.stateNode}if(!r)throw Error(ve(147,t));var s=r,c=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(f){var u=s.refs;u===RC&&(u=s.refs={}),f===null?delete u[c]:u[c]=f},e._stringRef=c,e)}if(typeof t!="string")throw Error(ve(284));if(!n._owner)throw Error(ve(290,t))}return t}function Dy(t,e){throw t=Object.prototype.toString.call(e),Error(ve(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function WE(t){var e=t._init;return e(t._payload)}function zC(t){function e(J,tt){if(t){var Q=J.deletions;Q===null?(J.deletions=[tt],J.flags|=16):Q.push(tt)}}function n(J,tt){if(!t)return null;for(;tt!==null;)e(J,tt),tt=tt.sibling;return null}function r(J,tt){for(J=new Map;tt!==null;)tt.key!==null?J.set(tt.key,tt):J.set(tt.index,tt),tt=tt.sibling;return J}function s(J,tt){return J=Yh(J,tt),J.index=0,J.sibling=null,J}function c(J,tt,Q){return J.index=Q,t?(Q=J.alternate,Q!==null?(Q=Q.index,Q<tt?(J.flags|=2,tt):Q):(J.flags|=2,tt)):(J.flags|=1048576,tt)}function f(J){return t&&J.alternate===null&&(J.flags|=2),J}function u(J,tt,Q,_t){return tt===null||tt.tag!==6?(tt=$0(Q,J.mode,_t),tt.return=J,tt):(tt=s(tt,Q),tt.return=J,tt)}function w(J,tt,Q,_t){var Ot=Q.type;return Ot===Gf?A(J,tt,Q.props.children,_t,Q.key):tt!==null&&(tt.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===Rh&&WE(Ot)===tt.type)?(_t=s(tt,Q.props),_t.ref=Ag(J,tt,Q),_t.return=J,_t):(_t=r_(Q.type,Q.key,Q.props,null,J.mode,_t),_t.ref=Ag(J,tt,Q),_t.return=J,_t)}function S(J,tt,Q,_t){return tt===null||tt.tag!==4||tt.stateNode.containerInfo!==Q.containerInfo||tt.stateNode.implementation!==Q.implementation?(tt=G0(Q,J.mode,_t),tt.return=J,tt):(tt=s(tt,Q.children||[]),tt.return=J,tt)}function A(J,tt,Q,_t,Ot){return tt===null||tt.tag!==7?(tt=jp(Q,J.mode,_t,Ot),tt.return=J,tt):(tt=s(tt,Q),tt.return=J,tt)}function N(J,tt,Q){if(typeof tt=="string"&&tt!==""||typeof tt=="number")return tt=$0(""+tt,J.mode,Q),tt.return=J,tt;if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case Ey:return Q=r_(tt.type,tt.key,tt.props,null,J.mode,Q),Q.ref=Ag(J,null,tt),Q.return=J,Q;case $f:return tt=G0(tt,J.mode,Q),tt.return=J,tt;case Rh:var _t=tt._init;return N(J,_t(tt._payload),Q)}if(Fg(tt)||Cg(tt))return tt=jp(tt,J.mode,Q,null),tt.return=J,tt;Dy(J,tt)}return null}function O(J,tt,Q,_t){var Ot=tt!==null?tt.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Ot!==null?null:u(J,tt,""+Q,_t);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case Ey:return Q.key===Ot?w(J,tt,Q,_t):null;case $f:return Q.key===Ot?S(J,tt,Q,_t):null;case Rh:return Ot=Q._init,O(J,tt,Ot(Q._payload),_t)}if(Fg(Q)||Cg(Q))return Ot!==null?null:A(J,tt,Q,_t,null);Dy(J,Q)}return null}function j(J,tt,Q,_t,Ot){if(typeof _t=="string"&&_t!==""||typeof _t=="number")return J=J.get(Q)||null,u(tt,J,""+_t,Ot);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case Ey:return J=J.get(_t.key===null?Q:_t.key)||null,w(tt,J,_t,Ot);case $f:return J=J.get(_t.key===null?Q:_t.key)||null,S(tt,J,_t,Ot);case Rh:var zt=_t._init;return j(J,tt,Q,zt(_t._payload),Ot)}if(Fg(_t)||Cg(_t))return J=J.get(Q)||null,A(tt,J,_t,Ot,null);Dy(tt,_t)}return null}function W(J,tt,Q,_t){for(var Ot=null,zt=null,Rt=tt,At=tt=0,Ht=null;Rt!==null&&At<Q.length;At++){Rt.index>At?(Ht=Rt,Rt=null):Ht=Rt.sibling;var Xt=O(J,Rt,Q[At],_t);if(Xt===null){Rt===null&&(Rt=Ht);break}t&&Rt&&Xt.alternate===null&&e(J,Rt),tt=c(Xt,tt,At),zt===null?Ot=Xt:zt.sibling=Xt,zt=Xt,Rt=Ht}if(At===Q.length)return n(J,Rt),gi&&zp(J,At),Ot;if(Rt===null){for(;At<Q.length;At++)Rt=N(J,Q[At],_t),Rt!==null&&(tt=c(Rt,tt,At),zt===null?Ot=Rt:zt.sibling=Rt,zt=Rt);return gi&&zp(J,At),Ot}for(Rt=r(J,Rt);At<Q.length;At++)Ht=j(Rt,J,At,Q[At],_t),Ht!==null&&(t&&Ht.alternate!==null&&Rt.delete(Ht.key===null?At:Ht.key),tt=c(Ht,tt,At),zt===null?Ot=Ht:zt.sibling=Ht,zt=Ht);return t&&Rt.forEach(function(De){return e(J,De)}),gi&&zp(J,At),Ot}function nt(J,tt,Q,_t){var Ot=Cg(Q);if(typeof Ot!="function")throw Error(ve(150));if(Q=Ot.call(Q),Q==null)throw Error(ve(151));for(var zt=Ot=null,Rt=tt,At=tt=0,Ht=null,Xt=Q.next();Rt!==null&&!Xt.done;At++,Xt=Q.next()){Rt.index>At?(Ht=Rt,Rt=null):Ht=Rt.sibling;var De=O(J,Rt,Xt.value,_t);if(De===null){Rt===null&&(Rt=Ht);break}t&&Rt&&De.alternate===null&&e(J,Rt),tt=c(De,tt,At),zt===null?Ot=De:zt.sibling=De,zt=De,Rt=Ht}if(Xt.done)return n(J,Rt),gi&&zp(J,At),Ot;if(Rt===null){for(;!Xt.done;At++,Xt=Q.next())Xt=N(J,Xt.value,_t),Xt!==null&&(tt=c(Xt,tt,At),zt===null?Ot=Xt:zt.sibling=Xt,zt=Xt);return gi&&zp(J,At),Ot}for(Rt=r(J,Rt);!Xt.done;At++,Xt=Q.next())Xt=j(Rt,J,At,Xt.value,_t),Xt!==null&&(t&&Xt.alternate!==null&&Rt.delete(Xt.key===null?At:Xt.key),tt=c(Xt,tt,At),zt===null?Ot=Xt:zt.sibling=Xt,zt=Xt);return t&&Rt.forEach(function(ue){return e(J,ue)}),gi&&zp(J,At),Ot}function pt(J,tt,Q,_t){if(typeof Q=="object"&&Q!==null&&Q.type===Gf&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case Ey:t:{for(var Ot=Q.key,zt=tt;zt!==null;){if(zt.key===Ot){if(Ot=Q.type,Ot===Gf){if(zt.tag===7){n(J,zt.sibling),tt=s(zt,Q.props.children),tt.return=J,J=tt;break t}}else if(zt.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===Rh&&WE(Ot)===zt.type){n(J,zt.sibling),tt=s(zt,Q.props),tt.ref=Ag(J,zt,Q),tt.return=J,J=tt;break t}n(J,zt);break}else e(J,zt);zt=zt.sibling}Q.type===Gf?(tt=jp(Q.props.children,J.mode,_t,Q.key),tt.return=J,J=tt):(_t=r_(Q.type,Q.key,Q.props,null,J.mode,_t),_t.ref=Ag(J,tt,Q),_t.return=J,J=_t)}return f(J);case $f:t:{for(zt=Q.key;tt!==null;){if(tt.key===zt)if(tt.tag===4&&tt.stateNode.containerInfo===Q.containerInfo&&tt.stateNode.implementation===Q.implementation){n(J,tt.sibling),tt=s(tt,Q.children||[]),tt.return=J,J=tt;break t}else{n(J,tt);break}else e(J,tt);tt=tt.sibling}tt=G0(Q,J.mode,_t),tt.return=J,J=tt}return f(J);case Rh:return zt=Q._init,pt(J,tt,zt(Q._payload),_t)}if(Fg(Q))return W(J,tt,Q,_t);if(Cg(Q))return nt(J,tt,Q,_t);Dy(J,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,tt!==null&&tt.tag===6?(n(J,tt.sibling),tt=s(tt,Q),tt.return=J,J=tt):(n(J,tt),tt=$0(Q,J.mode,_t),tt.return=J,J=tt),f(J)):n(J,tt)}return pt}var pd=zC(!0),FC=zC(!1),Bm={},Ku=dp(Bm),hm=dp(Bm),pm=dp(Bm);function Up(t){if(t===Bm)throw Error(ve(174));return t}function B1(t,e){switch(Wr(pm,e),Wr(hm,t),Wr(Ku,Bm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ax(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ax(e,t)}ni(Ku),Wr(Ku,e)}function fd(){ni(Ku),ni(hm),ni(pm)}function BC(t){Up(pm.current);var e=Up(Ku.current),n=ax(e,t.type);e!==n&&(Wr(hm,t),Wr(Ku,n))}function V1(t){hm.current===t&&(ni(Ku),ni(hm))}var Ii=dp(0);function P_(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var O0=[];function U1(){for(var t=0;t<O0.length;t++)O0[t]._workInProgressVersionPrimary=null;O0.length=0}var Jy=Qc.ReactCurrentDispatcher,z0=Qc.ReactCurrentBatchConfig,Xp=0,Li=null,Co=null,jo=null,M_=!1,Wg=!1,fm=0,BA=0;function Cs(){throw Error(ve(321))}function $1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!yu(t[n],e[n]))return!1;return!0}function G1(t,e,n,r,s,c){if(Xp=c,Li=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Jy.current=t===null||t.memoizedState===null?GA:jA,t=n(r,s),Wg){c=0;do{if(Wg=!1,fm=0,25<=c)throw Error(ve(301));c+=1,jo=Co=null,e.updateQueue=null,Jy.current=qA,t=n(r,s)}while(Wg)}if(Jy.current=L_,e=Co!==null&&Co.next!==null,Xp=0,jo=Co=Li=null,M_=!1,e)throw Error(ve(300));return t}function j1(){var t=fm!==0;return fm=0,t}function Gu(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jo===null?Li.memoizedState=jo=t:jo=jo.next=t,jo}function Ol(){if(Co===null){var t=Li.alternate;t=t!==null?t.memoizedState:null}else t=Co.next;var e=jo===null?Li.memoizedState:jo.next;if(e!==null)jo=e,Co=t;else{if(t===null)throw Error(ve(310));Co=t,t={memoizedState:Co.memoizedState,baseState:Co.baseState,baseQueue:Co.baseQueue,queue:Co.queue,next:null},jo===null?Li.memoizedState=jo=t:jo=jo.next=t}return jo}function dm(t,e){return typeof e=="function"?e(t):e}function F0(t){var e=Ol(),n=e.queue;if(n===null)throw Error(ve(311));n.lastRenderedReducer=t;var r=Co,s=r.baseQueue,c=n.pending;if(c!==null){if(s!==null){var f=s.next;s.next=c.next,c.next=f}r.baseQueue=s=c,n.pending=null}if(s!==null){c=s.next,r=r.baseState;var u=f=null,w=null,S=c;do{var A=S.lane;if((Xp&A)===A)w!==null&&(w=w.next={lane:0,action:S.action,hasEagerState:S.hasEagerState,eagerState:S.eagerState,next:null}),r=S.hasEagerState?S.eagerState:t(r,S.action);else{var N={lane:A,action:S.action,hasEagerState:S.hasEagerState,eagerState:S.eagerState,next:null};w===null?(u=w=N,f=r):w=w.next=N,Li.lanes|=A,Wp|=A}S=S.next}while(S!==null&&S!==c);w===null?f=r:w.next=u,yu(r,e.memoizedState)||(wa=!0),e.memoizedState=r,e.baseState=f,e.baseQueue=w,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do c=s.lane,Li.lanes|=c,Wp|=c,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function B0(t){var e=Ol(),n=e.queue;if(n===null)throw Error(ve(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,c=e.memoizedState;if(s!==null){n.pending=null;var f=s=s.next;do c=t(c,f.action),f=f.next;while(f!==s);yu(c,e.memoizedState)||(wa=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),n.lastRenderedState=c}return[c,r]}function VC(){}function UC(t,e){var n=Li,r=Ol(),s=e(),c=!yu(r.memoizedState,s);if(c&&(r.memoizedState=s,wa=!0),r=r.queue,q1(jC.bind(null,n,r,t),[t]),r.getSnapshot!==e||c||jo!==null&&jo.memoizedState.tag&1){if(n.flags|=2048,gm(9,GC.bind(null,n,r,s,e),void 0,null),Ho===null)throw Error(ve(349));Xp&30||$C(n,e,s)}return s}function $C(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Li.updateQueue,e===null?(e={lastEffect:null,stores:null},Li.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function GC(t,e,n,r){e.value=n,e.getSnapshot=r,qC(e)&&ZC(t)}function jC(t,e,n){return n(function(){qC(e)&&ZC(t)})}function qC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!yu(t,n)}catch{return!0}}function ZC(t){var e=Vc(t,1);e!==null&&du(e,t,1,-1)}function HE(t){var e=Gu();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dm,lastRenderedState:t},e.queue=t,t=t.dispatch=$A.bind(null,Li,t),[e.memoizedState,t]}function gm(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Li.updateQueue,e===null?(e={lastEffect:null,stores:null},Li.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function XC(){return Ol().memoizedState}function Qy(t,e,n,r){var s=Gu();Li.flags|=t,s.memoizedState=gm(1|e,n,void 0,r===void 0?null:r)}function iv(t,e,n,r){var s=Ol();r=r===void 0?null:r;var c=void 0;if(Co!==null){var f=Co.memoizedState;if(c=f.destroy,r!==null&&$1(r,f.deps)){s.memoizedState=gm(e,n,c,r);return}}Li.flags|=t,s.memoizedState=gm(1|e,n,c,r)}function YE(t,e){return Qy(8390656,8,t,e)}function q1(t,e){return iv(2048,8,t,e)}function WC(t,e){return iv(4,2,t,e)}function HC(t,e){return iv(4,4,t,e)}function YC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function KC(t,e,n){return n=n!=null?n.concat([t]):null,iv(4,4,YC.bind(null,e,t),n)}function Z1(){}function JC(t,e){var n=Ol();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function QC(t,e){var n=Ol();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function tT(t,e,n){return Xp&21?(yu(n,e)||(n=rC(),Li.lanes|=n,Wp|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wa=!0),t.memoizedState=n)}function VA(t,e){var n=Er;Er=n!==0&&4>n?n:4,t(!0);var r=z0.transition;z0.transition={};try{t(!1),e()}finally{Er=n,z0.transition=r}}function eT(){return Ol().memoizedState}function UA(t,e,n){var r=Hh(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},nT(t))rT(e,n);else if(n=NC(t,e,n,r),n!==null){var s=Js();du(n,t,r,s),iT(n,e,r)}}function $A(t,e,n){var r=Hh(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(nT(t))rT(e,s);else{var c=t.alternate;if(t.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var f=e.lastRenderedState,u=c(f,n);if(s.hasEagerState=!0,s.eagerState=u,yu(u,f)){var w=e.interleaved;w===null?(s.next=s,z1(e)):(s.next=w.next,w.next=s),e.interleaved=s;return}}catch{}finally{}n=NC(t,e,s,r),n!==null&&(s=Js(),du(n,t,r,s),iT(n,e,r))}}function nT(t){var e=t.alternate;return t===Li||e!==null&&e===Li}function rT(t,e){Wg=M_=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function iT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,E1(t,n)}}var L_={readContext:Rl,useCallback:Cs,useContext:Cs,useEffect:Cs,useImperativeHandle:Cs,useInsertionEffect:Cs,useLayoutEffect:Cs,useMemo:Cs,useReducer:Cs,useRef:Cs,useState:Cs,useDebugValue:Cs,useDeferredValue:Cs,useTransition:Cs,useMutableSource:Cs,useSyncExternalStore:Cs,useId:Cs,unstable_isNewReconciler:!1},GA={readContext:Rl,useCallback:function(t,e){return Gu().memoizedState=[t,e===void 0?null:e],t},useContext:Rl,useEffect:YE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Qy(4194308,4,YC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Qy(4194308,4,t,e)},useInsertionEffect:function(t,e){return Qy(4,2,t,e)},useMemo:function(t,e){var n=Gu();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Gu();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=UA.bind(null,Li,t),[r.memoizedState,t]},useRef:function(t){var e=Gu();return t={current:t},e.memoizedState=t},useState:HE,useDebugValue:Z1,useDeferredValue:function(t){return Gu().memoizedState=t},useTransition:function(){var t=HE(!1),e=t[0];return t=VA.bind(null,t[1]),Gu().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Li,s=Gu();if(gi){if(n===void 0)throw Error(ve(407));n=n()}else{if(n=e(),Ho===null)throw Error(ve(349));Xp&30||$C(r,e,n)}s.memoizedState=n;var c={value:n,getSnapshot:e};return s.queue=c,YE(jC.bind(null,r,c,t),[t]),r.flags|=2048,gm(9,GC.bind(null,r,c,n,e),void 0,null),n},useId:function(){var t=Gu(),e=Ho.identifierPrefix;if(gi){var n=Nc,r=kc;n=(r&~(1<<32-fu(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=fm++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=BA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},jA={readContext:Rl,useCallback:JC,useContext:Rl,useEffect:q1,useImperativeHandle:KC,useInsertionEffect:WC,useLayoutEffect:HC,useMemo:QC,useReducer:F0,useRef:XC,useState:function(){return F0(dm)},useDebugValue:Z1,useDeferredValue:function(t){var e=Ol();return tT(e,Co.memoizedState,t)},useTransition:function(){var t=F0(dm)[0],e=Ol().memoizedState;return[t,e]},useMutableSource:VC,useSyncExternalStore:UC,useId:eT,unstable_isNewReconciler:!1},qA={readContext:Rl,useCallback:JC,useContext:Rl,useEffect:q1,useImperativeHandle:KC,useInsertionEffect:WC,useLayoutEffect:HC,useMemo:QC,useReducer:B0,useRef:XC,useState:function(){return B0(dm)},useDebugValue:Z1,useDeferredValue:function(t){var e=Ol();return Co===null?e.memoizedState=t:tT(e,Co.memoizedState,t)},useTransition:function(){var t=B0(dm)[0],e=Ol().memoizedState;return[t,e]},useMutableSource:VC,useSyncExternalStore:UC,useId:eT,unstable_isNewReconciler:!1};function dd(t,e){try{var n="",r=e;do n+=vL(r),r=r.return;while(r);var s=n}catch(c){s=`
Error generating stack: `+c.message+`
`+c.stack}return{value:t,source:e,stack:s,digest:null}}function V0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Lx(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ZA=typeof WeakMap=="function"?WeakMap:Map;function oT(t,e,n){n=Rc(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){k_||(k_=!0,Vx=r),Lx(t,e)},n}function sT(t,e,n){n=Rc(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Lx(t,e)}}var c=t.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(n.callback=function(){Lx(t,e),typeof r!="function"&&(Wh===null?Wh=new Set([this]):Wh.add(this));var f=e.stack;this.componentDidCatch(e.value,{componentStack:f!==null?f:""})}),n}function KE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ZA;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=sk.bind(null,t,e,n),e.then(t,t))}function JE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function QE(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Rc(-1,1),e.tag=2,Xh(n,e,1))),n.lanes|=1),t)}var XA=Qc.ReactCurrentOwner,wa=!1;function Hs(t,e,n,r){e.child=t===null?FC(e,null,n,r):pd(e,t.child,n,r)}function tS(t,e,n,r,s){n=n.render;var c=e.ref;return sd(e,s),r=G1(t,e,n,r,c,s),n=j1(),t!==null&&!wa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Uc(t,e,s)):(gi&&n&&A1(e),e.flags|=1,Hs(t,e,r,s),e.child)}function eS(t,e,n,r,s){if(t===null){var c=n.type;return typeof c=="function"&&!tw(c)&&c.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=c,aT(t,e,c,r,s)):(t=r_(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(c=t.child,!(t.lanes&s)){var f=c.memoizedProps;if(n=n.compare,n=n!==null?n:am,n(f,r)&&t.ref===e.ref)return Uc(t,e,s)}return e.flags|=1,t=Yh(c,r),t.ref=e.ref,t.return=e,e.child=t}function aT(t,e,n,r,s){if(t!==null){var c=t.memoizedProps;if(am(c,r)&&t.ref===e.ref)if(wa=!1,e.pendingProps=r=c,(t.lanes&s)!==0)t.flags&131072&&(wa=!0);else return e.lanes=t.lanes,Uc(t,e,s)}return Ax(t,e,n,r,s)}function lT(t,e,n){var r=e.pendingProps,s=r.children,c=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wr(Qf,ja),ja|=n;else{if(!(n&1073741824))return t=c!==null?c.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Wr(Qf,ja),ja|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=c!==null?c.baseLanes:n,Wr(Qf,ja),ja|=r}else c!==null?(r=c.baseLanes|n,e.memoizedState=null):r=n,Wr(Qf,ja),ja|=r;return Hs(t,e,s,n),e.child}function uT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ax(t,e,n,r,s){var c=Ea(n)?qp:Ls.current;return c=cd(e,c),sd(e,s),n=G1(t,e,n,r,c,s),r=j1(),t!==null&&!wa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Uc(t,e,s)):(gi&&r&&A1(e),e.flags|=1,Hs(t,e,n,s),e.child)}function nS(t,e,n,r,s){if(Ea(n)){var c=!0;b_(e)}else c=!1;if(sd(e,s),e.stateNode===null)t_(t,e),OC(e,n,r),Mx(e,n,r,s),r=!0;else if(t===null){var f=e.stateNode,u=e.memoizedProps;f.props=u;var w=f.context,S=n.contextType;typeof S=="object"&&S!==null?S=Rl(S):(S=Ea(n)?qp:Ls.current,S=cd(e,S));var A=n.getDerivedStateFromProps,N=typeof A=="function"||typeof f.getSnapshotBeforeUpdate=="function";N||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(u!==r||w!==S)&&XE(e,f,r,S),Oh=!1;var O=e.memoizedState;f.state=O,T_(e,r,f,s),w=e.memoizedState,u!==r||O!==w||ba.current||Oh?(typeof A=="function"&&(Px(e,n,A,r),w=e.memoizedState),(u=Oh||ZE(e,n,u,r,O,w,S))?(N||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(e.flags|=4194308)):(typeof f.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=w),f.props=r,f.state=w,f.context=S,r=u):(typeof f.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{f=e.stateNode,DC(t,e),u=e.memoizedProps,S=e.type===e.elementType?u:lu(e.type,u),f.props=S,N=e.pendingProps,O=f.context,w=n.contextType,typeof w=="object"&&w!==null?w=Rl(w):(w=Ea(n)?qp:Ls.current,w=cd(e,w));var j=n.getDerivedStateFromProps;(A=typeof j=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(u!==N||O!==w)&&XE(e,f,r,w),Oh=!1,O=e.memoizedState,f.state=O,T_(e,r,f,s);var W=e.memoizedState;u!==N||O!==W||ba.current||Oh?(typeof j=="function"&&(Px(e,n,j,r),W=e.memoizedState),(S=Oh||ZE(e,n,S,r,O,W,w)||!1)?(A||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(r,W,w),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(r,W,w)),typeof f.componentDidUpdate=="function"&&(e.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof f.componentDidUpdate!="function"||u===t.memoizedProps&&O===t.memoizedState||(e.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&O===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=W),f.props=r,f.state=W,f.context=w,r=S):(typeof f.componentDidUpdate!="function"||u===t.memoizedProps&&O===t.memoizedState||(e.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&O===t.memoizedState||(e.flags|=1024),r=!1)}return kx(t,e,n,r,c,s)}function kx(t,e,n,r,s,c){uT(t,e);var f=(e.flags&128)!==0;if(!r&&!f)return s&&UE(e,n,!1),Uc(t,e,c);r=e.stateNode,XA.current=e;var u=f&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&f?(e.child=pd(e,t.child,null,c),e.child=pd(e,null,u,c)):Hs(t,e,u,c),e.memoizedState=r.state,s&&UE(e,n,!0),e.child}function cT(t){var e=t.stateNode;e.pendingContext?VE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&VE(t,e.context,!1),B1(t,e.containerInfo)}function rS(t,e,n,r,s){return hd(),N1(s),e.flags|=256,Hs(t,e,n,r),e.child}var Nx={dehydrated:null,treeContext:null,retryLane:0};function Dx(t){return{baseLanes:t,cachePool:null,transitions:null}}function hT(t,e,n){var r=e.pendingProps,s=Ii.current,c=!1,f=(e.flags&128)!==0,u;if((u=f)||(u=t!==null&&t.memoizedState===null?!1:(s&2)!==0),u?(c=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Wr(Ii,s&1),t===null)return Cx(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(f=r.children,t=r.fallback,c?(r=e.mode,c=e.child,f={mode:"hidden",children:f},!(r&1)&&c!==null?(c.childLanes=0,c.pendingProps=f):c=av(f,r,0,null),t=jp(t,r,n,null),c.return=e,t.return=e,c.sibling=t,e.child=c,e.child.memoizedState=Dx(n),e.memoizedState=Nx,t):X1(e,f));if(s=t.memoizedState,s!==null&&(u=s.dehydrated,u!==null))return WA(t,e,f,r,u,s,n);if(c){c=r.fallback,f=e.mode,s=t.child,u=s.sibling;var w={mode:"hidden",children:r.children};return!(f&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=w,e.deletions=null):(r=Yh(s,w),r.subtreeFlags=s.subtreeFlags&14680064),u!==null?c=Yh(u,c):(c=jp(c,f,n,null),c.flags|=2),c.return=e,r.return=e,r.sibling=c,e.child=r,r=c,c=e.child,f=t.child.memoizedState,f=f===null?Dx(n):{baseLanes:f.baseLanes|n,cachePool:null,transitions:f.transitions},c.memoizedState=f,c.childLanes=t.childLanes&~n,e.memoizedState=Nx,r}return c=t.child,t=c.sibling,r=Yh(c,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function X1(t,e){return e=av({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ry(t,e,n,r){return r!==null&&N1(r),pd(e,t.child,null,n),t=X1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function WA(t,e,n,r,s,c,f){if(n)return e.flags&256?(e.flags&=-257,r=V0(Error(ve(422))),Ry(t,e,f,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(c=r.fallback,s=e.mode,r=av({mode:"visible",children:r.children},s,0,null),c=jp(c,s,f,null),c.flags|=2,r.return=e,c.return=e,r.sibling=c,e.child=r,e.mode&1&&pd(e,t.child,null,f),e.child.memoizedState=Dx(f),e.memoizedState=Nx,c);if(!(e.mode&1))return Ry(t,e,f,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var u=r.dgst;return r=u,c=Error(ve(419)),r=V0(c,r,void 0),Ry(t,e,f,r)}if(u=(f&t.childLanes)!==0,wa||u){if(r=Ho,r!==null){switch(f&-f){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|f)?0:s,s!==0&&s!==c.retryLane&&(c.retryLane=s,Vc(t,s),du(r,t,s,-1))}return Q1(),r=V0(Error(ve(421))),Ry(t,e,f,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=ak.bind(null,t),s._reactRetry=e,null):(t=c.treeContext,Za=Zh(s.nextSibling),Xa=e,gi=!0,cu=null,t!==null&&(Cl[Tl++]=kc,Cl[Tl++]=Nc,Cl[Tl++]=Zp,kc=t.id,Nc=t.overflow,Zp=e),e=X1(e,r.children),e.flags|=4096,e)}function iS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Tx(t.return,e,n)}function U0(t,e,n,r,s){var c=t.memoizedState;c===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=r,c.tail=n,c.tailMode=s)}function pT(t,e,n){var r=e.pendingProps,s=r.revealOrder,c=r.tail;if(Hs(t,e,r.children,n),r=Ii.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)t:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&iS(t,n,e);else if(t.tag===19)iS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;t.sibling===null;){if(t.return===null||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Wr(Ii,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&P_(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),U0(e,!1,s,n,c);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&P_(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}U0(e,!0,n,null,c);break;case"together":U0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function t_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Uc(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Wp|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ve(153));if(e.child!==null){for(t=e.child,n=Yh(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Yh(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function HA(t,e,n){switch(e.tag){case 3:cT(e),hd();break;case 5:BC(e);break;case 1:Ea(e.type)&&b_(e);break;case 4:B1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Wr(I_,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Wr(Ii,Ii.current&1),e.flags|=128,null):n&e.child.childLanes?hT(t,e,n):(Wr(Ii,Ii.current&1),t=Uc(t,e,n),t!==null?t.sibling:null);Wr(Ii,Ii.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return pT(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Wr(Ii,Ii.current),r)break;return null;case 22:case 23:return e.lanes=0,lT(t,e,n)}return Uc(t,e,n)}var fT,Rx,dT,gT;fT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Rx=function(){};dT=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Up(Ku.current);var c=null;switch(n){case"input":s=rx(t,s),r=rx(t,r),c=[];break;case"select":s=Ai({},s,{value:void 0}),r=Ai({},r,{value:void 0}),c=[];break;case"textarea":s=sx(t,s),r=sx(t,r),c=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=x_)}lx(n,r);var f;n=null;for(S in s)if(!r.hasOwnProperty(S)&&s.hasOwnProperty(S)&&s[S]!=null)if(S==="style"){var u=s[S];for(f in u)u.hasOwnProperty(f)&&(n||(n={}),n[f]="")}else S!=="dangerouslySetInnerHTML"&&S!=="children"&&S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(tm.hasOwnProperty(S)?c||(c=[]):(c=c||[]).push(S,null));for(S in r){var w=r[S];if(u=s!=null?s[S]:void 0,r.hasOwnProperty(S)&&w!==u&&(w!=null||u!=null))if(S==="style")if(u){for(f in u)!u.hasOwnProperty(f)||w&&w.hasOwnProperty(f)||(n||(n={}),n[f]="");for(f in w)w.hasOwnProperty(f)&&u[f]!==w[f]&&(n||(n={}),n[f]=w[f])}else n||(c||(c=[]),c.push(S,n)),n=w;else S==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,u=u?u.__html:void 0,w!=null&&u!==w&&(c=c||[]).push(S,w)):S==="children"?typeof w!="string"&&typeof w!="number"||(c=c||[]).push(S,""+w):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&(tm.hasOwnProperty(S)?(w!=null&&S==="onScroll"&&ei("scroll",t),c||u===w||(c=[])):(c=c||[]).push(S,w))}n&&(c=c||[]).push("style",n);var S=c;(e.updateQueue=S)&&(e.flags|=4)}};gT=function(t,e,n,r){n!==r&&(e.flags|=4)};function kg(t,e){if(!gi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function YA(t,e,n){var r=e.pendingProps;switch(k1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ts(e),null;case 1:return Ea(e.type)&&w_(),Ts(e),null;case 3:return r=e.stateNode,fd(),ni(ba),ni(Ls),U1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ny(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cu!==null&&(Gx(cu),cu=null))),Rx(t,e),Ts(e),null;case 5:V1(e);var s=Up(pm.current);if(n=e.type,t!==null&&e.stateNode!=null)dT(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ve(166));return Ts(e),null}if(t=Up(Ku.current),Ny(e)){r=e.stateNode,n=e.type;var c=e.memoizedProps;switch(r[Wu]=e,r[cm]=c,t=(e.mode&1)!==0,n){case"dialog":ei("cancel",r),ei("close",r);break;case"iframe":case"object":case"embed":ei("load",r);break;case"video":case"audio":for(s=0;s<Vg.length;s++)ei(Vg[s],r);break;case"source":ei("error",r);break;case"img":case"image":case"link":ei("error",r),ei("load",r);break;case"details":ei("toggle",r);break;case"input":fE(r,c),ei("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!c.multiple},ei("invalid",r);break;case"textarea":gE(r,c),ei("invalid",r)}lx(n,c),s=null;for(var f in c)if(c.hasOwnProperty(f)){var u=c[f];f==="children"?typeof u=="string"?r.textContent!==u&&(c.suppressHydrationWarning!==!0&&ky(r.textContent,u,t),s=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(c.suppressHydrationWarning!==!0&&ky(r.textContent,u,t),s=["children",""+u]):tm.hasOwnProperty(f)&&u!=null&&f==="onScroll"&&ei("scroll",r)}switch(n){case"input":Sy(r),dE(r,c,!0);break;case"textarea":Sy(r),mE(r);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(r.onclick=x_)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{f=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$I(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=f.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=f.createElement(n,{is:r.is}):(t=f.createElement(n),n==="select"&&(f=t,r.multiple?f.multiple=!0:r.size&&(f.size=r.size))):t=f.createElementNS(t,n),t[Wu]=e,t[cm]=r,fT(t,e,!1,!1),e.stateNode=t;t:{switch(f=ux(n,r),n){case"dialog":ei("cancel",t),ei("close",t),s=r;break;case"iframe":case"object":case"embed":ei("load",t),s=r;break;case"video":case"audio":for(s=0;s<Vg.length;s++)ei(Vg[s],t);s=r;break;case"source":ei("error",t),s=r;break;case"img":case"image":case"link":ei("error",t),ei("load",t),s=r;break;case"details":ei("toggle",t),s=r;break;case"input":fE(t,r),s=rx(t,r),ei("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ai({},r,{value:void 0}),ei("invalid",t);break;case"textarea":gE(t,r),s=sx(t,r),ei("invalid",t);break;default:s=r}lx(n,s),u=s;for(c in u)if(u.hasOwnProperty(c)){var w=u[c];c==="style"?qI(t,w):c==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,w!=null&&GI(t,w)):c==="children"?typeof w=="string"?(n!=="textarea"||w!=="")&&em(t,w):typeof w=="number"&&em(t,""+w):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(tm.hasOwnProperty(c)?w!=null&&c==="onScroll"&&ei("scroll",t):w!=null&&y1(t,c,w,f))}switch(n){case"input":Sy(t),dE(t,r,!1);break;case"textarea":Sy(t),mE(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Qh(r.value));break;case"select":t.multiple=!!r.multiple,c=r.value,c!=null?nd(t,!!r.multiple,c,!1):r.defaultValue!=null&&nd(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=x_)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ts(e),null;case 6:if(t&&e.stateNode!=null)gT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ve(166));if(n=Up(pm.current),Up(Ku.current),Ny(e)){if(r=e.stateNode,n=e.memoizedProps,r[Wu]=e,(c=r.nodeValue!==n)&&(t=Xa,t!==null))switch(t.tag){case 3:ky(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ky(r.nodeValue,n,(t.mode&1)!==0)}c&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Wu]=e,e.stateNode=r}return Ts(e),null;case 13:if(ni(Ii),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(gi&&Za!==null&&e.mode&1&&!(e.flags&128))kC(),hd(),e.flags|=98560,c=!1;else if(c=Ny(e),r!==null&&r.dehydrated!==null){if(t===null){if(!c)throw Error(ve(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(ve(317));c[Wu]=e}else hd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ts(e),c=!1}else cu!==null&&(Gx(cu),cu=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ii.current&1?To===0&&(To=3):Q1())),e.updateQueue!==null&&(e.flags|=4),Ts(e),null);case 4:return fd(),Rx(t,e),t===null&&lm(e.stateNode.containerInfo),Ts(e),null;case 10:return O1(e.type._context),Ts(e),null;case 17:return Ea(e.type)&&w_(),Ts(e),null;case 19:if(ni(Ii),c=e.memoizedState,c===null)return Ts(e),null;if(r=(e.flags&128)!==0,f=c.rendering,f===null)if(r)kg(c,!1);else{if(To!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(f=P_(t),f!==null){for(e.flags|=128,kg(c,!1),r=f.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)c=n,t=r,c.flags&=14680066,f=c.alternate,f===null?(c.childLanes=0,c.lanes=t,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=f.childLanes,c.lanes=f.lanes,c.child=f.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=f.memoizedProps,c.memoizedState=f.memoizedState,c.updateQueue=f.updateQueue,c.type=f.type,t=f.dependencies,c.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Wr(Ii,Ii.current&1|2),e.child}t=t.sibling}c.tail!==null&&ro()>gd&&(e.flags|=128,r=!0,kg(c,!1),e.lanes=4194304)}else{if(!r)if(t=P_(f),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),kg(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!gi)return Ts(e),null}else 2*ro()-c.renderingStartTime>gd&&n!==1073741824&&(e.flags|=128,r=!0,kg(c,!1),e.lanes=4194304);c.isBackwards?(f.sibling=e.child,e.child=f):(n=c.last,n!==null?n.sibling=f:e.child=f,c.last=f)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=ro(),e.sibling=null,n=Ii.current,Wr(Ii,r?n&1|2:n&1),e):(Ts(e),null);case 22:case 23:return J1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ja&1073741824&&(Ts(e),e.subtreeFlags&6&&(e.flags|=8192)):Ts(e),null;case 24:return null;case 25:return null}throw Error(ve(156,e.tag))}function KA(t,e){switch(k1(e),e.tag){case 1:return Ea(e.type)&&w_(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return fd(),ni(ba),ni(Ls),U1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return V1(e),null;case 13:if(ni(Ii),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ve(340));hd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ni(Ii),null;case 4:return fd(),null;case 10:return O1(e.type._context),null;case 22:case 23:return J1(),null;case 24:return null;default:return null}}var Oy=!1,Ps=!1,JA=typeof WeakSet=="function"?WeakSet:Set,We=null;function Jf(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Vi(t,e,r)}else n.current=null}function Ox(t,e,n){try{n()}catch(r){Vi(t,e,r)}}var oS=!1;function QA(t,e){if(vx=y_,t=vC(),L1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,c=r.focusNode;r=r.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break t}var f=0,u=-1,w=-1,S=0,A=0,N=t,O=null;e:for(;;){for(var j;N!==n||s!==0&&N.nodeType!==3||(u=f+s),N!==c||r!==0&&N.nodeType!==3||(w=f+r),N.nodeType===3&&(f+=N.nodeValue.length),(j=N.firstChild)!==null;)O=N,N=j;for(;;){if(N===t)break e;if(O===n&&++S===s&&(u=f),O===c&&++A===r&&(w=f),(j=N.nextSibling)!==null)break;N=O,O=N.parentNode}N=j}n=u===-1||w===-1?null:{start:u,end:w}}else n=null}n=n||{start:0,end:0}}else n=null;for(xx={focusedElem:t,selectionRange:n},y_=!1,We=e;We!==null;)if(e=We,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,We=t;else for(;We!==null;){e=We;try{var W=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(W!==null){var nt=W.memoizedProps,pt=W.memoizedState,J=e.stateNode,tt=J.getSnapshotBeforeUpdate(e.elementType===e.type?nt:lu(e.type,nt),pt);J.__reactInternalSnapshotBeforeUpdate=tt}break;case 3:var Q=e.stateNode.containerInfo;Q.nodeType===1?Q.textContent="":Q.nodeType===9&&Q.documentElement&&Q.removeChild(Q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ve(163))}}catch(_t){Vi(e,e.return,_t)}if(t=e.sibling,t!==null){t.return=e.return,We=t;break}We=e.return}return W=oS,oS=!1,W}function Hg(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var c=s.destroy;s.destroy=void 0,c!==void 0&&Ox(e,n,c)}s=s.next}while(s!==r)}}function ov(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function zx(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function mT(t){var e=t.alternate;e!==null&&(t.alternate=null,mT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Wu],delete e[cm],delete e[Ex],delete e[RA],delete e[OA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yT(t){return t.tag===5||t.tag===3||t.tag===4}function sS(t){t:for(;;){for(;t.sibling===null;){if(t.return===null||yT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue t;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Fx(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=x_));else if(r!==4&&(t=t.child,t!==null))for(Fx(t,e,n),t=t.sibling;t!==null;)Fx(t,e,n),t=t.sibling}function Bx(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Bx(t,e,n),t=t.sibling;t!==null;)Bx(t,e,n),t=t.sibling}var cs=null,uu=!1;function kh(t,e,n){for(n=n.child;n!==null;)_T(t,e,n),n=n.sibling}function _T(t,e,n){if(Yu&&typeof Yu.onCommitFiberUnmount=="function")try{Yu.onCommitFiberUnmount(K_,n)}catch{}switch(n.tag){case 5:Ps||Jf(n,e);case 6:var r=cs,s=uu;cs=null,kh(t,e,n),cs=r,uu=s,cs!==null&&(uu?(t=cs,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):cs.removeChild(n.stateNode));break;case 18:cs!==null&&(uu?(t=cs,n=n.stateNode,t.nodeType===8?D0(t.parentNode,n):t.nodeType===1&&D0(t,n),om(t)):D0(cs,n.stateNode));break;case 4:r=cs,s=uu,cs=n.stateNode.containerInfo,uu=!0,kh(t,e,n),cs=r,uu=s;break;case 0:case 11:case 14:case 15:if(!Ps&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var c=s,f=c.destroy;c=c.tag,f!==void 0&&(c&2||c&4)&&Ox(n,e,f),s=s.next}while(s!==r)}kh(t,e,n);break;case 1:if(!Ps&&(Jf(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Vi(n,e,u)}kh(t,e,n);break;case 21:kh(t,e,n);break;case 22:n.mode&1?(Ps=(r=Ps)||n.memoizedState!==null,kh(t,e,n),Ps=r):kh(t,e,n);break;default:kh(t,e,n)}}function aS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new JA),e.forEach(function(r){var s=lk.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function su(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var c=t,f=e,u=f;t:for(;u!==null;){switch(u.tag){case 5:cs=u.stateNode,uu=!1;break t;case 3:cs=u.stateNode.containerInfo,uu=!0;break t;case 4:cs=u.stateNode.containerInfo,uu=!0;break t}u=u.return}if(cs===null)throw Error(ve(160));_T(c,f,s),cs=null,uu=!1;var w=s.alternate;w!==null&&(w.return=null),s.return=null}catch(S){Vi(s,e,S)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vT(e,t),e=e.sibling}function vT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(su(e,t),Uu(t),r&4){try{Hg(3,t,t.return),ov(3,t)}catch(nt){Vi(t,t.return,nt)}try{Hg(5,t,t.return)}catch(nt){Vi(t,t.return,nt)}}break;case 1:su(e,t),Uu(t),r&512&&n!==null&&Jf(n,n.return);break;case 5:if(su(e,t),Uu(t),r&512&&n!==null&&Jf(n,n.return),t.flags&32){var s=t.stateNode;try{em(s,"")}catch(nt){Vi(t,t.return,nt)}}if(r&4&&(s=t.stateNode,s!=null)){var c=t.memoizedProps,f=n!==null?n.memoizedProps:c,u=t.type,w=t.updateQueue;if(t.updateQueue=null,w!==null)try{u==="input"&&c.type==="radio"&&c.name!=null&&VI(s,c),ux(u,f);var S=ux(u,c);for(f=0;f<w.length;f+=2){var A=w[f],N=w[f+1];A==="style"?qI(s,N):A==="dangerouslySetInnerHTML"?GI(s,N):A==="children"?em(s,N):y1(s,A,N,S)}switch(u){case"input":ix(s,c);break;case"textarea":UI(s,c);break;case"select":var O=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!c.multiple;var j=c.value;j!=null?nd(s,!!c.multiple,j,!1):O!==!!c.multiple&&(c.defaultValue!=null?nd(s,!!c.multiple,c.defaultValue,!0):nd(s,!!c.multiple,c.multiple?[]:"",!1))}s[cm]=c}catch(nt){Vi(t,t.return,nt)}}break;case 6:if(su(e,t),Uu(t),r&4){if(t.stateNode===null)throw Error(ve(162));s=t.stateNode,c=t.memoizedProps;try{s.nodeValue=c}catch(nt){Vi(t,t.return,nt)}}break;case 3:if(su(e,t),Uu(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{om(e.containerInfo)}catch(nt){Vi(t,t.return,nt)}break;case 4:su(e,t),Uu(t);break;case 13:su(e,t),Uu(t),s=t.child,s.flags&8192&&(c=s.memoizedState!==null,s.stateNode.isHidden=c,!c||s.alternate!==null&&s.alternate.memoizedState!==null||(Y1=ro())),r&4&&aS(t);break;case 22:if(A=n!==null&&n.memoizedState!==null,t.mode&1?(Ps=(S=Ps)||A,su(e,t),Ps=S):su(e,t),Uu(t),r&8192){if(S=t.memoizedState!==null,(t.stateNode.isHidden=S)&&!A&&t.mode&1)for(We=t,A=t.child;A!==null;){for(N=We=A;We!==null;){switch(O=We,j=O.child,O.tag){case 0:case 11:case 14:case 15:Hg(4,O,O.return);break;case 1:Jf(O,O.return);var W=O.stateNode;if(typeof W.componentWillUnmount=="function"){r=O,n=O.return;try{e=r,W.props=e.memoizedProps,W.state=e.memoizedState,W.componentWillUnmount()}catch(nt){Vi(r,n,nt)}}break;case 5:Jf(O,O.return);break;case 22:if(O.memoizedState!==null){uS(N);continue}}j!==null?(j.return=O,We=j):uS(N)}A=A.sibling}t:for(A=null,N=t;;){if(N.tag===5){if(A===null){A=N;try{s=N.stateNode,S?(c=s.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(u=N.stateNode,w=N.memoizedProps.style,f=w!=null&&w.hasOwnProperty("display")?w.display:null,u.style.display=jI("display",f))}catch(nt){Vi(t,t.return,nt)}}}else if(N.tag===6){if(A===null)try{N.stateNode.nodeValue=S?"":N.memoizedProps}catch(nt){Vi(t,t.return,nt)}}else if((N.tag!==22&&N.tag!==23||N.memoizedState===null||N===t)&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===t)break t;for(;N.sibling===null;){if(N.return===null||N.return===t)break t;A===N&&(A=null),N=N.return}A===N&&(A=null),N.sibling.return=N.return,N=N.sibling}}break;case 19:su(e,t),Uu(t),r&4&&aS(t);break;case 21:break;default:su(e,t),Uu(t)}}function Uu(t){var e=t.flags;if(e&2){try{t:{for(var n=t.return;n!==null;){if(yT(n)){var r=n;break t}n=n.return}throw Error(ve(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(em(s,""),r.flags&=-33);var c=sS(t);Bx(t,c,s);break;case 3:case 4:var f=r.stateNode.containerInfo,u=sS(t);Fx(t,u,f);break;default:throw Error(ve(161))}}catch(w){Vi(t,t.return,w)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tk(t,e,n){We=t,xT(t)}function xT(t,e,n){for(var r=(t.mode&1)!==0;We!==null;){var s=We,c=s.child;if(s.tag===22&&r){var f=s.memoizedState!==null||Oy;if(!f){var u=s.alternate,w=u!==null&&u.memoizedState!==null||Ps;u=Oy;var S=Ps;if(Oy=f,(Ps=w)&&!S)for(We=s;We!==null;)f=We,w=f.child,f.tag===22&&f.memoizedState!==null?cS(s):w!==null?(w.return=f,We=w):cS(s);for(;c!==null;)We=c,xT(c),c=c.sibling;We=s,Oy=u,Ps=S}lS(t)}else s.subtreeFlags&8772&&c!==null?(c.return=s,We=c):lS(t)}}function lS(t){for(;We!==null;){var e=We;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ps||ov(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ps)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:lu(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&qE(e,c,r);break;case 3:var f=e.updateQueue;if(f!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}qE(e,f,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var w=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":w.autoFocus&&n.focus();break;case"img":w.src&&(n.src=w.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var S=e.alternate;if(S!==null){var A=S.memoizedState;if(A!==null){var N=A.dehydrated;N!==null&&om(N)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ve(163))}Ps||e.flags&512&&zx(e)}catch(O){Vi(e,e.return,O)}}if(e===t){We=null;break}if(n=e.sibling,n!==null){n.return=e.return,We=n;break}We=e.return}}function uS(t){for(;We!==null;){var e=We;if(e===t){We=null;break}var n=e.sibling;if(n!==null){n.return=e.return,We=n;break}We=e.return}}function cS(t){for(;We!==null;){var e=We;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ov(4,e)}catch(w){Vi(e,n,w)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(w){Vi(e,s,w)}}var c=e.return;try{zx(e)}catch(w){Vi(e,c,w)}break;case 5:var f=e.return;try{zx(e)}catch(w){Vi(e,f,w)}}}catch(w){Vi(e,e.return,w)}if(e===t){We=null;break}var u=e.sibling;if(u!==null){u.return=e.return,We=u;break}We=e.return}}var ek=Math.ceil,A_=Qc.ReactCurrentDispatcher,W1=Qc.ReactCurrentOwner,kl=Qc.ReactCurrentBatchConfig,sr=0,Ho=null,co=null,fs=0,ja=0,Qf=dp(0),To=0,mm=null,Wp=0,sv=0,H1=0,Yg=null,xa=null,Y1=0,gd=1/0,Lc=null,k_=!1,Vx=null,Wh=null,zy=!1,Uh=null,N_=0,Kg=0,Ux=null,e_=-1,n_=0;function Js(){return sr&6?ro():e_!==-1?e_:e_=ro()}function Hh(t){return t.mode&1?sr&2&&fs!==0?fs&-fs:FA.transition!==null?(n_===0&&(n_=rC()),n_):(t=Er,t!==0||(t=window.event,t=t===void 0?16:cC(t.type)),t):1}function du(t,e,n,r){if(50<Kg)throw Kg=0,Ux=null,Error(ve(185));Om(t,n,r),(!(sr&2)||t!==Ho)&&(t===Ho&&(!(sr&2)&&(sv|=n),To===4&&Fh(t,fs)),Sa(t,r),n===1&&sr===0&&!(e.mode&1)&&(gd=ro()+500,nv&&gp()))}function Sa(t,e){var n=t.callbackNode;FL(t,e);var r=m_(t,t===Ho?fs:0);if(r===0)n!==null&&vE(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&vE(n),e===1)t.tag===0?zA(hS.bind(null,t)):MC(hS.bind(null,t)),NA(function(){!(sr&6)&&gp()}),n=null;else{switch(iC(r)){case 1:n=b1;break;case 4:n=eC;break;case 16:n=g_;break;case 536870912:n=nC;break;default:n=g_}n=PT(n,wT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function wT(t,e){if(e_=-1,n_=0,sr&6)throw Error(ve(327));var n=t.callbackNode;if(ad()&&t.callbackNode!==n)return null;var r=m_(t,t===Ho?fs:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=D_(t,r);else{e=r;var s=sr;sr|=2;var c=ET();(Ho!==t||fs!==e)&&(Lc=null,gd=ro()+500,Gp(t,e));do try{ik();break}catch(u){bT(t,u)}while(!0);R1(),A_.current=c,sr=s,co!==null?e=0:(Ho=null,fs=0,e=To)}if(e!==0){if(e===2&&(s=dx(t),s!==0&&(r=s,e=$x(t,s))),e===1)throw n=mm,Gp(t,0),Fh(t,r),Sa(t,ro()),n;if(e===6)Fh(t,r);else{if(s=t.current.alternate,!(r&30)&&!nk(s)&&(e=D_(t,r),e===2&&(c=dx(t),c!==0&&(r=c,e=$x(t,c))),e===1))throw n=mm,Gp(t,0),Fh(t,r),Sa(t,ro()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(ve(345));case 2:Fp(t,xa,Lc);break;case 3:if(Fh(t,r),(r&130023424)===r&&(e=Y1+500-ro(),10<e)){if(m_(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Js(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=bx(Fp.bind(null,t,xa,Lc),e);break}Fp(t,xa,Lc);break;case 4:if(Fh(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var f=31-fu(r);c=1<<f,f=e[f],f>s&&(s=f),r&=~c}if(r=s,r=ro()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ek(r/1960))-r,10<r){t.timeoutHandle=bx(Fp.bind(null,t,xa,Lc),r);break}Fp(t,xa,Lc);break;case 5:Fp(t,xa,Lc);break;default:throw Error(ve(329))}}}return Sa(t,ro()),t.callbackNode===n?wT.bind(null,t):null}function $x(t,e){var n=Yg;return t.current.memoizedState.isDehydrated&&(Gp(t,e).flags|=256),t=D_(t,e),t!==2&&(e=xa,xa=n,e!==null&&Gx(e)),t}function Gx(t){xa===null?xa=t:xa.push.apply(xa,t)}function nk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],c=s.getSnapshot;s=s.value;try{if(!yu(c(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fh(t,e){for(e&=~H1,e&=~sv,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-fu(e),r=1<<n;t[n]=-1,e&=~r}}function hS(t){if(sr&6)throw Error(ve(327));ad();var e=m_(t,0);if(!(e&1))return Sa(t,ro()),null;var n=D_(t,e);if(t.tag!==0&&n===2){var r=dx(t);r!==0&&(e=r,n=$x(t,r))}if(n===1)throw n=mm,Gp(t,0),Fh(t,e),Sa(t,ro()),n;if(n===6)throw Error(ve(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Fp(t,xa,Lc),Sa(t,ro()),null}function K1(t,e){var n=sr;sr|=1;try{return t(e)}finally{sr=n,sr===0&&(gd=ro()+500,nv&&gp())}}function Hp(t){Uh!==null&&Uh.tag===0&&!(sr&6)&&ad();var e=sr;sr|=1;var n=kl.transition,r=Er;try{if(kl.transition=null,Er=1,t)return t()}finally{Er=r,kl.transition=n,sr=e,!(sr&6)&&gp()}}function J1(){ja=Qf.current,ni(Qf)}function Gp(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kA(n)),co!==null)for(n=co.return;n!==null;){var r=n;switch(k1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&w_();break;case 3:fd(),ni(ba),ni(Ls),U1();break;case 5:V1(r);break;case 4:fd();break;case 13:ni(Ii);break;case 19:ni(Ii);break;case 10:O1(r.type._context);break;case 22:case 23:J1()}n=n.return}if(Ho=t,co=t=Yh(t.current,null),fs=ja=e,To=0,mm=null,H1=sv=Wp=0,xa=Yg=null,Vp!==null){for(e=0;e<Vp.length;e++)if(n=Vp[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,c=n.pending;if(c!==null){var f=c.next;c.next=s,r.next=f}n.pending=r}Vp=null}return t}function bT(t,e){do{var n=co;try{if(R1(),Jy.current=L_,M_){for(var r=Li.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}M_=!1}if(Xp=0,jo=Co=Li=null,Wg=!1,fm=0,W1.current=null,n===null||n.return===null){To=1,mm=e,co=null;break}t:{var c=t,f=n.return,u=n,w=e;if(e=fs,u.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){var S=w,A=u,N=A.tag;if(!(A.mode&1)&&(N===0||N===11||N===15)){var O=A.alternate;O?(A.updateQueue=O.updateQueue,A.memoizedState=O.memoizedState,A.lanes=O.lanes):(A.updateQueue=null,A.memoizedState=null)}var j=JE(f);if(j!==null){j.flags&=-257,QE(j,f,u,c,e),j.mode&1&&KE(c,S,e),e=j,w=S;var W=e.updateQueue;if(W===null){var nt=new Set;nt.add(w),e.updateQueue=nt}else W.add(w);break t}else{if(!(e&1)){KE(c,S,e),Q1();break t}w=Error(ve(426))}}else if(gi&&u.mode&1){var pt=JE(f);if(pt!==null){!(pt.flags&65536)&&(pt.flags|=256),QE(pt,f,u,c,e),N1(dd(w,u));break t}}c=w=dd(w,u),To!==4&&(To=2),Yg===null?Yg=[c]:Yg.push(c),c=f;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var J=oT(c,w,e);jE(c,J);break t;case 1:u=w;var tt=c.type,Q=c.stateNode;if(!(c.flags&128)&&(typeof tt.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(Wh===null||!Wh.has(Q)))){c.flags|=65536,e&=-e,c.lanes|=e;var _t=sT(c,u,e);jE(c,_t);break t}}c=c.return}while(c!==null)}IT(n)}catch(Ot){e=Ot,co===n&&n!==null&&(co=n=n.return);continue}break}while(!0)}function ET(){var t=A_.current;return A_.current=L_,t===null?L_:t}function Q1(){(To===0||To===3||To===2)&&(To=4),Ho===null||!(Wp&268435455)&&!(sv&268435455)||Fh(Ho,fs)}function D_(t,e){var n=sr;sr|=2;var r=ET();(Ho!==t||fs!==e)&&(Lc=null,Gp(t,e));do try{rk();break}catch(s){bT(t,s)}while(!0);if(R1(),sr=n,A_.current=r,co!==null)throw Error(ve(261));return Ho=null,fs=0,To}function rk(){for(;co!==null;)ST(co)}function ik(){for(;co!==null&&!ML();)ST(co)}function ST(t){var e=TT(t.alternate,t,ja);t.memoizedProps=t.pendingProps,e===null?IT(t):co=e,W1.current=null}function IT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=KA(n,e),n!==null){n.flags&=32767,co=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{To=6,co=null;return}}else if(n=YA(n,e,ja),n!==null){co=n;return}if(e=e.sibling,e!==null){co=e;return}co=e=t}while(e!==null);To===0&&(To=5)}function Fp(t,e,n){var r=Er,s=kl.transition;try{kl.transition=null,Er=1,ok(t,e,n,r)}finally{kl.transition=s,Er=r}return null}function ok(t,e,n,r){do ad();while(Uh!==null);if(sr&6)throw Error(ve(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ve(177));t.callbackNode=null,t.callbackPriority=0;var c=n.lanes|n.childLanes;if(BL(t,c),t===Ho&&(co=Ho=null,fs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zy||(zy=!0,PT(g_,function(){return ad(),null})),c=(n.flags&15990)!==0,n.subtreeFlags&15990||c){c=kl.transition,kl.transition=null;var f=Er;Er=1;var u=sr;sr|=4,W1.current=null,QA(t,n),vT(n,t),IA(xx),y_=!!vx,xx=vx=null,t.current=n,tk(n),LL(),sr=u,Er=f,kl.transition=c}else t.current=n;if(zy&&(zy=!1,Uh=t,N_=s),c=t.pendingLanes,c===0&&(Wh=null),NL(n.stateNode),Sa(t,ro()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(k_)throw k_=!1,t=Vx,Vx=null,t;return N_&1&&t.tag!==0&&ad(),c=t.pendingLanes,c&1?t===Ux?Kg++:(Kg=0,Ux=t):Kg=0,gp(),null}function ad(){if(Uh!==null){var t=iC(N_),e=kl.transition,n=Er;try{if(kl.transition=null,Er=16>t?16:t,Uh===null)var r=!1;else{if(t=Uh,Uh=null,N_=0,sr&6)throw Error(ve(331));var s=sr;for(sr|=4,We=t.current;We!==null;){var c=We,f=c.child;if(We.flags&16){var u=c.deletions;if(u!==null){for(var w=0;w<u.length;w++){var S=u[w];for(We=S;We!==null;){var A=We;switch(A.tag){case 0:case 11:case 15:Hg(8,A,c)}var N=A.child;if(N!==null)N.return=A,We=N;else for(;We!==null;){A=We;var O=A.sibling,j=A.return;if(mT(A),A===S){We=null;break}if(O!==null){O.return=j,We=O;break}We=j}}}var W=c.alternate;if(W!==null){var nt=W.child;if(nt!==null){W.child=null;do{var pt=nt.sibling;nt.sibling=null,nt=pt}while(nt!==null)}}We=c}}if(c.subtreeFlags&2064&&f!==null)f.return=c,We=f;else t:for(;We!==null;){if(c=We,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Hg(9,c,c.return)}var J=c.sibling;if(J!==null){J.return=c.return,We=J;break t}We=c.return}}var tt=t.current;for(We=tt;We!==null;){f=We;var Q=f.child;if(f.subtreeFlags&2064&&Q!==null)Q.return=f,We=Q;else t:for(f=tt;We!==null;){if(u=We,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:ov(9,u)}}catch(Ot){Vi(u,u.return,Ot)}if(u===f){We=null;break t}var _t=u.sibling;if(_t!==null){_t.return=u.return,We=_t;break t}We=u.return}}if(sr=s,gp(),Yu&&typeof Yu.onPostCommitFiberRoot=="function")try{Yu.onPostCommitFiberRoot(K_,t)}catch{}r=!0}return r}finally{Er=n,kl.transition=e}}return!1}function pS(t,e,n){e=dd(n,e),e=oT(t,e,1),t=Xh(t,e,1),e=Js(),t!==null&&(Om(t,1,e),Sa(t,e))}function Vi(t,e,n){if(t.tag===3)pS(t,t,n);else for(;e!==null;){if(e.tag===3){pS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Wh===null||!Wh.has(r))){t=dd(n,t),t=sT(e,t,1),e=Xh(e,t,1),t=Js(),e!==null&&(Om(e,1,t),Sa(e,t));break}}e=e.return}}function sk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Js(),t.pingedLanes|=t.suspendedLanes&n,Ho===t&&(fs&n)===n&&(To===4||To===3&&(fs&130023424)===fs&&500>ro()-Y1?Gp(t,0):H1|=n),Sa(t,e)}function CT(t,e){e===0&&(t.mode&1?(e=Ty,Ty<<=1,!(Ty&130023424)&&(Ty=4194304)):e=1);var n=Js();t=Vc(t,e),t!==null&&(Om(t,e,n),Sa(t,n))}function ak(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),CT(t,n)}function lk(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ve(314))}r!==null&&r.delete(e),CT(t,n)}var TT;TT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ba.current)wa=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wa=!1,HA(t,e,n);wa=!!(t.flags&131072)}else wa=!1,gi&&e.flags&1048576&&LC(e,S_,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;t_(t,e),t=e.pendingProps;var s=cd(e,Ls.current);sd(e,n),s=G1(null,e,r,t,s,n);var c=j1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ea(r)?(c=!0,b_(e)):c=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,F1(e),s.updater=rv,e.stateNode=s,s._reactInternals=e,Mx(e,r,t,n),e=kx(null,e,r,!0,c,n)):(e.tag=0,gi&&c&&A1(e),Hs(null,e,s,n),e=e.child),e;case 16:r=e.elementType;t:{switch(t_(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=ck(r),t=lu(r,t),s){case 0:e=Ax(null,e,r,t,n);break t;case 1:e=nS(null,e,r,t,n);break t;case 11:e=tS(null,e,r,t,n);break t;case 14:e=eS(null,e,r,lu(r.type,t),n);break t}throw Error(ve(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:lu(r,s),Ax(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:lu(r,s),nS(t,e,r,s,n);case 3:t:{if(cT(e),t===null)throw Error(ve(387));r=e.pendingProps,c=e.memoizedState,s=c.element,DC(t,e),T_(e,r,null,n);var f=e.memoizedState;if(r=f.element,c.isDehydrated)if(c={element:r,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){s=dd(Error(ve(423)),e),e=rS(t,e,r,n,s);break t}else if(r!==s){s=dd(Error(ve(424)),e),e=rS(t,e,r,n,s);break t}else for(Za=Zh(e.stateNode.containerInfo.firstChild),Xa=e,gi=!0,cu=null,n=FC(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hd(),r===s){e=Uc(t,e,n);break t}Hs(t,e,r,n)}e=e.child}return e;case 5:return BC(e),t===null&&Cx(e),r=e.type,s=e.pendingProps,c=t!==null?t.memoizedProps:null,f=s.children,wx(r,s)?f=null:c!==null&&wx(r,c)&&(e.flags|=32),uT(t,e),Hs(t,e,f,n),e.child;case 6:return t===null&&Cx(e),null;case 13:return hT(t,e,n);case 4:return B1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=pd(e,null,r,n):Hs(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:lu(r,s),tS(t,e,r,s,n);case 7:return Hs(t,e,e.pendingProps,n),e.child;case 8:return Hs(t,e,e.pendingProps.children,n),e.child;case 12:return Hs(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,s=e.pendingProps,c=e.memoizedProps,f=s.value,Wr(I_,r._currentValue),r._currentValue=f,c!==null)if(yu(c.value,f)){if(c.children===s.children&&!ba.current){e=Uc(t,e,n);break t}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var u=c.dependencies;if(u!==null){f=c.child;for(var w=u.firstContext;w!==null;){if(w.context===r){if(c.tag===1){w=Rc(-1,n&-n),w.tag=2;var S=c.updateQueue;if(S!==null){S=S.shared;var A=S.pending;A===null?w.next=w:(w.next=A.next,A.next=w),S.pending=w}}c.lanes|=n,w=c.alternate,w!==null&&(w.lanes|=n),Tx(c.return,n,e),u.lanes|=n;break}w=w.next}}else if(c.tag===10)f=c.type===e.type?null:c.child;else if(c.tag===18){if(f=c.return,f===null)throw Error(ve(341));f.lanes|=n,u=f.alternate,u!==null&&(u.lanes|=n),Tx(f,n,e),f=c.sibling}else f=c.child;if(f!==null)f.return=c;else for(f=c;f!==null;){if(f===e){f=null;break}if(c=f.sibling,c!==null){c.return=f.return,f=c;break}f=f.return}c=f}Hs(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,sd(e,n),s=Rl(s),r=r(s),e.flags|=1,Hs(t,e,r,n),e.child;case 14:return r=e.type,s=lu(r,e.pendingProps),s=lu(r.type,s),eS(t,e,r,s,n);case 15:return aT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:lu(r,s),t_(t,e),e.tag=1,Ea(r)?(t=!0,b_(e)):t=!1,sd(e,n),OC(e,r,s),Mx(e,r,s,n),kx(null,e,r,!0,t,n);case 19:return pT(t,e,n);case 22:return lT(t,e,n)}throw Error(ve(156,e.tag))};function PT(t,e){return tC(t,e)}function uk(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ll(t,e,n,r){return new uk(t,e,n,r)}function tw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ck(t){if(typeof t=="function")return tw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===v1)return 11;if(t===x1)return 14}return 2}function Yh(t,e){var n=t.alternate;return n===null?(n=Ll(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function r_(t,e,n,r,s,c){var f=2;if(r=t,typeof t=="function")tw(t)&&(f=1);else if(typeof t=="string")f=5;else t:switch(t){case Gf:return jp(n.children,s,c,e);case _1:f=8,s|=8;break;case Q0:return t=Ll(12,n,e,s|2),t.elementType=Q0,t.lanes=c,t;case tx:return t=Ll(13,n,e,s),t.elementType=tx,t.lanes=c,t;case ex:return t=Ll(19,n,e,s),t.elementType=ex,t.lanes=c,t;case zI:return av(n,s,c,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case RI:f=10;break t;case OI:f=9;break t;case v1:f=11;break t;case x1:f=14;break t;case Rh:f=16,r=null;break t}throw Error(ve(130,t==null?t:typeof t,""))}return e=Ll(f,n,e,s),e.elementType=t,e.type=r,e.lanes=c,e}function jp(t,e,n,r){return t=Ll(7,t,r,e),t.lanes=n,t}function av(t,e,n,r){return t=Ll(22,t,r,e),t.elementType=zI,t.lanes=n,t.stateNode={isHidden:!1},t}function $0(t,e,n){return t=Ll(6,t,null,e),t.lanes=n,t}function G0(t,e,n){return e=Ll(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hk(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=E0(0),this.expirationTimes=E0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=E0(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ew(t,e,n,r,s,c,f,u,w){return t=new hk(t,e,n,u,w),e===1?(e=1,c===!0&&(e|=8)):e=0,c=Ll(3,null,null,e),t.current=c,c.stateNode=t,c.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},F1(c),t}function pk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$f,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function MT(t){if(!t)return tp;t=t._reactInternals;t:{if(hf(t)!==t||t.tag!==1)throw Error(ve(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Ea(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(e!==null);throw Error(ve(171))}if(t.tag===1){var n=t.type;if(Ea(n))return PC(t,n,e)}return e}function LT(t,e,n,r,s,c,f,u,w){return t=ew(n,r,!0,t,s,c,f,u,w),t.context=MT(null),n=t.current,r=Js(),s=Hh(n),c=Rc(r,s),c.callback=e??null,Xh(n,c,s),t.current.lanes=s,Om(t,s,r),Sa(t,r),t}function lv(t,e,n,r){var s=e.current,c=Js(),f=Hh(s);return n=MT(n),e.context===null?e.context=n:e.pendingContext=n,e=Rc(c,f),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xh(s,e,f),t!==null&&(du(t,s,f,c),Ky(t,s,f)),f}function R_(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function nw(t,e){fS(t,e),(t=t.alternate)&&fS(t,e)}function fk(){return null}var AT=typeof reportError=="function"?reportError:function(t){console.error(t)};function rw(t){this._internalRoot=t}uv.prototype.render=rw.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ve(409));lv(t,e,null,null)};uv.prototype.unmount=rw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Hp(function(){lv(null,t,null,null)}),e[Bc]=null}};function uv(t){this._internalRoot=t}uv.prototype.unstable_scheduleHydration=function(t){if(t){var e=aC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<zh.length&&e!==0&&e<zh[n].priority;n++);zh.splice(n,0,t),n===0&&uC(t)}};function iw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function cv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function dS(){}function dk(t,e,n,r,s){if(s){if(typeof r=="function"){var c=r;r=function(){var S=R_(f);c.call(S)}}var f=LT(e,r,t,0,null,!1,!1,"",dS);return t._reactRootContainer=f,t[Bc]=f.current,lm(t.nodeType===8?t.parentNode:t),Hp(),f}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var u=r;r=function(){var S=R_(w);u.call(S)}}var w=ew(t,0,!1,null,null,!1,!1,"",dS);return t._reactRootContainer=w,t[Bc]=w.current,lm(t.nodeType===8?t.parentNode:t),Hp(function(){lv(e,w,n,r)}),w}function hv(t,e,n,r,s){var c=n._reactRootContainer;if(c){var f=c;if(typeof s=="function"){var u=s;s=function(){var w=R_(f);u.call(w)}}lv(e,f,t,s)}else f=dk(n,e,t,s,r);return R_(f)}oC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Bg(e.pendingLanes);n!==0&&(E1(e,n|1),Sa(e,ro()),!(sr&6)&&(gd=ro()+500,gp()))}break;case 13:Hp(function(){var r=Vc(t,1);if(r!==null){var s=Js();du(r,t,1,s)}}),nw(t,1)}};S1=function(t){if(t.tag===13){var e=Vc(t,134217728);if(e!==null){var n=Js();du(e,t,134217728,n)}nw(t,134217728)}};sC=function(t){if(t.tag===13){var e=Hh(t),n=Vc(t,e);if(n!==null){var r=Js();du(n,t,e,r)}nw(t,e)}};aC=function(){return Er};lC=function(t,e){var n=Er;try{return Er=t,e()}finally{Er=n}};hx=function(t,e,n){switch(e){case"input":if(ix(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ev(r);if(!s)throw Error(ve(90));BI(r),ix(r,s)}}}break;case"textarea":UI(t,n);break;case"select":e=n.value,e!=null&&nd(t,!!n.multiple,e,!1)}};WI=K1;HI=Hp;var gk={usingClientEntryPoint:!1,Events:[Fm,Xf,ev,ZI,XI,K1]},Ng={findFiberByHostInstance:Bp,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},mk={bundleType:Ng.bundleType,version:Ng.version,rendererPackageName:Ng.rendererPackageName,rendererConfig:Ng.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=JI(t),t===null?null:t.stateNode},findFiberByHostInstance:Ng.findFiberByHostInstance||fk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fy.isDisabled&&Fy.supportsFiber)try{K_=Fy.inject(mk),Yu=Fy}catch{}}il.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gk;il.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!iw(e))throw Error(ve(200));return pk(t,e,null,n)};il.createRoot=function(t,e){if(!iw(t))throw Error(ve(299));var n=!1,r="",s=AT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ew(t,1,!1,null,null,n,!1,r,s),t[Bc]=e.current,lm(t.nodeType===8?t.parentNode:t),new rw(e)};il.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ve(188)):(t=Object.keys(t).join(","),Error(ve(268,t)));return t=JI(e),t=t===null?null:t.stateNode,t};il.flushSync=function(t){return Hp(t)};il.hydrate=function(t,e,n){if(!cv(e))throw Error(ve(200));return hv(null,t,e,!0,n)};il.hydrateRoot=function(t,e,n){if(!iw(t))throw Error(ve(405));var r=n!=null&&n.hydratedSources||null,s=!1,c="",f=AT;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),e=LT(e,null,t,1,n??null,s,!1,c,f),t[Bc]=e.current,lm(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new uv(e)};il.render=function(t,e,n){if(!cv(e))throw Error(ve(200));return hv(null,t,e,!1,n)};il.unmountComponentAtNode=function(t){if(!cv(t))throw Error(ve(40));return t._reactRootContainer?(Hp(function(){hv(null,null,t,!1,function(){t._reactRootContainer=null,t[Bc]=null})}),!0):!1};il.unstable_batchedUpdates=K1;il.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!cv(n))throw Error(ve(200));if(t==null||t._reactInternals===void 0)throw Error(ve(38));return hv(t,e,n,!1,r)};il.version="18.2.0-next-9e3b772b8-20220608";function kT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kT)}catch(t){console.error(t)}}kT(),LI.exports=il;var yk=LI.exports,gS=yk;K0.createRoot=gS.createRoot,K0.hydrateRoot=gS.hydrateRoot;var NT={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(Bf,function(){var n,r,s;function c(u,w){if(!n)n=w;else if(!r)r=w;else{var S="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",A={};n(A),s=w(A),typeof window<"u"&&(s.workerUrl=window.URL.createObjectURL(new Blob([S],{type:"text/javascript"})))}}c(["exports"],function(u){function w(a,i,l,p){return new(l||(l=Promise))(function(g,_){function x(M){try{T(p.next(M))}catch(D){_(D)}}function E(M){try{T(p.throw(M))}catch(D){_(D)}}function T(M){var D;M.done?g(M.value):(D=M.value,D instanceof l?D:new l(function(B){B(D)})).then(x,E)}T((p=p.apply(a,i||[])).next())})}function S(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}typeof SuppressedError=="function"&&SuppressedError;var A=N;function N(a,i){this.x=a,this.y=i}N.prototype={clone:function(){return new N(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,i){return this.clone()._rotateAround(a,i)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var i=a.x-this.x,l=a.y-this.y;return i*i+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,i){return Math.atan2(this.x*i-this.y*a,this.x*a+this.y*i)},_matMult:function(a){var i=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=i,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var i=Math.cos(a),l=Math.sin(a),p=l*this.x+i*this.y;return this.x=i*this.x-l*this.y,this.y=p,this},_rotateAround:function(a,i){var l=Math.cos(a),p=Math.sin(a),g=i.y+p*(this.x-i.x)+l*(this.y-i.y);return this.x=i.x+l*(this.x-i.x)-p*(this.y-i.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},N.convert=function(a){return a instanceof N?a:Array.isArray(a)?new N(a[0],a[1]):a};var O=S(A),j=W;function W(a,i,l,p){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(p-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=i,this.p2x=l,this.p2y=p}W.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,i){if(i===void 0&&(i=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,p=0;p<8;p++){var g=this.sampleCurveX(l)-a;if(Math.abs(g)<i)return l;var _=this.sampleCurveDerivativeX(l);if(Math.abs(_)<1e-6)break;l-=g/_}var x=0,E=1;for(l=a,p=0;p<20&&(g=this.sampleCurveX(l),!(Math.abs(g-a)<i));p++)a>g?x=l:E=l,l=.5*(E-x)+x;return l},solve:function(a,i){return this.sampleCurveY(this.solveCurveX(a,i))}};var nt=S(j);let pt,J;function tt(){return pt==null&&(pt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),pt}function Q(){if(J==null&&(J=!1,tt())){const i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let p=0;p<5*5;p++){const g=4*p;i.fillStyle=`rgb(${g},${g+1},${g+2})`,i.fillRect(p%5,Math.floor(p/5),1,1)}const l=i.getImageData(0,0,5,5).data;for(let p=0;p<5*5*4;p++)if(p%4!=3&&l[p]!==p){J=!0;break}}}return J||!1}function _t(a,i,l,p){const g=new nt(a,i,l,p);return function(_){return g.solve(_)}}const Ot=_t(.25,.1,.25,1);function zt(a,i,l){return Math.min(l,Math.max(i,a))}function Rt(a,i,l){const p=l-i,g=((a-i)%p+p)%p+i;return g===i?l:g}function At(a,...i){for(const l of i)for(const p in l)a[p]=l[p];return a}let Ht=1;function Xt(a,i,l){const p={};for(const g in a)p[g]=i.call(l||this,a[g],g,a);return p}function De(a,i,l){const p={};for(const g in a)i.call(l||this,a[g],g,a)&&(p[g]=a[g]);return p}function ue(a){return Array.isArray(a)?a.map(ue):typeof a=="object"&&a?Xt(a,ue):a}const on={};function Gt(a){on[a]||(typeof console<"u"&&console.warn(a),on[a]=!0)}function ye(a,i,l){return(l.y-a.y)*(i.x-a.x)>(i.y-a.y)*(l.x-a.x)}function Ue(a){let i=0;for(let l,p,g=0,_=a.length,x=_-1;g<_;x=g++)l=a[g],p=a[x],i+=(p.x-l.x)*(l.y+p.y);return i}function hn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let he=null;function Fe(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function _n(a,i,l,p,g){return w(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(a,{timestamp:0});try{const x=_==null?void 0:_.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const E=x.startsWith("BGR"),T=new Uint8ClampedArray(p*g*4);if(yield _.copyTo(T,function(M,D,B,U,H){const K=4*Math.max(-D,0),it=(Math.max(0,B)-B)*U*4+K,ht=4*U,mt=Math.max(0,D),Tt=Math.max(0,B);return{rect:{x:mt,y:Tt,width:Math.min(M.width,D+U)-mt,height:Math.min(M.height,B+H)-Tt},layout:[{offset:it,stride:ht}]}}(a,i,l,p,g)),E)for(let M=0;M<T.length;M+=4){const D=T[M];T[M]=T[M+2],T[M+2]=D}return T}finally{_.close()}})}let mn,Ke,pn,Xn;const Wn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(a){const i=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(a,i=0){return this.getImageCanvasContext(a).getImageData(-i,-i,a.width+2*i,a.height+2*i)},getImageCanvasContext(a){const i=window.document.createElement("canvas"),l=i.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return i.width=a.width,i.height=a.height,l.drawImage(a,0,0,a.width,a.height),l},resolveURL:a=>(pn||(pn=document.createElement("a")),pn.href=a,pn.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Xn==null&&(Xn=matchMedia("(prefers-reduced-motion: reduce)")),Xn.matches)}},_o={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Dr extends Error{constructor(i,l,p,g){super(`AJAXError: ${l} (${i}): ${p}`),this.status=i,this.statusText=l,this.url=p,this.body=g}}const Te=hn()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Oe=a=>_o.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))];function bn(a,i){const l=new AbortController,p=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:Te(),signal:l.signal});let g=!1,_=!1;return a.type==="json"&&p.headers.set("Accept","application/json"),_||fetch(p).then(x=>x.ok?(E=>{(a.type==="arrayBuffer"||a.type==="image"?E.arrayBuffer():a.type==="json"?E.json():E.text()).then(T=>{_||(g=!0,i(null,T,E.headers.get("Cache-Control"),E.headers.get("Expires")))}).catch(T=>{_||i(new Error(T.message))})})(x):x.blob().then(E=>i(new Dr(x.status,x.statusText,a.url,E)))).catch(x=>{x.code!==20&&i(new Error(x.message))}),{cancel:()=>{_=!0,g||l.abort()}}}const es=function(a,i){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){if(hn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,i);if(!hn())return(Oe(a.url)||bn)(a,i)}if(!(/^file:/.test(l=a.url)||/^file:/.test(Te())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return bn(a,i);if(hn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,i,void 0,!0)}var l;return function(p,g){const _=new XMLHttpRequest;_.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(_.responseType="arraybuffer");for(const x in p.headers)_.setRequestHeader(x,p.headers[x]);return p.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=p.credentials==="include",_.onerror=()=>{g(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let x=_.response;if(p.type==="json")try{x=JSON.parse(_.response)}catch(E){return g(E)}g(null,x,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else{const x=new Blob([_.response],{type:_.getResponseHeader("Content-Type")});g(new Dr(_.status,_.statusText,p.url,x))}},_.send(p.body),{cancel:()=>_.abort()}}(a,i)},xi=function(a,i){return es(At(a,{type:"arrayBuffer"}),i)};function Dn(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const i=new URL(a),l=window.location;return i.protocol===l.protocol&&i.host===l.host}function hr(a,i,l){l[a]&&l[a].indexOf(i)!==-1||(l[a]=l[a]||[],l[a].push(i))}function vn(a,i,l){if(l&&l[a]){const p=l[a].indexOf(i);p!==-1&&l[a].splice(p,1)}}class Di{constructor(i,l={}){At(this,l),this.type=i}}class Ui extends Di{constructor(i,l={}){super("error",At({error:i},l))}}class ko{on(i,l){return this._listeners=this._listeners||{},hr(i,l,this._listeners),this}off(i,l){return vn(i,l,this._listeners),vn(i,l,this._oneTimeListeners),this}once(i,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},hr(i,l,this._oneTimeListeners),this):new Promise(p=>this.once(i,p))}fire(i,l){typeof i=="string"&&(i=new Di(i,l||{}));const p=i.type;if(this.listens(p)){i.target=this;const g=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const E of g)E.call(this,i);const _=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const E of _)vn(p,E,this._oneTimeListeners),E.call(this,i);const x=this._eventedParent;x&&(At(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(i))}else i instanceof Ui&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,l){return this._eventedParent=i,this._eventedParentData=l,this}}var qt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ri=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Rr(a,i){const l={};for(const p in a)p!=="ref"&&(l[p]=a[p]);return Ri.forEach(p=>{p in i&&(l[p]=i[p])}),l}function Vn(a,i){if(Array.isArray(a)){if(!Array.isArray(i)||a.length!==i.length)return!1;for(let l=0;l<a.length;l++)if(!Vn(a[l],i[l]))return!1;return!0}if(typeof a=="object"&&a!==null&&i!==null){if(typeof i!="object"||Object.keys(a).length!==Object.keys(i).length)return!1;for(const l in a)if(!Vn(a[l],i[l]))return!1;return!0}return a===i}const En={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function $i(a,i,l){l.push({command:En.addSource,args:[a,i[a]]})}function ao(a,i,l){i.push({command:En.removeSource,args:[a]}),l[a]=!0}function vo(a,i,l,p){ao(a,l,p),$i(a,i,l)}function Rs(a,i,l){let p;for(p in a[l])if(Object.prototype.hasOwnProperty.call(a[l],p)&&p!=="data"&&!Vn(a[l][p],i[l][p]))return!1;for(p in i[l])if(Object.prototype.hasOwnProperty.call(i[l],p)&&p!=="data"&&!Vn(a[l][p],i[l][p]))return!1;return!0}function No(a,i,l,p,g,_){let x;for(x in i=i||{},a=a||{})Object.prototype.hasOwnProperty.call(a,x)&&(Vn(a[x],i[x])||l.push({command:_,args:[p,x,i[x],g]}));for(x in i)Object.prototype.hasOwnProperty.call(i,x)&&!Object.prototype.hasOwnProperty.call(a,x)&&(Vn(a[x],i[x])||l.push({command:_,args:[p,x,i[x],g]}))}function Kr(a){return a.id}function wi(a,i){return a[i.id]=i,a}class ce{constructor(i,l,p,g){this.message=(i?`${i}: `:"")+p,g&&(this.identifier=g),l!=null&&l.__line__&&(this.line=l.__line__)}}function Gi(a,...i){for(const l of i)for(const p in l)a[p]=l[p];return a}class pr extends Error{constructor(i,l){super(l),this.message=l,this.key=i}}class Os{constructor(i,l=[]){this.parent=i,this.bindings={};for(const[p,g]of l)this.bindings[p]=g}concat(i){return new Os(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const Oi={kind:"null"},pe={kind:"number"},ln={kind:"string"},tn={kind:"boolean"},li={kind:"color"},ji={kind:"object"},Xe={kind:"value"},qi={kind:"collator"},q={kind:"formatted"},V={kind:"padding"},G={kind:"resolvedImage"},et={kind:"variableAnchorOffsetCollection"};function at(a,i){return{kind:"array",itemType:a,N:i}}function lt(a){if(a.kind==="array"){const i=lt(a.itemType);return typeof a.N=="number"?`array<${i}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${i}>`}return a.kind}const It=[Oi,pe,ln,tn,li,q,ji,at(Xe),V,G,et];function vt(a,i){if(i.kind==="error")return null;if(a.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!vt(a.itemType,i.itemType))&&(typeof a.N!="number"||a.N===i.N))return null}else{if(a.kind===i.kind)return null;if(a.kind==="value"){for(const l of It)if(!vt(l,i))return null}}return`Expected ${lt(a)} but found ${lt(i)} instead.`}function dt(a,i){return i.some(l=>l.kind===a.kind)}function bt(a,i){return i.some(l=>l==="null"?a===null:l==="array"?Array.isArray(a):l==="object"?a&&!Array.isArray(a)&&typeof a=="object":l===typeof a)}function Yt(a,i){return a.kind==="array"&&i.kind==="array"?a.itemType.kind===i.itemType.kind&&typeof a.N=="number":a.kind===i.kind}const Kt=.96422,Jt=.82521,z=4/29,$=6/29,Y=3*$*$,yt=$*$*$,gt=Math.PI/180,Mt=180/Math.PI;function Nt(a){return(a%=360)<0&&(a+=360),a}function Qt([a,i,l,p]){let g,_;const x=ie((.2225045*(a=Ut(a))+.7168786*(i=Ut(i))+.0606169*(l=Ut(l)))/1);a===i&&i===l?g=_=x:(g=ie((.4360747*a+.3850649*i+.1430804*l)/Kt),_=ie((.0139322*a+.0971045*i+.7141733*l)/Jt));const E=116*x-16;return[E<0?0:E,500*(g-x),200*(x-_),p]}function Ut(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function ie(a){return a>yt?Math.pow(a,1/3):a/Y+z}function oe([a,i,l,p]){let g=(a+16)/116,_=isNaN(i)?g:g+i/500,x=isNaN(l)?g:g-l/200;return g=1*qe(g),_=Kt*qe(_),x=Jt*qe(x),[ze(3.1338561*_-1.6168667*g-.4906146*x),ze(-.9787684*_+1.9161415*g+.033454*x),ze(.0719453*_-.2289914*g+1.4052427*x),p]}function ze(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function qe(a){return a>$?a*a*a:Y*(a-z)}function fn(a){return parseInt(a.padEnd(2,a),16)/255}function vr(a,i){return Hn(i?a/100:a,0,1)}function Hn(a,i,l){return Math.min(Math.max(i,a),l)}function fr(a){return!a.some(Number.isNaN)}const In={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Sn{constructor(i,l,p,g=1,_=!0){this.r=i,this.g=l,this.b=p,this.a=g,_||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[i,l,p,g]))}static parse(i){if(i instanceof Sn)return i;if(typeof i!="string")return;const l=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=In[p];if(g){const[x,E,T]=g;return[x/255,E/255,T/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const x=p.length<6?1:2;let E=1;return[fn(p.slice(E,E+=x)),fn(p.slice(E,E+=x)),fn(p.slice(E,E+=x)),fn(p.slice(E,E+x)||"ff")]}if(p.startsWith("rgb")){const x=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[E,T,M,D,B,U,H,K,it,ht,mt,Tt]=x,xt=[D||" ",H||" ",ht].join("");if(xt==="  "||xt==="  /"||xt===",,"||xt===",,,"){const Lt=[M,U,it].join(""),Vt=Lt==="%%%"?100:Lt===""?255:0;if(Vt){const ee=[Hn(+T/Vt,0,1),Hn(+B/Vt,0,1),Hn(+K/Vt,0,1),mt?vr(+mt,Tt):1];if(fr(ee))return ee}}return}}const _=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[x,E,T,M,D,B,U,H,K]=_,it=[T||" ",D||" ",U].join("");if(it==="  "||it==="  /"||it===",,"||it===",,,"){const ht=[+E,Hn(+M,0,100),Hn(+B,0,100),H?vr(+H,K):1];if(fr(ht))return function([mt,Tt,xt,Lt]){function Vt(ee){const ke=(ee+mt/30)%12,Ve=Tt*Math.min(xt,1-xt);return xt-Ve*Math.max(-1,Math.min(ke-3,9-ke,1))}return mt=Nt(mt),Tt/=100,xt/=100,[Vt(0),Vt(8),Vt(4),Lt]}(ht)}}}(i);return l?new Sn(...l,!1):void 0}get rgb(){const{r:i,g:l,b:p,a:g}=this,_=g||1/0;return this.overwriteGetter("rgb",[i/_,l/_,p/_,g])}get hcl(){return this.overwriteGetter("hcl",function(i){const[l,p,g,_]=Qt(i),x=Math.sqrt(p*p+g*g);return[Math.round(1e4*x)?Nt(Math.atan2(g,p)*Mt):NaN,x,l,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Qt(this.rgb))}overwriteGetter(i,l){return Object.defineProperty(this,i,{value:l}),l}toString(){const[i,l,p,g]=this.rgb;return`rgba(${[i,l,p].map(_=>Math.round(255*_)).join(",")},${g})`}}Sn.black=new Sn(0,0,0,1),Sn.white=new Sn(1,1,1,1),Sn.transparent=new Sn(0,0,0,0),Sn.red=new Sn(1,0,0,1);class Or{constructor(i,l,p){this.sensitivity=i?l?"variant":"case":l?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,l){return this.collator.compare(i,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class nr{constructor(i,l,p,g,_){this.text=i,this.image=l,this.scale=p,this.fontStack=g,this.textColor=_}}class Fn{constructor(i){this.sections=i}static fromString(i){return new Fn([new nr(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof Fn?i:Fn.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class ui{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof ui)return i;if(typeof i=="number")return new ui([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const l of i)if(typeof l!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new ui(i)}}toString(){return JSON.stringify(this.values)}}const dr=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class jr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof jr)return i;if(Array.isArray(i)&&!(i.length<1)&&i.length%2==0){for(let l=0;l<i.length;l+=2){const p=i[l],g=i[l+1];if(typeof p!="string"||!dr.has(p)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new jr(i)}}toString(){return JSON.stringify(this.values)}}class qr{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new qr({name:i,available:!1}):null}}function Da(a,i,l,p){return typeof a=="number"&&a>=0&&a<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof l=="number"&&l>=0&&l<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[a,i,l,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[a,i,l,p]:[a,i,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function la(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Sn||a instanceof Or||a instanceof Fn||a instanceof ui||a instanceof jr||a instanceof qr)return!0;if(Array.isArray(a)){for(const i of a)if(!la(i))return!1;return!0}if(typeof a=="object"){for(const i in a)if(!la(a[i]))return!1;return!0}return!1}function ir(a){if(a===null)return Oi;if(typeof a=="string")return ln;if(typeof a=="boolean")return tn;if(typeof a=="number")return pe;if(a instanceof Sn)return li;if(a instanceof Or)return qi;if(a instanceof Fn)return q;if(a instanceof ui)return V;if(a instanceof jr)return et;if(a instanceof qr)return G;if(Array.isArray(a)){const i=a.length;let l;for(const p of a){const g=ir(p);if(l){if(l===g)continue;l=Xe;break}l=g}return at(l||Xe,i)}return ji}function xn(a){const i=typeof a;return a===null?"":i==="string"||i==="number"||i==="boolean"?String(a):a instanceof Sn||a instanceof Fn||a instanceof ui||a instanceof jr||a instanceof qr?a.toString():JSON.stringify(a)}class Zi{constructor(i,l){this.type=i,this.value=l}static parse(i,l){if(i.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!la(i[1]))return l.error("invalid value");const p=i[1];let g=ir(p);const _=l.expectedType;return g.kind!=="array"||g.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(g=_),new Zi(g,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ar{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const ua={string:ln,number:pe,boolean:tn,object:ji};class zi{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");let p,g=1;const _=i[0];if(_==="array"){let E,T;if(i.length>2){const M=i[1];if(typeof M!="string"||!(M in ua)||M==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);E=ua[M],g++}else E=Xe;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return l.error('The length argument to "array" must be a positive integer literal',2);T=i[2],g++}p=at(E,T)}else{if(!ua[_])throw new Error(`Types doesn't contain name = ${_}`);p=ua[_]}const x=[];for(;g<i.length;g++){const E=l.parse(i[g],g,Xe);if(!E)return null;x.push(E)}return new zi(p,x)}evaluate(i){for(let l=0;l<this.args.length;l++){const p=this.args[l].evaluate(i);if(!vt(this.type,ir(p)))return p;if(l===this.args.length-1)throw new ar(`Expected value to be of type ${lt(this.type)}, but found ${lt(ir(p))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const zs={"to-boolean":tn,"to-color":li,"to-number":pe,"to-string":ln};class Ir{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const p=i[0];if(!zs[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&i.length!==2)return l.error("Expected one argument.");const g=zs[p],_=[];for(let x=1;x<i.length;x++){const E=l.parse(i[x],x,Xe);if(!E)return null;_.push(E)}return new Ir(g,_)}evaluate(i){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(i);case"color":{let l,p;for(const g of this.args){if(l=g.evaluate(i),p=null,l instanceof Sn)return l;if(typeof l=="string"){const _=i.parseColor(l);if(_)return _}else if(Array.isArray(l)&&(p=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Da(l[0],l[1],l[2],l[3]),!p))return new Sn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new ar(p||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(const p of this.args){l=p.evaluate(i);const g=ui.parse(l);if(g)return g}throw new ar(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(const p of this.args){l=p.evaluate(i);const g=jr.parse(l);if(g)return g}throw new ar(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(const p of this.args){if(l=p.evaluate(i),l===null)return 0;const g=Number(l);if(!isNaN(g))return g}throw new ar(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return Fn.fromString(xn(this.args[0].evaluate(i)));case"resolvedImage":return qr.fromString(xn(this.args[0].evaluate(i)));default:return xn(this.args[0].evaluate(i))}}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const ca=["Unknown","Point","LineString","Polygon"];class b{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ca[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let l=this._parseColorCache[i];return l||(l=this._parseColorCache[i]=Sn.parse(i)),l}}class L{constructor(i,l,p=[],g,_=new Os,x=[]){this.registry=i,this.path=p,this.key=p.map(E=>`[${E}]`).join(""),this.scope=_,this.errors=x,this.expectedType=g,this._isConstant=l}parse(i,l,p,g,_={}){return l?this.concat(l,p,g)._parse(i,_):this._parse(i,_)}_parse(i,l){function p(g,_,x){return x==="assert"?new zi(_,[g]):x==="coerce"?new Ir(_,[g]):g}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=i[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[g];if(_){let x=_.parse(i,this);if(!x)return null;if(this.expectedType){const E=this.expectedType,T=x.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||T.kind!=="value")if(E.kind!=="color"&&E.kind!=="formatted"&&E.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(E.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(E.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(E,T))return null}else x=p(x,E,l.typeAnnotation||"coerce");else x=p(x,E,l.typeAnnotation||"coerce");else x=p(x,E,l.typeAnnotation||"coerce");else x=p(x,E,l.typeAnnotation||"assert")}if(!(x instanceof Zi)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const E=new b;try{x=new Zi(x.type,x.evaluate(E))}catch(T){return this.error(T.message),null}}return x}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,l,p){const g=typeof i=="number"?this.path.concat(i):this.path,_=p?this.scope.concat(p):this.scope;return new L(this.registry,this._isConstant,g,l||null,_,this.errors)}error(i,...l){const p=`${this.key}${l.map(g=>`[${g}]`).join("")}`;this.errors.push(new pr(p,i))}checkSubtype(i,l){const p=vt(i,l);return p&&this.error(p),p}}class X{constructor(i,l,p){this.type=qi,this.locale=p,this.caseSensitive=i,this.diacriticSensitive=l}static parse(i,l){if(i.length!==2)return l.error("Expected one argument.");const p=i[1];if(typeof p!="object"||Array.isArray(p))return l.error("Collator options argument must be an object.");const g=l.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,tn);if(!g)return null;const _=l.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,tn);if(!_)return null;let x=null;return p.locale&&(x=l.parse(p.locale,1,ln),!x)?null:new X(g,_,x)}evaluate(i){return new Or(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}const ct=8192;function wt(a,i){a[0]=Math.min(a[0],i[0]),a[1]=Math.min(a[1],i[1]),a[2]=Math.max(a[2],i[0]),a[3]=Math.max(a[3],i[1])}function Et(a,i){return!(a[0]<=i[0]||a[2]>=i[2]||a[1]<=i[1]||a[3]>=i[3])}function kt(a,i){const l=(180+a[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,g=Math.pow(2,i.z);return[Math.round(l*g*ct),Math.round(p*g*ct)]}function se(a,i,l){const p=a[0]-i[0],g=a[1]-i[1],_=a[0]-l[0],x=a[1]-l[1];return p*x-_*g==0&&p*_<=0&&g*x<=0}function de(a,i){let l=!1;for(let x=0,E=i.length;x<E;x++){const T=i[x];for(let M=0,D=T.length;M<D-1;M++){if(se(a,T[M],T[M+1]))return!1;(g=T[M])[1]>(p=a)[1]!=(_=T[M+1])[1]>p[1]&&p[0]<(_[0]-g[0])*(p[1]-g[1])/(_[1]-g[1])+g[0]&&(l=!l)}}var p,g,_;return l}function Me(a,i){for(let l=0;l<i.length;l++)if(de(a,i[l]))return!0;return!1}function Le(a,i,l,p){const g=p[0]-l[0],_=p[1]-l[1],x=(a[0]-l[0])*_-g*(a[1]-l[1]),E=(i[0]-l[0])*_-g*(i[1]-l[1]);return x>0&&E<0||x<0&&E>0}function Ee(a,i,l){for(const M of l)for(let D=0;D<M.length-1;++D)if((E=[(x=M[D+1])[0]-(_=M[D])[0],x[1]-_[1]])[0]*(T=[(g=i)[0]-(p=a)[0],g[1]-p[1]])[1]-E[1]*T[0]!=0&&Le(p,g,_,x)&&Le(_,x,p,g))return!0;var p,g,_,x,E,T;return!1}function un(a,i){for(let l=0;l<a.length;++l)if(!de(a[l],i))return!1;for(let l=0;l<a.length-1;++l)if(Ee(a[l],a[l+1],i))return!1;return!0}function Cr(a,i){for(let l=0;l<i.length;l++)if(un(a,i[l]))return!0;return!1}function dn(a,i,l){const p=[];for(let g=0;g<a.length;g++){const _=[];for(let x=0;x<a[g].length;x++){const E=kt(a[g][x],l);wt(i,E),_.push(E)}p.push(_)}return p}function Jr(a,i,l){const p=[];for(let g=0;g<a.length;g++){const _=dn(a[g],i,l);p.push(_)}return p}function ne(a,i,l,p){if(a[0]<l[0]||a[0]>l[2]){const g=.5*p;let _=a[0]-l[0]>g?-p:l[0]-a[0]>g?p:0;_===0&&(_=a[0]-l[2]>g?-p:l[2]-a[0]>g?p:0),a[0]+=_}wt(i,a)}function $e(a,i,l,p){const g=Math.pow(2,p.z)*ct,_=[p.x*ct,p.y*ct],x=[];for(const E of a)for(const T of E){const M=[T.x+_[0],T.y+_[1]];ne(M,i,l,g),x.push(M)}return x}function Yn(a,i,l,p){const g=Math.pow(2,p.z)*ct,_=[p.x*ct,p.y*ct],x=[];for(const T of a){const M=[];for(const D of T){const B=[D.x+_[0],D.y+_[1]];wt(i,B),M.push(B)}x.push(M)}if(i[2]-i[0]<=g/2){(E=i)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const T of x)for(const M of T)ne(M,i,l,g)}var E;return x}class Tr{constructor(i,l){this.type=tn,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(la(i[1])){const p=i[1];if(p.type==="FeatureCollection")for(let g=0;g<p.features.length;++g){const _=p.features[g].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Tr(p,p.features[g].geometry)}else if(p.type==="Feature"){const g=p.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Tr(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Tr(p,p)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(l,p){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(p.type==="Polygon"){const E=dn(p.coordinates,_,x),T=$e(l.geometry(),g,_,x);if(!Et(g,_))return!1;for(const M of T)if(!de(M,E))return!1}if(p.type==="MultiPolygon"){const E=Jr(p.coordinates,_,x),T=$e(l.geometry(),g,_,x);if(!Et(g,_))return!1;for(const M of T)if(!Me(M,E))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(l,p){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(p.type==="Polygon"){const E=dn(p.coordinates,_,x),T=Yn(l.geometry(),g,_,x);if(!Et(g,_))return!1;for(const M of T)if(!un(M,E))return!1}if(p.type==="MultiPolygon"){const E=Jr(p.coordinates,_,x),T=Yn(l.geometry(),g,_,x);if(!Et(g,_))return!1;for(const M of T)if(!Cr(M,E))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class zr{constructor(i,l){this.type=l.type,this.name=i,this.boundExpression=l}static parse(i,l){if(i.length!==2||typeof i[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const p=i[1];return l.scope.has(p)?new zr(p,l.scope.get(p)):l.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class Do{constructor(i,l,p,g){this.name=i,this.type=l,this._evaluate=p,this.args=g}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,l){const p=i[0],g=Do.definitions[p];if(!g)return l.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(g)?g[0]:g.type,x=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,E=x.filter(([M])=>!Array.isArray(M)||M.length===i.length-1);let T=null;for(const[M,D]of E){T=new L(l.registry,eh,l.path,null,l.scope);const B=[];let U=!1;for(let H=1;H<i.length;H++){const K=i[H],it=Array.isArray(M)?M[H-1]:M.type,ht=T.parse(K,1+B.length,it);if(!ht){U=!0;break}B.push(ht)}if(!U)if(Array.isArray(M)&&M.length!==B.length)T.error(`Expected ${M.length} arguments, but found ${B.length} instead.`);else{for(let H=0;H<B.length;H++){const K=Array.isArray(M)?M[H]:M.type,it=B[H];T.concat(H+1).checkSubtype(K,it.type)}if(T.errors.length===0)return new Do(p,_,D,B)}}if(E.length===1)l.errors.push(...T.errors);else{const M=(E.length?E:x).map(([B])=>{return U=B,Array.isArray(U)?`(${U.map(lt).join(", ")})`:`(${lt(U.type)}...)`;var U}).join(" | "),D=[];for(let B=1;B<i.length;B++){const U=l.parse(i[B],1+D.length);if(!U)return null;D.push(lt(U.type))}l.error(`Expected arguments of type ${M}, but found (${D.join(", ")}) instead.`)}return null}static register(i,l){Do.definitions=l;for(const p in l)i[p]=Do}}function eh(a){if(a instanceof zr)return eh(a.boundExpression);if(a instanceof Do&&a.name==="error"||a instanceof X||a instanceof Tr)return!1;const i=a instanceof Ir||a instanceof zi;let l=!0;return a.eachChild(p=>{l=i?l&&eh(p):l&&p instanceof Zi}),!!l&&lr(a)&&nh(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function lr(a){if(a instanceof Do&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Tr)return!1;let i=!0;return a.eachChild(l=>{i&&!lr(l)&&(i=!1)}),i}function Pu(a){if(a instanceof Do&&a.name==="feature-state")return!1;let i=!0;return a.eachChild(l=>{i&&!Pu(l)&&(i=!1)}),i}function nh(a,i){if(a instanceof Do&&i.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(p=>{l&&!nh(p,i)&&(l=!1)}),l}function Ro(a,i){const l=a.length-1;let p,g,_=0,x=l,E=0;for(;_<=x;)if(E=Math.floor((_+x)/2),p=a[E],g=a[E+1],p<=i){if(E===l||i<g)return E;_=E+1}else{if(!(p>i))throw new ar("Input is not a number.");x=E-1}return 0}class Ra{constructor(i,l,p){this.type=i,this.input=l,this.labels=[],this.outputs=[];for(const[g,_]of p)this.labels.push(g),this.outputs.push(_)}static parse(i,l){if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");const p=l.parse(i[1],1,pe);if(!p)return null;const g=[];let _=null;l.expectedType&&l.expectedType.kind!=="value"&&(_=l.expectedType);for(let x=1;x<i.length;x+=2){const E=x===1?-1/0:i[x],T=i[x+1],M=x,D=x+1;if(typeof E!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(g.length&&g[g.length-1][0]>=E)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const B=l.parse(T,D,_);if(!B)return null;_=_||B.type,g.push([E,B])}return new Ra(_,p,g)}evaluate(i){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(i);const g=this.input.evaluate(i);if(g<=l[0])return p[0].evaluate(i);const _=l.length;return g>=l[_-1]?p[_-1].evaluate(i):p[Ro(l,g)].evaluate(i)}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function Mn(a,i,l){return a+l*(i-a)}function lc(a,i,l){return a.map((p,g)=>Mn(p,i[g],l))}const xo={number:Mn,color:function(a,i,l,p="rgb"){switch(p){case"rgb":{const[g,_,x,E]=lc(a.rgb,i.rgb,l);return new Sn(g,_,x,E,!1)}case"hcl":{const[g,_,x,E]=a.hcl,[T,M,D,B]=i.hcl;let U,H;if(isNaN(g)||isNaN(T))isNaN(g)?isNaN(T)?U=NaN:(U=T,x!==1&&x!==0||(H=M)):(U=g,D!==1&&D!==0||(H=_));else{let Tt=T-g;T>g&&Tt>180?Tt-=360:T<g&&g-T>180&&(Tt+=360),U=g+l*Tt}const[K,it,ht,mt]=function([Tt,xt,Lt,Vt]){return Tt=isNaN(Tt)?0:Tt*gt,oe([Lt,Math.cos(Tt)*xt,Math.sin(Tt)*xt,Vt])}([U,H??Mn(_,M,l),Mn(x,D,l),Mn(E,B,l)]);return new Sn(K,it,ht,mt,!1)}case"lab":{const[g,_,x,E]=oe(lc(a.lab,i.lab,l));return new Sn(g,_,x,E,!1)}}},array:lc,padding:function(a,i,l){return new ui(lc(a.values,i.values,l))},variableAnchorOffsetCollection:function(a,i,l){const p=a.values,g=i.values;if(p.length!==g.length)throw new ar(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${i.toString()}`);const _=[];for(let x=0;x<p.length;x+=2){if(p[x]!==g[x])throw new ar(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${p[x]}, to[${x}]: ${g[x]}`);_.push(p[x]);const[E,T]=p[x+1],[M,D]=g[x+1];_.push([Mn(E,M,l),Mn(T,D,l)])}return new jr(_)}};class Oo{constructor(i,l,p,g,_){this.type=i,this.operator=l,this.interpolation=p,this.input=g,this.labels=[],this.outputs=[];for(const[x,E]of _)this.labels.push(x),this.outputs.push(E)}static interpolationFactor(i,l,p,g){let _=0;if(i.name==="exponential")_=rh(l,i.base,p,g);else if(i.name==="linear")_=rh(l,1,p,g);else if(i.name==="cubic-bezier"){const x=i.controlPoints;_=new nt(x[0],x[1],x[2],x[3]).solve(rh(l,1,p,g))}return _}static parse(i,l){let[p,g,_,...x]=i;if(!Array.isArray(g)||g.length===0)return l.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const M=g[1];if(typeof M!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:M}}else{if(g[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const M=g.slice(1);if(M.length!==4||M.some(D=>typeof D!="number"||D<0||D>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:M}}}if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(_=l.parse(_,2,pe),!_)return null;const E=[];let T=null;p==="interpolate-hcl"||p==="interpolate-lab"?T=li:l.expectedType&&l.expectedType.kind!=="value"&&(T=l.expectedType);for(let M=0;M<x.length;M+=2){const D=x[M],B=x[M+1],U=M+3,H=M+4;if(typeof D!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(E.length&&E[E.length-1][0]>=D)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const K=l.parse(B,H,T);if(!K)return null;T=T||K.type,E.push([D,K])}return Yt(T,pe)||Yt(T,li)||Yt(T,V)||Yt(T,et)||Yt(T,at(pe))?new Oo(T,p,g,_,E):l.error(`Type ${lt(T)} is not interpolatable.`)}evaluate(i){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(i);const g=this.input.evaluate(i);if(g<=l[0])return p[0].evaluate(i);const _=l.length;if(g>=l[_-1])return p[_-1].evaluate(i);const x=Ro(l,g),E=Oo.interpolationFactor(this.interpolation,g,l[x],l[x+1]),T=p[x].evaluate(i),M=p[x+1].evaluate(i);switch(this.operator){case"interpolate":return xo[this.type.kind](T,M,E);case"interpolate-hcl":return xo.color(T,M,E,"hcl");case"interpolate-lab":return xo.color(T,M,E,"lab")}}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function rh(a,i,l,p){const g=p-l,_=a-l;return g===0?0:i===1?_/g:(Math.pow(i,_)-1)/(Math.pow(i,g)-1)}class ih{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expectected at least one argument.");let p=null;const g=l.expectedType;g&&g.kind!=="value"&&(p=g);const _=[];for(const E of i.slice(1)){const T=l.parse(E,1+_.length,p,void 0,{typeAnnotation:"omit"});if(!T)return null;p=p||T.type,_.push(T)}if(!p)throw new Error("No output type");const x=g&&_.some(E=>vt(g,E.type));return new ih(x?Xe:p,_)}evaluate(i){let l,p=null,g=0;for(const _ of this.args)if(g++,p=_.evaluate(i),p&&p instanceof qr&&!p.available&&(l||(l=p.name),p=null,g===this.args.length&&(p=l)),p!==null)break;return p}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}class oh{constructor(i,l){this.type=l.type,this.bindings=[].concat(i),this.result=l}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const l of this.bindings)i(l[1]);i(this.result)}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const p=[];for(let _=1;_<i.length-1;_+=2){const x=i[_];if(typeof x!="string")return l.error(`Expected string, but found ${typeof x} instead.`,_);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",_);const E=l.parse(i[_+1],_+1);if(!E)return null;p.push([x,E])}const g=l.parse(i[i.length-1],i.length-1,l.expectedType,p);return g?new oh(p,g):null}outputDefined(){return this.result.outputDefined()}}class wp{constructor(i,l,p){this.type=i,this.index=l,this.input=p}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,pe),g=l.parse(i[2],2,at(l.expectedType||Xe));return p&&g?new wp(g.type.itemType,p,g):null}evaluate(i){const l=this.index.evaluate(i),p=this.input.evaluate(i);if(l<0)throw new ar(`Array index out of bounds: ${l} < 0.`);if(l>=p.length)throw new ar(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l!==Math.floor(l))throw new ar(`Array index must be an integer, but found ${l} instead.`);return p[l]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class sh{constructor(i,l){this.type=tn,this.needle=i,this.haystack=l}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,Xe),g=l.parse(i[2],2,Xe);return p&&g?dt(p.type,[tn,ln,pe,Oi,Xe])?new sh(p,g):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${lt(p.type)} instead`):null}evaluate(i){const l=this.needle.evaluate(i),p=this.haystack.evaluate(i);if(!p)return!1;if(!bt(l,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${lt(ir(l))} instead.`);if(!bt(p,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${lt(ir(p))} instead.`);return p.indexOf(l)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class uc{constructor(i,l,p){this.type=pe,this.needle=i,this.haystack=l,this.fromIndex=p}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,Xe),g=l.parse(i[2],2,Xe);if(!p||!g)return null;if(!dt(p.type,[tn,ln,pe,Oi,Xe]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${lt(p.type)} instead`);if(i.length===4){const _=l.parse(i[3],3,pe);return _?new uc(p,g,_):null}return new uc(p,g)}evaluate(i){const l=this.needle.evaluate(i),p=this.haystack.evaluate(i);if(!bt(l,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${lt(ir(l))} instead.`);if(!bt(p,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${lt(ir(p))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(i);return p.indexOf(l,g)}return p.indexOf(l)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class ah{constructor(i,l,p,g,_,x){this.inputType=i,this.type=l,this.input=p,this.cases=g,this.outputs=_,this.otherwise=x}static parse(i,l){if(i.length<5)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return l.error("Expected an even number of arguments.");let p,g;l.expectedType&&l.expectedType.kind!=="value"&&(g=l.expectedType);const _={},x=[];for(let M=2;M<i.length-1;M+=2){let D=i[M];const B=i[M+1];Array.isArray(D)||(D=[D]);const U=l.concat(M);if(D.length===0)return U.error("Expected at least one branch label.");for(const K of D){if(typeof K!="number"&&typeof K!="string")return U.error("Branch labels must be numbers or strings.");if(typeof K=="number"&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof K=="number"&&Math.floor(K)!==K)return U.error("Numeric branch labels must be integer values.");if(p){if(U.checkSubtype(p,ir(K)))return null}else p=ir(K);if(_[String(K)]!==void 0)return U.error("Branch labels must be unique.");_[String(K)]=x.length}const H=l.parse(B,M,g);if(!H)return null;g=g||H.type,x.push(H)}const E=l.parse(i[1],1,Xe);if(!E)return null;const T=l.parse(i[i.length-1],i.length-1,g);return T?E.type.kind!=="value"&&l.concat(1).checkSubtype(p,E.type)?null:new ah(p,g,E,_,x,T):null}evaluate(i){const l=this.input.evaluate(i);return(ir(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class bp{constructor(i,l,p){this.type=i,this.branches=l,this.otherwise=p}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return l.error("Expected an odd number of arguments.");let p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const g=[];for(let x=1;x<i.length-1;x+=2){const E=l.parse(i[x],x,tn);if(!E)return null;const T=l.parse(i[x+1],x+1,p);if(!T)return null;g.push([E,T]),p=p||T.type}const _=l.parse(i[i.length-1],i.length-1,p);if(!_)return null;if(!p)throw new Error("Can't infer output type");return new bp(p,g,_)}evaluate(i){for(const[l,p]of this.branches)if(l.evaluate(i))return p.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[l,p]of this.branches)i(l),i(p);i(this.otherwise)}outputDefined(){return this.branches.every(([i,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class lh{constructor(i,l,p,g){this.type=i,this.input=l,this.beginIndex=p,this.endIndex=g}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,Xe),g=l.parse(i[2],2,pe);if(!p||!g)return null;if(!dt(p.type,[at(Xe),ln,Xe]))return l.error(`Expected first argument to be of type array or string, but found ${lt(p.type)} instead`);if(i.length===4){const _=l.parse(i[3],3,pe);return _?new lh(p.type,p,g,_):null}return new lh(p.type,p,g)}evaluate(i){const l=this.input.evaluate(i),p=this.beginIndex.evaluate(i);if(!bt(l,["string","array"]))throw new ar(`Expected first argument to be of type array or string, but found ${lt(ir(l))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(i);return l.slice(p,g)}return l.slice(p)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function cc(a,i){return a==="=="||a==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function uh(a,i,l,p){return p.compare(i,l)===0}function Yl(a,i,l){const p=a!=="=="&&a!=="!=";return class DT{constructor(_,x,E){this.type=tn,this.lhs=_,this.rhs=x,this.collator=E,this.hasUntypedArgument=_.type.kind==="value"||x.type.kind==="value"}static parse(_,x){if(_.length!==3&&_.length!==4)return x.error("Expected two or three arguments.");const E=_[0];let T=x.parse(_[1],1,Xe);if(!T)return null;if(!cc(E,T.type))return x.concat(1).error(`"${E}" comparisons are not supported for type '${lt(T.type)}'.`);let M=x.parse(_[2],2,Xe);if(!M)return null;if(!cc(E,M.type))return x.concat(2).error(`"${E}" comparisons are not supported for type '${lt(M.type)}'.`);if(T.type.kind!==M.type.kind&&T.type.kind!=="value"&&M.type.kind!=="value")return x.error(`Cannot compare types '${lt(T.type)}' and '${lt(M.type)}'.`);p&&(T.type.kind==="value"&&M.type.kind!=="value"?T=new zi(M.type,[T]):T.type.kind!=="value"&&M.type.kind==="value"&&(M=new zi(T.type,[M])));let D=null;if(_.length===4){if(T.type.kind!=="string"&&M.type.kind!=="string"&&T.type.kind!=="value"&&M.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(D=x.parse(_[3],3,qi),!D)return null}return new DT(T,M,D)}evaluate(_){const x=this.lhs.evaluate(_),E=this.rhs.evaluate(_);if(p&&this.hasUntypedArgument){const T=ir(x),M=ir(E);if(T.kind!==M.kind||T.kind!=="string"&&T.kind!=="number")throw new ar(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${M.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const T=ir(x),M=ir(E);if(T.kind!=="string"||M.kind!=="string")return i(_,x,E)}return this.collator?l(_,x,E,this.collator.evaluate(_)):i(_,x,E)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const ha=Yl("==",function(a,i,l){return i===l},uh),yf=Yl("!=",function(a,i,l){return i!==l},function(a,i,l,p){return!uh(0,i,l,p)}),_f=Yl("<",function(a,i,l){return i<l},function(a,i,l,p){return p.compare(i,l)<0}),qd=Yl(">",function(a,i,l){return i>l},function(a,i,l,p){return p.compare(i,l)>0}),vf=Yl("<=",function(a,i,l){return i<=l},function(a,i,l,p){return p.compare(i,l)<=0}),ch=Yl(">=",function(a,i,l){return i>=l},function(a,i,l,p){return p.compare(i,l)>=0});class hh{constructor(i,l,p,g,_){this.type=ln,this.number=i,this.locale=l,this.currency=p,this.minFractionDigits=g,this.maxFractionDigits=_}static parse(i,l){if(i.length!==3)return l.error("Expected two arguments.");const p=l.parse(i[1],1,pe);if(!p)return null;const g=i[2];if(typeof g!="object"||Array.isArray(g))return l.error("NumberFormat options argument must be an object.");let _=null;if(g.locale&&(_=l.parse(g.locale,1,ln),!_))return null;let x=null;if(g.currency&&(x=l.parse(g.currency,1,ln),!x))return null;let E=null;if(g["min-fraction-digits"]&&(E=l.parse(g["min-fraction-digits"],1,pe),!E))return null;let T=null;return g["max-fraction-digits"]&&(T=l.parse(g["max-fraction-digits"],1,pe),!T)?null:new hh(p,_,x,E,T)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class hc{constructor(i){this.type=q,this.sections=i}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const p=i[1];if(!Array.isArray(p)&&typeof p=="object")return l.error("First argument must be an image or text section.");const g=[];let _=!1;for(let x=1;x<=i.length-1;++x){const E=i[x];if(_&&typeof E=="object"&&!Array.isArray(E)){_=!1;let T=null;if(E["font-scale"]&&(T=l.parse(E["font-scale"],1,pe),!T))return null;let M=null;if(E["text-font"]&&(M=l.parse(E["text-font"],1,at(ln)),!M))return null;let D=null;if(E["text-color"]&&(D=l.parse(E["text-color"],1,li),!D))return null;const B=g[g.length-1];B.scale=T,B.font=M,B.textColor=D}else{const T=l.parse(i[x],1,Xe);if(!T)return null;const M=T.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,g.push({content:T,scale:null,font:null,textColor:null})}}return new hc(g)}evaluate(i){return new Fn(this.sections.map(l=>{const p=l.content.evaluate(i);return ir(p)===G?new nr("",p,null,null,null):new nr(xn(p),null,l.scale?l.scale.evaluate(i):null,l.font?l.font.evaluate(i).join(","):null,l.textColor?l.textColor.evaluate(i):null)}))}eachChild(i){for(const l of this.sections)i(l.content),l.scale&&i(l.scale),l.font&&i(l.font),l.textColor&&i(l.textColor)}outputDefined(){return!1}}class Ep{constructor(i){this.type=G,this.input=i}static parse(i,l){if(i.length!==2)return l.error("Expected two arguments.");const p=l.parse(i[1],1,ln);return p?new Ep(p):l.error("No image name provided.")}evaluate(i){const l=this.input.evaluate(i),p=qr.fromString(l);return p&&i.availableImages&&(p.available=i.availableImages.indexOf(l)>-1),p}eachChild(i){i(this.input)}outputDefined(){return!1}}class Oa{constructor(i){this.type=pe,this.input=i}static parse(i,l){if(i.length!==2)return l.error(`Expected 1 argument, but found ${i.length-1} instead.`);const p=l.parse(i[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${lt(p.type)} instead.`):new Oa(p):null}evaluate(i){const l=this.input.evaluate(i);if(typeof l=="string"||Array.isArray(l))return l.length;throw new ar(`Expected value to be of type string or array, but found ${lt(ir(l))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const Kl={"==":ha,"!=":yf,">":qd,"<":_f,">=":ch,"<=":vf,array:zi,at:wp,boolean:zi,case:bp,coalesce:ih,collator:X,format:hc,image:Ep,in:sh,"index-of":uc,interpolate:Oo,"interpolate-hcl":Oo,"interpolate-lab":Oo,length:Oa,let:oh,literal:Zi,match:ah,number:zi,"number-format":hh,object:zi,slice:lh,step:Ra,string:zi,"to-boolean":Ir,"to-color":Ir,"to-number":Ir,"to-string":Ir,var:zr,within:Tr};function xf(a,[i,l,p,g]){i=i.evaluate(a),l=l.evaluate(a),p=p.evaluate(a);const _=g?g.evaluate(a):1,x=Da(i,l,p,_);if(x)throw new ar(x);return new Sn(i/255,l/255,p/255,_,!1)}function wf(a,i){return a in i}function pc(a,i){const l=i[a];return l===void 0?null:l}function Fs(a){return{type:a}}function ph(a){return{result:"success",value:a}}function pa(a){return{result:"error",value:a}}function ll(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Mu(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Sp(a){return!!a.expression&&a.expression.interpolated}function Un(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function Pr(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function Zd(a){return a}function An(a,i){const l=i.type==="color",p=a.stops&&typeof a.stops[0][0]=="object",g=p||!(p||a.property!==void 0),_=a.type||(Sp(i)?"exponential":"interval");if(l||i.type==="padding"){const D=l?Sn.parse:ui.parse;(a=Gi({},a)).stops&&(a.stops=a.stops.map(B=>[B[0],D(B[1])])),a.default=D(a.default?a.default:i.default)}if(a.colorSpace&&(x=a.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var x;let E,T,M;if(_==="exponential")E=ns;else if(_==="interval")E=Kn;else if(_==="categorical"){E=xr,T=Object.create(null);for(const D of a.stops)T[D[0]]=D[1];M=typeof a.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);E=cl}if(p){const D={},B=[];for(let K=0;K<a.stops.length;K++){const it=a.stops[K],ht=it[0].zoom;D[ht]===void 0&&(D[ht]={zoom:ht,type:a.type,property:a.property,default:a.default,stops:[]},B.push(ht)),D[ht].stops.push([it[0].value,it[1]])}const U=[];for(const K of B)U.push([D[K].zoom,An(D[K],i)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:Oo.interpolationFactor.bind(void 0,H),zoomStops:U.map(K=>K[0]),evaluate:({zoom:K},it)=>ns({stops:U,base:a.base},i,K).evaluate(K,it)}}if(g){const D=_==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:Oo.interpolationFactor.bind(void 0,D),zoomStops:a.stops.map(B=>B[0]),evaluate:({zoom:B})=>E(a,i,B,T,M)}}return{kind:"source",evaluate(D,B){const U=B&&B.properties?B.properties[a.property]:void 0;return U===void 0?ul(a.default,i.default):E(a,i,U,T,M)}}}function ul(a,i,l){return a!==void 0?a:i!==void 0?i:l!==void 0?l:void 0}function xr(a,i,l,p,g){return ul(typeof l===g?p[l]:void 0,a.default,i.default)}function Kn(a,i,l){if(Un(l)!=="number")return ul(a.default,i.default);const p=a.stops.length;if(p===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[p-1][0])return a.stops[p-1][1];const g=Ro(a.stops.map(_=>_[0]),l);return a.stops[g][1]}function ns(a,i,l){const p=a.base!==void 0?a.base:1;if(Un(l)!=="number")return ul(a.default,i.default);const g=a.stops.length;if(g===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[g-1][0])return a.stops[g-1][1];const _=Ro(a.stops.map(D=>D[0]),l),x=function(D,B,U,H){const K=H-U,it=D-U;return K===0?0:B===1?it/K:(Math.pow(B,it)-1)/(Math.pow(B,K)-1)}(l,p,a.stops[_][0],a.stops[_+1][0]),E=a.stops[_][1],T=a.stops[_+1][1],M=xo[i.type]||Zd;return typeof E.evaluate=="function"?{evaluate(...D){const B=E.evaluate.apply(void 0,D),U=T.evaluate.apply(void 0,D);if(B!==void 0&&U!==void 0)return M(B,U,x,a.colorSpace)}}:M(E,T,x,a.colorSpace)}function cl(a,i,l){switch(i.type){case"color":l=Sn.parse(l);break;case"formatted":l=Fn.fromString(l.toString());break;case"resolvedImage":l=qr.fromString(l.toString());break;case"padding":l=ui.parse(l);break;default:Un(l)===i.type||i.type==="enum"&&i.values[l]||(l=void 0)}return ul(l,a.default,i.default)}Do.register(Kl,{error:[{kind:"error"},[ln],(a,[i])=>{throw new ar(i.evaluate(a))}],typeof:[ln,[Xe],(a,[i])=>lt(ir(i.evaluate(a)))],"to-rgba":[at(pe,4),[li],(a,[i])=>{const[l,p,g,_]=i.evaluate(a).rgb;return[255*l,255*p,255*g,_]}],rgb:[li,[pe,pe,pe],xf],rgba:[li,[pe,pe,pe,pe],xf],has:{type:tn,overloads:[[[ln],(a,[i])=>wf(i.evaluate(a),a.properties())],[[ln,ji],(a,[i,l])=>wf(i.evaluate(a),l.evaluate(a))]]},get:{type:Xe,overloads:[[[ln],(a,[i])=>pc(i.evaluate(a),a.properties())],[[ln,ji],(a,[i,l])=>pc(i.evaluate(a),l.evaluate(a))]]},"feature-state":[Xe,[ln],(a,[i])=>pc(i.evaluate(a),a.featureState||{})],properties:[ji,[],a=>a.properties()],"geometry-type":[ln,[],a=>a.geometryType()],id:[Xe,[],a=>a.id()],zoom:[pe,[],a=>a.globals.zoom],"heatmap-density":[pe,[],a=>a.globals.heatmapDensity||0],"line-progress":[pe,[],a=>a.globals.lineProgress||0],accumulated:[Xe,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[pe,Fs(pe),(a,i)=>{let l=0;for(const p of i)l+=p.evaluate(a);return l}],"*":[pe,Fs(pe),(a,i)=>{let l=1;for(const p of i)l*=p.evaluate(a);return l}],"-":{type:pe,overloads:[[[pe,pe],(a,[i,l])=>i.evaluate(a)-l.evaluate(a)],[[pe],(a,[i])=>-i.evaluate(a)]]},"/":[pe,[pe,pe],(a,[i,l])=>i.evaluate(a)/l.evaluate(a)],"%":[pe,[pe,pe],(a,[i,l])=>i.evaluate(a)%l.evaluate(a)],ln2:[pe,[],()=>Math.LN2],pi:[pe,[],()=>Math.PI],e:[pe,[],()=>Math.E],"^":[pe,[pe,pe],(a,[i,l])=>Math.pow(i.evaluate(a),l.evaluate(a))],sqrt:[pe,[pe],(a,[i])=>Math.sqrt(i.evaluate(a))],log10:[pe,[pe],(a,[i])=>Math.log(i.evaluate(a))/Math.LN10],ln:[pe,[pe],(a,[i])=>Math.log(i.evaluate(a))],log2:[pe,[pe],(a,[i])=>Math.log(i.evaluate(a))/Math.LN2],sin:[pe,[pe],(a,[i])=>Math.sin(i.evaluate(a))],cos:[pe,[pe],(a,[i])=>Math.cos(i.evaluate(a))],tan:[pe,[pe],(a,[i])=>Math.tan(i.evaluate(a))],asin:[pe,[pe],(a,[i])=>Math.asin(i.evaluate(a))],acos:[pe,[pe],(a,[i])=>Math.acos(i.evaluate(a))],atan:[pe,[pe],(a,[i])=>Math.atan(i.evaluate(a))],min:[pe,Fs(pe),(a,i)=>Math.min(...i.map(l=>l.evaluate(a)))],max:[pe,Fs(pe),(a,i)=>Math.max(...i.map(l=>l.evaluate(a)))],abs:[pe,[pe],(a,[i])=>Math.abs(i.evaluate(a))],round:[pe,[pe],(a,[i])=>{const l=i.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[pe,[pe],(a,[i])=>Math.floor(i.evaluate(a))],ceil:[pe,[pe],(a,[i])=>Math.ceil(i.evaluate(a))],"filter-==":[tn,[ln,Xe],(a,[i,l])=>a.properties()[i.value]===l.value],"filter-id-==":[tn,[Xe],(a,[i])=>a.id()===i.value],"filter-type-==":[tn,[ln],(a,[i])=>a.geometryType()===i.value],"filter-<":[tn,[ln,Xe],(a,[i,l])=>{const p=a.properties()[i.value],g=l.value;return typeof p==typeof g&&p<g}],"filter-id-<":[tn,[Xe],(a,[i])=>{const l=a.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[tn,[ln,Xe],(a,[i,l])=>{const p=a.properties()[i.value],g=l.value;return typeof p==typeof g&&p>g}],"filter-id->":[tn,[Xe],(a,[i])=>{const l=a.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[tn,[ln,Xe],(a,[i,l])=>{const p=a.properties()[i.value],g=l.value;return typeof p==typeof g&&p<=g}],"filter-id-<=":[tn,[Xe],(a,[i])=>{const l=a.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[tn,[ln,Xe],(a,[i,l])=>{const p=a.properties()[i.value],g=l.value;return typeof p==typeof g&&p>=g}],"filter-id->=":[tn,[Xe],(a,[i])=>{const l=a.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[tn,[Xe],(a,[i])=>i.value in a.properties()],"filter-has-id":[tn,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[tn,[at(ln)],(a,[i])=>i.value.indexOf(a.geometryType())>=0],"filter-id-in":[tn,[at(Xe)],(a,[i])=>i.value.indexOf(a.id())>=0],"filter-in-small":[tn,[ln,at(Xe)],(a,[i,l])=>l.value.indexOf(a.properties()[i.value])>=0],"filter-in-large":[tn,[ln,at(Xe)],(a,[i,l])=>function(p,g,_,x){for(;_<=x;){const E=_+x>>1;if(g[E]===p)return!0;g[E]>p?x=E-1:_=E+1}return!1}(a.properties()[i.value],l.value,0,l.value.length-1)],all:{type:tn,overloads:[[[tn,tn],(a,[i,l])=>i.evaluate(a)&&l.evaluate(a)],[Fs(tn),(a,i)=>{for(const l of i)if(!l.evaluate(a))return!1;return!0}]]},any:{type:tn,overloads:[[[tn,tn],(a,[i,l])=>i.evaluate(a)||l.evaluate(a)],[Fs(tn),(a,i)=>{for(const l of i)if(l.evaluate(a))return!0;return!1}]]},"!":[tn,[tn],(a,[i])=>!i.evaluate(a)],"is-supported-script":[tn,[ln],(a,[i])=>{const l=a.globals&&a.globals.isSupportedScript;return!l||l(i.evaluate(a))}],upcase:[ln,[ln],(a,[i])=>i.evaluate(a).toUpperCase()],downcase:[ln,[ln],(a,[i])=>i.evaluate(a).toLowerCase()],concat:[ln,Fs(Xe),(a,i)=>i.map(l=>xn(l.evaluate(a))).join("")],"resolved-locale":[ln,[qi],(a,[i])=>i.evaluate(a).resolvedLocale()]});class Lu{constructor(i,l){var p;this.expression=i,this._warningHistory={},this._evaluator=new b,this._defaultValue=l?(p=l).type==="color"&&Pr(p.default)?new Sn(0,0,0,0):p.type==="color"?Sn.parse(p.default)||null:p.type==="padding"?ui.parse(p.default)||null:p.type==="variableAnchorOffsetCollection"?jr.parse(p.default)||null:p.default===void 0?null:p.default:null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(i,l,p,g,_,x){return this._evaluator.globals=i,this._evaluator.feature=l,this._evaluator.featureState=p,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(i,l,p,g,_,x){this._evaluator.globals=i,this._evaluator.feature=l||null,this._evaluator.featureState=p||null,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new ar(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function Bs(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Kl}function fh(a,i){const l=new L(Kl,eh,[],i?function(g){const _={color:li,string:ln,number:pe,enum:ln,boolean:tn,formatted:q,padding:V,resolvedImage:G,variableAnchorOffsetCollection:et};return g.type==="array"?at(_[g.value]||Xe,g.length):_[g.type]}(i):void 0),p=l.parse(a,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?ph(new Lu(p,i)):pa(l.errors)}class Au{constructor(i,l){this.kind=i,this._styleExpression=l,this.isStateDependent=i!=="constant"&&!Pu(l.expression)}evaluateWithoutErrorHandling(i,l,p,g,_,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,p,g,_,x)}evaluate(i,l,p,g,_,x){return this._styleExpression.evaluate(i,l,p,g,_,x)}}class hl{constructor(i,l,p,g){this.kind=i,this.zoomStops=p,this._styleExpression=l,this.isStateDependent=i!=="camera"&&!Pu(l.expression),this.interpolationType=g}evaluateWithoutErrorHandling(i,l,p,g,_,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,p,g,_,x)}evaluate(i,l,p,g,_,x){return this._styleExpression.evaluate(i,l,p,g,_,x)}interpolationFactor(i,l,p){return this.interpolationType?Oo.interpolationFactor(this.interpolationType,i,l,p):0}}function dh(a,i){const l=fh(a,i);if(l.result==="error")return l;const p=l.value.expression,g=lr(p);if(!g&&!ll(i))return pa([new pr("","data expressions not supported")]);const _=nh(p,["zoom"]);if(!_&&!Mu(i))return pa([new pr("","zoom expressions not supported")]);const x=fc(p);return x||_?x instanceof pr?pa([x]):x instanceof Oo&&!Sp(i)?pa([new pr("",'"interpolate" expressions cannot be used with this property')]):ph(x?new hl(g?"camera":"composite",l.value,x.labels,x instanceof Oo?x.interpolation:void 0):new Au(g?"constant":"source",l.value)):pa([new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ku{constructor(i,l){this._parameters=i,this._specification=l,Gi(this,An(this._parameters,this._specification))}static deserialize(i){return new ku(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function fc(a){let i=null;if(a instanceof oh)i=fc(a.result);else if(a instanceof ih){for(const l of a.args)if(i=fc(l),i)break}else(a instanceof Ra||a instanceof Oo)&&a.input instanceof Do&&a.input.name==="zoom"&&(i=a);return i instanceof pr||a.eachChild(l=>{const p=fc(l);p instanceof pr?i=p:!i&&p?i=new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&p&&i!==p&&(i=new pr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function dc(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const i of a.slice(1))if(!dc(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const bf={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gh(a){if(a==null)return{filter:()=>!0,needGeometry:!1};dc(a)||(a=yh(a));const i=fh(a,bf);if(i.result==="error")throw new Error(i.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,p,g)=>i.value.evaluate(l,p,{},g),needGeometry:Jl(a)}}function mh(a,i){return a<i?-1:a>i?1:0}function Jl(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let i=1;i<a.length;i++)if(Jl(a[i]))return!0;return!1}function yh(a){if(!a)return!0;const i=a[0];return a.length<=1?i!=="any":i==="=="?fa(a[1],a[2],"=="):i==="!="?Nu(fa(a[1],a[2],"==")):i==="<"||i===">"||i==="<="||i===">="?fa(a[1],a[2],i):i==="any"?(l=a.slice(1),["any"].concat(l.map(yh))):i==="all"?["all"].concat(a.slice(1).map(yh)):i==="none"?["all"].concat(a.slice(1).map(yh).map(Nu)):i==="in"?Ef(a[1],a.slice(2)):i==="!in"?Nu(Ef(a[1],a.slice(2))):i==="has"?pl(a[1]):i==="!has"?Nu(pl(a[1])):i!=="within"||a;var l}function fa(a,i,l){switch(a){case"$type":return[`filter-type-${l}`,i];case"$id":return[`filter-id-${l}`,i];default:return[`filter-${l}`,a,i]}}function Ef(a,i){if(i.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(l=>typeof l!=typeof i[0])?["filter-in-large",a,["literal",i.sort(mh)]]:["filter-in-small",a,["literal",i]]}}function pl(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Nu(a){return["!",a]}function _h(a){const i=typeof a;if(i==="number"||i==="boolean"||i==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let g="[";for(const _ of a)g+=`${_h(_)},`;return`${g}]`}const l=Object.keys(a).sort();let p="{";for(let g=0;g<l.length;g++)p+=`${JSON.stringify(l[g])}:${_h(a[l[g]])},`;return`${p}}`}function Ql(a){let i="";for(const l of Ri)i+=`/${_h(a[l])}`;return i}function vh(a){const i=a.value;return i?[new ce(a.key,i,"constants have been deprecated as of v8")]:[]}function Mr(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function fl(a){if(Array.isArray(a))return a.map(fl);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const i={};for(const l in a)i[l]=fl(a[l]);return i}return Mr(a)}function wo(a){const i=a.key,l=a.value,p=a.valueSpec||{},g=a.objectElementValidators||{},_=a.style,x=a.styleSpec,E=a.validateSpec;let T=[];const M=Un(l);if(M!=="object")return[new ce(i,l,`object expected, ${M} found`)];for(const D in l){const B=D.split(".")[0],U=p[B]||p["*"];let H;if(g[B])H=g[B];else if(p[B])H=E;else if(g["*"])H=g["*"];else{if(!p["*"]){T.push(new ce(i,l[D],`unknown property "${D}"`));continue}H=E}T=T.concat(H({key:(i&&`${i}.`)+D,value:l[D],valueSpec:U,style:_,styleSpec:x,object:l,objectKey:D,validateSpec:E},l))}for(const D in p)g[D]||p[D].required&&p[D].default===void 0&&l[D]===void 0&&T.push(new ce(i,l,`missing required property "${D}"`));return T}function da(a){const i=a.value,l=a.valueSpec,p=a.style,g=a.styleSpec,_=a.key,x=a.arrayElementValidator||a.validateSpec;if(Un(i)!=="array")return[new ce(_,i,`array expected, ${Un(i)} found`)];if(l.length&&i.length!==l.length)return[new ce(_,i,`array length ${l.length} expected, length ${i.length} found`)];if(l["min-length"]&&i.length<l["min-length"])return[new ce(_,i,`array length at least ${l["min-length"]} expected, length ${i.length} found`)];let E={type:l.value,values:l.values};g.$version<7&&(E.function=l.function),Un(l.value)==="object"&&(E=l.value);let T=[];for(let M=0;M<i.length;M++)T=T.concat(x({array:i,arrayIndex:M,value:i[M],valueSpec:E,validateSpec:a.validateSpec,style:p,styleSpec:g,key:`${_}[${M}]`}));return T}function Du(a){const i=a.key,l=a.value,p=a.valueSpec;let g=Un(l);return g==="number"&&l!=l&&(g="NaN"),g!=="number"?[new ce(i,l,`number expected, ${g} found`)]:"minimum"in p&&l<p.minimum?[new ce(i,l,`${l} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&l>p.maximum?[new ce(i,l,`${l} is greater than the maximum value ${p.maximum}`)]:[]}function xh(a){const i=a.valueSpec,l=Mr(a.value.type);let p,g,_,x={};const E=l!=="categorical"&&a.value.property===void 0,T=!E,M=Un(a.value.stops)==="array"&&Un(a.value.stops[0])==="array"&&Un(a.value.stops[0][0])==="object",D=wo({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(H){if(l==="identity")return[new ce(H.key,H.value,'identity function may not have a "stops" property')];let K=[];const it=H.value;return K=K.concat(da({key:H.key,value:it,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:B})),Un(it)==="array"&&it.length===0&&K.push(new ce(H.key,it,"array must have at least one stop")),K},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:i,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return l==="identity"&&E&&D.push(new ce(a.key,a.value,'missing required property "property"')),l==="identity"||a.value.stops||D.push(new ce(a.key,a.value,'missing required property "stops"')),l==="exponential"&&a.valueSpec.expression&&!Sp(a.valueSpec)&&D.push(new ce(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(T&&!ll(a.valueSpec)?D.push(new ce(a.key,a.value,"property functions not supported")):E&&!Mu(a.valueSpec)&&D.push(new ce(a.key,a.value,"zoom functions not supported"))),l!=="categorical"&&!M||a.value.property!==void 0||D.push(new ce(a.key,a.value,'"property" property is required')),D;function B(H){let K=[];const it=H.value,ht=H.key;if(Un(it)!=="array")return[new ce(ht,it,`array expected, ${Un(it)} found`)];if(it.length!==2)return[new ce(ht,it,`array length 2 expected, length ${it.length} found`)];if(M){if(Un(it[0])!=="object")return[new ce(ht,it,`object expected, ${Un(it[0])} found`)];if(it[0].zoom===void 0)return[new ce(ht,it,"object stop key must have zoom")];if(it[0].value===void 0)return[new ce(ht,it,"object stop key must have value")];if(_&&_>Mr(it[0].zoom))return[new ce(ht,it[0].zoom,"stop zoom values must appear in ascending order")];Mr(it[0].zoom)!==_&&(_=Mr(it[0].zoom),g=void 0,x={}),K=K.concat(wo({key:`${ht}[0]`,value:it[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:Du,value:U}}))}else K=K.concat(U({key:`${ht}[0]`,value:it[0],valueSpec:{},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},it));return Bs(fl(it[1]))?K.concat([new ce(`${ht}[1]`,it[1],"expressions are not allowed in function stops.")]):K.concat(H.validateSpec({key:`${ht}[1]`,value:it[1],valueSpec:i,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function U(H,K){const it=Un(H.value),ht=Mr(H.value),mt=H.value!==null?H.value:K;if(p){if(it!==p)return[new ce(H.key,mt,`${it} stop domain type must match previous stop domain type ${p}`)]}else p=it;if(it!=="number"&&it!=="string"&&it!=="boolean")return[new ce(H.key,mt,"stop domain value must be a number, string, or boolean")];if(it!=="number"&&l!=="categorical"){let Tt=`number expected, ${it} found`;return ll(i)&&l===void 0&&(Tt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ce(H.key,mt,Tt)]}return l!=="categorical"||it!=="number"||isFinite(ht)&&Math.floor(ht)===ht?l!=="categorical"&&it==="number"&&g!==void 0&&ht<g?[new ce(H.key,mt,"stop domain values must appear in ascending order")]:(g=ht,l==="categorical"&&ht in x?[new ce(H.key,mt,"stop domain values must be unique")]:(x[ht]=!0,[])):[new ce(H.key,mt,`integer expected, found ${ht}`)]}}function Pt(a){const i=(a.expressionContext==="property"?dh:fh)(fl(a.value),a.valueSpec);if(i.result==="error")return i.value.map(p=>new ce(`${a.key}${p.key}`,a.value,p.message));const l=i.value.expression||i.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!l.outputDefined())return[new ce(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Pu(l))return[new ce(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Pu(l))return[new ce(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!nh(l,["zoom","feature-state"]))return[new ce(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!lr(l))return[new ce(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wt(a){const i=a.key,l=a.value,p=a.valueSpec,g=[];return Array.isArray(p.values)?p.values.indexOf(Mr(l))===-1&&g.push(new ce(i,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(Mr(l))===-1&&g.push(new ce(i,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),g}function Se(a){return dc(fl(a.value))?Pt(Gi({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):en(a)}function en(a){const i=a.value,l=a.key;if(Un(i)!=="array")return[new ce(l,i,`array expected, ${Un(i)} found`)];const p=a.styleSpec;let g,_=[];if(i.length<1)return[new ce(l,i,"filter array must have at least 1 element")];switch(_=_.concat(Wt({key:`${l}[0]`,value:i[0],valueSpec:p.filter_operator,style:a.style,styleSpec:a.styleSpec})),Mr(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&Mr(i[1])==="$type"&&_.push(new ce(l,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&_.push(new ce(l,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(g=Un(i[1]),g!=="string"&&_.push(new ce(`${l}[1]`,i[1],`string expected, ${g} found`)));for(let x=2;x<i.length;x++)g=Un(i[x]),Mr(i[1])==="$type"?_=_.concat(Wt({key:`${l}[${x}]`,value:i[x],valueSpec:p.geometry_type,style:a.style,styleSpec:a.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&_.push(new ce(`${l}[${x}]`,i[x],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let x=1;x<i.length;x++)_=_.concat(en({key:`${l}[${x}]`,value:i[x],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":g=Un(i[1]),i.length!==2?_.push(new ce(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):g!=="string"&&_.push(new ce(`${l}[1]`,i[1],`string expected, ${g} found`));break;case"within":g=Un(i[1]),i.length!==2?_.push(new ce(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):g!=="object"&&_.push(new ce(`${l}[1]`,i[1],`object expected, ${g} found`))}return _}function wr(a,i){const l=a.key,p=a.validateSpec,g=a.style,_=a.styleSpec,x=a.value,E=a.objectKey,T=_[`${i}_${a.layerType}`];if(!T)return[];const M=E.match(/^(.*)-transition$/);if(i==="paint"&&M&&T[M[1]]&&T[M[1]].transition)return p({key:l,value:x,valueSpec:_.transition,style:g,styleSpec:_});const D=a.valueSpec||T[E];if(!D)return[new ce(l,x,`unknown property "${E}"`)];let B;if(Un(x)==="string"&&ll(D)&&!D.tokens&&(B=/^{([^}]+)}$/.exec(x)))return[new ce(l,x,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const U=[];return a.layerType==="symbol"&&(E==="text-field"&&g&&!g.glyphs&&U.push(new ce(l,x,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&Pr(fl(x))&&Mr(x.type)==="identity"&&U.push(new ce(l,x,'"text-font" does not support identity functions'))),U.concat(p({key:a.key,value:x,valueSpec:D,style:g,styleSpec:_,expressionContext:"property",propertyType:i,propertyKey:E}))}function Rn(a){return wr(a,"paint")}function Fr(a){return wr(a,"layout")}function Qr(a){let i=[];const l=a.value,p=a.key,g=a.style,_=a.styleSpec;l.type||l.ref||i.push(new ce(p,l,'either "type" or "ref" is required'));let x=Mr(l.type);const E=Mr(l.ref);if(l.id){const T=Mr(l.id);for(let M=0;M<a.arrayIndex;M++){const D=g.layers[M];Mr(D.id)===T&&i.push(new ce(p,l.id,`duplicate layer id "${l.id}", previously used at line ${D.id.__line__}`))}}if("ref"in l){let T;["type","source","source-layer","filter","layout"].forEach(M=>{M in l&&i.push(new ce(p,l[M],`"${M}" is prohibited for ref layers`))}),g.layers.forEach(M=>{Mr(M.id)===E&&(T=M)}),T?T.ref?i.push(new ce(p,l.ref,"ref cannot reference another ref layer")):x=Mr(T.type):i.push(new ce(p,l.ref,`ref layer "${E}" not found`))}else if(x!=="background")if(l.source){const T=g.sources&&g.sources[l.source],M=T&&Mr(T.type);T?M==="vector"&&x==="raster"?i.push(new ce(p,l.source,`layer "${l.id}" requires a raster source`)):M!=="raster-dem"&&x==="hillshade"?i.push(new ce(p,l.source,`layer "${l.id}" requires a raster-dem source`)):M==="raster"&&x!=="raster"?i.push(new ce(p,l.source,`layer "${l.id}" requires a vector source`)):M!=="vector"||l["source-layer"]?M==="raster-dem"&&x!=="hillshade"?i.push(new ce(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!l.paint||!l.paint["line-gradient"]||M==="geojson"&&T.lineMetrics||i.push(new ce(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new ce(p,l,`layer "${l.id}" must specify a "source-layer"`)):i.push(new ce(p,l.source,`source "${l.source}" not found`))}else i.push(new ce(p,l,'missing required property "source"'));return i=i.concat(wo({key:p,value:l,valueSpec:_.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${p}.type`,value:l.type,valueSpec:_.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:l,objectKey:"type"}),filter:Se,layout:T=>wo({layer:l,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>Fr(Gi({layerType:x},M))}}),paint:T=>wo({layer:l,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>Rn(Gi({layerType:x},M))}})}})),i}function ci(a){const i=a.value,l=a.key,p=Un(i);return p!=="string"?[new ce(l,i,`string expected, ${p} found`)]:[]}const Br={promoteId:function({key:a,value:i}){if(Un(i)==="string")return ci({key:a,value:i});{const l=[];for(const p in i)l.push(...ci({key:`${a}.${p}`,value:i[p]}));return l}}};function Jn(a){const i=a.value,l=a.key,p=a.styleSpec,g=a.style,_=a.validateSpec;if(!i.type)return[new ce(l,i,'"type" is required')];const x=Mr(i.type);let E;switch(x){case"vector":case"raster":return E=wo({key:l,value:i,valueSpec:p[`source_${x.replace("-","_")}`],style:a.style,styleSpec:p,objectElementValidators:Br,validateSpec:_}),E;case"raster-dem":return E=function(T){var M;const D=(M=T.sourceName)!==null&&M!==void 0?M:"",B=T.value,U=T.styleSpec,H=U.source_raster_dem,K=T.style;let it=[];const ht=Un(B);if(B===void 0)return it;if(ht!=="object")return it.push(new ce("source_raster_dem",B,`object expected, ${ht} found`)),it;const mt=Mr(B.encoding)==="custom",Tt=["redFactor","greenFactor","blueFactor","baseShift"],xt=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const Lt in B)!mt&&Tt.includes(Lt)?it.push(new ce(Lt,B[Lt],`In "${D}": "${Lt}" is only valid when "encoding" is set to "custom". ${xt} encoding found`)):H[Lt]?it=it.concat(T.validateSpec({key:Lt,value:B[Lt],valueSpec:H[Lt],validateSpec:T.validateSpec,style:K,styleSpec:U})):it.push(new ce(Lt,B[Lt],`unknown property "${Lt}"`));return it}({sourceName:l,value:i,style:a.style,styleSpec:p,validateSpec:_}),E;case"geojson":if(E=wo({key:l,value:i,valueSpec:p.source_geojson,style:g,styleSpec:p,validateSpec:_,objectElementValidators:Br}),i.cluster)for(const T in i.clusterProperties){const[M,D]=i.clusterProperties[T],B=typeof M=="string"?[M,["accumulated"],["get",T]]:M;E.push(...Pt({key:`${l}.${T}.map`,value:D,validateSpec:_,expressionContext:"cluster-map"})),E.push(...Pt({key:`${l}.${T}.reduce`,value:B,validateSpec:_,expressionContext:"cluster-reduce"}))}return E;case"video":return wo({key:l,value:i,valueSpec:p.source_video,style:g,validateSpec:_,styleSpec:p});case"image":return wo({key:l,value:i,valueSpec:p.source_image,style:g,validateSpec:_,styleSpec:p});case"canvas":return[new ce(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Wt({key:`${l}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:_,styleSpec:p})}}function zo(a){const i=a.value,l=a.styleSpec,p=l.light,g=a.style;let _=[];const x=Un(i);if(i===void 0)return _;if(x!=="object")return _=_.concat([new ce("light",i,`object expected, ${x} found`)]),_;for(const E in i){const T=E.match(/^(.*)-transition$/);_=_.concat(T&&p[T[1]]&&p[T[1]].transition?a.validateSpec({key:E,value:i[E],valueSpec:l.transition,validateSpec:a.validateSpec,style:g,styleSpec:l}):p[E]?a.validateSpec({key:E,value:i[E],valueSpec:p[E],validateSpec:a.validateSpec,style:g,styleSpec:l}):[new ce(E,i[E],`unknown property "${E}"`)])}return _}function ga(a){const i=a.value,l=a.styleSpec,p=l.terrain,g=a.style;let _=[];const x=Un(i);if(i===void 0)return _;if(x!=="object")return _=_.concat([new ce("terrain",i,`object expected, ${x} found`)]),_;for(const E in i)_=_.concat(p[E]?a.validateSpec({key:E,value:i[E],valueSpec:p[E],validateSpec:a.validateSpec,style:g,styleSpec:l}):[new ce(E,i[E],`unknown property "${E}"`)]);return _}function lo(a){let i=[];const l=a.value,p=a.key;if(Array.isArray(l)){const g=[],_=[];for(const x in l)l[x].id&&g.includes(l[x].id)&&i.push(new ce(p,l,`all the sprites' ids must be unique, but ${l[x].id} is duplicated`)),g.push(l[x].id),l[x].url&&_.includes(l[x].url)&&i.push(new ce(p,l,`all the sprites' URLs must be unique, but ${l[x].url} is duplicated`)),_.push(l[x].url),i=i.concat(wo({key:`${p}[${x}]`,value:l[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return i}return ci({key:p,value:l})}const ma={"*":()=>[],array:da,boolean:function(a){const i=a.value,l=a.key,p=Un(i);return p!=="boolean"?[new ce(l,i,`boolean expected, ${p} found`)]:[]},number:Du,color:function(a){const i=a.key,l=a.value,p=Un(l);return p!=="string"?[new ce(i,l,`color expected, ${p} found`)]:Sn.parse(String(l))?[]:[new ce(i,l,`color expected, "${l}" found`)]},constants:vh,enum:Wt,filter:Se,function:xh,layer:Qr,object:wo,source:Jn,light:zo,terrain:ga,string:ci,formatted:function(a){return ci(a).length===0?[]:Pt(a)},resolvedImage:function(a){return ci(a).length===0?[]:Pt(a)},padding:function(a){const i=a.key,l=a.value;if(Un(l)==="array"){if(l.length<1||l.length>4)return[new ce(i,l,`padding requires 1 to 4 values; ${l.length} values found`)];const p={type:"number"};let g=[];for(let _=0;_<l.length;_++)g=g.concat(a.validateSpec({key:`${i}[${_}]`,value:l[_],validateSpec:a.validateSpec,valueSpec:p}));return g}return Du({key:i,value:l,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const i=a.key,l=a.value,p=Un(l),g=a.styleSpec;if(p!=="array"||l.length<1||l.length%2!=0)return[new ce(i,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let x=0;x<l.length;x+=2)_=_.concat(Wt({key:`${i}[${x}]`,value:l[x],valueSpec:g.layout_symbol["text-anchor"]})),_=_.concat(da({key:`${i}[${x+1}]`,value:l[x+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:g}));return _},sprite:lo};function Fo(a){const i=a.value,l=a.valueSpec,p=a.styleSpec;return a.validateSpec=Fo,l.expression&&Pr(Mr(i))?xh(a):l.expression&&Bs(fl(i))?Pt(a):l.type&&ma[l.type]?ma[l.type](a):wo(Gi({},a,{valueSpec:l.type?p[l.type]:l}))}function gc(a){const i=a.value,l=a.key,p=ci(a);return p.length||(i.indexOf("{fontstack}")===-1&&p.push(new ce(l,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&p.push(new ce(l,i,'"glyphs" url must include a "{range}" token'))),p}function Xi(a,i=qt){let l=[];return l=l.concat(Fo({key:"",value:a,valueSpec:i.$root,styleSpec:i,style:a,validateSpec:Fo,objectElementValidators:{glyphs:gc,"*":()=>[]}})),a.constants&&(l=l.concat(vh({key:"constants",value:a.constants,style:a,styleSpec:i,validateSpec:Fo}))),mc(l)}function rs(a){return function(i){return a({...i,validateSpec:Fo})}}function mc(a){return[].concat(a).sort((i,l)=>i.line-l.line)}function za(a){return function(...i){return mc(a.apply(this,i))}}Xi.source=za(rs(Jn)),Xi.sprite=za(rs(lo)),Xi.glyphs=za(rs(gc)),Xi.light=za(rs(zo)),Xi.terrain=za(rs(ga)),Xi.layer=za(rs(Qr)),Xi.filter=za(rs(Se)),Xi.paintProperty=za(rs(Rn)),Xi.layoutProperty=za(rs(Fr));const Fa=Xi,gr=Fa.light,Qn=Fa.paintProperty,yc=Fa.layoutProperty;function Vs(a,i){let l=!1;if(i&&i.length)for(const p of i)a.fire(new Ui(new Error(p.message))),l=!0;return l}class dl{constructor(i,l,p){const g=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const x=new Int32Array(this.arrayBuffer);i=x[0],this.d=(l=x[1])+2*(p=x[2]);for(let T=0;T<this.d*this.d;T++){const M=x[3+T],D=x[3+T+1];g.push(M===D?null:x.subarray(M,D))}const E=x[3+g.length+1];this.keys=x.subarray(x[3+g.length],E),this.bboxes=x.subarray(E),this.insert=this._insertReadonly}else{this.d=l+2*p;for(let x=0;x<this.d*this.d;x++)g.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=i,this.padding=p,this.scale=l/i,this.uid=0;const _=p/l*i;this.min=-_,this.max=i+_}insert(i,l,p,g,_){this._forEachCell(l,p,g,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(g),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,l,p,g,_,x){this.cells[_].push(x)}query(i,l,p,g,_){const x=this.min,E=this.max;if(i<=x&&l<=x&&E<=p&&E<=g&&!_)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(i,l,p,g,this._queryCell,T,{},_),T}}_queryCell(i,l,p,g,_,x,E,T){const M=this.cells[_];if(M!==null){const D=this.keys,B=this.bboxes;for(let U=0;U<M.length;U++){const H=M[U];if(E[H]===void 0){const K=4*H;(T?T(B[K+0],B[K+1],B[K+2],B[K+3]):i<=B[K+2]&&l<=B[K+3]&&p>=B[K+0]&&g>=B[K+1])?(E[H]=!0,x.push(D[H])):E[H]=!1}}}}_forEachCell(i,l,p,g,_,x,E,T){const M=this._convertToCellCoord(i),D=this._convertToCellCoord(l),B=this._convertToCellCoord(p),U=this._convertToCellCoord(g);for(let H=M;H<=B;H++)for(let K=D;K<=U;K++){const it=this.d*K+H;if((!T||T(this._convertFromCellCoord(H),this._convertFromCellCoord(K),this._convertFromCellCoord(H+1),this._convertFromCellCoord(K+1)))&&_.call(this,i,l,p,g,it,x,E,T))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,l=3+this.cells.length+1+1;let p=0;for(let x=0;x<this.cells.length;x++)p+=this.cells[x].length;const g=new Int32Array(l+p+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let _=l;for(let x=0;x<i.length;x++){const E=i[x];g[3+x]=_,g.set(E,_),_+=E.length}return g[3+i.length]=_,g.set(this.keys,_),_+=this.keys.length,g[3+i.length+1]=_,g.set(this.bboxes,_),_+=this.bboxes.length,g.buffer}static serialize(i,l){const p=i.toArrayBuffer();return l&&l.push(p),{buffer:p}}static deserialize(i){return new dl(i.buffer)}}const hi={};function Pe(a,i,l={}){if(hi[a])throw new Error(`${a} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:a,writeable:!1}),hi[a]={klass:i,omit:l.omit||[],shallow:l.shallow||[]}}Pe("Object",Object),Pe("TransferableGridIndex",dl),Pe("Color",Sn),Pe("Error",Error),Pe("AJAXError",Dr),Pe("ResolvedImage",qr),Pe("StylePropertyFunction",ku),Pe("StyleExpression",Lu,{omit:["_evaluator"]}),Pe("ZoomDependentExpression",hl),Pe("ZoomConstantExpression",Au),Pe("CompoundExpression",Do,{omit:["_evaluate"]});for(const a in Kl)Kl[a]._classRegistryKey||Pe(`Expression_${a}`,Kl[a]);function Us(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function _s(a,i){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob)return a;if(Us(a)||Fe(a))return i&&i.push(a),a;if(ArrayBuffer.isView(a)){const l=a;return i&&i.push(l.buffer),l}if(a instanceof ImageData)return i&&i.push(a.data.buffer),a;if(Array.isArray(a)){const l=[];for(const p of a)l.push(_s(p,i));return l}if(typeof a=="object"){const l=a.constructor,p=l._classRegistryKey;if(!p)throw new Error("can't serialize object of unregistered class");if(!hi[p])throw new Error(`${p} is not registered.`);const g=l.serialize?l.serialize(a,i):{};if(l.serialize){if(i&&g===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in a){if(!a.hasOwnProperty(_)||hi[p].omit.indexOf(_)>=0)continue;const x=a[_];g[_]=hi[p].shallow.indexOf(_)>=0?x:_s(x,i)}a instanceof Error&&(g.message=a.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(g.$name=p),g}throw new Error("can't serialize object of type "+typeof a)}function Ba(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||Us(a)||Fe(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Ba);if(typeof a=="object"){const i=a.$name||"Object";if(!hi[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:l}=hi[i];if(!l)throw new Error(`can't deserialize unregistered class ${i}`);if(l.deserialize)return l.deserialize(a);const p=Object.create(l.prototype);for(const g of Object.keys(a)){if(g==="$name")continue;const _=a[g];p[g]=hi[i].shallow.indexOf(g)>=0?_:Ba(_)}return p}throw new Error("can't deserialize object of type "+typeof a)}class tu{constructor(){this.first=!0}update(i,l){const p=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=l),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=p,!0))}}const xe={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function wh(a){for(const i of a)if(Ou(i.charCodeAt(0)))return!0;return!1}function Ru(a){for(const i of a)if(!Ip(i.charCodeAt(0)))return!1;return!0}function Ip(a){return!(xe.Arabic(a)||xe["Arabic Supplement"](a)||xe["Arabic Extended-A"](a)||xe["Arabic Presentation Forms-A"](a)||xe["Arabic Presentation Forms-B"](a))}function Ou(a){return!(a!==746&&a!==747&&(a<4352||!(xe["Bopomofo Extended"](a)||xe.Bopomofo(a)||xe["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||xe["CJK Compatibility Ideographs"](a)||xe["CJK Compatibility"](a)||xe["CJK Radicals Supplement"](a)||xe["CJK Strokes"](a)||!(!xe["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||xe["CJK Unified Ideographs Extension A"](a)||xe["CJK Unified Ideographs"](a)||xe["Enclosed CJK Letters and Months"](a)||xe["Hangul Compatibility Jamo"](a)||xe["Hangul Jamo Extended-A"](a)||xe["Hangul Jamo Extended-B"](a)||xe["Hangul Jamo"](a)||xe["Hangul Syllables"](a)||xe.Hiragana(a)||xe["Ideographic Description Characters"](a)||xe.Kanbun(a)||xe["Kangxi Radicals"](a)||xe["Katakana Phonetic Extensions"](a)||xe.Katakana(a)&&a!==12540||!(!xe["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!xe["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||xe["Unified Canadian Aboriginal Syllabics"](a)||xe["Unified Canadian Aboriginal Syllabics Extended"](a)||xe["Vertical Forms"](a)||xe["Yijing Hexagram Symbols"](a)||xe["Yi Syllables"](a)||xe["Yi Radicals"](a))))}function _c(a){return!(Ou(a)||function(i){return!!(xe["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||xe["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||xe["Letterlike Symbols"](i)||xe["Number Forms"](i)||xe["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||xe["Control Pictures"](i)&&i!==9251||xe["Optical Character Recognition"](i)||xe["Enclosed Alphanumerics"](i)||xe["Geometric Shapes"](i)||xe["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||xe["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||xe["CJK Symbols and Punctuation"](i)||xe.Katakana(i)||xe["Private Use Area"](i)||xe["CJK Compatibility Forms"](i)||xe["Small Form Variants"](i)||xe["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(a))}function Cp(a){return a>=1424&&a<=2303||xe["Arabic Presentation Forms-A"](a)||xe["Arabic Presentation Forms-B"](a)}function vc(a,i){return!(!i&&Cp(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||xe.Khmer(a))}function bh(a){for(const i of a)if(Cp(i.charCodeAt(0)))return!0;return!1}const Xd="deferred",Wd="loading",Hd="loaded";let Yd=null,vs="unavailable",zu=null;const Tp=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(vs="error"),Yd&&Yd(a)};function Kd(){Pp.fire(new Di("pluginStateChange",{pluginStatus:vs,pluginURL:zu}))}const Pp=new ko,Jd=function(){return vs},Wm=function(){if(vs!==Xd||!zu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");vs=Wd,Kd(),zu&&xi({url:zu},a=>{a?Tp(a):(vs=Hd,Kd())})},$s={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>vs===Hd||$s.applyArabicShaping!=null,isLoading:()=>vs===Wd,setState(a){if(!hn())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");vs=a.pluginStatus,zu=a.pluginURL},isParsed(){if(!hn())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return $s.applyArabicShaping!=null&&$s.processBidirectionalText!=null&&$s.processStyledBidirectionalText!=null},getPluginURL(){if(!hn())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return zu}};class Lr{constructor(i,l){this.zoom=i,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new tu,this.transition={})}isSupportedScript(i){return function(l,p){for(const g of l)if(!vc(g.charCodeAt(0),p))return!1;return!0}(i,$s.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,l=i-Math.floor(i),p=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*l}}}class Sf{constructor(i,l){this.property=i,this.value=l,this.expression=function(p,g){if(Pr(p))return new ku(p,g);if(Bs(p)){const _=dh(p,g);if(_.result==="error")throw new Error(_.value.map(x=>`${x.key}: ${x.message}`).join(", "));return _.value}{let _=p;return g.type==="color"&&typeof p=="string"?_=Sn.parse(p):g.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(p)&&(_=jr.parse(p)):_=ui.parse(p),{kind:"constant",evaluate:()=>_}}}(l===void 0?i.specification.default:l,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,l,p){return this.property.possiblyEvaluate(this,i,l,p)}}class Qd{constructor(i){this.property=i,this.value=new Sf(i,void 0)}transitioned(i,l){return new Ym(this.property,this.value,l,At({},i.transition,this.transition),i.now)}untransitioned(){return new Ym(this.property,this.value,null,{},0)}}class Hm{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return ue(this._values[i].value.value)}setValue(i,l){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Qd(this._values[i].property)),this._values[i].value=new Sf(this._values[i].property,l===null?void 0:ue(l))}getTransition(i){return ue(this._values[i].transition)}setTransition(i,l){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Qd(this._values[i].property)),this._values[i].transition=ue(l)||void 0}serialize(){const i={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(i[l]=p);const g=this.getTransition(l);g!==void 0&&(i[`${l}-transition`]=g)}return i}transitioned(i,l){const p=new Km(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].transitioned(i,l._values[g]);return p}untransitioned(){const i=new Km(this._properties);for(const l of Object.keys(this._values))i._values[l]=this._values[l].untransitioned();return i}}class Ym{constructor(i,l,p,g,_){this.property=i,this.value=l,this.begin=_+g.delay||0,this.end=this.begin+g.duration||0,i.specification.transition&&(g.delay||g.duration)&&(this.prior=p)}possiblyEvaluate(i,l,p){const g=i.now||0,_=this.value.possiblyEvaluate(i,l,p),x=this.prior;if(x){if(g>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(g<this.begin)return x.possiblyEvaluate(i,l,p);{const E=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(i,l,p),_,function(T){if(T<=0)return 0;if(T>=1)return 1;const M=T*T,D=M*T;return 4*(T<.5?D:3*(T-M)+D-.75)}(E))}}return _}}class Km{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,l,p){const g=new If(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(i,l,p);return g}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Tv{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}hasValue(i){return this._values[i].value!==void 0}getValue(i){return ue(this._values[i].value)}setValue(i,l){this._values[i]=new Sf(this._values[i].property,l===null?void 0:ue(l))}serialize(){const i={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(i[l]=p)}return i}possiblyEvaluate(i,l,p){const g=new If(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(i,l,p);return g}}class is{constructor(i,l,p){this.property=i,this.value=l,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,l,p,g){return this.property.evaluate(this.value,this.parameters,i,l,p,g)}}class If{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Ze{constructor(i){this.specification=i}possiblyEvaluate(i,l){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(l)}interpolate(i,l,p){const g=xo[this.specification.type];return g?g(i,l,p):i}}class nn{constructor(i,l){this.specification=i,this.overrides=l}possiblyEvaluate(i,l,p,g){return new is(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(l,null,{},p,g)}:i.expression,l)}interpolate(i,l,p){if(i.value.kind!=="constant"||l.value.kind!=="constant")return i;if(i.value.value===void 0||l.value.value===void 0)return new is(this,{kind:"constant",value:void 0},i.parameters);const g=xo[this.specification.type];if(g){const _=g(i.value.value,l.value.value,p);return new is(this,{kind:"constant",value:_},i.parameters)}return i}evaluate(i,l,p,g,_,x){return i.kind==="constant"?i.value:i.evaluate(l,p,g,_,x)}}class Mp extends nn{possiblyEvaluate(i,l,p,g){if(i.value===void 0)return new is(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){const _=i.expression.evaluate(l,null,{},p,g),x=i.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,E=this._calculate(x,x,x,l);return new is(this,{kind:"constant",value:E},l)}if(i.expression.kind==="camera"){const _=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new is(this,{kind:"constant",value:_},l)}return new is(this,i.expression,l)}evaluate(i,l,p,g,_,x){if(i.kind==="source"){const E=i.evaluate(l,p,g,_,x);return this._calculate(E,E,E,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},p,g),i.evaluate({zoom:Math.floor(l.zoom)},p,g),i.evaluate({zoom:Math.floor(l.zoom)+1},p,g),l):i.value}_calculate(i,l,p,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}}interpolate(i){return i}}class tg{constructor(i){this.specification=i}possiblyEvaluate(i,l,p,g){if(i.value!==void 0){if(i.expression.kind==="constant"){const _=i.expression.evaluate(l,null,{},p,g);return this._calculate(_,_,_,l)}return this._calculate(i.expression.evaluate(new Lr(Math.floor(l.zoom-1),l)),i.expression.evaluate(new Lr(Math.floor(l.zoom),l)),i.expression.evaluate(new Lr(Math.floor(l.zoom+1),l)),l)}}_calculate(i,l,p,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}}interpolate(i){return i}}class eg{constructor(i){this.specification=i}possiblyEvaluate(i,l,p,g){return!!i.expression.evaluate(l,null,{},p,g)}interpolate(){return!1}}class bi{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in i){const p=i[l];p.specification.overridable&&this.overridableProperties.push(l);const g=this.defaultPropertyValues[l]=new Sf(p,void 0),_=this.defaultTransitionablePropertyValues[l]=new Qd(p);this.defaultTransitioningPropertyValues[l]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=g.possiblyEvaluate({})}}}Pe("DataDrivenProperty",nn),Pe("DataConstantProperty",Ze),Pe("CrossFadedDataDrivenProperty",Mp),Pe("CrossFadedProperty",tg),Pe("ColorRampProperty",eg);const ng="-transition";class ya extends ko{constructor(i,l){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new Tv(l.layout)),l.paint)){this._transitionablePaint=new Hm(l.paint);for(const p in i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(const p in i.layout)this.setLayoutProperty(p,i.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new If(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,l,p={}){l!=null&&this._validate(yc,`layers.${this.id}.layout.${i}`,i,l,p)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)}getPaintProperty(i){return i.endsWith(ng)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,l,p={}){if(l!=null&&this._validate(Qn,`layers.${this.id}.paint.${i}`,i,l,p))return!1;if(i.endsWith(ng))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;{const g=this._transitionablePaint._values[i],_=g.property.specification["property-type"]==="cross-faded-data-driven",x=g.value.isDataDriven(),E=g.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);const T=this._transitionablePaint._values[i].value;return T.isDataDriven()||x||_||this._handleOverridablePaintPropertyUpdate(i,E,T)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,l,p){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),De(i,(l,p)=>!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length))}_validate(i,l,p,g,_={}){return(!_||_.validate!==!1)&&Vs(this,i.call(Fa,{key:l,layerType:this.type,objectKey:p,value:g,styleSpec:qt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const l=this.paint.get(i);if(l instanceof is&&ll(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const Jm={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xc{constructor(i,l){this._structArray=i,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ti{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,l){return i._trim(),l&&(i.isTransferred=!0,l.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const l=Object.create(this.prototype);return l.arrayBuffer=i.arrayBuffer,l.length=i.length,l.capacity=i.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Zr(a,i=1){let l=0,p=0;return{members:a.map(g=>{const _=Jm[g.type].BYTES_PER_ELEMENT,x=l=Eh(l,Math.max(i,_)),E=g.components||1;return p=Math.max(p,_),l+=_*E,{name:g.name,type:g.type,components:E,offset:x}}),size:Eh(l,Math.max(p,i)),alignment:i}}function Eh(a,i){return Math.ceil(a/i)*i}class Lp extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const g=2*i;return this.int16[g+0]=l,this.int16[g+1]=p,i}}Lp.prototype.bytesPerElement=4,Pe("StructArrayLayout2i4",Lp);class Ap extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=3*i;return this.int16[_+0]=l,this.int16[_+1]=p,this.int16[_+2]=g,i}}Ap.prototype.bytesPerElement=6,Pe("StructArrayLayout3i6",Ap);class wc extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,g)}emplace(i,l,p,g,_){const x=4*i;return this.int16[x+0]=l,this.int16[x+1]=p,this.int16[x+2]=g,this.int16[x+3]=_,i}}wc.prototype.bytesPerElement=8,Pe("StructArrayLayout4i8",wc);class rg extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x){const E=this.length;return this.resize(E+1),this.emplace(E,i,l,p,g,_,x)}emplace(i,l,p,g,_,x,E){const T=6*i;return this.int16[T+0]=l,this.int16[T+1]=p,this.int16[T+2]=g,this.int16[T+3]=_,this.int16[T+4]=x,this.int16[T+5]=E,i}}rg.prototype.bytesPerElement=12,Pe("StructArrayLayout2i4i12",rg);class ig extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x){const E=this.length;return this.resize(E+1),this.emplace(E,i,l,p,g,_,x)}emplace(i,l,p,g,_,x,E){const T=4*i,M=8*i;return this.int16[T+0]=l,this.int16[T+1]=p,this.uint8[M+4]=g,this.uint8[M+5]=_,this.uint8[M+6]=x,this.uint8[M+7]=E,i}}ig.prototype.bytesPerElement=8,Pe("StructArrayLayout2i4ub8",ig);class Sh extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const g=2*i;return this.float32[g+0]=l,this.float32[g+1]=p,i}}Sh.prototype.bytesPerElement=8,Pe("StructArrayLayout2f8",Sh);class og extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,E,T,M,D){const B=this.length;return this.resize(B+1),this.emplace(B,i,l,p,g,_,x,E,T,M,D)}emplace(i,l,p,g,_,x,E,T,M,D,B){const U=10*i;return this.uint16[U+0]=l,this.uint16[U+1]=p,this.uint16[U+2]=g,this.uint16[U+3]=_,this.uint16[U+4]=x,this.uint16[U+5]=E,this.uint16[U+6]=T,this.uint16[U+7]=M,this.uint16[U+8]=D,this.uint16[U+9]=B,i}}og.prototype.bytesPerElement=20,Pe("StructArrayLayout10ui20",og);class sg extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,E,T,M,D,B,U){const H=this.length;return this.resize(H+1),this.emplace(H,i,l,p,g,_,x,E,T,M,D,B,U)}emplace(i,l,p,g,_,x,E,T,M,D,B,U,H){const K=12*i;return this.int16[K+0]=l,this.int16[K+1]=p,this.int16[K+2]=g,this.int16[K+3]=_,this.uint16[K+4]=x,this.uint16[K+5]=E,this.uint16[K+6]=T,this.uint16[K+7]=M,this.int16[K+8]=D,this.int16[K+9]=B,this.int16[K+10]=U,this.int16[K+11]=H,i}}sg.prototype.bytesPerElement=24,Pe("StructArrayLayout4i4ui4i24",sg);class tr extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=3*i;return this.float32[_+0]=l,this.float32[_+1]=p,this.float32[_+2]=g,i}}tr.prototype.bytesPerElement=12,Pe("StructArrayLayout3f12",tr);class y extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint32[1*i+0]=l,i}}y.prototype.bytesPerElement=4,Pe("StructArrayLayout1ul4",y);class o extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,E,T,M){const D=this.length;return this.resize(D+1),this.emplace(D,i,l,p,g,_,x,E,T,M)}emplace(i,l,p,g,_,x,E,T,M,D){const B=10*i,U=5*i;return this.int16[B+0]=l,this.int16[B+1]=p,this.int16[B+2]=g,this.int16[B+3]=_,this.int16[B+4]=x,this.int16[B+5]=E,this.uint32[U+3]=T,this.uint16[B+8]=M,this.uint16[B+9]=D,i}}o.prototype.bytesPerElement=20,Pe("StructArrayLayout6i1ul2ui20",o);class h extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x){const E=this.length;return this.resize(E+1),this.emplace(E,i,l,p,g,_,x)}emplace(i,l,p,g,_,x,E){const T=6*i;return this.int16[T+0]=l,this.int16[T+1]=p,this.int16[T+2]=g,this.int16[T+3]=_,this.int16[T+4]=x,this.int16[T+5]=E,i}}h.prototype.bytesPerElement=12,Pe("StructArrayLayout2i2i2i12",h);class d extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,g,_)}emplace(i,l,p,g,_,x){const E=4*i,T=8*i;return this.float32[E+0]=l,this.float32[E+1]=p,this.float32[E+2]=g,this.int16[T+6]=_,this.int16[T+7]=x,i}}d.prototype.bytesPerElement=16,Pe("StructArrayLayout2f1f2i16",d);class m extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,g)}emplace(i,l,p,g,_){const x=12*i,E=3*i;return this.uint8[x+0]=l,this.uint8[x+1]=p,this.float32[E+1]=g,this.float32[E+2]=_,i}}m.prototype.bytesPerElement=12,Pe("StructArrayLayout2ub2f12",m);class v extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=3*i;return this.uint16[_+0]=l,this.uint16[_+1]=p,this.uint16[_+2]=g,i}}v.prototype.bytesPerElement=6,Pe("StructArrayLayout3ui6",v);class I extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,E,T,M,D,B,U,H,K,it,ht,mt){const Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,i,l,p,g,_,x,E,T,M,D,B,U,H,K,it,ht,mt)}emplace(i,l,p,g,_,x,E,T,M,D,B,U,H,K,it,ht,mt,Tt){const xt=24*i,Lt=12*i,Vt=48*i;return this.int16[xt+0]=l,this.int16[xt+1]=p,this.uint16[xt+2]=g,this.uint16[xt+3]=_,this.uint32[Lt+2]=x,this.uint32[Lt+3]=E,this.uint32[Lt+4]=T,this.uint16[xt+10]=M,this.uint16[xt+11]=D,this.uint16[xt+12]=B,this.float32[Lt+7]=U,this.float32[Lt+8]=H,this.uint8[Vt+36]=K,this.uint8[Vt+37]=it,this.uint8[Vt+38]=ht,this.uint32[Lt+10]=mt,this.int16[xt+22]=Tt,i}}I.prototype.bytesPerElement=48,Pe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",I);class C extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,_,x,E,T,M,D,B,U,H,K,it,ht,mt,Tt,xt,Lt,Vt,ee,ke,Ve,Ae,Ce,_e,Re){const we=this.length;return this.resize(we+1),this.emplace(we,i,l,p,g,_,x,E,T,M,D,B,U,H,K,it,ht,mt,Tt,xt,Lt,Vt,ee,ke,Ve,Ae,Ce,_e,Re)}emplace(i,l,p,g,_,x,E,T,M,D,B,U,H,K,it,ht,mt,Tt,xt,Lt,Vt,ee,ke,Ve,Ae,Ce,_e,Re,we){const le=32*i,Je=16*i;return this.int16[le+0]=l,this.int16[le+1]=p,this.int16[le+2]=g,this.int16[le+3]=_,this.int16[le+4]=x,this.int16[le+5]=E,this.int16[le+6]=T,this.int16[le+7]=M,this.uint16[le+8]=D,this.uint16[le+9]=B,this.uint16[le+10]=U,this.uint16[le+11]=H,this.uint16[le+12]=K,this.uint16[le+13]=it,this.uint16[le+14]=ht,this.uint16[le+15]=mt,this.uint16[le+16]=Tt,this.uint16[le+17]=xt,this.uint16[le+18]=Lt,this.uint16[le+19]=Vt,this.uint16[le+20]=ee,this.uint16[le+21]=ke,this.uint16[le+22]=Ve,this.uint32[Je+12]=Ae,this.float32[Je+13]=Ce,this.float32[Je+14]=_e,this.uint16[le+30]=Re,this.uint16[le+31]=we,i}}C.prototype.bytesPerElement=64,Pe("StructArrayLayout8i15ui1ul2f2ui64",C);class P extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.float32[1*i+0]=l,i}}P.prototype.bytesPerElement=4,Pe("StructArrayLayout1f4",P);class k extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=3*i;return this.uint16[6*i+0]=l,this.float32[_+1]=p,this.float32[_+2]=g,i}}k.prototype.bytesPerElement=12,Pe("StructArrayLayout1ui2f12",k);class R extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const _=4*i;return this.uint32[2*i+0]=l,this.uint16[_+2]=p,this.uint16[_+3]=g,i}}R.prototype.bytesPerElement=8,Pe("StructArrayLayout1ul2ui8",R);class F extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const g=2*i;return this.uint16[g+0]=l,this.uint16[g+1]=p,i}}F.prototype.bytesPerElement=4,Pe("StructArrayLayout2ui4",F);class Z extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint16[1*i+0]=l,i}}Z.prototype.bytesPerElement=2,Pe("StructArrayLayout1ui2",Z);class st extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,g)}emplace(i,l,p,g,_){const x=4*i;return this.float32[x+0]=l,this.float32[x+1]=p,this.float32[x+2]=g,this.float32[x+3]=_,i}}st.prototype.bytesPerElement=16,Pe("StructArrayLayout4f16",st);class ot extends xc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new O(this.anchorPointX,this.anchorPointY)}}ot.prototype.size=20;class ut extends o{get(i){return new ot(this,i)}}Pe("CollisionBoxArray",ut);class rt extends xc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}rt.prototype.size=48;class St extends I{get(i){return new rt(this,i)}}Pe("PlacedSymbolArray",St);class Ft extends xc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ft.prototype.size=64;class ft extends C{get(i){return new Ft(this,i)}}Pe("SymbolInstanceArray",ft);class Ct extends P{getoffsetX(i){return this.float32[1*i+0]}}Pe("GlyphOffsetArray",Ct);class $t extends Ap{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Pe("SymbolLineVertexArray",$t);class jt extends xc{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}jt.prototype.size=12;class te extends k{get(i){return new jt(this,i)}}Pe("TextAnchorOffsetArray",te);class ae extends xc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ae.prototype.size=8;class re extends R{get(i){return new ae(this,i)}}Pe("FeatureIndexArray",re);class ge extends Lp{}class Be extends Lp{}class kn extends Lp{}class Ie extends rg{}class rn extends ig{}class Ge extends Sh{}class ur extends og{}class Ln extends sg{}class wn extends tr{}class Nn extends y{}class pi extends h{}class br extends m{}class bo extends v{}class Wi extends F{}const Ei=Zr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Gs}=Ei;class Ar{constructor(i=[]){this.segments=i}prepareSegment(i,l,p,g){let _=this.segments[this.segments.length-1];return i>Ar.MAX_VERTEX_ARRAY_LENGTH&&Gt(`Max vertices per segment is ${Ar.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!_||_.vertexLength+i>Ar.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==g)&&(_={vertexOffset:l.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},g!==void 0&&(_.sortKey=g),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const i of this.segments)for(const l in i.vaos)i.vaos[l].destroy()}static simpleSegment(i,l,p,g){return new Ar([{vertexOffset:i,primitiveOffset:l,vertexLength:p,primitiveLength:g,vaos:{},sortKey:0}])}}function gl(a,i){return 256*(a=zt(Math.floor(a),0,255))+zt(Math.floor(i),0,255)}Ar.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pe("SegmentVector",Ar);const ml=Zr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Fu={exports:{}},bc={exports:{}};bc.exports=function(a,i){var l,p,g,_,x,E,T,M;for(p=a.length-(l=3&a.length),g=i,x=3432918353,E=461845907,M=0;M<p;)T=255&a.charCodeAt(M)|(255&a.charCodeAt(++M))<<8|(255&a.charCodeAt(++M))<<16|(255&a.charCodeAt(++M))<<24,++M,g=27492+(65535&(_=5*(65535&(g=(g^=T=(65535&(T=(T=(65535&T)*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*E+(((T>>>16)*E&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(T=0,l){case 3:T^=(255&a.charCodeAt(M+2))<<16;case 2:T^=(255&a.charCodeAt(M+1))<<8;case 1:g^=T=(65535&(T=(T=(65535&(T^=255&a.charCodeAt(M)))*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*E+(((T>>>16)*E&65535)<<16)&4294967295}return g^=a.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var Ih=bc.exports,Bo={exports:{}};Bo.exports=function(a,i){for(var l,p=a.length,g=i^p,_=0;p>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(_)|(255&a.charCodeAt(++_))<<8|(255&a.charCodeAt(++_))<<16|(255&a.charCodeAt(++_))<<24))+((1540483477*(l>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++_;switch(p){case 3:g^=(255&a.charCodeAt(_+2))<<16;case 2:g^=(255&a.charCodeAt(_+1))<<8;case 1:g=1540483477*(65535&(g^=255&a.charCodeAt(_)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var Eo=Ih,os=Bo.exports;Fu.exports=Eo,Fu.exports.murmur3=Eo,Fu.exports.murmur2=os;var Ec=S(Fu.exports);class fi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,l,p,g){this.ids.push(Hi(i)),this.positions.push(l,p,g)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=Hi(i);let p=0,g=this.ids.length-1;for(;p<g;){const x=p+g>>1;this.ids[x]>=l?g=x:p=x+1}const _=[];for(;this.ids[p]===l;)_.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return _}static serialize(i,l){const p=new Float64Array(i.ids),g=new Uint32Array(i.positions);return xs(p,g,0,p.length-1),l&&l.push(p.buffer,g.buffer),{ids:p,positions:g}}static deserialize(i){const l=new fi;return l.ids=i.ids,l.positions=i.positions,l.indexed=!0,l}}function Hi(a){const i=+a;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:Ec(String(a))}function xs(a,i,l,p){for(;l<p;){const g=a[l+p>>1];let _=l-1,x=p+1;for(;;){do _++;while(a[_]<g);do x--;while(a[x]>g);if(_>=x)break;di(a,_,x),di(i,3*_,3*x),di(i,3*_+1,3*x+1),di(i,3*_+2,3*x+2)}x-l<p-x?(xs(a,i,l,x),l=x+1):(xs(a,i,x+1,p),p=x)}}function di(a,i,l){const p=a[i];a[i]=a[l],a[l]=p}Pe("FeaturePositionMap",fi);class Sc{constructor(i,l){this.gl=i.gl,this.location=l}}class Cf extends Sc{constructor(i,l){super(i,l),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class Qm extends Sc{constructor(i,l){super(i,l),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class ty extends Sc{constructor(i,l){super(i,l),this.current=Sn.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const Pv=new Float32Array(16);function ag(a){return[gl(255*a.r,255*a.g),gl(255*a.b,255*a.a)]}class yl{constructor(i,l,p){this.value=i,this.uniformNames=l.map(g=>`u_${g}`),this.type=p}setUniform(i,l,p){i.set(p.constantOr(this.value))}getBinding(i,l,p){return this.type==="color"?new ty(i,l):new Cf(i,l)}}class Ic{constructor(i,l){this.uniformNames=l.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=i.tlbr}setUniform(i,l,p,g){const _=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&i.set(_)}getBinding(i,l,p){return p.substr(0,9)==="u_pattern"?new Qm(i,l):new Cf(i,l)}}class _l{constructor(i,l,p,g){this.expression=i,this.type=p,this.maxValue=0,this.paintVertexAttributes=l.map(_=>({name:`a_${_}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(i,l,p,g,_){const x=this.paintVertexArray.length,E=this.expression.evaluate(new Lr(0),l,{},g,[],_);this.paintVertexArray.resize(i),this._setPaintValue(x,i,E)}updatePaintArray(i,l,p,g){const _=this.expression.evaluate({zoom:0},p,g);this._setPaintValue(i,l,_)}_setPaintValue(i,l,p){if(this.type==="color"){const g=ag(p);for(let _=i;_<l;_++)this.paintVertexArray.emplace(_,g[0],g[1])}else{for(let g=i;g<l;g++)this.paintVertexArray.emplace(g,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _a{constructor(i,l,p,g,_,x){this.expression=i,this.uniformNames=l.map(E=>`u_${E}_t`),this.type=p,this.useIntegerZoom=g,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=l.map(E=>({name:`a_${E}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(i,l,p,g,_){const x=this.expression.evaluate(new Lr(this.zoom),l,{},g,[],_),E=this.expression.evaluate(new Lr(this.zoom+1),l,{},g,[],_),T=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(T,i,x,E)}updatePaintArray(i,l,p,g){const _=this.expression.evaluate({zoom:this.zoom},p,g),x=this.expression.evaluate({zoom:this.zoom+1},p,g);this._setPaintValue(i,l,_,x)}_setPaintValue(i,l,p,g){if(this.type==="color"){const _=ag(p),x=ag(g);for(let E=i;E<l;E++)this.paintVertexArray.emplace(E,_[0],_[1],x[0],x[1])}else{for(let _=i;_<l;_++)this.paintVertexArray.emplace(_,p,g);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(g))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,l){const p=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,g=zt(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);i.set(g)}getBinding(i,l,p){return new Cf(i,l)}}class vl{constructor(i,l,p,g,_,x){this.expression=i,this.type=l,this.useIntegerZoom=p,this.zoom=g,this.layerId=x,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(i,l,p){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(g,i,l.patterns&&l.patterns[this.layerId],p)}updatePaintArray(i,l,p,g,_){this._setPaintValues(i,l,p.patterns&&p.patterns[this.layerId],_)}_setPaintValues(i,l,p,g){if(!g||!p)return;const{min:_,mid:x,max:E}=p,T=g[_],M=g[x],D=g[E];if(T&&M&&D)for(let B=i;B<l;B++)this.zoomInPaintVertexArray.emplace(B,M.tl[0],M.tl[1],M.br[0],M.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],M.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(B,M.tl[0],M.tl[1],M.br[0],M.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],M.pixelRatio,D.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,ml.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,ml.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class lg{constructor(i,l,p){this.binders={},this._buffers=[];const g=[];for(const _ in i.paint._values){if(!p(_))continue;const x=i.paint.get(_);if(!(x instanceof is&&ll(x.property.specification)))continue;const E=K2(_,i.type),T=x.value,M=x.property.specification.type,D=x.property.useIntegerZoom,B=x.property.specification["property-type"],U=B==="cross-faded"||B==="cross-faded-data-driven";if(T.kind==="constant")this.binders[_]=U?new Ic(T.value,E):new yl(T.value,E,M),g.push(`/u_${_}`);else if(T.kind==="source"||U){const H=Tw(_,M,"source");this.binders[_]=U?new vl(T,M,D,l,H,i.id):new _l(T,E,M,H),g.push(`/a_${_}`)}else{const H=Tw(_,M,"composite");this.binders[_]=new _a(T,E,M,D,l,H),g.push(`/z_${_}`)}}this.cacheKey=g.sort().join("")}getMaxValue(i){const l=this.binders[i];return l instanceof _l||l instanceof _a?l.maxValue:0}populatePaintArrays(i,l,p,g,_){for(const x in this.binders){const E=this.binders[x];(E instanceof _l||E instanceof _a||E instanceof vl)&&E.populatePaintArray(i,l,p,g,_)}}setConstantPatternPositions(i,l){for(const p in this.binders){const g=this.binders[p];g instanceof Ic&&g.setConstantPatternPositions(i,l)}}updatePaintArrays(i,l,p,g,_){let x=!1;for(const E in i){const T=l.getPositions(E);for(const M of T){const D=p.feature(M.index);for(const B in this.binders){const U=this.binders[B];if((U instanceof _l||U instanceof _a||U instanceof vl)&&U.expression.isStateDependent===!0){const H=g.paint.get(B);U.expression=H.value,U.updatePaintArray(M.start,M.end,D,i[E],_),x=!0}}}}return x}defines(){const i=[];for(const l in this.binders){const p=this.binders[l];(p instanceof yl||p instanceof Ic)&&i.push(...p.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return i}getBinderAttributes(){const i=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof _l||p instanceof _a)for(let g=0;g<p.paintVertexAttributes.length;g++)i.push(p.paintVertexAttributes[g].name);else if(p instanceof vl)for(let g=0;g<ml.members.length;g++)i.push(ml.members[g].name)}return i}getBinderUniforms(){const i=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof yl||p instanceof Ic||p instanceof _a)for(const g of p.uniformNames)i.push(g)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,l){const p=[];for(const g in this.binders){const _=this.binders[g];if(_ instanceof yl||_ instanceof Ic||_ instanceof _a){for(const x of _.uniformNames)if(l[x]){const E=_.getBinding(i,l[x],x);p.push({name:x,property:g,binding:E})}}}return p}setUniforms(i,l,p,g){for(const{name:_,property:x,binding:E}of l)this.binders[x].setUniform(E,g,p.get(x),_)}updatePaintBuffers(i){this._buffers=[];for(const l in this.binders){const p=this.binders[l];if(i&&p instanceof vl){const g=i.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(p instanceof _l||p instanceof _a)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(i){for(const l in this.binders){const p=this.binders[l];(p instanceof _l||p instanceof _a||p instanceof vl)&&p.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const l=this.binders[i];(l instanceof _l||l instanceof _a||l instanceof vl)&&l.destroy()}}}class eu{constructor(i,l,p=()=>!0){this.programConfigurations={};for(const g of i)this.programConfigurations[g.id]=new lg(g,l,p);this.needsUpload=!1,this._featureMap=new fi,this._bufferOffset=0}populatePaintArrays(i,l,p,g,_,x){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(i,l,g,_,x);l.id!==void 0&&this._featureMap.add(l.id,p,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,l,p,g){for(const _ of p)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(i,this._featureMap,l,_,g)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function K2(a,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${i}-`,"").replace(/-/g,"_")]}function Tw(a,i,l){const p={color:{source:Sh,composite:st},number:{source:P,composite:Sh}},g=function(_){return{"line-pattern":{source:ur,composite:ur},"fill-pattern":{source:ur,composite:ur},"fill-extrusion-pattern":{source:ur,composite:ur}}[_]}(a);return g&&g[l]||p[i][l]}Pe("ConstantBinder",yl),Pe("CrossFadedConstantBinder",Ic),Pe("SourceExpressionBinder",_l),Pe("CrossFadedCompositeBinder",vl),Pe("CompositeExpressionBinder",_a),Pe("ProgramConfiguration",lg,{omit:["_buffers"]}),Pe("ProgramConfigurationSet",eu);const Fi=8192,Mv=Math.pow(2,14)-1,Pw=-Mv-1;function kp(a){const i=Fi/a.extent,l=a.loadGeometry();for(let p=0;p<l.length;p++){const g=l[p];for(let _=0;_<g.length;_++){const x=g[_],E=Math.round(x.x*i),T=Math.round(x.y*i);x.x=zt(E,Pw,Mv),x.y=zt(T,Pw,Mv),(E<x.x||E>x.x+1||T<x.y||T>x.y+1)&&Gt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function Np(a,i){return{type:a.type,id:a.id,properties:a.properties,geometry:i?kp(a):[]}}function ey(a,i,l,p,g){a.emplaceBack(2*i+(p+1)/2,2*l+(g+1)/2)}class Lv{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Be,this.indexArray=new bo,this.segments=new Ar,this.programConfigurations=new eu(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){const g=this.layers[0],_=[];let x=null,E=!1;g.type==="circle"&&(x=g.layout.get("circle-sort-key"),E=!x.isConstant());for(const{feature:T,id:M,index:D,sourceLayerIndex:B}of i){const U=this.layers[0]._featureFilter.needGeometry,H=Np(T,U);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom),H,p))continue;const K=E?x.evaluate(H,{},p):void 0,it={id:M,properties:T.properties,type:T.type,sourceLayerIndex:B,index:D,geometry:U?H.geometry:kp(T),patterns:{},sortKey:K};_.push(it)}E&&_.sort((T,M)=>T.sortKey-M.sortKey);for(const T of _){const{geometry:M,index:D,sourceLayerIndex:B}=T,U=i[D].feature;this.addFeature(T,M,D,p),l.featureIndex.insert(U,M,D,B,this.index)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Gs),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,p,g){for(const _ of l)for(const x of _){const E=x.x,T=x.y;if(E<0||E>=Fi||T<0||T>=Fi)continue;const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),D=M.vertexLength;ey(this.layoutVertexArray,E,T,-1,-1),ey(this.layoutVertexArray,E,T,1,-1),ey(this.layoutVertexArray,E,T,1,1),ey(this.layoutVertexArray,E,T,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+3,D+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,{},g)}}function Mw(a,i){for(let l=0;l<a.length;l++)if(Tf(i,a[l]))return!0;for(let l=0;l<i.length;l++)if(Tf(a,i[l]))return!0;return!!Av(a,i)}function J2(a,i,l){return!!Tf(a,i)||!!kv(i,a,l)}function Lw(a,i){if(a.length===1)return kw(i,a[0]);for(let l=0;l<i.length;l++){const p=i[l];for(let g=0;g<p.length;g++)if(Tf(a,p[g]))return!0}for(let l=0;l<a.length;l++)if(kw(i,a[l]))return!0;for(let l=0;l<i.length;l++)if(Av(a,i[l]))return!0;return!1}function Q2(a,i,l){if(a.length>1){if(Av(a,i))return!0;for(let p=0;p<i.length;p++)if(kv(i[p],a,l))return!0}for(let p=0;p<a.length;p++)if(kv(a[p],i,l))return!0;return!1}function Av(a,i){if(a.length===0||i.length===0)return!1;for(let l=0;l<a.length-1;l++){const p=a[l],g=a[l+1];for(let _=0;_<i.length-1;_++)if(tP(p,g,i[_],i[_+1]))return!0}return!1}function tP(a,i,l,p){return ye(a,l,p)!==ye(i,l,p)&&ye(a,i,l)!==ye(a,i,p)}function kv(a,i,l){const p=l*l;if(i.length===1)return a.distSqr(i[0])<p;for(let g=1;g<i.length;g++)if(Aw(a,i[g-1],i[g])<p)return!0;return!1}function Aw(a,i,l){const p=i.distSqr(l);if(p===0)return a.distSqr(i);const g=((a.x-i.x)*(l.x-i.x)+(a.y-i.y)*(l.y-i.y))/p;return a.distSqr(g<0?i:g>1?l:l.sub(i)._mult(g)._add(i))}function kw(a,i){let l,p,g,_=!1;for(let x=0;x<a.length;x++){l=a[x];for(let E=0,T=l.length-1;E<l.length;T=E++)p=l[E],g=l[T],p.y>i.y!=g.y>i.y&&i.x<(g.x-p.x)*(i.y-p.y)/(g.y-p.y)+p.x&&(_=!_)}return _}function Tf(a,i){let l=!1;for(let p=0,g=a.length-1;p<a.length;g=p++){const _=a[p],x=a[g];_.y>i.y!=x.y>i.y&&i.x<(x.x-_.x)*(i.y-_.y)/(x.y-_.y)+_.x&&(l=!l)}return l}function eP(a,i,l){const p=l[0],g=l[2];if(a.x<p.x&&i.x<p.x||a.x>g.x&&i.x>g.x||a.y<p.y&&i.y<p.y||a.y>g.y&&i.y>g.y)return!1;const _=ye(a,i,l[0]);return _!==ye(a,i,l[1])||_!==ye(a,i,l[2])||_!==ye(a,i,l[3])}function ug(a,i,l){const p=i.paint.get(a).value;return p.kind==="constant"?p.value:l.programConfigurations.get(i.id).getMaxValue(a)}function ny(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function ry(a,i,l,p,g){if(!i[0]&&!i[1])return a;const _=O.convert(i)._mult(g);l==="viewport"&&_._rotate(-p);const x=[];for(let E=0;E<a.length;E++)x.push(a[E].sub(_));return x}let Nw,Dw;Pe("CircleBucket",Lv,{omit:["layers"]});var nP={get paint(){return Dw=Dw||new bi({"circle-radius":new nn(qt.paint_circle["circle-radius"]),"circle-color":new nn(qt.paint_circle["circle-color"]),"circle-blur":new nn(qt.paint_circle["circle-blur"]),"circle-opacity":new nn(qt.paint_circle["circle-opacity"]),"circle-translate":new Ze(qt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ze(qt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ze(qt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ze(qt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new nn(qt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new nn(qt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new nn(qt.paint_circle["circle-stroke-opacity"])})},get layout(){return Nw=Nw||new bi({"circle-sort-key":new nn(qt.layout_circle["circle-sort-key"])})}},ws=1e-6,Pf=typeof Float32Array<"u"?Float32Array:Array;function Nv(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Rw(a,i,l){var p=i[0],g=i[1],_=i[2],x=i[3],E=i[4],T=i[5],M=i[6],D=i[7],B=i[8],U=i[9],H=i[10],K=i[11],it=i[12],ht=i[13],mt=i[14],Tt=i[15],xt=l[0],Lt=l[1],Vt=l[2],ee=l[3];return a[0]=xt*p+Lt*E+Vt*B+ee*it,a[1]=xt*g+Lt*T+Vt*U+ee*ht,a[2]=xt*_+Lt*M+Vt*H+ee*mt,a[3]=xt*x+Lt*D+Vt*K+ee*Tt,a[4]=(xt=l[4])*p+(Lt=l[5])*E+(Vt=l[6])*B+(ee=l[7])*it,a[5]=xt*g+Lt*T+Vt*U+ee*ht,a[6]=xt*_+Lt*M+Vt*H+ee*mt,a[7]=xt*x+Lt*D+Vt*K+ee*Tt,a[8]=(xt=l[8])*p+(Lt=l[9])*E+(Vt=l[10])*B+(ee=l[11])*it,a[9]=xt*g+Lt*T+Vt*U+ee*ht,a[10]=xt*_+Lt*M+Vt*H+ee*mt,a[11]=xt*x+Lt*D+Vt*K+ee*Tt,a[12]=(xt=l[12])*p+(Lt=l[13])*E+(Vt=l[14])*B+(ee=l[15])*it,a[13]=xt*g+Lt*T+Vt*U+ee*ht,a[14]=xt*_+Lt*M+Vt*H+ee*mt,a[15]=xt*x+Lt*D+Vt*K+ee*Tt,a}Math.hypot||(Math.hypot=function(){for(var a=0,i=arguments.length;i--;)a+=arguments[i]*arguments[i];return Math.sqrt(a)});var cg,rP=Rw;function iy(a,i,l){var p=i[0],g=i[1],_=i[2],x=i[3];return a[0]=l[0]*p+l[4]*g+l[8]*_+l[12]*x,a[1]=l[1]*p+l[5]*g+l[9]*_+l[13]*x,a[2]=l[2]*p+l[6]*g+l[10]*_+l[14]*x,a[3]=l[3]*p+l[7]*g+l[11]*_+l[15]*x,a}cg=new Pf(4),Pf!=Float32Array&&(cg[0]=0,cg[1]=0,cg[2]=0,cg[3]=0);class iP extends ya{constructor(i){super(i,nP)}createBucket(i){return new Lv(i)}queryRadius(i){const l=i;return ug("circle-radius",this,l)+ug("circle-stroke-width",this,l)+ny(this.paint.get("circle-translate"))}queryIntersectsFeature(i,l,p,g,_,x,E,T){const M=ry(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,E),D=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),B=this.paint.get("circle-pitch-alignment")==="map",U=B?M:function(K,it){return K.map(ht=>Ow(ht,it))}(M,T),H=B?D*E:D;for(const K of g)for(const it of K){const ht=B?it:Ow(it,T);let mt=H;const Tt=iy([],[it.x,it.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?mt*=Tt[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(mt*=x.cameraToCenterDistance/Tt[3]),J2(U,ht,mt))return!0}return!1}}function Ow(a,i){const l=iy([],[a.x,a.y,0,1],i);return new O(l[0]/l[3],l[1]/l[3])}class zw extends Lv{}let Fw;Pe("HeatmapBucket",zw,{omit:["layers"]});var oP={get paint(){return Fw=Fw||new bi({"heatmap-radius":new nn(qt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new nn(qt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ze(qt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new eg(qt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ze(qt.paint_heatmap["heatmap-opacity"])})}};function Dv(a,{width:i,height:l},p,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==i*l*p)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${i*l*p}`)}else g=new Uint8Array(i*l*p);return a.width=i,a.height=l,a.data=g,a}function Bw(a,{width:i,height:l},p){if(i===a.width&&l===a.height)return;const g=Dv({},{width:i,height:l},p);Rv(a,g,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,i),height:Math.min(a.height,l)},p),a.width=i,a.height=l,a.data=g.data}function Rv(a,i,l,p,g,_){if(g.width===0||g.height===0)return i;if(g.width>a.width||g.height>a.height||l.x>a.width-g.width||l.y>a.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>i.width||g.height>i.height||p.x>i.width-g.width||p.y>i.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const x=a.data,E=i.data;if(x===E)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<g.height;T++){const M=((l.y+T)*a.width+l.x)*_,D=((p.y+T)*i.width+p.x)*_;for(let B=0;B<g.width*_;B++)E[D+B]=x[M+B]}return i}class hg{constructor(i,l){Dv(this,i,1,l)}resize(i){Bw(this,i,1)}clone(){return new hg({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,p,g,_){Rv(i,l,p,g,_,1)}}class Va{constructor(i,l){Dv(this,i,4,l)}resize(i){Bw(this,i,4)}replace(i,l){l?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Va({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,p,g,_){Rv(i,l,p,g,_,4)}}function Vw(a){const i={},l=a.resolution||256,p=a.clips?a.clips.length:1,g=a.image||new Va({width:l,height:p});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const _=(x,E,T)=>{i[a.evaluationKey]=T;const M=a.expression.evaluate(i);g.data[x+E+0]=Math.floor(255*M.r/M.a),g.data[x+E+1]=Math.floor(255*M.g/M.a),g.data[x+E+2]=Math.floor(255*M.b/M.a),g.data[x+E+3]=Math.floor(255*M.a)};if(a.clips)for(let x=0,E=0;x<p;++x,E+=4*l)for(let T=0,M=0;T<l;T++,M+=4){const D=T/(l-1),{start:B,end:U}=a.clips[x];_(E,M,B*(1-D)+U*D)}else for(let x=0,E=0;x<l;x++,E+=4)_(0,E,x/(l-1));return g}Pe("AlphaImage",hg),Pe("RGBAImage",Va);class sP extends ya{createBucket(i){return new zw(i)}constructor(i){super(i,oP),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Vw({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Uw;var aP={get paint(){return Uw=Uw||new bi({"hillshade-illumination-direction":new Ze(qt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ze(qt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ze(qt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ze(qt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ze(qt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ze(qt.paint_hillshade["hillshade-accent-color"])})}};class lP extends ya{constructor(i){super(i,aP)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const uP=Zr([{name:"a_pos",components:2,type:"Int16"}],4),{members:cP}=uP;var Ov={exports:{}};function oy(a,i,l){l=l||2;var p,g,_,x,E,T,M,D=i&&i.length,B=D?i[0]*l:a.length,U=$w(a,0,B,l,!0),H=[];if(!U||U.next===U.prev)return H;if(D&&(U=function(it,ht,mt,Tt){var xt,Lt,Vt,ee=[];for(xt=0,Lt=ht.length;xt<Lt;xt++)(Vt=$w(it,ht[xt]*Tt,xt<Lt-1?ht[xt+1]*Tt:it.length,Tt,!1))===Vt.next&&(Vt.steiner=!0),ee.push(_P(Vt));for(ee.sort(gP),xt=0;xt<ee.length;xt++)mt=mP(ee[xt],mt);return mt}(a,i,U,l)),a.length>80*l){p=_=a[0],g=x=a[1];for(var K=l;K<B;K+=l)(E=a[K])<p&&(p=E),(T=a[K+1])<g&&(g=T),E>_&&(_=E),T>x&&(x=T);M=(M=Math.max(_-p,x-g))!==0?32767/M:0}return pg(U,H,l,p,g,M,0),H}function $w(a,i,l,p,g){var _,x;if(g===Bv(a,i,l,p)>0)for(_=i;_<l;_+=p)x=qw(_,a[_],a[_+1],x);else for(_=l-p;_>=i;_-=p)x=qw(_,a[_],a[_+1],x);return x&&sy(x,x.next)&&(dg(x),x=x.next),x}function Dp(a,i){if(!a)return a;i||(i=a);var l,p=a;do if(l=!1,p.steiner||!sy(p,p.next)&&Si(p.prev,p,p.next)!==0)p=p.next;else{if(dg(p),(p=i=p.prev)===p.next)break;l=!0}while(l||p!==i);return i}function pg(a,i,l,p,g,_,x){if(a){!x&&_&&function(D,B,U,H){var K=D;do K.z===0&&(K.z=zv(K.x,K.y,B,U,H)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next;while(K!==D);K.prevZ.nextZ=null,K.prevZ=null,function(it){var ht,mt,Tt,xt,Lt,Vt,ee,ke,Ve=1;do{for(mt=it,it=null,Lt=null,Vt=0;mt;){for(Vt++,Tt=mt,ee=0,ht=0;ht<Ve&&(ee++,Tt=Tt.nextZ);ht++);for(ke=Ve;ee>0||ke>0&&Tt;)ee!==0&&(ke===0||!Tt||mt.z<=Tt.z)?(xt=mt,mt=mt.nextZ,ee--):(xt=Tt,Tt=Tt.nextZ,ke--),Lt?Lt.nextZ=xt:it=xt,xt.prevZ=Lt,Lt=xt;mt=Tt}Lt.nextZ=null,Ve*=2}while(Vt>1)}(K)}(a,p,g,_);for(var E,T,M=a;a.prev!==a.next;)if(E=a.prev,T=a.next,_?pP(a,p,g,_):hP(a))i.push(E.i/l|0),i.push(a.i/l|0),i.push(T.i/l|0),dg(a),a=T.next,M=T.next;else if((a=T)===M){x?x===1?pg(a=fP(Dp(a),i,l),i,l,p,g,_,2):x===2&&dP(a,i,l,p,g,_):pg(Dp(a),i,l,p,g,_,1);break}}}function hP(a){var i=a.prev,l=a,p=a.next;if(Si(i,l,p)>=0)return!1;for(var g=i.x,_=l.x,x=p.x,E=i.y,T=l.y,M=p.y,D=g<_?g<x?g:x:_<x?_:x,B=E<T?E<M?E:M:T<M?T:M,U=g>_?g>x?g:x:_>x?_:x,H=E>T?E>M?E:M:T>M?T:M,K=p.next;K!==i;){if(K.x>=D&&K.x<=U&&K.y>=B&&K.y<=H&&Mf(g,E,_,T,x,M,K.x,K.y)&&Si(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function pP(a,i,l,p){var g=a.prev,_=a,x=a.next;if(Si(g,_,x)>=0)return!1;for(var E=g.x,T=_.x,M=x.x,D=g.y,B=_.y,U=x.y,H=E<T?E<M?E:M:T<M?T:M,K=D<B?D<U?D:U:B<U?B:U,it=E>T?E>M?E:M:T>M?T:M,ht=D>B?D>U?D:U:B>U?B:U,mt=zv(H,K,i,l,p),Tt=zv(it,ht,i,l,p),xt=a.prevZ,Lt=a.nextZ;xt&&xt.z>=mt&&Lt&&Lt.z<=Tt;){if(xt.x>=H&&xt.x<=it&&xt.y>=K&&xt.y<=ht&&xt!==g&&xt!==x&&Mf(E,D,T,B,M,U,xt.x,xt.y)&&Si(xt.prev,xt,xt.next)>=0||(xt=xt.prevZ,Lt.x>=H&&Lt.x<=it&&Lt.y>=K&&Lt.y<=ht&&Lt!==g&&Lt!==x&&Mf(E,D,T,B,M,U,Lt.x,Lt.y)&&Si(Lt.prev,Lt,Lt.next)>=0))return!1;Lt=Lt.nextZ}for(;xt&&xt.z>=mt;){if(xt.x>=H&&xt.x<=it&&xt.y>=K&&xt.y<=ht&&xt!==g&&xt!==x&&Mf(E,D,T,B,M,U,xt.x,xt.y)&&Si(xt.prev,xt,xt.next)>=0)return!1;xt=xt.prevZ}for(;Lt&&Lt.z<=Tt;){if(Lt.x>=H&&Lt.x<=it&&Lt.y>=K&&Lt.y<=ht&&Lt!==g&&Lt!==x&&Mf(E,D,T,B,M,U,Lt.x,Lt.y)&&Si(Lt.prev,Lt,Lt.next)>=0)return!1;Lt=Lt.nextZ}return!0}function fP(a,i,l){var p=a;do{var g=p.prev,_=p.next.next;!sy(g,_)&&Gw(g,p,p.next,_)&&fg(g,_)&&fg(_,g)&&(i.push(g.i/l|0),i.push(p.i/l|0),i.push(_.i/l|0),dg(p),dg(p.next),p=a=_),p=p.next}while(p!==a);return Dp(p)}function dP(a,i,l,p,g,_){var x=a;do{for(var E=x.next.next;E!==x.prev;){if(x.i!==E.i&&vP(x,E)){var T=jw(x,E);return x=Dp(x,x.next),T=Dp(T,T.next),pg(x,i,l,p,g,_,0),void pg(T,i,l,p,g,_,0)}E=E.next}x=x.next}while(x!==a)}function gP(a,i){return a.x-i.x}function mP(a,i){var l=function(g,_){var x,E=_,T=g.x,M=g.y,D=-1/0;do{if(M<=E.y&&M>=E.next.y&&E.next.y!==E.y){var B=E.x+(M-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(B<=T&&B>D&&(D=B,x=E.x<E.next.x?E:E.next,B===T))return x}E=E.next}while(E!==_);if(!x)return null;var U,H=x,K=x.x,it=x.y,ht=1/0;E=x;do T>=E.x&&E.x>=K&&T!==E.x&&Mf(M<it?T:D,M,K,it,M<it?D:T,M,E.x,E.y)&&(U=Math.abs(M-E.y)/(T-E.x),fg(E,g)&&(U<ht||U===ht&&(E.x>x.x||E.x===x.x&&yP(x,E)))&&(x=E,ht=U)),E=E.next;while(E!==H);return x}(a,i);if(!l)return i;var p=jw(l,a);return Dp(p,p.next),Dp(l,l.next)}function yP(a,i){return Si(a.prev,a,i.prev)<0&&Si(i.next,a,a.next)<0}function zv(a,i,l,p,g){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-p)*g|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function _P(a){var i=a,l=a;do(i.x<l.x||i.x===l.x&&i.y<l.y)&&(l=i),i=i.next;while(i!==a);return l}function Mf(a,i,l,p,g,_,x,E){return(g-x)*(i-E)>=(a-x)*(_-E)&&(a-x)*(p-E)>=(l-x)*(i-E)&&(l-x)*(_-E)>=(g-x)*(p-E)}function vP(a,i){return a.next.i!==i.i&&a.prev.i!==i.i&&!function(l,p){var g=l;do{if(g.i!==l.i&&g.next.i!==l.i&&g.i!==p.i&&g.next.i!==p.i&&Gw(g,g.next,l,p))return!0;g=g.next}while(g!==l);return!1}(a,i)&&(fg(a,i)&&fg(i,a)&&function(l,p){var g=l,_=!1,x=(l.x+p.x)/2,E=(l.y+p.y)/2;do g.y>E!=g.next.y>E&&g.next.y!==g.y&&x<(g.next.x-g.x)*(E-g.y)/(g.next.y-g.y)+g.x&&(_=!_),g=g.next;while(g!==l);return _}(a,i)&&(Si(a.prev,a,i.prev)||Si(a,i.prev,i))||sy(a,i)&&Si(a.prev,a,a.next)>0&&Si(i.prev,i,i.next)>0)}function Si(a,i,l){return(i.y-a.y)*(l.x-i.x)-(i.x-a.x)*(l.y-i.y)}function sy(a,i){return a.x===i.x&&a.y===i.y}function Gw(a,i,l,p){var g=ly(Si(a,i,l)),_=ly(Si(a,i,p)),x=ly(Si(l,p,a)),E=ly(Si(l,p,i));return g!==_&&x!==E||!(g!==0||!ay(a,l,i))||!(_!==0||!ay(a,p,i))||!(x!==0||!ay(l,a,p))||!(E!==0||!ay(l,i,p))}function ay(a,i,l){return i.x<=Math.max(a.x,l.x)&&i.x>=Math.min(a.x,l.x)&&i.y<=Math.max(a.y,l.y)&&i.y>=Math.min(a.y,l.y)}function ly(a){return a>0?1:a<0?-1:0}function fg(a,i){return Si(a.prev,a,a.next)<0?Si(a,i,a.next)>=0&&Si(a,a.prev,i)>=0:Si(a,i,a.prev)<0||Si(a,a.next,i)<0}function jw(a,i){var l=new Fv(a.i,a.x,a.y),p=new Fv(i.i,i.x,i.y),g=a.next,_=i.prev;return a.next=i,i.prev=a,l.next=g,g.prev=l,p.next=l,l.prev=p,_.next=p,p.prev=_,p}function qw(a,i,l,p){var g=new Fv(a,i,l);return p?(g.next=p.next,g.prev=p,p.next.prev=g,p.next=g):(g.prev=g,g.next=g),g}function dg(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Fv(a,i,l){this.i=a,this.x=i,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bv(a,i,l,p){for(var g=0,_=i,x=l-p;_<l;_+=p)g+=(a[x]-a[_])*(a[_+1]+a[x+1]),x=_;return g}Ov.exports=oy,Ov.exports.default=oy,oy.deviation=function(a,i,l,p){var g=i&&i.length,_=Math.abs(Bv(a,0,g?i[0]*l:a.length,l));if(g)for(var x=0,E=i.length;x<E;x++)_-=Math.abs(Bv(a,i[x]*l,x<E-1?i[x+1]*l:a.length,l));var T=0;for(x=0;x<p.length;x+=3){var M=p[x]*l,D=p[x+1]*l,B=p[x+2]*l;T+=Math.abs((a[M]-a[B])*(a[D+1]-a[M+1])-(a[M]-a[D])*(a[B+1]-a[M+1]))}return _===0&&T===0?0:Math.abs((T-_)/_)},oy.flatten=function(a){for(var i=a[0][0].length,l={vertices:[],holes:[],dimensions:i},p=0,g=0;g<a.length;g++){for(var _=0;_<a[g].length;_++)for(var x=0;x<i;x++)l.vertices.push(a[g][_][x]);g>0&&l.holes.push(p+=a[g-1].length)}return l};var Zw=S(Ov.exports);function xP(a,i,l,p,g){Xw(a,i,l||0,p||a.length-1,g||wP)}function Xw(a,i,l,p,g){for(;p>l;){if(p-l>600){var _=p-l+1,x=i-l+1,E=Math.log(_),T=.5*Math.exp(2*E/3),M=.5*Math.sqrt(E*T*(_-T)/_)*(x-_/2<0?-1:1);Xw(a,i,Math.max(l,Math.floor(i-x*T/_+M)),Math.min(p,Math.floor(i+(_-x)*T/_+M)),g)}var D=a[i],B=l,U=p;for(gg(a,l,i),g(a[p],D)>0&&gg(a,l,p);B<U;){for(gg(a,B,U),B++,U--;g(a[B],D)<0;)B++;for(;g(a[U],D)>0;)U--}g(a[l],D)===0?gg(a,l,U):gg(a,++U,p),U<=i&&(l=U+1),i<=U&&(p=U-1)}}function gg(a,i,l){var p=a[i];a[i]=a[l],a[l]=p}function wP(a,i){return a<i?-1:a>i?1:0}function Vv(a,i){const l=a.length;if(l<=1)return[a];const p=[];let g,_;for(let x=0;x<l;x++){const E=Ue(a[x]);E!==0&&(a[x].area=Math.abs(E),_===void 0&&(_=E<0),_===E<0?(g&&p.push(g),g=[a[x]]):g.push(a[x]))}if(g&&p.push(g),i>1)for(let x=0;x<p.length;x++)p[x].length<=i||(xP(p[x],i,1,p[x].length-1,bP),p[x]=p[x].slice(0,i));return p}function bP(a,i){return i.area-a.area}function Uv(a,i,l){const p=l.patternDependencies;let g=!1;for(const _ of i){const x=_.paint.get(`${a}-pattern`);x.isConstant()||(g=!0);const E=x.constantOr(null);E&&(g=!0,p[E.to]=!0,p[E.from]=!0)}return g}function $v(a,i,l,p,g){const _=g.patternDependencies;for(const x of i){const E=x.paint.get(`${a}-pattern`).value;if(E.kind!=="constant"){let T=E.evaluate({zoom:p-1},l,{},g.availableImages),M=E.evaluate({zoom:p},l,{},g.availableImages),D=E.evaluate({zoom:p+1},l,{},g.availableImages);T=T&&T.name?T.name:T,M=M&&M.name?M.name:M,D=D&&D.name?D.name:D,_[T]=!0,_[M]=!0,_[D]=!0,l.patterns[x.id]={min:T,mid:M,max:D}}}return l}class Gv{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new kn,this.indexArray=new bo,this.indexArray2=new Wi,this.programConfigurations=new eu(i.layers,i.zoom),this.segments=new Ar,this.segments2=new Ar,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){this.hasPattern=Uv("fill",this.layers,l);const g=this.layers[0].layout.get("fill-sort-key"),_=!g.isConstant(),x=[];for(const{feature:E,id:T,index:M,sourceLayerIndex:D}of i){const B=this.layers[0]._featureFilter.needGeometry,U=Np(E,B);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom),U,p))continue;const H=_?g.evaluate(U,{},p,l.availableImages):void 0,K={id:T,properties:E.properties,type:E.type,sourceLayerIndex:D,index:M,geometry:B?U.geometry:kp(E),patterns:{},sortKey:H};x.push(K)}_&&x.sort((E,T)=>E.sortKey-T.sortKey);for(const E of x){const{geometry:T,index:M,sourceLayerIndex:D}=E;if(this.hasPattern){const B=$v("fill",this.layers,E,this.zoom,l);this.patternFeatures.push(B)}else this.addFeature(E,T,M,p,{});l.featureIndex.insert(i[M].feature,T,M,D,this.index)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}addFeatures(i,l,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,l,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,cP),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,l,p,g,_){for(const x of Vv(l,500)){let E=0;for(const H of x)E+=H.length;const T=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),M=T.vertexLength,D=[],B=[];for(const H of x){if(H.length===0)continue;H!==x[0]&&B.push(D.length/2);const K=this.segments2.prepareSegment(H.length,this.layoutVertexArray,this.indexArray2),it=K.vertexLength;this.layoutVertexArray.emplaceBack(H[0].x,H[0].y),this.indexArray2.emplaceBack(it+H.length-1,it),D.push(H[0].x),D.push(H[0].y);for(let ht=1;ht<H.length;ht++)this.layoutVertexArray.emplaceBack(H[ht].x,H[ht].y),this.indexArray2.emplaceBack(it+ht-1,it+ht),D.push(H[ht].x),D.push(H[ht].y);K.vertexLength+=H.length,K.primitiveLength+=H.length}const U=Zw(D,B);for(let H=0;H<U.length;H+=3)this.indexArray.emplaceBack(M+U[H],M+U[H+1],M+U[H+2]);T.vertexLength+=E,T.primitiveLength+=U.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,_,g)}}let Ww,Hw;Pe("FillBucket",Gv,{omit:["layers","patternFeatures"]});var EP={get paint(){return Hw=Hw||new bi({"fill-antialias":new Ze(qt.paint_fill["fill-antialias"]),"fill-opacity":new nn(qt.paint_fill["fill-opacity"]),"fill-color":new nn(qt.paint_fill["fill-color"]),"fill-outline-color":new nn(qt.paint_fill["fill-outline-color"]),"fill-translate":new Ze(qt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ze(qt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Mp(qt.paint_fill["fill-pattern"])})},get layout(){return Ww=Ww||new bi({"fill-sort-key":new nn(qt.layout_fill["fill-sort-key"])})}};class SP extends ya{constructor(i){super(i,EP)}recalculate(i,l){super.recalculate(i,l);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Gv(i)}queryRadius(){return ny(this.paint.get("fill-translate"))}queryIntersectsFeature(i,l,p,g,_,x,E){return Lw(ry(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,E),g)}isTileClipped(){return!0}}const IP=Zr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),CP=Zr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:TP}=IP;var Ch={},PP=A,Yw=Lf;function Lf(a,i,l,p,g){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=p,this._values=g,a.readFields(MP,this,i)}function MP(a,i,l){a==1?i.id=l.readVarint():a==2?function(p,g){for(var _=p.readVarint()+p.pos;p.pos<_;){var x=g._keys[p.readVarint()],E=g._values[p.readVarint()];g.properties[x]=E}}(l,i):a==3?i.type=l.readVarint():a==4&&(i._geometry=l.pos)}function LP(a){for(var i,l,p=0,g=0,_=a.length,x=_-1;g<_;x=g++)p+=((l=a[x]).x-(i=a[g]).x)*(i.y+l.y);return p}Lf.types=["Unknown","Point","LineString","Polygon"],Lf.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var i,l=a.readVarint()+a.pos,p=1,g=0,_=0,x=0,E=[];a.pos<l;){if(g<=0){var T=a.readVarint();p=7&T,g=T>>3}if(g--,p===1||p===2)_+=a.readSVarint(),x+=a.readSVarint(),p===1&&(i&&E.push(i),i=[]),i.push(new PP(_,x));else{if(p!==7)throw new Error("unknown command "+p);i&&i.push(i[0].clone())}}return i&&E.push(i),E},Lf.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var i=a.readVarint()+a.pos,l=1,p=0,g=0,_=0,x=1/0,E=-1/0,T=1/0,M=-1/0;a.pos<i;){if(p<=0){var D=a.readVarint();l=7&D,p=D>>3}if(p--,l===1||l===2)(g+=a.readSVarint())<x&&(x=g),g>E&&(E=g),(_+=a.readSVarint())<T&&(T=_),_>M&&(M=_);else if(l!==7)throw new Error("unknown command "+l)}return[x,T,E,M]},Lf.prototype.toGeoJSON=function(a,i,l){var p,g,_=this.extent*Math.pow(2,l),x=this.extent*a,E=this.extent*i,T=this.loadGeometry(),M=Lf.types[this.type];function D(H){for(var K=0;K<H.length;K++){var it=H[K];H[K]=[360*(it.x+x)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(it.y+E)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(p=0;p<T.length;p++)B[p]=T[p][0];D(T=B);break;case 2:for(p=0;p<T.length;p++)D(T[p]);break;case 3:for(T=function(H){var K=H.length;if(K<=1)return[H];for(var it,ht,mt=[],Tt=0;Tt<K;Tt++){var xt=LP(H[Tt]);xt!==0&&(ht===void 0&&(ht=xt<0),ht===xt<0?(it&&mt.push(it),it=[H[Tt]]):it.push(H[Tt]))}return it&&mt.push(it),mt}(T),p=0;p<T.length;p++)for(g=0;g<T[p].length;g++)D(T[p][g])}T.length===1?T=T[0]:M="Multi"+M;var U={type:"Feature",geometry:{type:M,coordinates:T},properties:this.properties};return"id"in this&&(U.id=this.id),U};var AP=Yw,Kw=Jw;function Jw(a,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(kP,this,i),this.length=this._features.length}function kP(a,i,l){a===15?i.version=l.readVarint():a===1?i.name=l.readString():a===5?i.extent=l.readVarint():a===2?i._features.push(l.pos):a===3?i._keys.push(l.readString()):a===4&&i._values.push(function(p){for(var g=null,_=p.readVarint()+p.pos;p.pos<_;){var x=p.readVarint()>>3;g=x===1?p.readString():x===2?p.readFloat():x===3?p.readDouble():x===4?p.readVarint64():x===5?p.readVarint():x===6?p.readSVarint():x===7?p.readBoolean():null}return g}(l))}Jw.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var i=this._pbf.readVarint()+this._pbf.pos;return new AP(this._pbf,i,this.extent,this._keys,this._values)};var NP=Kw;function DP(a,i,l){if(a===3){var p=new NP(l,l.readVarint()+l.pos);p.length&&(i[p.name]=p)}}Ch.VectorTile=function(a,i){this.layers=a.readFields(DP,{},i)},Ch.VectorTileFeature=Yw,Ch.VectorTileLayer=Kw;const RP=Ch.VectorTileFeature.types,jv=Math.pow(2,13);function mg(a,i,l,p,g,_,x,E){a.emplaceBack(i,l,2*Math.floor(p*jv)+x,g*jv*2,_*jv*2,Math.round(E))}class qv{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Ie,this.centroidVertexArray=new ge,this.indexArray=new bo,this.programConfigurations=new eu(i.layers,i.zoom),this.segments=new Ar,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){this.features=[],this.hasPattern=Uv("fill-extrusion",this.layers,l);for(const{feature:g,id:_,index:x,sourceLayerIndex:E}of i){const T=this.layers[0]._featureFilter.needGeometry,M=Np(g,T);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom),M,p))continue;const D={id:_,sourceLayerIndex:E,index:x,geometry:T?M.geometry:kp(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push($v("fill-extrusion",this.layers,D,this.zoom,l)):this.addFeature(D,D.geometry,x,p,{}),l.featureIndex.insert(g,D.geometry,x,E,this.index,!0)}}addFeatures(i,l,p){for(const g of this.features){const{geometry:_}=g;this.addFeature(g,_,g.index,l,p)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,TP),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,CP.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,l,p,g,_){const x={x:0,y:0,vertexCount:0};for(const E of Vv(l,500)){let T=0;for(const K of E)T+=K.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const K of E){if(K.length===0||zP(K))continue;let it=0;for(let ht=0;ht<K.length;ht++){const mt=K[ht];if(ht>=1){const Tt=K[ht-1];if(!OP(mt,Tt)){M.vertexLength+4>Ar.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const xt=mt.sub(Tt)._perp()._unit(),Lt=Tt.dist(mt);it+Lt>32768&&(it=0),mg(this.layoutVertexArray,mt.x,mt.y,xt.x,xt.y,0,0,it),mg(this.layoutVertexArray,mt.x,mt.y,xt.x,xt.y,0,1,it),x.x+=2*mt.x,x.y+=2*mt.y,x.vertexCount+=2,it+=Lt,mg(this.layoutVertexArray,Tt.x,Tt.y,xt.x,xt.y,0,0,it),mg(this.layoutVertexArray,Tt.x,Tt.y,xt.x,xt.y,0,1,it),x.x+=2*Tt.x,x.y+=2*Tt.y,x.vertexCount+=2;const Vt=M.vertexLength;this.indexArray.emplaceBack(Vt,Vt+2,Vt+1),this.indexArray.emplaceBack(Vt+1,Vt+2,Vt+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+T>Ar.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),RP[i.type]!=="Polygon")continue;const D=[],B=[],U=M.vertexLength;for(const K of E)if(K.length!==0){K!==E[0]&&B.push(D.length/2);for(let it=0;it<K.length;it++){const ht=K[it];mg(this.layoutVertexArray,ht.x,ht.y,0,0,1,1,0),x.x+=ht.x,x.y+=ht.y,x.vertexCount+=1,D.push(ht.x),D.push(ht.y)}}const H=Zw(D,B);for(let K=0;K<H.length;K+=3)this.indexArray.emplaceBack(U+H[K],U+H[K+2],U+H[K+1]);M.primitiveLength+=H.length/3,M.vertexLength+=T}for(let E=0;E<x.vertexCount;E++)this.centroidVertexArray.emplaceBack(Math.floor(x.x/x.vertexCount),Math.floor(x.y/x.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,_,g)}}function OP(a,i){return a.x===i.x&&(a.x<0||a.x>Fi)||a.y===i.y&&(a.y<0||a.y>Fi)}function zP(a){return a.every(i=>i.x<0)||a.every(i=>i.x>Fi)||a.every(i=>i.y<0)||a.every(i=>i.y>Fi)}let Qw;Pe("FillExtrusionBucket",qv,{omit:["layers","features"]});var FP={get paint(){return Qw=Qw||new bi({"fill-extrusion-opacity":new Ze(qt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new nn(qt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ze(qt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ze(qt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Mp(qt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new nn(qt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new nn(qt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ze(qt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class BP extends ya{constructor(i){super(i,FP)}createBucket(i){return new qv(i)}queryRadius(){return ny(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,l,p,g,_,x,E,T){const M=ry(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,E),D=this.paint.get("fill-extrusion-height").evaluate(l,p),B=this.paint.get("fill-extrusion-base").evaluate(l,p),U=function(K,it,ht,mt){const Tt=[];for(const xt of K){const Lt=[xt.x,xt.y,0,1];iy(Lt,Lt,it),Tt.push(new O(Lt[0]/Lt[3],Lt[1]/Lt[3]))}return Tt}(M,T),H=function(K,it,ht,mt){const Tt=[],xt=[],Lt=mt[8]*it,Vt=mt[9]*it,ee=mt[10]*it,ke=mt[11]*it,Ve=mt[8]*ht,Ae=mt[9]*ht,Ce=mt[10]*ht,_e=mt[11]*ht;for(const Re of K){const we=[],le=[];for(const Je of Re){const je=Je.x,Cn=Je.y,kr=mt[0]*je+mt[4]*Cn+mt[12],Vr=mt[1]*je+mt[5]*Cn+mt[13],Ki=mt[2]*je+mt[6]*Cn+mt[14],va=mt[3]*je+mt[7]*Cn+mt[15],bs=Ki+ee,Bi=va+ke,So=kr+Ve,Uo=Vr+Ae,Es=Ki+Ce,Ss=va+_e,Ji=new O((kr+Lt)/Bi,(Vr+Vt)/Bi);Ji.z=bs/Bi,we.push(Ji);const Qi=new O(So/Ss,Uo/Ss);Qi.z=Es/Ss,le.push(Qi)}Tt.push(we),xt.push(le)}return[Tt,xt]}(g,B,D,T);return function(K,it,ht){let mt=1/0;Lw(ht,it)&&(mt=tb(ht,it[0]));for(let Tt=0;Tt<it.length;Tt++){const xt=it[Tt],Lt=K[Tt];for(let Vt=0;Vt<xt.length-1;Vt++){const ee=xt[Vt],ke=[ee,xt[Vt+1],Lt[Vt+1],Lt[Vt],ee];Mw(ht,ke)&&(mt=Math.min(mt,tb(ht,ke)))}}return mt!==1/0&&mt}(H[0],H[1],U)}}function yg(a,i){return a.x*i.x+a.y*i.y}function tb(a,i){if(a.length===1){let l=0;const p=i[l++];let g;for(;!g||p.equals(g);)if(g=i[l++],!g)return 1/0;for(;l<i.length;l++){const _=i[l],x=a[0],E=g.sub(p),T=_.sub(p),M=x.sub(p),D=yg(E,E),B=yg(E,T),U=yg(T,T),H=yg(M,E),K=yg(M,T),it=D*U-B*B,ht=(U*H-B*K)/it,mt=(D*K-B*H)/it,Tt=p.z*(1-ht-mt)+g.z*ht+_.z*mt;if(isFinite(Tt))return Tt}return 1/0}{let l=1/0;for(const p of i)l=Math.min(l,p.z);return l}}const VP=Zr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:UP}=VP,$P=Zr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:GP}=$P,jP=Ch.VectorTileFeature.types,qP=Math.cos(Math.PI/180*37.5),eb=Math.pow(2,14)/.5;class Zv{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new rn,this.layoutVertexArray2=new Ge,this.indexArray=new bo,this.programConfigurations=new eu(i.layers,i.zoom),this.segments=new Ar,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){this.hasPattern=Uv("line",this.layers,l);const g=this.layers[0].layout.get("line-sort-key"),_=!g.isConstant(),x=[];for(const{feature:E,id:T,index:M,sourceLayerIndex:D}of i){const B=this.layers[0]._featureFilter.needGeometry,U=Np(E,B);if(!this.layers[0]._featureFilter.filter(new Lr(this.zoom),U,p))continue;const H=_?g.evaluate(U,{},p):void 0,K={id:T,properties:E.properties,type:E.type,sourceLayerIndex:D,index:M,geometry:B?U.geometry:kp(E),patterns:{},sortKey:H};x.push(K)}_&&x.sort((E,T)=>E.sortKey-T.sortKey);for(const E of x){const{geometry:T,index:M,sourceLayerIndex:D}=E;if(this.hasPattern){const B=$v("line",this.layers,E,this.zoom,l);this.patternFeatures.push(B)}else this.addFeature(E,T,M,p,{});l.featureIndex.insert(i[M].feature,T,M,D,this.index)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}addFeatures(i,l,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,l,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,GP)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,UP),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,l,p,g,_){const x=this.layers[0].layout,E=x.get("line-join").evaluate(i,{}),T=x.get("line-cap"),M=x.get("line-miter-limit"),D=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const B of l)this.addLine(B,i,E,T,M,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,_,g)}addLine(i,l,p,g,_,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let mt=0;mt<i.length-1;mt++)this.totalDistance+=i[mt].dist(i[mt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=jP[l.type]==="Polygon";let T=i.length;for(;T>=2&&i[T-1].equals(i[T-2]);)T--;let M=0;for(;M<T-1&&i[M].equals(i[M+1]);)M++;if(T<(E?3:2))return;p==="bevel"&&(_=1.05);const D=this.overscaling<=16?15*Fi/(512*this.overscaling):0,B=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let U,H,K,it,ht;this.e1=this.e2=-1,E&&(U=i[T-2],ht=i[M].sub(U)._unit()._perp());for(let mt=M;mt<T;mt++){if(K=mt===T-1?E?i[M+1]:void 0:i[mt+1],K&&i[mt].equals(K))continue;ht&&(it=ht),U&&(H=U),U=i[mt],ht=K?K.sub(U)._unit()._perp():it,it=it||ht;let Tt=it.add(ht);Tt.x===0&&Tt.y===0||Tt._unit();const xt=it.x*ht.x+it.y*ht.y,Lt=Tt.x*ht.x+Tt.y*ht.y,Vt=Lt!==0?1/Lt:1/0,ee=2*Math.sqrt(2-2*Lt),ke=Lt<qP&&H&&K,Ve=it.x*ht.y-it.y*ht.x>0;if(ke&&mt>M){const _e=U.dist(H);if(_e>2*D){const Re=U.sub(U.sub(H)._mult(D/_e)._round());this.updateDistance(H,Re),this.addCurrentVertex(Re,it,0,0,B),H=Re}}const Ae=H&&K;let Ce=Ae?p:E?"butt":g;if(Ae&&Ce==="round"&&(Vt<x?Ce="miter":Vt<=2&&(Ce="fakeround")),Ce==="miter"&&Vt>_&&(Ce="bevel"),Ce==="bevel"&&(Vt>2&&(Ce="flipbevel"),Vt<_&&(Ce="miter")),H&&this.updateDistance(H,U),Ce==="miter")Tt._mult(Vt),this.addCurrentVertex(U,Tt,0,0,B);else if(Ce==="flipbevel"){if(Vt>100)Tt=ht.mult(-1);else{const _e=Vt*it.add(ht).mag()/it.sub(ht).mag();Tt._perp()._mult(_e*(Ve?-1:1))}this.addCurrentVertex(U,Tt,0,0,B),this.addCurrentVertex(U,Tt.mult(-1),0,0,B)}else if(Ce==="bevel"||Ce==="fakeround"){const _e=-Math.sqrt(Vt*Vt-1),Re=Ve?_e:0,we=Ve?0:_e;if(H&&this.addCurrentVertex(U,it,Re,we,B),Ce==="fakeround"){const le=Math.round(180*ee/Math.PI/20);for(let Je=1;Je<le;Je++){let je=Je/le;if(je!==.5){const kr=je-.5;je+=je*kr*(je-1)*((1.0904+xt*(xt*(3.55645-1.43519*xt)-3.2452))*kr*kr+(.848013+xt*(.215638*xt-1.06021)))}const Cn=ht.sub(it)._mult(je)._add(it)._unit()._mult(Ve?-1:1);this.addHalfVertex(U,Cn.x,Cn.y,!1,Ve,0,B)}}K&&this.addCurrentVertex(U,ht,-Re,-we,B)}else if(Ce==="butt")this.addCurrentVertex(U,Tt,0,0,B);else if(Ce==="square"){const _e=H?1:-1;this.addCurrentVertex(U,Tt,_e,_e,B)}else Ce==="round"&&(H&&(this.addCurrentVertex(U,it,0,0,B),this.addCurrentVertex(U,it,1,1,B,!0)),K&&(this.addCurrentVertex(U,ht,-1,-1,B,!0),this.addCurrentVertex(U,ht,0,0,B)));if(ke&&mt<T-1){const _e=U.dist(K);if(_e>2*D){const Re=U.add(K.sub(U)._mult(D/_e)._round());this.updateDistance(U,Re),this.addCurrentVertex(Re,ht,0,0,B),U=Re}}}}addCurrentVertex(i,l,p,g,_,x=!1){const E=l.y*g-l.x,T=-l.y-l.x*g;this.addHalfVertex(i,l.x+l.y*p,l.y-l.x*p,x,!1,p,_),this.addHalfVertex(i,E,T,x,!0,-g,_),this.distance>eb/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,l,p,g,_,x))}addHalfVertex({x:i,y:l},p,g,_,x,E,T){const M=.5*(this.lineClips?this.scaledDistance*(eb-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(_?1:0),(l<<1)+(x?1:0),Math.round(63*p)+128,Math.round(63*g)+128,1+(E===0?0:E<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),T.primitiveLength++),x?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,l){this.distance+=i.dist(l),this.updateScaledDistance()}}let nb,rb;Pe("LineBucket",Zv,{omit:["layers","patternFeatures"]});var ib={get paint(){return rb=rb||new bi({"line-opacity":new nn(qt.paint_line["line-opacity"]),"line-color":new nn(qt.paint_line["line-color"]),"line-translate":new Ze(qt.paint_line["line-translate"]),"line-translate-anchor":new Ze(qt.paint_line["line-translate-anchor"]),"line-width":new nn(qt.paint_line["line-width"]),"line-gap-width":new nn(qt.paint_line["line-gap-width"]),"line-offset":new nn(qt.paint_line["line-offset"]),"line-blur":new nn(qt.paint_line["line-blur"]),"line-dasharray":new tg(qt.paint_line["line-dasharray"]),"line-pattern":new Mp(qt.paint_line["line-pattern"]),"line-gradient":new eg(qt.paint_line["line-gradient"])})},get layout(){return nb=nb||new bi({"line-cap":new Ze(qt.layout_line["line-cap"]),"line-join":new nn(qt.layout_line["line-join"]),"line-miter-limit":new Ze(qt.layout_line["line-miter-limit"]),"line-round-limit":new Ze(qt.layout_line["line-round-limit"]),"line-sort-key":new nn(qt.layout_line["line-sort-key"])})}};class ZP extends nn{possiblyEvaluate(i,l){return l=new Lr(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(i,l)}evaluate(i,l,p,g){return l=At({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(i,l,p,g)}}let uy;class XP extends ya{constructor(i){super(i,ib),this.gradientVersion=0,uy||(uy=new ZP(ib.paint.properties["line-width"].specification),uy.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const l=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(l)&&l._styleExpression.expression instanceof Ra,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,l){super.recalculate(i,l),this.paint._values["line-floorwidth"]=uy.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Zv(i)}queryRadius(i){const l=i,p=ob(ug("line-width",this,l),ug("line-gap-width",this,l)),g=ug("line-offset",this,l);return p/2+Math.abs(g)+ny(this.paint.get("line-translate"))}queryIntersectsFeature(i,l,p,g,_,x,E){const T=ry(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,E),M=E/2*ob(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),D=this.paint.get("line-offset").evaluate(l,p);return D&&(g=function(B,U){const H=[];for(let K=0;K<B.length;K++){const it=B[K],ht=[];for(let mt=0;mt<it.length;mt++){const Tt=it[mt-1],xt=it[mt],Lt=it[mt+1],Vt=mt===0?new O(0,0):xt.sub(Tt)._unit()._perp(),ee=mt===it.length-1?new O(0,0):Lt.sub(xt)._unit()._perp(),ke=Vt._add(ee)._unit(),Ve=ke.x*ee.x+ke.y*ee.y;Ve!==0&&ke._mult(1/Ve),ht.push(ke._mult(U)._add(xt))}H.push(ht)}return H}(g,D*E)),function(B,U,H){for(let K=0;K<U.length;K++){const it=U[K];if(B.length>=3){for(let ht=0;ht<it.length;ht++)if(Tf(B,it[ht]))return!0}if(Q2(B,it,H))return!0}return!1}(T,g,M)}isTileClipped(){return!0}}function ob(a,i){return i>0?i+2*a:a}const WP=Zr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),HP=Zr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Zr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const YP=Zr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Zr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const sb=Zr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),KP=Zr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function JP(a,i,l){return a.sections.forEach(p=>{p.text=function(g,_,x){const E=_.layout.get("text-transform").evaluate(x,{});return E==="uppercase"?g=g.toLocaleUpperCase():E==="lowercase"&&(g=g.toLocaleLowerCase()),$s.applyArabicShaping&&(g=$s.applyArabicShaping(g)),g}(p.text,i,l)}),a}Zr([{name:"triangle",components:3,type:"Uint16"}]),Zr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Zr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Zr([{type:"Float32",name:"offsetX"}]),Zr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Zr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const _g={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Yi=24,ab=mr,lb=function(a,i,l,p,g){var _,x,E=8*g-p-1,T=(1<<E)-1,M=T>>1,D=-7,B=l?g-1:0,U=l?-1:1,H=a[i+B];for(B+=U,_=H&(1<<-D)-1,H>>=-D,D+=E;D>0;_=256*_+a[i+B],B+=U,D-=8);for(x=_&(1<<-D)-1,_>>=-D,D+=p;D>0;x=256*x+a[i+B],B+=U,D-=8);if(_===0)_=1-M;else{if(_===T)return x?NaN:1/0*(H?-1:1);x+=Math.pow(2,p),_-=M}return(H?-1:1)*x*Math.pow(2,_-p)},ub=function(a,i,l,p,g,_){var x,E,T,M=8*_-g-1,D=(1<<M)-1,B=D>>1,U=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=p?0:_-1,K=p?1:-1,it=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(E=isNaN(i)?1:0,x=D):(x=Math.floor(Math.log(i)/Math.LN2),i*(T=Math.pow(2,-x))<1&&(x--,T*=2),(i+=x+B>=1?U/T:U*Math.pow(2,1-B))*T>=2&&(x++,T/=2),x+B>=D?(E=0,x=D):x+B>=1?(E=(i*T-1)*Math.pow(2,g),x+=B):(E=i*Math.pow(2,B-1)*Math.pow(2,g),x=0));g>=8;a[l+H]=255&E,H+=K,E/=256,g-=8);for(x=x<<g|E,M+=g;M>0;a[l+H]=255&x,H+=K,x/=256,M-=8);a[l+H-K]|=128*it};function mr(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}mr.Varint=0,mr.Fixed64=1,mr.Bytes=2,mr.Fixed32=5;var Xv=4294967296,cb=1/Xv,hb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Cc(a){return a.type===mr.Bytes?a.readVarint()+a.pos:a.pos+1}function Af(a,i,l){return l?4294967296*i+(a>>>0):4294967296*(i>>>0)+(a>>>0)}function pb(a,i,l){var p=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));l.realloc(p);for(var g=l.pos-1;g>=a;g--)l.buf[g+p]=l.buf[g]}function QP(a,i){for(var l=0;l<a.length;l++)i.writeVarint(a[l])}function tM(a,i){for(var l=0;l<a.length;l++)i.writeSVarint(a[l])}function eM(a,i){for(var l=0;l<a.length;l++)i.writeFloat(a[l])}function nM(a,i){for(var l=0;l<a.length;l++)i.writeDouble(a[l])}function rM(a,i){for(var l=0;l<a.length;l++)i.writeBoolean(a[l])}function iM(a,i){for(var l=0;l<a.length;l++)i.writeFixed32(a[l])}function oM(a,i){for(var l=0;l<a.length;l++)i.writeSFixed32(a[l])}function sM(a,i){for(var l=0;l<a.length;l++)i.writeFixed64(a[l])}function aM(a,i){for(var l=0;l<a.length;l++)i.writeSFixed64(a[l])}function cy(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+16777216*a[i+3]}function kf(a,i,l){a[l]=i,a[l+1]=i>>>8,a[l+2]=i>>>16,a[l+3]=i>>>24}function fb(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+(a[i+3]<<24)}mr.prototype={destroy:function(){this.buf=null},readFields:function(a,i,l){for(l=l||this.length;this.pos<l;){var p=this.readVarint(),g=p>>3,_=this.pos;this.type=7&p,a(g,i,this),this.pos===_&&this.skip(p)}return i},readMessage:function(a,i){return this.readFields(a,i,this.readVarint()+this.pos)},readFixed32:function(){var a=cy(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=fb(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=cy(this.buf,this.pos)+cy(this.buf,this.pos+4)*Xv;return this.pos+=8,a},readSFixed64:function(){var a=cy(this.buf,this.pos)+fb(this.buf,this.pos+4)*Xv;return this.pos+=8,a},readFloat:function(){var a=lb(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=lb(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var i,l,p=this.buf;return i=127&(l=p[this.pos++]),l<128?i:(i|=(127&(l=p[this.pos++]))<<7,l<128?i:(i|=(127&(l=p[this.pos++]))<<14,l<128?i:(i|=(127&(l=p[this.pos++]))<<21,l<128?i:function(g,_,x){var E,T,M=x.buf;if(E=(112&(T=M[x.pos++]))>>4,T<128||(E|=(127&(T=M[x.pos++]))<<3,T<128)||(E|=(127&(T=M[x.pos++]))<<10,T<128)||(E|=(127&(T=M[x.pos++]))<<17,T<128)||(E|=(127&(T=M[x.pos++]))<<24,T<128)||(E|=(1&(T=M[x.pos++]))<<31,T<128))return Af(g,E,_);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(l=p[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,i=this.pos;return this.pos=a,a-i>=12&&hb?function(l,p,g){return hb.decode(l.subarray(p,g))}(this.buf,i,a):function(l,p,g){for(var _="",x=p;x<g;){var E,T,M,D=l[x],B=null,U=D>239?4:D>223?3:D>191?2:1;if(x+U>g)break;U===1?D<128&&(B=D):U===2?(192&(E=l[x+1]))==128&&(B=(31&D)<<6|63&E)<=127&&(B=null):U===3?(T=l[x+2],(192&(E=l[x+1]))==128&&(192&T)==128&&((B=(15&D)<<12|(63&E)<<6|63&T)<=2047||B>=55296&&B<=57343)&&(B=null)):U===4&&(T=l[x+2],M=l[x+3],(192&(E=l[x+1]))==128&&(192&T)==128&&(192&M)==128&&((B=(15&D)<<18|(63&E)<<12|(63&T)<<6|63&M)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,U=1):B>65535&&(B-=65536,_+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),_+=String.fromCharCode(B),x+=U}return _}(this.buf,i,a)},readBytes:function(){var a=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,a);return this.pos=a,i},readPackedVarint:function(a,i){if(this.type!==mr.Bytes)return a.push(this.readVarint(i));var l=Cc(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(i));return a},readPackedSVarint:function(a){if(this.type!==mr.Bytes)return a.push(this.readSVarint());var i=Cc(this);for(a=a||[];this.pos<i;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==mr.Bytes)return a.push(this.readBoolean());var i=Cc(this);for(a=a||[];this.pos<i;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==mr.Bytes)return a.push(this.readFloat());var i=Cc(this);for(a=a||[];this.pos<i;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==mr.Bytes)return a.push(this.readDouble());var i=Cc(this);for(a=a||[];this.pos<i;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==mr.Bytes)return a.push(this.readFixed32());var i=Cc(this);for(a=a||[];this.pos<i;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==mr.Bytes)return a.push(this.readSFixed32());var i=Cc(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==mr.Bytes)return a.push(this.readFixed64());var i=Cc(this);for(a=a||[];this.pos<i;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==mr.Bytes)return a.push(this.readSFixed64());var i=Cc(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed64());return a},skip:function(a){var i=7&a;if(i===mr.Varint)for(;this.buf[this.pos++]>127;);else if(i===mr.Bytes)this.pos=this.readVarint()+this.pos;else if(i===mr.Fixed32)this.pos+=4;else{if(i!==mr.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(a,i){this.writeVarint(a<<3|i)},realloc:function(a){for(var i=this.length||16;i<this.pos+a;)i*=2;if(i!==this.length){var l=new Uint8Array(i);l.set(this.buf),this.buf=l,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),kf(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),kf(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),kf(this.buf,-1&a,this.pos),kf(this.buf,Math.floor(a*cb),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),kf(this.buf,-1&a,this.pos),kf(this.buf,Math.floor(a*cb),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(i,l){var p,g;if(i>=0?(p=i%4294967296|0,g=i/4294967296|0):(g=~(-i/4294967296),4294967295^(p=~(-i%4294967296))?p=p+1|0:(p=0,g=g+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(_,x,E){E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,E.buf[E.pos]=127&(_>>>=7)}(p,0,l),function(_,x){var E=(7&_)<<4;x.buf[x.pos++]|=E|((_>>>=3)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_)))))}(g,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var i=this.pos;this.pos=function(p,g,_){for(var x,E,T=0;T<g.length;T++){if((x=g.charCodeAt(T))>55295&&x<57344){if(!E){x>56319||T+1===g.length?(p[_++]=239,p[_++]=191,p[_++]=189):E=x;continue}if(x<56320){p[_++]=239,p[_++]=191,p[_++]=189,E=x;continue}x=E-55296<<10|x-56320|65536,E=null}else E&&(p[_++]=239,p[_++]=191,p[_++]=189,E=null);x<128?p[_++]=x:(x<2048?p[_++]=x>>6|192:(x<65536?p[_++]=x>>12|224:(p[_++]=x>>18|240,p[_++]=x>>12&63|128),p[_++]=x>>6&63|128),p[_++]=63&x|128)}return _}(this.buf,a,this.pos);var l=this.pos-i;l>=128&&pb(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),ub(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),ub(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var i=a.length;this.writeVarint(i),this.realloc(i);for(var l=0;l<i;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,i){this.pos++;var l=this.pos;a(i,this);var p=this.pos-l;p>=128&&pb(l,p,this),this.pos=l-1,this.writeVarint(p),this.pos+=p},writeMessage:function(a,i,l){this.writeTag(a,mr.Bytes),this.writeRawMessage(i,l)},writePackedVarint:function(a,i){i.length&&this.writeMessage(a,QP,i)},writePackedSVarint:function(a,i){i.length&&this.writeMessage(a,tM,i)},writePackedBoolean:function(a,i){i.length&&this.writeMessage(a,rM,i)},writePackedFloat:function(a,i){i.length&&this.writeMessage(a,eM,i)},writePackedDouble:function(a,i){i.length&&this.writeMessage(a,nM,i)},writePackedFixed32:function(a,i){i.length&&this.writeMessage(a,iM,i)},writePackedSFixed32:function(a,i){i.length&&this.writeMessage(a,oM,i)},writePackedFixed64:function(a,i){i.length&&this.writeMessage(a,sM,i)},writePackedSFixed64:function(a,i){i.length&&this.writeMessage(a,aM,i)},writeBytesField:function(a,i){this.writeTag(a,mr.Bytes),this.writeBytes(i)},writeFixed32Field:function(a,i){this.writeTag(a,mr.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(a,i){this.writeTag(a,mr.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(a,i){this.writeTag(a,mr.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(a,i){this.writeTag(a,mr.Fixed64),this.writeSFixed64(i)},writeVarintField:function(a,i){this.writeTag(a,mr.Varint),this.writeVarint(i)},writeSVarintField:function(a,i){this.writeTag(a,mr.Varint),this.writeSVarint(i)},writeStringField:function(a,i){this.writeTag(a,mr.Bytes),this.writeString(i)},writeFloatField:function(a,i){this.writeTag(a,mr.Fixed32),this.writeFloat(i)},writeDoubleField:function(a,i){this.writeTag(a,mr.Fixed64),this.writeDouble(i)},writeBooleanField:function(a,i){this.writeVarintField(a,!!i)}};var Wv=S(ab);const Hv=3;function lM(a,i,l){a===1&&l.readMessage(uM,i)}function uM(a,i,l){if(a===3){const{id:p,bitmap:g,width:_,height:x,left:E,top:T,advance:M}=l.readMessage(cM,{});i.push({id:p,bitmap:new hg({width:_+2*Hv,height:x+2*Hv},g),metrics:{width:_,height:x,left:E,top:T,advance:M}})}}function cM(a,i,l){a===1?i.id=l.readVarint():a===2?i.bitmap=l.readBytes():a===3?i.width=l.readVarint():a===4?i.height=l.readVarint():a===5?i.left=l.readSVarint():a===6?i.top=l.readSVarint():a===7&&(i.advance=l.readVarint())}const db=Hv;function gb(a){let i=0,l=0;for(const x of a)i+=x.w*x.h,l=Math.max(l,x.w);a.sort((x,E)=>E.h-x.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),l),h:1/0}];let g=0,_=0;for(const x of a)for(let E=p.length-1;E>=0;E--){const T=p[E];if(!(x.w>T.w||x.h>T.h)){if(x.x=T.x,x.y=T.y,_=Math.max(_,x.y+x.h),g=Math.max(g,x.x+x.w),x.w===T.w&&x.h===T.h){const M=p.pop();E<p.length&&(p[E]=M)}else x.h===T.h?(T.x+=x.w,T.w-=x.w):x.w===T.w?(T.y+=x.h,T.h-=x.h):(p.push({x:T.x+x.w,y:T.y,w:T.w-x.w,h:x.h}),T.y+=x.h,T.h-=x.h);break}}return{w:g,h:_,fill:i/(g*_)||0}}const js=1;class Yv{constructor(i,{pixelRatio:l,version:p,stretchX:g,stretchY:_,content:x}){this.paddedRect=i,this.pixelRatio=l,this.stretchX=g,this.stretchY=_,this.content=x,this.version=p}get tl(){return[this.paddedRect.x+js,this.paddedRect.y+js]}get br(){return[this.paddedRect.x+this.paddedRect.w-js,this.paddedRect.y+this.paddedRect.h-js]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*js)/this.pixelRatio,(this.paddedRect.h-2*js)/this.pixelRatio]}}class mb{constructor(i,l){const p={},g={};this.haveRenderCallbacks=[];const _=[];this.addImages(i,p,_),this.addImages(l,g,_);const{w:x,h:E}=gb(_),T=new Va({width:x||1,height:E||1});for(const M in i){const D=i[M],B=p[M].paddedRect;Va.copy(D.data,T,{x:0,y:0},{x:B.x+js,y:B.y+js},D.data)}for(const M in l){const D=l[M],B=g[M].paddedRect,U=B.x+js,H=B.y+js,K=D.data.width,it=D.data.height;Va.copy(D.data,T,{x:0,y:0},{x:U,y:H},D.data),Va.copy(D.data,T,{x:0,y:it-1},{x:U,y:H-1},{width:K,height:1}),Va.copy(D.data,T,{x:0,y:0},{x:U,y:H+it},{width:K,height:1}),Va.copy(D.data,T,{x:K-1,y:0},{x:U-1,y:H},{width:1,height:it}),Va.copy(D.data,T,{x:0,y:0},{x:U+K,y:H},{width:1,height:it})}this.image=T,this.iconPositions=p,this.patternPositions=g}addImages(i,l,p){for(const g in i){const _=i[g],x={x:0,y:0,w:_.data.width+2*js,h:_.data.height+2*js};p.push(x),l[g]=new Yv(x,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(i,l){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in i.updatedImages)this.patchUpdatedImage(this.iconPositions[p],i.getImage(p),l),this.patchUpdatedImage(this.patternPositions[p],i.getImage(p),l)}patchUpdatedImage(i,l,p){if(!i||!l||i.version===l.version)return;i.version=l.version;const[g,_]=i.tl;p.update(l.data,void 0,{x:g,y:_})}}var Th;Pe("ImagePosition",Yv),Pe("ImageAtlas",mb),u.ai=void 0,(Th=u.ai||(u.ai={}))[Th.none=0]="none",Th[Th.horizontal=1]="horizontal",Th[Th.vertical=2]="vertical",Th[Th.horizontalOnly=3]="horizontalOnly";const vg=-17;class xg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,l){const p=new xg;return p.scale=i||1,p.fontStack=l,p}static forImage(i){const l=new xg;return l.imageName=i,l}}class Nf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,l){const p=new Nf;for(let g=0;g<i.sections.length;g++){const _=i.sections[g];_.image?p.addImageSection(_):p.addTextSection(_,l)}return p}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let l="";for(let p=0;p<i.length;p++){const g=i.charCodeAt(p+1)||null,_=i.charCodeAt(p-1)||null;l+=g&&_c(g)&&!_g[i[p+1]]||_&&_c(_)&&!_g[i[p-1]]||!_g[i[p]]?i[p]:_g[i[p]]}return l}(this.text)}trim(){let i=0;for(let p=0;p<this.text.length&&py[this.text.charCodeAt(p)];p++)i++;let l=this.text.length;for(let p=this.text.length-1;p>=0&&p>=i&&py[this.text.charCodeAt(p)];p--)l--;this.text=this.text.substring(i,l),this.sectionIndex=this.sectionIndex.slice(i,l)}substring(i,l){const p=new Nf;return p.text=this.text.substring(i,l),p.sectionIndex=this.sectionIndex.slice(i,l),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,l)=>Math.max(i,this.sections[l].scale),0)}addTextSection(i,l){this.text+=i.text,this.sections.push(xg.forText(i.scale,i.fontStack||l));const p=this.sections.length-1;for(let g=0;g<i.text.length;++g)this.sectionIndex.push(p)}addImageSection(i){const l=i.image?i.image.name:"";if(l.length===0)return void Gt("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(xg.forImage(l)),this.sectionIndex.push(this.sections.length-1)):Gt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function hy(a,i,l,p,g,_,x,E,T,M,D,B,U,H,K,it){const ht=Nf.fromFeature(a,g);let mt;B===u.ai.vertical&&ht.verticalizePunctuation();const{processBidirectionalText:Tt,processStyledBidirectionalText:xt}=$s;if(Tt&&ht.sections.length===1){mt=[];const ee=Tt(ht.toString(),Kv(ht,M,_,i,p,H,K));for(const ke of ee){const Ve=new Nf;Ve.text=ke,Ve.sections=ht.sections;for(let Ae=0;Ae<ke.length;Ae++)Ve.sectionIndex.push(0);mt.push(Ve)}}else if(xt){mt=[];const ee=xt(ht.text,ht.sectionIndex,Kv(ht,M,_,i,p,H,K));for(const ke of ee){const Ve=new Nf;Ve.text=ke[0],Ve.sectionIndex=ke[1],Ve.sections=ht.sections,mt.push(Ve)}}else mt=function(ee,ke){const Ve=[],Ae=ee.text;let Ce=0;for(const _e of ke)Ve.push(ee.substring(Ce,_e)),Ce=_e;return Ce<Ae.length&&Ve.push(ee.substring(Ce,Ae.length)),Ve}(ht,Kv(ht,M,_,i,p,H,K));const Lt=[],Vt={positionedLines:Lt,text:ht.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(ee,ke,Ve,Ae,Ce,_e,Re,we,le,Je,je,Cn){let kr=0,Vr=vg,Ki=0,va=0;const bs=we==="right"?1:we==="left"?0:.5;let Bi=0;for(const Ji of Ce){Ji.trim();const Qi=Ji.getMaxScale(),ss=(Qi-1)*Yi,Is={positionedGlyphs:[],lineOffset:0};ee.positionedLines[Bi]=Is;const as=Is.positionedGlyphs;let qs=0;if(!Ji.length()){Vr+=_e,++Bi;continue}for(let to=0;to<Ji.length();to++){const On=Ji.getSection(to),ls=Ji.getSectionIndex(to),$o=Ji.getCharCode(to);let eo=0,xl=null,nu=null,ru=null,Tc=Yi;const wl=!(le===u.ai.horizontal||!je&&!Ou($o)||je&&(py[$o]||(So=$o,xe.Arabic(So)||xe["Arabic Supplement"](So)||xe["Arabic Extended-A"](So)||xe["Arabic Presentation Forms-A"](So)||xe["Arabic Presentation Forms-B"](So))));if(On.imageName){const $a=Ae[On.imageName];if(!$a)continue;ru=On.imageName,ee.iconsInText=ee.iconsInText||!0,nu=$a.paddedRect;const Xs=$a.displaySize;On.scale=On.scale*Yi/Cn,xl={width:Xs[0],height:Xs[1],left:js,top:-db,advance:wl?Xs[1]:Xs[0]},eo=ss+(Yi-Xs[1]*On.scale),Tc=xl.advance;const Pc=wl?Xs[0]*On.scale-Yi*Qi:Xs[1]*On.scale-Yi*Qi;Pc>0&&Pc>qs&&(qs=Pc)}else{const $a=Ve[On.fontStack],Xs=$a&&$a[$o];if(Xs&&Xs.rect)nu=Xs.rect,xl=Xs.metrics;else{const Pc=ke[On.fontStack],Ig=Pc&&Pc[$o];if(!Ig)continue;xl=Ig.metrics}eo=(Qi-On.scale)*Yi}wl?(ee.verticalizable=!0,as.push({glyph:$o,imageName:ru,x:kr,y:Vr+eo,vertical:wl,scale:On.scale,fontStack:On.fontStack,sectionIndex:ls,metrics:xl,rect:nu}),kr+=Tc*On.scale+Je):(as.push({glyph:$o,imageName:ru,x:kr,y:Vr+eo,vertical:wl,scale:On.scale,fontStack:On.fontStack,sectionIndex:ls,metrics:xl,rect:nu}),kr+=xl.advance*On.scale+Je)}as.length!==0&&(Ki=Math.max(kr-Je,Ki),fM(as,0,as.length-1,bs,qs)),kr=0;const Zs=_e*Qi+qs;Is.lineOffset=Math.max(qs,ss),Vr+=Zs,va=Math.max(Zs,va),++Bi}var So;const Uo=Vr-vg,{horizontalAlign:Es,verticalAlign:Ss}=Jv(Re);(function(Ji,Qi,ss,Is,as,qs,Zs,to,On){const ls=(Qi-ss)*as;let $o=0;$o=qs!==Zs?-to*Is-vg:(-Is*On+.5)*Zs;for(const eo of Ji)for(const xl of eo.positionedGlyphs)xl.x+=ls,xl.y+=$o})(ee.positionedLines,bs,Es,Ss,Ki,va,_e,Uo,Ce.length),ee.top+=-Ss*Uo,ee.bottom=ee.top+Uo,ee.left+=-Es*Ki,ee.right=ee.left+Ki}(Vt,i,l,p,mt,x,E,T,B,M,U,it),!function(ee){for(const ke of ee)if(ke.positionedGlyphs.length!==0)return!1;return!0}(Lt)&&Vt}const py={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hM={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function yb(a,i,l,p,g,_){if(i.imageName){const x=p[i.imageName];return x?x.displaySize[0]*i.scale*Yi/_+g:0}{const x=l[i.fontStack],E=x&&x[a];return E?E.metrics.advance*i.scale+g:0}}function _b(a,i,l,p){const g=Math.pow(a-i,2);return p?a<i?g/2:2*g:g+Math.abs(l)*l}function pM(a,i,l){let p=0;return a===10&&(p-=1e4),l&&(p+=150),a!==40&&a!==65288||(p+=50),i!==41&&i!==65289||(p+=50),p}function vb(a,i,l,p,g,_){let x=null,E=_b(i,l,g,_);for(const T of p){const M=_b(i-T.x,l,g,_)+T.badness;M<=E&&(x=T,E=M)}return{index:a,x:i,priorBreak:x,badness:E}}function xb(a){return a?xb(a.priorBreak).concat(a.index):[]}function Kv(a,i,l,p,g,_,x){if(_!=="point")return[];if(!a)return[];const E=[],T=function(U,H,K,it,ht,mt){let Tt=0;for(let xt=0;xt<U.length();xt++){const Lt=U.getSection(xt);Tt+=yb(U.getCharCode(xt),Lt,it,ht,H,mt)}return Tt/Math.max(1,Math.ceil(Tt/K))}(a,i,l,p,g,x),M=a.text.indexOf("")>=0;let D=0;for(let U=0;U<a.length();U++){const H=a.getSection(U),K=a.getCharCode(U);if(py[K]||(D+=yb(K,H,p,g,i,x)),U<a.length()-1){const it=!((B=K)<11904||!(xe["Bopomofo Extended"](B)||xe.Bopomofo(B)||xe["CJK Compatibility Forms"](B)||xe["CJK Compatibility Ideographs"](B)||xe["CJK Compatibility"](B)||xe["CJK Radicals Supplement"](B)||xe["CJK Strokes"](B)||xe["CJK Symbols and Punctuation"](B)||xe["CJK Unified Ideographs Extension A"](B)||xe["CJK Unified Ideographs"](B)||xe["Enclosed CJK Letters and Months"](B)||xe["Halfwidth and Fullwidth Forms"](B)||xe.Hiragana(B)||xe["Ideographic Description Characters"](B)||xe["Kangxi Radicals"](B)||xe["Katakana Phonetic Extensions"](B)||xe.Katakana(B)||xe["Vertical Forms"](B)||xe["Yi Radicals"](B)||xe["Yi Syllables"](B)));(hM[K]||it||H.imageName)&&E.push(vb(U+1,D,T,E,pM(K,a.getCharCode(U+1),it&&M),!1))}}var B;return xb(vb(a.length(),D,T,E,0,!0))}function Jv(a){let i=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:i,verticalAlign:l}}function fM(a,i,l,p,g){if(!p&&!g)return;const _=a[l],x=(a[l].x+_.metrics.advance*_.scale)*p;for(let E=i;E<=l;E++)a[E].x-=x,a[E].y+=g}function dM(a,i,l){const{horizontalAlign:p,verticalAlign:g}=Jv(l),_=i[0]-a.displaySize[0]*p,x=i[1]-a.displaySize[1]*g;return{image:a,top:x,bottom:x+a.displaySize[1],left:_,right:_+a.displaySize[0]}}function wb(a,i,l,p,g,_){const x=a.image;let E;if(x.content){const ht=x.content,mt=x.pixelRatio||1;E=[ht[0]/mt,ht[1]/mt,x.displaySize[0]-ht[2]/mt,x.displaySize[1]-ht[3]/mt]}const T=i.left*_,M=i.right*_;let D,B,U,H;l==="width"||l==="both"?(H=g[0]+T-p[3],B=g[0]+M+p[1]):(H=g[0]+(T+M-x.displaySize[0])/2,B=H+x.displaySize[0]);const K=i.top*_,it=i.bottom*_;return l==="height"||l==="both"?(D=g[1]+K-p[0],U=g[1]+it+p[2]):(D=g[1]+(K+it-x.displaySize[1])/2,U=D+x.displaySize[1]),{image:x,top:D,right:B,bottom:U,left:H,collisionPadding:E}}const wg=255,Bu=128,Ph=wg*Bu;function bb(a,i){const{expression:l}=i;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Lr(a+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:g}=l;let _=0;for(;_<p.length&&p[_]<=a;)_++;_=Math.max(0,_-1);let x=_;for(;x<p.length&&p[x]<a+1;)x++;x=Math.min(p.length-1,x);const E=p[_],T=p[x];return l.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:T,interpolationType:g}:{kind:"camera",minZoom:E,maxZoom:T,minSize:l.evaluate(new Lr(E)),maxSize:l.evaluate(new Lr(T)),interpolationType:g}}}function Qv(a,i,l){let p="never";const g=a.get(i);return g?p=g:a.get(l)&&(p="always"),p}const gM=Ch.VectorTileFeature.types,mM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fy(a,i,l,p,g,_,x,E,T,M,D,B,U){const H=E?Math.min(Ph,Math.round(E[0])):0,K=E?Math.min(Ph,Math.round(E[1])):0;a.emplaceBack(i,l,Math.round(32*p),Math.round(32*g),_,x,(H<<1)+(T?1:0),K,16*M,16*D,256*B,256*U)}function t0(a,i,l){a.emplaceBack(i.x,i.y,l),a.emplaceBack(i.x,i.y,l),a.emplaceBack(i.x,i.y,l),a.emplaceBack(i.x,i.y,l)}function yM(a){for(const i of a.sections)if(bh(i.text))return!0;return!1}class e0{constructor(i){this.layoutVertexArray=new Ln,this.indexArray=new bo,this.programConfigurations=i,this.segments=new Ar,this.dynamicLayoutVertexArray=new wn,this.opacityVertexArray=new Nn,this.hasVisibleVertices=!1,this.placedSymbolArray=new St}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,l,p,g){this.isEmpty()||(p&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,WP.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,HP.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,mM,!0),this.opacityVertexBuffer.itemSize=1),(p||g)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pe("SymbolBuffers",e0);class n0{constructor(i,l,p){this.layoutVertexArray=new i,this.layoutAttributes=l,this.indexArray=new p,this.segments=new Ar,this.collisionVertexArray=new br}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,YP.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pe("CollisionBuffers",n0);class Df{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(x=>x.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Nv([]),this.placementViewportMatrix=Nv([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=bb(this.zoom,l["text-size"]),this.iconSizeData=bb(this.zoom,l["icon-size"]);const p=this.layers[0].layout,g=p.get("symbol-sort-key"),_=p.get("symbol-z-order");this.canOverlap=Qv(p,"text-overlap","text-allow-overlap")!=="never"||Qv(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(x=>u.ai[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=i.sourceID}createArrays(){this.text=new e0(new eu(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new e0(new eu(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Ct,this.lineVertexArray=new $t,this.symbolInstances=new ft,this.textAnchorOffsets=new te}calculateGlyphDependencies(i,l,p,g,_){for(let x=0;x<i.length;x++)if(l[i.charCodeAt(x)]=!0,(p||g)&&_){const E=_g[i.charAt(x)];E&&(l[E.charCodeAt(0)]=!0)}}populate(i,l,p){const g=this.layers[0],_=g.layout,x=_.get("text-font"),E=_.get("text-field"),T=_.get("icon-image"),M=(E.value.kind!=="constant"||E.value.value instanceof Fn&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),D=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,B=_.get("symbol-sort-key");if(this.features=[],!M&&!D)return;const U=l.iconDependencies,H=l.glyphDependencies,K=l.availableImages,it=new Lr(this.zoom);for(const{feature:ht,id:mt,index:Tt,sourceLayerIndex:xt}of i){const Lt=g._featureFilter.needGeometry,Vt=Np(ht,Lt);if(!g._featureFilter.filter(it,Vt,p))continue;let ee,ke;if(Lt||(Vt.geometry=kp(ht)),M){const Ae=g.getValueAndResolveTokens("text-field",Vt,p,K),Ce=Fn.factory(Ae);yM(Ce)&&(this.hasRTLText=!0),(!this.hasRTLText||Jd()==="unavailable"||this.hasRTLText&&$s.isParsed())&&(ee=JP(Ce,g,Vt))}if(D){const Ae=g.getValueAndResolveTokens("icon-image",Vt,p,K);ke=Ae instanceof qr?Ae:qr.fromString(Ae)}if(!ee&&!ke)continue;const Ve=this.sortFeaturesByKey?B.evaluate(Vt,{},p):void 0;if(this.features.push({id:mt,text:ee,icon:ke,index:Tt,sourceLayerIndex:xt,geometry:Vt.geometry,properties:ht.properties,type:gM[ht.type],sortKey:Ve}),ke&&(U[ke.name]=!0),ee){const Ae=x.evaluate(Vt,{},p).join(","),Ce=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.ai.vertical)>=0;for(const _e of ee.sections)if(_e.image)U[_e.image.name]=!0;else{const Re=wh(ee.toString()),we=_e.fontStack||Ae,le=H[we]=H[we]||{};this.calculateGlyphDependencies(_e.text,le,Ce,this.allowVerticalPlacement,Re)}}}_.get("symbol-placement")==="line"&&(this.features=function(ht){const mt={},Tt={},xt=[];let Lt=0;function Vt(Ae){xt.push(ht[Ae]),Lt++}function ee(Ae,Ce,_e){const Re=Tt[Ae];return delete Tt[Ae],Tt[Ce]=Re,xt[Re].geometry[0].pop(),xt[Re].geometry[0]=xt[Re].geometry[0].concat(_e[0]),Re}function ke(Ae,Ce,_e){const Re=mt[Ce];return delete mt[Ce],mt[Ae]=Re,xt[Re].geometry[0].shift(),xt[Re].geometry[0]=_e[0].concat(xt[Re].geometry[0]),Re}function Ve(Ae,Ce,_e){const Re=_e?Ce[0][Ce[0].length-1]:Ce[0][0];return`${Ae}:${Re.x}:${Re.y}`}for(let Ae=0;Ae<ht.length;Ae++){const Ce=ht[Ae],_e=Ce.geometry,Re=Ce.text?Ce.text.toString():null;if(!Re){Vt(Ae);continue}const we=Ve(Re,_e),le=Ve(Re,_e,!0);if(we in Tt&&le in mt&&Tt[we]!==mt[le]){const Je=ke(we,le,_e),je=ee(we,le,xt[Je].geometry);delete mt[we],delete Tt[le],Tt[Ve(Re,xt[je].geometry,!0)]=je,xt[Je].geometry=null}else we in Tt?ee(we,le,_e):le in mt?ke(we,le,_e):(Vt(Ae),mt[we]=Lt-1,Tt[le]=Lt-1)}return xt.filter(Ae=>Ae.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ht,mt)=>ht.sortKey-mt.sortKey)}update(i,l,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,l,this.layers,p),this.icon.programConfigurations.updatePaintArrays(i,l,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,l){const p=this.lineVertexArray.length;if(i.segment!==void 0){let g=i.dist(l[i.segment+1]),_=i.dist(l[i.segment]);const x={};for(let E=i.segment+1;E<l.length;E++)x[E]={x:l[E].x,y:l[E].y,tileUnitDistanceFromAnchor:g},E<l.length-1&&(g+=l[E+1].dist(l[E]));for(let E=i.segment||0;E>=0;E--)x[E]={x:l[E].x,y:l[E].y,tileUnitDistanceFromAnchor:_},E>0&&(_+=l[E-1].dist(l[E]));for(let E=0;E<l.length;E++){const T=x[E];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(i,l,p,g,_,x,E,T,M,D,B,U){const H=i.indexArray,K=i.layoutVertexArray,it=i.segments.prepareSegment(4*l.length,K,H,this.canOverlap?x.sortKey:void 0),ht=this.glyphOffsetArray.length,mt=it.vertexLength,Tt=this.allowVerticalPlacement&&E===u.ai.vertical?Math.PI/2:0,xt=x.text&&x.text.sections;for(let Lt=0;Lt<l.length;Lt++){const{tl:Vt,tr:ee,bl:ke,br:Ve,tex:Ae,pixelOffsetTL:Ce,pixelOffsetBR:_e,minFontScaleX:Re,minFontScaleY:we,glyphOffset:le,isSDF:Je,sectionIndex:je}=l[Lt],Cn=it.vertexLength,kr=le[1];fy(K,T.x,T.y,Vt.x,kr+Vt.y,Ae.x,Ae.y,p,Je,Ce.x,Ce.y,Re,we),fy(K,T.x,T.y,ee.x,kr+ee.y,Ae.x+Ae.w,Ae.y,p,Je,_e.x,Ce.y,Re,we),fy(K,T.x,T.y,ke.x,kr+ke.y,Ae.x,Ae.y+Ae.h,p,Je,Ce.x,_e.y,Re,we),fy(K,T.x,T.y,Ve.x,kr+Ve.y,Ae.x+Ae.w,Ae.y+Ae.h,p,Je,_e.x,_e.y,Re,we),t0(i.dynamicLayoutVertexArray,T,Tt),H.emplaceBack(Cn,Cn+1,Cn+2),H.emplaceBack(Cn+1,Cn+2,Cn+3),it.vertexLength+=4,it.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(le[0]),Lt!==l.length-1&&je===l[Lt+1].sectionIndex||i.programConfigurations.populatePaintArrays(K.length,x,x.index,{},U,xt&&xt[je])}i.placedSymbolArray.emplaceBack(T.x,T.y,ht,this.glyphOffsetArray.length-ht,mt,M,D,T.segment,p?p[0]:0,p?p[1]:0,g[0],g[1],E,0,!1,0,B)}_addCollisionDebugVertex(i,l,p,g,_,x){return l.emplaceBack(0,0),i.emplaceBack(p.x,p.y,g,_,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(i,l,p,g,_,x,E){const T=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),M=T.vertexLength,D=_.layoutVertexArray,B=_.collisionVertexArray,U=E.anchorX,H=E.anchorY;this._addCollisionDebugVertex(D,B,x,U,H,new O(i,l)),this._addCollisionDebugVertex(D,B,x,U,H,new O(p,l)),this._addCollisionDebugVertex(D,B,x,U,H,new O(p,g)),this._addCollisionDebugVertex(D,B,x,U,H,new O(i,g)),T.vertexLength+=4;const K=_.indexArray;K.emplaceBack(M,M+1),K.emplaceBack(M+1,M+2),K.emplaceBack(M+2,M+3),K.emplaceBack(M+3,M),T.primitiveLength+=4}addDebugCollisionBoxes(i,l,p,g){for(let _=i;_<l;_++){const x=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,g?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new n0(pi,sb.members,Wi),this.iconCollisionBox=new n0(pi,sb.members,Wi);for(let i=0;i<this.symbolInstances.length;i++){const l=this.symbolInstances.get(i);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(i,l,p,g,_,x,E,T,M){const D={};for(let B=l;B<p;B++){const U=i.get(B);D.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.textFeatureIndex=U.featureIndex;break}for(let B=g;B<_;B++){const U=i.get(B);D.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalTextFeatureIndex=U.featureIndex;break}for(let B=x;B<E;B++){const U=i.get(B);D.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.iconFeatureIndex=U.featureIndex;break}for(let B=T;B<M;B++){const U=i.get(B);D.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalIconFeatureIndex=U.featureIndex;break}return D}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const p=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,l){const p=i.placedSymbolArray.get(l),g=p.vertexStartIndex+4*p.numGlyphs;for(let _=p.vertexStartIndex;_<g;_+=4)i.indexArray.emplaceBack(_,_+1,_+2),i.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(i),p=Math.cos(i),g=[],_=[],x=[];for(let E=0;E<this.symbolInstances.length;++E){x.push(E);const T=this.symbolInstances.get(E);g.push(0|Math.round(l*T.anchorX+p*T.anchorY)),_.push(T.featureIndex)}return x.sort((E,T)=>g[E]-g[T]||_[T]-_[E]),x}addToSortKeyRanges(i,l){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===l?p.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const p=this.symbolInstances.get(l);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((g,_,x)=>{g>=0&&x.indexOf(g)===_&&this.addIndicesForPlacedSymbol(this.text,g)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Eb,Sb;Pe("SymbolBucket",Df,{omit:["layers","collisionBoxArray","features","compareText"]}),Df.MAX_GLYPHS=65535,Df.addDynamicAttributes=t0;var r0={get paint(){return Sb=Sb||new bi({"icon-opacity":new nn(qt.paint_symbol["icon-opacity"]),"icon-color":new nn(qt.paint_symbol["icon-color"]),"icon-halo-color":new nn(qt.paint_symbol["icon-halo-color"]),"icon-halo-width":new nn(qt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new nn(qt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ze(qt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ze(qt.paint_symbol["icon-translate-anchor"]),"text-opacity":new nn(qt.paint_symbol["text-opacity"]),"text-color":new nn(qt.paint_symbol["text-color"],{runtimeType:li,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new nn(qt.paint_symbol["text-halo-color"]),"text-halo-width":new nn(qt.paint_symbol["text-halo-width"]),"text-halo-blur":new nn(qt.paint_symbol["text-halo-blur"]),"text-translate":new Ze(qt.paint_symbol["text-translate"]),"text-translate-anchor":new Ze(qt.paint_symbol["text-translate-anchor"])})},get layout(){return Eb=Eb||new bi({"symbol-placement":new Ze(qt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ze(qt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ze(qt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new nn(qt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ze(qt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ze(qt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ze(qt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ze(qt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ze(qt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ze(qt.layout_symbol["icon-rotation-alignment"]),"icon-size":new nn(qt.layout_symbol["icon-size"]),"icon-text-fit":new Ze(qt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ze(qt.layout_symbol["icon-text-fit-padding"]),"icon-image":new nn(qt.layout_symbol["icon-image"]),"icon-rotate":new nn(qt.layout_symbol["icon-rotate"]),"icon-padding":new nn(qt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ze(qt.layout_symbol["icon-keep-upright"]),"icon-offset":new nn(qt.layout_symbol["icon-offset"]),"icon-anchor":new nn(qt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ze(qt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ze(qt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ze(qt.layout_symbol["text-rotation-alignment"]),"text-field":new nn(qt.layout_symbol["text-field"]),"text-font":new nn(qt.layout_symbol["text-font"]),"text-size":new nn(qt.layout_symbol["text-size"]),"text-max-width":new nn(qt.layout_symbol["text-max-width"]),"text-line-height":new Ze(qt.layout_symbol["text-line-height"]),"text-letter-spacing":new nn(qt.layout_symbol["text-letter-spacing"]),"text-justify":new nn(qt.layout_symbol["text-justify"]),"text-radial-offset":new nn(qt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ze(qt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new nn(qt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new nn(qt.layout_symbol["text-anchor"]),"text-max-angle":new Ze(qt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ze(qt.layout_symbol["text-writing-mode"]),"text-rotate":new nn(qt.layout_symbol["text-rotate"]),"text-padding":new Ze(qt.layout_symbol["text-padding"]),"text-keep-upright":new Ze(qt.layout_symbol["text-keep-upright"]),"text-transform":new nn(qt.layout_symbol["text-transform"]),"text-offset":new nn(qt.layout_symbol["text-offset"]),"text-allow-overlap":new Ze(qt.layout_symbol["text-allow-overlap"]),"text-overlap":new Ze(qt.layout_symbol["text-overlap"]),"text-ignore-placement":new Ze(qt.layout_symbol["text-ignore-placement"]),"text-optional":new Ze(qt.layout_symbol["text-optional"])})}};class Ib{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:Oi,this.defaultValue=i}evaluate(i){if(i.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(i.formattedSection))return l.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pe("FormatSectionOverride",Ib,{omit:["defaultValue"]});class dy extends ya{constructor(i){super(i,r0)}recalculate(i,l){if(super.recalculate(i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const g=[];for(const _ of p)g.indexOf(_)<0&&g.push(_);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,l,p,g){const _=this.layout.get(i).evaluate(l,{},p,g),x=this._unevaluatedLayout._values[i];return x.isDataDriven()||Bs(x.value)||!_?_:function(E,T){return T.replace(/{([^{}]+)}/g,(M,D)=>E&&D in E?String(E[D]):"")}(l.properties,_)}createBucket(i){return new Df(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of r0.paint.overridableProperties){if(!dy.hasPaintOverride(this.layout,i))continue;const l=this.paint.get(i),p=new Ib(l),g=new Lu(p,l.property.specification);let _=null;_=l.value.kind==="constant"||l.value.kind==="source"?new Au("source",g):new hl("composite",g,l.value.zoomStops),this.paint._values[i]=new is(l.property,_,l.parameters)}}_handleOverridablePaintPropertyUpdate(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&dy.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,l){const p=i.get("text-field"),g=r0.paint.properties[l];let _=!1;const x=E=>{for(const T of E)if(g.overrides&&g.overrides.hasOverride(T))return void(_=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Fn)x(p.value.value.sections);else if(p.value.kind==="source"){const E=M=>{_||(M instanceof Zi&&ir(M.value)===q?x(M.value.sections):M instanceof hc?x(M.sections):M.eachChild(E))},T=p.value;T._styleExpression&&E(T._styleExpression.expression)}return _}}let Cb;var _M={get paint(){return Cb=Cb||new bi({"background-color":new Ze(qt.paint_background["background-color"]),"background-pattern":new tg(qt.paint_background["background-pattern"]),"background-opacity":new Ze(qt.paint_background["background-opacity"])})}};class vM extends ya{constructor(i){super(i,_M)}}let Tb;var xM={get paint(){return Tb=Tb||new bi({"raster-opacity":new Ze(qt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ze(qt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ze(qt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ze(qt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ze(qt.paint_raster["raster-saturation"]),"raster-contrast":new Ze(qt.paint_raster["raster-contrast"]),"raster-resampling":new Ze(qt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ze(qt.paint_raster["raster-fade-duration"])})}};class wM extends ya{constructor(i){super(i,xM)}}class bM extends ya{constructor(i){super(i,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class EM{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const i0=63710088e-1;class Mh{constructor(i,l){if(isNaN(i)||isNaN(l))throw new Error(`Invalid LngLat object: (${i}, ${l})`);if(this.lng=+i,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Mh(Rt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const l=Math.PI/180,p=this.lat*l,g=i.lat*l,_=Math.sin(p)*Math.sin(g)+Math.cos(p)*Math.cos(g)*Math.cos((i.lng-this.lng)*l);return i0*Math.acos(Math.min(_,1))}static convert(i){if(i instanceof Mh)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Mh(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Mh(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Pb=2*Math.PI*i0;function Mb(a){return Pb*Math.cos(a*Math.PI/180)}function Lb(a){return(180+a)/360}function Ab(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function kb(a,i){return a/Mb(i)}function Nb(a){return 360*a-180}function o0(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class gy{constructor(i,l,p=0){this.x=+i,this.y=+l,this.z=+p}static fromLngLat(i,l=0){const p=Mh.convert(i);return new gy(Lb(p.lng),Ab(p.lat),kb(l,p.lat))}toLngLat(){return new Mh(Nb(this.x),o0(this.y))}toAltitude(){return this.z*Mb(o0(this.y))}meterInMercatorCoordinateUnits(){return 1/Pb*(i=o0(this.y),1/Math.cos(i*Math.PI/180));var i}}function Db(a,i,l){var p=2*Math.PI*6378137/256/Math.pow(2,l);return[a*p-2*Math.PI*6378137/2,i*p-2*Math.PI*6378137/2]}class s0{constructor(i,l,p){if(i<0||i>25||p<0||p>=Math.pow(2,i)||l<0||l>=Math.pow(2,i))throw new Error(`x=${l}, y=${p}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=l,this.y=p,this.key=bg(0,i,i,l,p)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,l,p){const g=(x=this.y,E=this.z,T=Db(256*(_=this.x),256*(x=Math.pow(2,E)-x-1),E),M=Db(256*(_+1),256*(x+1),E),T[0]+","+T[1]+","+M[0]+","+M[1]);var _,x,E,T,M;const D=function(B,U,H){let K,it="";for(let ht=B;ht>0;ht--)K=1<<ht-1,it+=(U&K?1:0)+(H&K?2:0);return it}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,g)}isChildOf(i){const l=this.z-i.z;return l>0&&i.x===this.x>>l&&i.y===this.y>>l}getTilePoint(i){const l=Math.pow(2,this.z);return new O((i.x*l-this.x)*Fi,(i.y*l-this.y)*Fi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Rb{constructor(i,l){this.wrap=i,this.canonical=l,this.key=bg(i,l.z,l.z,l.x,l.y)}}class Ua{constructor(i,l,p,g,_){if(i<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${p}`);this.overscaledZ=i,this.wrap=l,this.canonical=new s0(p,+g,+_),this.key=bg(l,i,p,g,_)}clone(){return new Ua(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-i;return i>this.canonical.z?new Ua(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ua(i,this.wrap,i,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(i,l){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-i;return i>this.canonical.z?bg(this.wrap*+l,i,this.canonical.z,this.canonical.x,this.canonical.y):bg(this.wrap*+l,i,i,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const l=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>l&&i.canonical.y===this.canonical.y>>l}children(i){if(this.overscaledZ>=i)return[new Ua(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,p=2*this.canonical.x,g=2*this.canonical.y;return[new Ua(l,this.wrap,l,p,g),new Ua(l,this.wrap,l,p+1,g),new Ua(l,this.wrap,l,p,g+1),new Ua(l,this.wrap,l,p+1,g+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Ua(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Ua(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Rb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new gy(i.x-this.wrap,i.y))}}function bg(a,i,l,p,g){(a*=2)<0&&(a=-1*a-1);const _=1<<l;return(_*_*a+_*g+p).toString(36)+l.toString(36)+i.toString(36)}Pe("CanonicalTileID",s0),Pe("OverscaledTileID",Ua,{omit:["posMatrix"]});class Ob{constructor(i,l,p,g=1,_=1,x=1,E=0){if(this.uid=i,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void Gt(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;const T=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=_,this.blueFactor=x,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<T;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(T,M)]=this.data[this._idx(T-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,T)]=this.data[this._idx(M,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<T;M++)for(let D=0;D<T;D++){const B=this.get(M,D);B>this.max&&(this.max=B),B<this.min&&(this.min=B)}}get(i,l){const p=new Uint8Array(this.data.buffer),g=4*this._idx(i,l);return this.unpack(p[g],p[g+1],p[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(i,l){if(i<-1||i>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(i+1)}unpack(i,l,p){return i*this.redFactor+l*this.greenFactor+p*this.blueFactor-this.baseShift}getPixels(){return new Va({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,l,p){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let g=l*this.dim,_=l*this.dim+this.dim,x=p*this.dim,E=p*this.dim+this.dim;switch(l){case-1:g=_-1;break;case 1:_=g+1}switch(p){case-1:x=E-1;break;case 1:E=x+1}const T=-l*this.dim,M=-p*this.dim;for(let D=x;D<E;D++)for(let B=g;B<_;B++)this.data[this._idx(B,D)]=i.data[this._idx(B+T,D+M)]}}Pe("DEMData",Ob);class zb{constructor(i){this._stringToNumber={},this._numberToString=[];for(let l=0;l<i.length;l++){const p=i[l];this._stringToNumber[p]=l,this._numberToString[l]=p}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class Fb{constructor(i,l,p,g,_){this.type="Feature",this._vectorTileFeature=i,i._z=l,i._x=p,i._y=g,this.properties=i.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(i[l]=this[l]);return i}}class Bb{constructor(i,l){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new dl(Fi,16,0),this.grid3D=new dl(Fi,16,0),this.featureIndexArray=new re,this.promoteId=l}insert(i,l,p,g,_,x){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,g,_);const T=x?this.grid3D:this.grid;for(let M=0;M<l.length;M++){const D=l[M],B=[1/0,1/0,-1/0,-1/0];for(let U=0;U<D.length;U++){const H=D[U];B[0]=Math.min(B[0],H.x),B[1]=Math.min(B[1],H.y),B[2]=Math.max(B[2],H.x),B[3]=Math.max(B[3],H.y)}B[0]<Fi&&B[1]<Fi&&B[2]>=0&&B[3]>=0&&T.insert(E,B[0],B[1],B[2],B[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ch.VectorTile(new Wv(this.rawTileData)).layers,this.sourceLayerCoder=new zb(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,l,p,g){this.loadVTLayers();const _=i.params||{},x=Fi/i.tileSize/i.scale,E=gh(_.filter),T=i.queryGeometry,M=i.queryPadding*x,D=Ub(T),B=this.grid.query(D.minX-M,D.minY-M,D.maxX+M,D.maxY+M),U=Ub(i.cameraQueryGeometry),H=this.grid3D.query(U.minX-M,U.minY-M,U.maxX+M,U.maxY+M,(ht,mt,Tt,xt)=>function(Lt,Vt,ee,ke,Ve){for(const Ce of Lt)if(Vt<=Ce.x&&ee<=Ce.y&&ke>=Ce.x&&Ve>=Ce.y)return!0;const Ae=[new O(Vt,ee),new O(Vt,Ve),new O(ke,Ve),new O(ke,ee)];if(Lt.length>2){for(const Ce of Ae)if(Tf(Lt,Ce))return!0}for(let Ce=0;Ce<Lt.length-1;Ce++)if(eP(Lt[Ce],Lt[Ce+1],Ae))return!0;return!1}(i.cameraQueryGeometry,ht-M,mt-M,Tt+M,xt+M));for(const ht of H)B.push(ht);B.sort(SM);const K={};let it;for(let ht=0;ht<B.length;ht++){const mt=B[ht];if(mt===it)continue;it=mt;const Tt=this.featureIndexArray.get(mt);let xt=null;this.loadMatchingFeature(K,Tt.bucketIndex,Tt.sourceLayerIndex,Tt.featureIndex,E,_.layers,_.availableImages,l,p,g,(Lt,Vt,ee)=>(xt||(xt=kp(Lt)),Vt.queryIntersectsFeature(T,Lt,ee,xt,this.z,i.transform,x,i.pixelPosMatrix)))}return K}loadMatchingFeature(i,l,p,g,_,x,E,T,M,D,B){const U=this.bucketLayerIDs[l];if(x&&!function(ht,mt){for(let Tt=0;Tt<ht.length;Tt++)if(mt.indexOf(ht[Tt])>=0)return!0;return!1}(x,U))return;const H=this.sourceLayerCoder.decode(p),K=this.vtLayers[H].feature(g);if(_.needGeometry){const ht=Np(K,!0);if(!_.filter(new Lr(this.tileID.overscaledZ),ht,this.tileID.canonical))return}else if(!_.filter(new Lr(this.tileID.overscaledZ),K))return;const it=this.getId(K,H);for(let ht=0;ht<U.length;ht++){const mt=U[ht];if(x&&x.indexOf(mt)<0)continue;const Tt=T[mt];if(!Tt)continue;let xt={};it&&D&&(xt=D.getState(Tt.sourceLayer||"_geojsonTileLayer",it));const Lt=At({},M[mt]);Lt.paint=Vb(Lt.paint,Tt.paint,K,xt,E),Lt.layout=Vb(Lt.layout,Tt.layout,K,xt,E);const Vt=!B||B(K,Tt,xt);if(!Vt)continue;const ee=new Fb(K,this.z,this.x,this.y,it);ee.layer=Lt;let ke=i[mt];ke===void 0&&(ke=i[mt]=[]),ke.push({featureIndex:g,feature:ee,intersectionZ:Vt})}}lookupSymbolFeatures(i,l,p,g,_,x,E,T){const M={};this.loadVTLayers();const D=gh(_);for(const B of i)this.loadMatchingFeature(M,p,g,B,D,x,E,T,l);return M}hasLayer(i){for(const l of this.bucketLayerIDs)for(const p of l)if(i===p)return!0;return!1}getId(i,l){let p=i.id;return this.promoteId&&(p=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof p=="boolean"&&(p=Number(p))),p}}function Vb(a,i,l,p,g){return Xt(a,(_,x)=>{const E=i instanceof If?i.get(x):null;return E&&E.evaluate?E.evaluate(l,p,g):E})}function Ub(a){let i=1/0,l=1/0,p=-1/0,g=-1/0;for(const _ of a)i=Math.min(i,_.x),l=Math.min(l,_.y),p=Math.max(p,_.x),g=Math.max(g,_.y);return{minX:i,minY:l,maxX:p,maxY:g}}function SM(a,i){return i-a}function $b(a,i,l,p,g){const _=[];for(let x=0;x<a.length;x++){const E=a[x];let T;for(let M=0;M<E.length-1;M++){let D=E[M],B=E[M+1];D.x<i&&B.x<i||(D.x<i?D=new O(i,D.y+(i-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x<i&&(B=new O(i,D.y+(i-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y<l&&B.y<l||(D.y<l?D=new O(D.x+(l-D.y)/(B.y-D.y)*(B.x-D.x),l)._round():B.y<l&&(B=new O(D.x+(l-D.y)/(B.y-D.y)*(B.x-D.x),l)._round()),D.x>=p&&B.x>=p||(D.x>=p?D=new O(p,D.y+(p-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x>=p&&(B=new O(p,D.y+(p-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y>=g&&B.y>=g||(D.y>=g?D=new O(D.x+(g-D.y)/(B.y-D.y)*(B.x-D.x),g)._round():B.y>=g&&(B=new O(D.x+(g-D.y)/(B.y-D.y)*(B.x-D.x),g)._round()),T&&D.equals(T[T.length-1])||(T=[D],_.push(T)),T.push(B)))))}}return _}Pe("FeatureIndex",Bb,{omit:["rawTileData","sourceLayerCoder"]});class Lh extends O{constructor(i,l,p,g){super(i,l),this.angle=p,g!==void 0&&(this.segment=g)}clone(){return new Lh(this.x,this.y,this.angle,this.segment)}}function Gb(a,i,l,p,g){if(i.segment===void 0||l===0)return!0;let _=i,x=i.segment+1,E=0;for(;E>-l/2;){if(x--,x<0)return!1;E-=a[x].dist(_),_=a[x]}E+=a[x].dist(a[x+1]),x++;const T=[];let M=0;for(;E<l/2;){const D=a[x],B=a[x+1];if(!B)return!1;let U=a[x-1].angleTo(D)-D.angleTo(B);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:E,angleDelta:U}),M+=U;E-T[0].distance>p;)M-=T.shift().angleDelta;if(M>g)return!1;x++,E+=D.dist(B)}return!0}function jb(a){let i=0;for(let l=0;l<a.length-1;l++)i+=a[l].dist(a[l+1]);return i}function qb(a,i,l){return a?.6*i*l:0}function Zb(a,i){return Math.max(a?a.right-a.left:0,i?i.right-i.left:0)}function IM(a,i,l,p,g,_){const x=qb(l,g,_),E=Zb(l,p)*_;let T=0;const M=jb(a)/2;for(let D=0;D<a.length-1;D++){const B=a[D],U=a[D+1],H=B.dist(U);if(T+H>M){const K=(M-T)/H,it=xo.number(B.x,U.x,K),ht=xo.number(B.y,U.y,K),mt=new Lh(it,ht,U.angleTo(B),D);return mt._round(),!x||Gb(a,mt,E,x,i)?mt:void 0}T+=H}}function CM(a,i,l,p,g,_,x,E,T){const M=qb(p,_,x),D=Zb(p,g),B=D*x,U=a[0].x===0||a[0].x===T||a[0].y===0||a[0].y===T;return i-B<i/4&&(i=B+i/4),Xb(a,U?i/2*E%i:(D/2+2*_)*x*E%i,i,M,l,B,U,!1,T)}function Xb(a,i,l,p,g,_,x,E,T){const M=_/2,D=jb(a);let B=0,U=i-l,H=[];for(let K=0;K<a.length-1;K++){const it=a[K],ht=a[K+1],mt=it.dist(ht),Tt=ht.angleTo(it);for(;U+l<B+mt;){U+=l;const xt=(U-B)/mt,Lt=xo.number(it.x,ht.x,xt),Vt=xo.number(it.y,ht.y,xt);if(Lt>=0&&Lt<T&&Vt>=0&&Vt<T&&U-M>=0&&U+M<=D){const ee=new Lh(Lt,Vt,Tt,K);ee._round(),p&&!Gb(a,ee,_,p,g)||H.push(ee)}}B+=mt}return E||H.length||x||(H=Xb(a,B/2,l,p,g,_,x,!0,T)),H}Pe("Anchor",Lh);const Rf=js;function Wb(a,i,l,p){const g=[],_=a.image,x=_.pixelRatio,E=_.paddedRect.w-2*Rf,T=_.paddedRect.h-2*Rf,M=a.right-a.left,D=a.bottom-a.top,B=_.stretchX||[[0,E]],U=_.stretchY||[[0,T]],H=(_e,Re)=>_e+Re[1]-Re[0],K=B.reduce(H,0),it=U.reduce(H,0),ht=E-K,mt=T-it;let Tt=0,xt=K,Lt=0,Vt=it,ee=0,ke=ht,Ve=0,Ae=mt;if(_.content&&p){const _e=_.content;Tt=my(B,0,_e[0]),Lt=my(U,0,_e[1]),xt=my(B,_e[0],_e[2]),Vt=my(U,_e[1],_e[3]),ee=_e[0]-Tt,Ve=_e[1]-Lt,ke=_e[2]-_e[0]-xt,Ae=_e[3]-_e[1]-Vt}const Ce=(_e,Re,we,le)=>{const Je=yy(_e.stretch-Tt,xt,M,a.left),je=_y(_e.fixed-ee,ke,_e.stretch,K),Cn=yy(Re.stretch-Lt,Vt,D,a.top),kr=_y(Re.fixed-Ve,Ae,Re.stretch,it),Vr=yy(we.stretch-Tt,xt,M,a.left),Ki=_y(we.fixed-ee,ke,we.stretch,K),va=yy(le.stretch-Lt,Vt,D,a.top),bs=_y(le.fixed-Ve,Ae,le.stretch,it),Bi=new O(Je,Cn),So=new O(Vr,Cn),Uo=new O(Vr,va),Es=new O(Je,va),Ss=new O(je/x,kr/x),Ji=new O(Ki/x,bs/x),Qi=i*Math.PI/180;if(Qi){const as=Math.sin(Qi),qs=Math.cos(Qi),Zs=[qs,-as,as,qs];Bi._matMult(Zs),So._matMult(Zs),Es._matMult(Zs),Uo._matMult(Zs)}const ss=_e.stretch+_e.fixed,Is=Re.stretch+Re.fixed;return{tl:Bi,tr:So,bl:Es,br:Uo,tex:{x:_.paddedRect.x+Rf+ss,y:_.paddedRect.y+Rf+Is,w:we.stretch+we.fixed-ss,h:le.stretch+le.fixed-Is},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ss,pixelOffsetBR:Ji,minFontScaleX:ke/x/M,minFontScaleY:Ae/x/D,isSDF:l}};if(p&&(_.stretchX||_.stretchY)){const _e=Hb(B,ht,K),Re=Hb(U,mt,it);for(let we=0;we<_e.length-1;we++){const le=_e[we],Je=_e[we+1];for(let je=0;je<Re.length-1;je++)g.push(Ce(le,Re[je],Je,Re[je+1]))}}else g.push(Ce({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:T+1}));return g}function my(a,i,l){let p=0;for(const g of a)p+=Math.max(i,Math.min(l,g[1]))-Math.max(i,Math.min(l,g[0]));return p}function Hb(a,i,l){const p=[{fixed:-Rf,stretch:0}];for(const[g,_]of a){const x=p[p.length-1];p.push({fixed:g-x.stretch,stretch:x.stretch}),p.push({fixed:g-x.stretch,stretch:x.stretch+(_-g)})}return p.push({fixed:i+Rf,stretch:l}),p}function yy(a,i,l,p){return a/i*l+p}function _y(a,i,l,p){return a-i*l/p}class vy{constructor(i,l,p,g,_,x,E,T,M,D){if(this.boxStartIndex=i.length,M){let B=x.top,U=x.bottom;const H=x.collisionPadding;H&&(B-=H[1],U+=H[3]);let K=U-B;K>0&&(K=Math.max(10,K),this.circleDiameter=K)}else{let B=x.top*E-T[0],U=x.bottom*E+T[2],H=x.left*E-T[3],K=x.right*E+T[1];const it=x.collisionPadding;if(it&&(H-=it[0]*E,B-=it[1]*E,K+=it[2]*E,U+=it[3]*E),D){const ht=new O(H,B),mt=new O(K,B),Tt=new O(H,U),xt=new O(K,U),Lt=D*Math.PI/180;ht._rotate(Lt),mt._rotate(Lt),Tt._rotate(Lt),xt._rotate(Lt),H=Math.min(ht.x,mt.x,Tt.x,xt.x),K=Math.max(ht.x,mt.x,Tt.x,xt.x),B=Math.min(ht.y,mt.y,Tt.y,xt.y),U=Math.max(ht.y,mt.y,Tt.y,xt.y)}i.emplaceBack(l.x,l.y,H,B,K,U,p,g,_)}this.boxEndIndex=i.length}}class TM{constructor(i=[],l=PM){if(this.data=i,this.length=this.data.length,this.compare=l,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:l,compare:p}=this,g=l[i];for(;i>0;){const _=i-1>>1,x=l[_];if(p(g,x)>=0)break;l[i]=x,i=_}l[i]=g}_down(i){const{data:l,compare:p}=this,g=this.length>>1,_=l[i];for(;i<g;){let x=1+(i<<1),E=l[x];const T=x+1;if(T<this.length&&p(l[T],E)<0&&(x=T,E=l[T]),p(E,_)>=0)break;l[i]=E,i=x}l[i]=_}}function PM(a,i){return a<i?-1:a>i?1:0}function MM(a,i=1,l=!1){let p=1/0,g=1/0,_=-1/0,x=-1/0;const E=a[0];for(let H=0;H<E.length;H++){const K=E[H];(!H||K.x<p)&&(p=K.x),(!H||K.y<g)&&(g=K.y),(!H||K.x>_)&&(_=K.x),(!H||K.y>x)&&(x=K.y)}const T=Math.min(_-p,x-g);let M=T/2;const D=new TM([],LM);if(T===0)return new O(p,g);for(let H=p;H<_;H+=T)for(let K=g;K<x;K+=T)D.push(new Of(H+M,K+M,M,a));let B=function(H){let K=0,it=0,ht=0;const mt=H[0];for(let Tt=0,xt=mt.length,Lt=xt-1;Tt<xt;Lt=Tt++){const Vt=mt[Tt],ee=mt[Lt],ke=Vt.x*ee.y-ee.x*Vt.y;it+=(Vt.x+ee.x)*ke,ht+=(Vt.y+ee.y)*ke,K+=3*ke}return new Of(it/K,ht/K,0,H)}(a),U=D.length;for(;D.length;){const H=D.pop();(H.d>B.d||!B.d)&&(B=H,l&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,U)),H.max-B.d<=i||(M=H.h/2,D.push(new Of(H.p.x-M,H.p.y-M,M,a)),D.push(new Of(H.p.x+M,H.p.y-M,M,a)),D.push(new Of(H.p.x-M,H.p.y+M,M,a)),D.push(new Of(H.p.x+M,H.p.y+M,M,a)),U+=4)}return l&&(console.log(`num probes: ${U}`),console.log(`best distance: ${B.d}`)),B.p}function LM(a,i){return i.max-a.max}function Of(a,i,l,p){this.p=new O(a,i),this.h=l,this.d=function(g,_){let x=!1,E=1/0;for(let T=0;T<_.length;T++){const M=_[T];for(let D=0,B=M.length,U=B-1;D<B;U=D++){const H=M[D],K=M[U];H.y>g.y!=K.y>g.y&&g.x<(K.x-H.x)*(g.y-H.y)/(K.y-H.y)+H.x&&(x=!x),E=Math.min(E,Aw(g,H,K))}}return(x?1:-1)*Math.sqrt(E)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var Vo;u.aq=void 0,(Vo=u.aq||(u.aq={}))[Vo.center=1]="center",Vo[Vo.left=2]="left",Vo[Vo.right=3]="right",Vo[Vo.top=4]="top",Vo[Vo.bottom=5]="bottom",Vo[Vo["top-left"]=6]="top-left",Vo[Vo["top-right"]=7]="top-right",Vo[Vo["bottom-left"]=8]="bottom-left",Vo[Vo["bottom-right"]=9]="bottom-right";const Ah=7,a0=Number.POSITIVE_INFINITY;function Yb(a,i){return i[1]!==a0?function(l,p,g){let _=0,x=0;switch(p=Math.abs(p),g=Math.abs(g),l){case"top-right":case"top-left":case"top":x=g-Ah;break;case"bottom-right":case"bottom-left":case"bottom":x=-g+Ah}switch(l){case"top-right":case"bottom-right":case"right":_=-p;break;case"top-left":case"bottom-left":case"left":_=p}return[_,x]}(a,i[0],i[1]):function(l,p){let g=0,_=0;p<0&&(p=0);const x=p/Math.SQRT2;switch(l){case"top-right":case"top-left":_=x-Ah;break;case"bottom-right":case"bottom-left":_=-x+Ah;break;case"bottom":_=-p+Ah;break;case"top":_=p-Ah}switch(l){case"top-right":case"bottom-right":g=-x;break;case"top-left":case"bottom-left":g=x;break;case"left":g=p;break;case"right":g=-p}return[g,_]}(a,i[0])}function Kb(a,i,l){var p;const g=a.layout,_=(p=g.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(i,{},l);if(_){const E=_.values,T=[];for(let M=0;M<E.length;M+=2){const D=T[M]=E[M],B=E[M+1].map(U=>U*Yi);D.startsWith("top")?B[1]-=Ah:D.startsWith("bottom")&&(B[1]+=Ah),T[M+1]=B}return new jr(T)}const x=g.get("text-variable-anchor");if(x){let E;E=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(i,{},l)*Yi,a0]:g.get("text-offset").evaluate(i,{},l).map(M=>M*Yi);const T=[];for(const M of x)T.push(M,Yb(M,E));return new jr(T)}return null}function l0(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function AM(a,i,l,p,g,_,x,E,T,M,D){let B=_.textMaxSize.evaluate(i,{});B===void 0&&(B=x);const U=a.layers[0].layout,H=U.get("icon-offset").evaluate(i,{},D),K=Qb(l.horizontal),it=x/24,ht=a.tilePixelRatio*it,mt=a.tilePixelRatio*B/24,Tt=a.tilePixelRatio*E,xt=a.tilePixelRatio*U.get("symbol-spacing"),Lt=U.get("text-padding")*a.tilePixelRatio,Vt=function(le,Je,je,Cn=1){const kr=le.get("icon-padding").evaluate(Je,{},je),Vr=kr&&kr.values;return[Vr[0]*Cn,Vr[1]*Cn,Vr[2]*Cn,Vr[3]*Cn]}(U,i,D,a.tilePixelRatio),ee=U.get("text-max-angle")/180*Math.PI,ke=U.get("text-rotation-alignment")!=="viewport"&&U.get("symbol-placement")!=="point",Ve=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",Ae=U.get("symbol-placement"),Ce=xt/2,_e=U.get("icon-text-fit");let Re;p&&_e!=="none"&&(a.allowVerticalPlacement&&l.vertical&&(Re=wb(p,l.vertical,_e,U.get("icon-text-fit-padding"),H,it)),K&&(p=wb(p,K,_e,U.get("icon-text-fit-padding"),H,it)));const we=(le,Je)=>{Je.x<0||Je.x>=Fi||Je.y<0||Je.y>=Fi||function(je,Cn,kr,Vr,Ki,va,bs,Bi,So,Uo,Es,Ss,Ji,Qi,ss,Is,as,qs,Zs,to,On,ls,$o,eo,xl){const nu=je.addToLineVertexArray(Cn,kr);let ru,Tc,wl,$a,Xs=0,Pc=0,Ig=0,rE=0,m0=-1,y0=-1;const Mc={};let iE=Ec("");if(je.allowVerticalPlacement&&Vr.vertical){const us=Bi.layout.get("text-rotate").evaluate(On,{},eo)+90;wl=new vy(So,Cn,Uo,Es,Ss,Vr.vertical,Ji,Qi,ss,us),bs&&($a=new vy(So,Cn,Uo,Es,Ss,bs,as,qs,ss,us))}if(Ki){const us=Bi.layout.get("icon-rotate").evaluate(On,{}),Ga=Bi.layout.get("icon-text-fit")!=="none",Rp=Wb(Ki,us,$o,Ga),ou=bs?Wb(bs,us,$o,Ga):void 0;Tc=new vy(So,Cn,Uo,Es,Ss,Ki,as,qs,!1,us),Xs=4*Rp.length;const Op=je.iconSizeData;let Vu=null;Op.kind==="source"?(Vu=[Bu*Bi.layout.get("icon-size").evaluate(On,{})],Vu[0]>Ph&&Gt(`${je.layerIds[0]}: Value for "icon-size" is >= ${wg}. Reduce your "icon-size".`)):Op.kind==="composite"&&(Vu=[Bu*ls.compositeIconSizes[0].evaluate(On,{},eo),Bu*ls.compositeIconSizes[1].evaluate(On,{},eo)],(Vu[0]>Ph||Vu[1]>Ph)&&Gt(`${je.layerIds[0]}: Value for "icon-size" is >= ${wg}. Reduce your "icon-size".`)),je.addSymbols(je.icon,Rp,Vu,to,Zs,On,u.ai.none,Cn,nu.lineStartIndex,nu.lineLength,-1,eo),m0=je.icon.placedSymbolArray.length-1,ou&&(Pc=4*ou.length,je.addSymbols(je.icon,ou,Vu,to,Zs,On,u.ai.vertical,Cn,nu.lineStartIndex,nu.lineLength,-1,eo),y0=je.icon.placedSymbolArray.length-1)}const oE=Object.keys(Vr.horizontal);for(const us of oE){const Ga=Vr.horizontal[us];if(!ru){iE=Ec(Ga.text);const ou=Bi.layout.get("text-rotate").evaluate(On,{},eo);ru=new vy(So,Cn,Uo,Es,Ss,Ga,Ji,Qi,ss,ou)}const Rp=Ga.positionedLines.length===1;if(Ig+=Jb(je,Cn,Ga,va,Bi,ss,On,Is,nu,Vr.vertical?u.ai.horizontal:u.ai.horizontalOnly,Rp?oE:[us],Mc,m0,ls,eo),Rp)break}Vr.vertical&&(rE+=Jb(je,Cn,Vr.vertical,va,Bi,ss,On,Is,nu,u.ai.vertical,["vertical"],Mc,y0,ls,eo));const DM=ru?ru.boxStartIndex:je.collisionBoxArray.length,RM=ru?ru.boxEndIndex:je.collisionBoxArray.length,OM=wl?wl.boxStartIndex:je.collisionBoxArray.length,zM=wl?wl.boxEndIndex:je.collisionBoxArray.length,FM=Tc?Tc.boxStartIndex:je.collisionBoxArray.length,BM=Tc?Tc.boxEndIndex:je.collisionBoxArray.length,VM=$a?$a.boxStartIndex:je.collisionBoxArray.length,UM=$a?$a.boxEndIndex:je.collisionBoxArray.length;let iu=-1;const wy=(us,Ga)=>us&&us.circleDiameter?Math.max(us.circleDiameter,Ga):Ga;iu=wy(ru,iu),iu=wy(wl,iu),iu=wy(Tc,iu),iu=wy($a,iu);const sE=iu>-1?1:0;sE&&(iu*=xl/Yi),je.glyphOffsetArray.length>=Df.MAX_GLYPHS&&Gt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),On.sortKey!==void 0&&je.addToSortKeyRanges(je.symbolInstances.length,On.sortKey);const $M=Kb(Bi,On,eo),[GM,jM]=function(us,Ga){const Rp=us.length,ou=Ga==null?void 0:Ga.values;if((ou==null?void 0:ou.length)>0)for(let Op=0;Op<ou.length;Op+=2){const Vu=ou[Op+1];us.emplaceBack(u.aq[ou[Op]],Vu[0],Vu[1])}return[Rp,us.length]}(je.textAnchorOffsets,$M);je.symbolInstances.emplaceBack(Cn.x,Cn.y,Mc.right>=0?Mc.right:-1,Mc.center>=0?Mc.center:-1,Mc.left>=0?Mc.left:-1,Mc.vertical||-1,m0,y0,iE,DM,RM,OM,zM,FM,BM,VM,UM,Uo,Ig,rE,Xs,Pc,sE,0,Ji,iu,GM,jM)}(a,Je,le,l,p,g,Re,a.layers[0],a.collisionBoxArray,i.index,i.sourceLayerIndex,a.index,ht,[Lt,Lt,Lt,Lt],ke,T,Tt,Vt,Ve,H,i,_,M,D,x)};if(Ae==="line")for(const le of $b(i.geometry,0,0,Fi,Fi)){const Je=CM(le,xt,ee,l.vertical||K,p,24,mt,a.overscaling,Fi);for(const je of Je)K&&kM(a,K.text,Ce,je)||we(le,je)}else if(Ae==="line-center"){for(const le of i.geometry)if(le.length>1){const Je=IM(le,ee,l.vertical||K,p,24,mt);Je&&we(le,Je)}}else if(i.type==="Polygon")for(const le of Vv(i.geometry,0)){const Je=MM(le,16);we(le[0],new Lh(Je.x,Je.y,0))}else if(i.type==="LineString")for(const le of i.geometry)we(le,new Lh(le[0].x,le[0].y,0));else if(i.type==="Point")for(const le of i.geometry)for(const Je of le)we([Je],new Lh(Je.x,Je.y,0))}function Jb(a,i,l,p,g,_,x,E,T,M,D,B,U,H,K){const it=function(Tt,xt,Lt,Vt,ee,ke,Ve,Ae){const Ce=Vt.layout.get("text-rotate").evaluate(ke,{})*Math.PI/180,_e=[];for(const Re of xt.positionedLines)for(const we of Re.positionedGlyphs){if(!we.rect)continue;const le=we.rect||{};let Je=db+1,je=!0,Cn=1,kr=0;const Vr=(ee||Ae)&&we.vertical,Ki=we.metrics.advance*we.scale/2;if(Ae&&xt.verticalizable&&(kr=Re.lineOffset/2-(we.imageName?-(Yi-we.metrics.width*we.scale)/2:(we.scale-1)*Yi)),we.imageName){const to=Ve[we.imageName];je=to.sdf,Cn=to.pixelRatio,Je=js/Cn}const va=ee?[we.x+Ki,we.y]:[0,0];let bs=ee?[0,0]:[we.x+Ki+Lt[0],we.y+Lt[1]-kr],Bi=[0,0];Vr&&(Bi=bs,bs=[0,0]);const So=we.metrics.isDoubleResolution?2:1,Uo=(we.metrics.left-Je)*we.scale-Ki+bs[0],Es=(-we.metrics.top-Je)*we.scale+bs[1],Ss=Uo+le.w/So*we.scale/Cn,Ji=Es+le.h/So*we.scale/Cn,Qi=new O(Uo,Es),ss=new O(Ss,Es),Is=new O(Uo,Ji),as=new O(Ss,Ji);if(Vr){const to=new O(-Ki,Ki-vg),On=-Math.PI/2,ls=Yi/2-Ki,$o=new O(5-vg-ls,-(we.imageName?ls:0)),eo=new O(...Bi);Qi._rotateAround(On,to)._add($o)._add(eo),ss._rotateAround(On,to)._add($o)._add(eo),Is._rotateAround(On,to)._add($o)._add(eo),as._rotateAround(On,to)._add($o)._add(eo)}if(Ce){const to=Math.sin(Ce),On=Math.cos(Ce),ls=[On,-to,to,On];Qi._matMult(ls),ss._matMult(ls),Is._matMult(ls),as._matMult(ls)}const qs=new O(0,0),Zs=new O(0,0);_e.push({tl:Qi,tr:ss,bl:Is,br:as,tex:le,writingMode:xt.writingMode,glyphOffset:va,sectionIndex:we.sectionIndex,isSDF:je,pixelOffsetTL:qs,pixelOffsetBR:Zs,minFontScaleX:0,minFontScaleY:0})}return _e}(0,l,E,g,_,x,p,a.allowVerticalPlacement),ht=a.textSizeData;let mt=null;ht.kind==="source"?(mt=[Bu*g.layout.get("text-size").evaluate(x,{})],mt[0]>Ph&&Gt(`${a.layerIds[0]}: Value for "text-size" is >= ${wg}. Reduce your "text-size".`)):ht.kind==="composite"&&(mt=[Bu*H.compositeTextSizes[0].evaluate(x,{},K),Bu*H.compositeTextSizes[1].evaluate(x,{},K)],(mt[0]>Ph||mt[1]>Ph)&&Gt(`${a.layerIds[0]}: Value for "text-size" is >= ${wg}. Reduce your "text-size".`)),a.addSymbols(a.text,it,mt,E,_,x,M,i,T.lineStartIndex,T.lineLength,U,K);for(const Tt of D)B[Tt]=a.text.placedSymbolArray.length-1;return 4*it.length}function Qb(a){for(const i in a)return a[i];return null}function kM(a,i,l,p){const g=a.compareText;if(i in g){const _=g[i];for(let x=_.length-1;x>=0;x--)if(p.dist(_[x])<l)return!0}else g[i]=[];return g[i].push(p),!1}const tE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class u0{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,p]=new Uint8Array(i,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=p>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const _=tE[15&p];if(!_)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(i,2,1),[E]=new Uint32Array(i,4,1);return new u0(E,x,_,i)}constructor(i,l=64,p=Float64Array,g){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=p,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const _=tE.indexOf(this.ArrayType),x=2*i*this.ArrayType.BYTES_PER_ELEMENT,E=i*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-E%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${p}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+E+T,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+x+E+T),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+E+T,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=i)}add(i,l){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=i,this.coords[this._pos++]=l,p}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return c0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,l,p,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:E}=this,T=[0,_.length-1,0],M=[];for(;T.length;){const D=T.pop()||0,B=T.pop()||0,U=T.pop()||0;if(B-U<=E){for(let ht=U;ht<=B;ht++){const mt=x[2*ht],Tt=x[2*ht+1];mt>=i&&mt<=p&&Tt>=l&&Tt<=g&&M.push(_[ht])}continue}const H=U+B>>1,K=x[2*H],it=x[2*H+1];K>=i&&K<=p&&it>=l&&it<=g&&M.push(_[H]),(D===0?i<=K:l<=it)&&(T.push(U),T.push(H-1),T.push(1-D)),(D===0?p>=K:g>=it)&&(T.push(H+1),T.push(B),T.push(1-D))}return M}within(i,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:x}=this,E=[0,g.length-1,0],T=[],M=p*p;for(;E.length;){const D=E.pop()||0,B=E.pop()||0,U=E.pop()||0;if(B-U<=x){for(let ht=U;ht<=B;ht++)nE(_[2*ht],_[2*ht+1],i,l)<=M&&T.push(g[ht]);continue}const H=U+B>>1,K=_[2*H],it=_[2*H+1];nE(K,it,i,l)<=M&&T.push(g[H]),(D===0?i-p<=K:l-p<=it)&&(E.push(U),E.push(H-1),E.push(1-D)),(D===0?i+p>=K:l+p>=it)&&(E.push(H+1),E.push(B),E.push(1-D))}return T}}function c0(a,i,l,p,g,_){if(g-p<=l)return;const x=p+g>>1;eE(a,i,x,p,g,_),c0(a,i,l,p,x-1,1-_),c0(a,i,l,x+1,g,1-_)}function eE(a,i,l,p,g,_){for(;g>p;){if(g-p>600){const M=g-p+1,D=l-p+1,B=Math.log(M),U=.5*Math.exp(2*B/3),H=.5*Math.sqrt(B*U*(M-U)/M)*(D-M/2<0?-1:1);eE(a,i,l,Math.max(p,Math.floor(l-D*U/M+H)),Math.min(g,Math.floor(l+(M-D)*U/M+H)),_)}const x=i[2*l+_];let E=p,T=g;for(Eg(a,i,p,l),i[2*g+_]>x&&Eg(a,i,p,g);E<T;){for(Eg(a,i,E,T),E++,T--;i[2*E+_]<x;)E++;for(;i[2*T+_]>x;)T--}i[2*p+_]===x?Eg(a,i,p,T):(T++,Eg(a,i,T,g)),T<=l&&(p=T+1),l<=T&&(g=T-1)}}function Eg(a,i,l,p){h0(a,l,p),h0(i,2*l,2*p),h0(i,2*l+1,2*p+1)}function h0(a,i,l){const p=a[i];a[i]=a[l],a[l]=p}function nE(a,i,l,p){const g=a-l,_=i-p;return g*g+_*_}var p0;u.bh=void 0,(p0=u.bh||(u.bh={})).create="create",p0.load="load",p0.fullLoad="fullLoad";let xy=null,Sg=[];const f0=1e3/60,d0="loadTime",g0="fullLoadTime",NM={mark(a){performance.mark(a)},frame(a){const i=a;xy!=null&&Sg.push(i-xy),xy=i},clearMetrics(){xy=null,Sg=[],performance.clearMeasures(d0),performance.clearMeasures(g0);for(const a in u.bh)performance.clearMarks(u.bh[a])},getPerformanceMetrics(){performance.measure(d0,u.bh.create,u.bh.load),performance.measure(g0,u.bh.create,u.bh.fullLoad);const a=performance.getEntriesByName(d0)[0].duration,i=performance.getEntriesByName(g0)[0].duration,l=Sg.length,p=1/(Sg.reduce((_,x)=>_+x,0)/l/1e3),g=Sg.filter(_=>_>f0).reduce((_,x)=>_+(x-f0)/f0,0);return{loadTime:a,fullLoadTime:i,fps:p,percentDroppedFrames:g/(l+g)*100,totalFrames:l}}};u.$=function(a,i,l){var p,g,_,x,E,T,M,D,B,U,H,K,it=l[0],ht=l[1],mt=l[2];return i===a?(a[12]=i[0]*it+i[4]*ht+i[8]*mt+i[12],a[13]=i[1]*it+i[5]*ht+i[9]*mt+i[13],a[14]=i[2]*it+i[6]*ht+i[10]*mt+i[14],a[15]=i[3]*it+i[7]*ht+i[11]*mt+i[15]):(g=i[1],_=i[2],x=i[3],E=i[4],T=i[5],M=i[6],D=i[7],B=i[8],U=i[9],H=i[10],K=i[11],a[0]=p=i[0],a[1]=g,a[2]=_,a[3]=x,a[4]=E,a[5]=T,a[6]=M,a[7]=D,a[8]=B,a[9]=U,a[10]=H,a[11]=K,a[12]=p*it+E*ht+B*mt+i[12],a[13]=g*it+T*ht+U*mt+i[13],a[14]=_*it+M*ht+H*mt+i[14],a[15]=x*it+D*ht+K*mt+i[15]),a},u.A=Pf,u.B=xo,u.C=class{constructor(a,i,l){this.receive=p=>{const g=p.data,_=g.id;if(_&&(!g.targetMapId||this.mapId===g.targetMapId))if(g.type==="<cancel>"){delete this.tasks[_];const x=this.cancelCallbacks[_];delete this.cancelCallbacks[_],x&&x()}else hn()||g.mustQueue?(this.tasks[_]=g,this.taskQueue.push(_),this.invoker.trigger()):this.processTask(_,g)},this.process=()=>{if(!this.taskQueue.length)return;const p=this.taskQueue.shift(),g=this.tasks[p];delete this.tasks[p],this.taskQueue.length&&this.invoker.trigger(),g&&this.processTask(p,g)},this.target=a,this.parent=i,this.mapId=l,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new EM(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=hn()?a:window}send(a,i,l,p,g=!1){const _=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(this.callbacks[_]=l);const x=[],E={id:_,type:a,hasCallback:!!l,targetMapId:p,mustQueue:g,sourceMapId:this.mapId,data:_s(i,x)};return this.target.postMessage(E,{transfer:x}),{cancel:()=>{l&&delete this.callbacks[_],this.target.postMessage({id:_,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}processTask(a,i){if(i.type==="<response>"){const l=this.callbacks[a];delete this.callbacks[a],l&&(i.error?l(Ba(i.error)):l(null,Ba(i.data)))}else{let l=!1;const p=[],g=i.hasCallback?(E,T)=>{l=!0,delete this.cancelCallbacks[a];const M={id:a,type:"<response>",sourceMapId:this.mapId,error:E?_s(E):null,data:_s(T,p)};this.target.postMessage(M,{transfer:p})}:E=>{l=!0};let _=null;const x=Ba(i.data);if(this.parent[i.type])_=this.parent[i.type](i.sourceMapId,x,g);else if("getWorkerSource"in this.parent){const E=i.type.split(".");_=this.parent.getWorkerSource(i.sourceMapId,E[0],x.source)[E[1]](x,g)}else g(new Error(`Could not find function ${i.type}`));!l&&_&&_.cancel&&(this.cancelCallbacks[a]=_.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.D=Ze,u.E=ko,u.F=function(a,i){const l={};for(let p=0;p<i.length;p++){const g=i[p];g in a&&(l[g]=a[g])}return l},u.G=Lb,u.H=Ab,u.I=Yv,u.J=tt,u.K=Q,u.L=Mh,u.M=_n,u.N=Fi,u.O=Ua,u.P=O,u.Q=Zr,u.R=Va,u.S=Ar,u.T=Hm,u.U=gy,u.V=class extends wc{},u.W=s0,u.X=function(a,i){const l=window.document.createElement("video");l.muted=!0,l.onloadstart=function(){i(null,l)};for(let p=0;p<a.length;p++){const g=window.document.createElement("source");Dn(a[p])||(l.crossOrigin="Anonymous"),g.src=a[p],l.appendChild(g)}return{cancel:()=>{}}},u.Y=ce,u.Z=function(){var a=new Pf(16);return Pf!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},u._=w,u.a=Fe,u.a$=class extends Z{},u.a0=function(a,i,l){var p=l[0],g=l[1],_=l[2];return a[0]=i[0]*p,a[1]=i[1]*p,a[2]=i[2]*p,a[3]=i[3]*p,a[4]=i[4]*g,a[5]=i[5]*g,a[6]=i[6]*g,a[7]=i[7]*g,a[8]=i[8]*_,a[9]=i[9]*_,a[10]=i[10]*_,a[11]=i[11]*_,a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15],a},u.a1=Rw,u.a2=function(){return Ht++},u.a3=ut,u.a4=Df,u.a5=function(){$s.isLoading()||$s.isLoaded()||Jd()!=="deferred"||Wm()},u.a6=gh,u.a7=Np,u.a8=Lr,u.a9=Fb,u.aA=Tp,u.aB=function(a){a=a.slice();const i=Object.create(null);for(let l=0;l<a.length;l++)i[a[l].id]=a[l];for(let l=0;l<a.length;l++)"ref"in a[l]&&(a[l]=Rr(a[l],i[a[l].ref]));return a},u.aC=function(a){if(a.type==="custom")return new bM(a);switch(a.type){case"background":return new vM(a);case"circle":return new iP(a);case"fill":return new SP(a);case"fill-extrusion":return new BP(a);case"heatmap":return new sP(a);case"hillshade":return new lP(a);case"line":return new XP(a);case"raster":return new wM(a);case"symbol":return new dy(a)}},u.aD=ue,u.aE=function(a,i){if(!a)return[{command:En.setStyle,args:[i]}];let l=[];try{if(!Vn(a.version,i.version))return[{command:En.setStyle,args:[i]}];Vn(a.center,i.center)||l.push({command:En.setCenter,args:[i.center]}),Vn(a.zoom,i.zoom)||l.push({command:En.setZoom,args:[i.zoom]}),Vn(a.bearing,i.bearing)||l.push({command:En.setBearing,args:[i.bearing]}),Vn(a.pitch,i.pitch)||l.push({command:En.setPitch,args:[i.pitch]}),Vn(a.sprite,i.sprite)||l.push({command:En.setSprite,args:[i.sprite]}),Vn(a.glyphs,i.glyphs)||l.push({command:En.setGlyphs,args:[i.glyphs]}),Vn(a.transition,i.transition)||l.push({command:En.setTransition,args:[i.transition]}),Vn(a.light,i.light)||l.push({command:En.setLight,args:[i.light]});const p={},g=[];(function(x,E,T,M){let D;for(D in E=E||{},x=x||{})Object.prototype.hasOwnProperty.call(x,D)&&(Object.prototype.hasOwnProperty.call(E,D)||ao(D,T,M));for(D in E)Object.prototype.hasOwnProperty.call(E,D)&&(Object.prototype.hasOwnProperty.call(x,D)?Vn(x[D],E[D])||(x[D].type==="geojson"&&E[D].type==="geojson"&&Rs(x,E,D)?T.push({command:En.setGeoJSONSourceData,args:[D,E[D].data]}):vo(D,E,T,M)):$i(D,E,T))})(a.sources,i.sources,g,p);const _=[];a.layers&&a.layers.forEach(x=>{p[x.source]?l.push({command:En.removeLayer,args:[x.id]}):_.push(x)}),l=l.concat(g),function(x,E,T){E=E||[];const M=(x=x||[]).map(Kr),D=E.map(Kr),B=x.reduce(wi,{}),U=E.reduce(wi,{}),H=M.slice(),K=Object.create(null);let it,ht,mt,Tt,xt,Lt,Vt;for(it=0,ht=0;it<M.length;it++)mt=M[it],Object.prototype.hasOwnProperty.call(U,mt)?ht++:(T.push({command:En.removeLayer,args:[mt]}),H.splice(H.indexOf(mt,ht),1));for(it=0,ht=0;it<D.length;it++)mt=D[D.length-1-it],H[H.length-1-it]!==mt&&(Object.prototype.hasOwnProperty.call(B,mt)?(T.push({command:En.removeLayer,args:[mt]}),H.splice(H.lastIndexOf(mt,H.length-ht),1)):ht++,Lt=H[H.length-it],T.push({command:En.addLayer,args:[U[mt],Lt]}),H.splice(H.length-it,0,mt),K[mt]=!0);for(it=0;it<D.length;it++)if(mt=D[it],Tt=B[mt],xt=U[mt],!K[mt]&&!Vn(Tt,xt))if(Vn(Tt.source,xt.source)&&Vn(Tt["source-layer"],xt["source-layer"])&&Vn(Tt.type,xt.type)){for(Vt in No(Tt.layout,xt.layout,T,mt,null,En.setLayoutProperty),No(Tt.paint,xt.paint,T,mt,null,En.setPaintProperty),Vn(Tt.filter,xt.filter)||T.push({command:En.setFilter,args:[mt,xt.filter]}),Vn(Tt.minzoom,xt.minzoom)&&Vn(Tt.maxzoom,xt.maxzoom)||T.push({command:En.setLayerZoomRange,args:[mt,xt.minzoom,xt.maxzoom]}),Tt)Object.prototype.hasOwnProperty.call(Tt,Vt)&&Vt!=="layout"&&Vt!=="paint"&&Vt!=="filter"&&Vt!=="metadata"&&Vt!=="minzoom"&&Vt!=="maxzoom"&&(Vt.indexOf("paint.")===0?No(Tt[Vt],xt[Vt],T,mt,Vt.slice(6),En.setPaintProperty):Vn(Tt[Vt],xt[Vt])||T.push({command:En.setLayerProperty,args:[mt,Vt,xt[Vt]]}));for(Vt in xt)Object.prototype.hasOwnProperty.call(xt,Vt)&&!Object.prototype.hasOwnProperty.call(Tt,Vt)&&Vt!=="layout"&&Vt!=="paint"&&Vt!=="filter"&&Vt!=="metadata"&&Vt!=="minzoom"&&Vt!=="maxzoom"&&(Vt.indexOf("paint.")===0?No(Tt[Vt],xt[Vt],T,mt,Vt.slice(6),En.setPaintProperty):Vn(Tt[Vt],xt[Vt])||T.push({command:En.setLayerProperty,args:[mt,Vt,xt[Vt]]}))}else T.push({command:En.removeLayer,args:[mt]}),Lt=H[H.lastIndexOf(mt)+1],T.push({command:En.addLayer,args:[xt,Lt]})}(_,i.layers,l)}catch(p){console.warn("Unable to compute style diff:",p),l=[{command:En.setStyle,args:[i]}]}return l},u.aF=function(a){const i=[],l=a.id;return l===void 0&&i.push({message:`layers.${l}: missing required property "id"`}),a.render===void 0&&i.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&i.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),i},u.aG=function a(i,l){if(Array.isArray(i)){if(!Array.isArray(l)||i.length!==l.length)return!1;for(let p=0;p<i.length;p++)if(!a(i[p],l[p]))return!1;return!0}if(typeof i=="object"&&i!==null&&l!==null){if(typeof l!="object"||Object.keys(i).length!==Object.keys(l).length)return!1;for(const p in i)if(!a(i[p],l[p]))return!1;return!0}return i===l},u.aH=Xt,u.aI=De,u.aJ=Pp,u.aK=function(a){return a({pluginStatus:vs,pluginURL:zu}),Pp.on("pluginStateChange",a),a},u.aL=class extends Sc{constructor(a,i){super(a,i),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},u.aM=Cf,u.aN=class extends Sc{constructor(a,i){super(a,i),this.current=Pv}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let i=1;i<16;i++)if(a[i]!==this.current[i]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},u.aO=Qm,u.aP=class extends Sc{constructor(a,i){super(a,i),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},u.aQ=class extends Sc{constructor(a,i){super(a,i),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},u.aR=ty,u.aS=function(a,i,l,p,g,_,x){var E=1/(i-l),T=1/(p-g),M=1/(_-x);return a[0]=-2*E,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*M,a[11]=0,a[12]=(i+l)*E,a[13]=(g+p)*T,a[14]=(x+_)*M,a[15]=1,a},u.aT=Sn,u.aU=rP,u.aV=class extends d{},u.aW=KP,u.aX=class extends v{},u.aY=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},u.aZ=Vw,u.a_=ge,u.aa=function(a){const i={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,p,g,_)=>{const x=g||_;return i[p]=!x||x.toLowerCase(),""}),i["max-age"]){const l=parseInt(i["max-age"],10);isNaN(l)?delete i["max-age"]:i["max-age"]=l}return i},u.ab=function(a,i){const l=[];for(const p in a)p in i||l.push(p);return l},u.ac=function(a){if(he==null){const i=a.navigator?a.navigator.userAgent:null;he=!!a.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return he},u.ad=zt,u.ae=function(a,i,l){var p=Math.sin(l),g=Math.cos(l),_=i[0],x=i[1],E=i[2],T=i[3],M=i[4],D=i[5],B=i[6],U=i[7];return i!==a&&(a[8]=i[8],a[9]=i[9],a[10]=i[10],a[11]=i[11],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[0]=_*g+M*p,a[1]=x*g+D*p,a[2]=E*g+B*p,a[3]=T*g+U*p,a[4]=M*g-_*p,a[5]=D*g-x*p,a[6]=B*g-E*p,a[7]=U*g-T*p,a},u.af=function(a){var i=new Pf(16);return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],i},u.ag=iy,u.ah=function(a,i){let l=0,p=0;if(a.kind==="constant")p=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:g,minZoom:_,maxZoom:x}=a,E=g?zt(Oo.interpolationFactor(g,i,_,x),0,1):0;a.kind==="camera"?p=xo.number(a.minSize,a.maxSize,E):l=E}return{uSizeT:l,uSize:p}},u.aj=function(a,{uSize:i,uSizeT:l},{lowerSize:p,upperSize:g}){return a.kind==="source"?p/Bu:a.kind==="composite"?xo.number(p/Bu,g/Bu,l):i},u.ak=t0,u.al=function(a,i,l,p){const g=i.y-a.y,_=i.x-a.x,x=p.y-l.y,E=p.x-l.x,T=x*_-E*g;if(T===0)return null;const M=(E*(a.y-l.y)-x*(a.x-l.x))/T;return new O(a.x+M*_,a.y+M*g)},u.am=$b,u.an=Mw,u.ao=Nv,u.ap=Yi,u.ar=Qv,u.as=function(a,i){var l=i[0],p=i[1],g=i[2],_=i[3],x=i[4],E=i[5],T=i[6],M=i[7],D=i[8],B=i[9],U=i[10],H=i[11],K=i[12],it=i[13],ht=i[14],mt=i[15],Tt=l*E-p*x,xt=l*T-g*x,Lt=l*M-_*x,Vt=p*T-g*E,ee=p*M-_*E,ke=g*M-_*T,Ve=D*it-B*K,Ae=D*ht-U*K,Ce=D*mt-H*K,_e=B*ht-U*it,Re=B*mt-H*it,we=U*mt-H*ht,le=Tt*we-xt*Re+Lt*_e+Vt*Ce-ee*Ae+ke*Ve;return le?(a[0]=(E*we-T*Re+M*_e)*(le=1/le),a[1]=(g*Re-p*we-_*_e)*le,a[2]=(it*ke-ht*ee+mt*Vt)*le,a[3]=(U*ee-B*ke-H*Vt)*le,a[4]=(T*Ce-x*we-M*Ae)*le,a[5]=(l*we-g*Ce+_*Ae)*le,a[6]=(ht*Lt-K*ke-mt*xt)*le,a[7]=(D*ke-U*Lt+H*xt)*le,a[8]=(x*Re-E*Ce+M*Ve)*le,a[9]=(p*Ce-l*Re-_*Ve)*le,a[10]=(K*ee-it*Lt+mt*Tt)*le,a[11]=(B*Lt-D*ee-H*Tt)*le,a[12]=(E*Ae-x*_e-T*Ve)*le,a[13]=(l*_e-p*Ae+g*Ve)*le,a[14]=(it*xt-K*Vt-ht*Tt)*le,a[15]=(D*Vt-B*xt+U*Tt)*le,a):null},u.at=l0,u.au=Jv,u.av=u0,u.aw=function(){const a={},i=qt.$version;for(const l in qt.$root){const p=qt.$root[l];if(p.required){let g=null;g=l==="version"?i:p.type==="array"?[]:{},g!=null&&(a[l]=g)}}return a},u.ax=En,u.ay=tu,u.az=Te,u.b=function(a,i){const l=new Blob([new Uint8Array(a)],{type:"image/png"});createImageBitmap(l).then(p=>{i(null,p)}).catch(p=>{i(new Error(`Could not load image because of ${p.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},u.b0=bo,u.b1=function(a,i){var l=a[0],p=a[1],g=a[2],_=a[3],x=a[4],E=a[5],T=a[6],M=a[7],D=a[8],B=a[9],U=a[10],H=a[11],K=a[12],it=a[13],ht=a[14],mt=a[15],Tt=i[0],xt=i[1],Lt=i[2],Vt=i[3],ee=i[4],ke=i[5],Ve=i[6],Ae=i[7],Ce=i[8],_e=i[9],Re=i[10],we=i[11],le=i[12],Je=i[13],je=i[14],Cn=i[15];return Math.abs(l-Tt)<=ws*Math.max(1,Math.abs(l),Math.abs(Tt))&&Math.abs(p-xt)<=ws*Math.max(1,Math.abs(p),Math.abs(xt))&&Math.abs(g-Lt)<=ws*Math.max(1,Math.abs(g),Math.abs(Lt))&&Math.abs(_-Vt)<=ws*Math.max(1,Math.abs(_),Math.abs(Vt))&&Math.abs(x-ee)<=ws*Math.max(1,Math.abs(x),Math.abs(ee))&&Math.abs(E-ke)<=ws*Math.max(1,Math.abs(E),Math.abs(ke))&&Math.abs(T-Ve)<=ws*Math.max(1,Math.abs(T),Math.abs(Ve))&&Math.abs(M-Ae)<=ws*Math.max(1,Math.abs(M),Math.abs(Ae))&&Math.abs(D-Ce)<=ws*Math.max(1,Math.abs(D),Math.abs(Ce))&&Math.abs(B-_e)<=ws*Math.max(1,Math.abs(B),Math.abs(_e))&&Math.abs(U-Re)<=ws*Math.max(1,Math.abs(U),Math.abs(Re))&&Math.abs(H-we)<=ws*Math.max(1,Math.abs(H),Math.abs(we))&&Math.abs(K-le)<=ws*Math.max(1,Math.abs(K),Math.abs(le))&&Math.abs(it-Je)<=ws*Math.max(1,Math.abs(it),Math.abs(Je))&&Math.abs(ht-je)<=ws*Math.max(1,Math.abs(ht),Math.abs(je))&&Math.abs(mt-Cn)<=ws*Math.max(1,Math.abs(mt),Math.abs(Cn))},u.b2=function(a,i){return a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[3],a[4]=i[4],a[5]=i[5],a[6]=i[6],a[7]=i[7],a[8]=i[8],a[9]=i[9],a[10]=i[10],a[11]=i[11],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15],a},u.b3=function(a,i,l){return a[0]=i[0]*l[0],a[1]=i[1]*l[1],a[2]=i[2]*l[2],a[3]=i[3]*l[3],a},u.b4=function(a,i){return a[0]*i[0]+a[1]*i[1]+a[2]*i[2]+a[3]*i[3]},u.b5=Rt,u.b6=Rb,u.b7=kb,u.b8=function(a,i,l,p,g){var _,x=1/Math.tan(i/2);return a[0]=x/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=x,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,g!=null&&g!==1/0?(a[10]=(g+p)*(_=1/(p-g)),a[14]=2*g*p*_):(a[10]=-1,a[14]=-2*p),a},u.b9=function(a,i,l){var p=Math.sin(l),g=Math.cos(l),_=i[4],x=i[5],E=i[6],T=i[7],M=i[8],D=i[9],B=i[10],U=i[11];return i!==a&&(a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[3],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[4]=_*g+M*p,a[5]=x*g+D*p,a[6]=E*g+B*p,a[7]=T*g+U*p,a[8]=M*g-_*p,a[9]=D*g-x*p,a[10]=B*g-E*p,a[11]=U*g-T*p,a},u.bA=A,u.bB=ab,u.bC=fh,u.bD=$s,u.ba=_t,u.bb=Ot,u.bc=function(a,i){return a[0]=i[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=i[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=i[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},u.bd=class extends Ap{},u.be=i0,u.bf=Nb,u.bg=NM,u.bi=Dr,u.bj=function(a,i,l=!1){if(vs===Xd||vs===Wd||vs===Hd)throw new Error("setRTLTextPlugin cannot be called multiple times.");zu=Wn.resolveURL(a),vs=Xd,Yd=i,Kd(),l||Wm()},u.bk=Jd,u.bl=function(a,i){const l={};for(let g=0;g<a.length;g++){const _=i&&i[a[g].id]||Ql(a[g]);i&&(i[a[g].id]=_);let x=l[_];x||(x=l[_]=[]),x.push(a[g])}const p=[];for(const g in l)p.push(l[g]);return p},u.bm=Pe,u.bn=zb,u.bo=Bb,u.bp=mb,u.bq=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Fi/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const i=a.bucket.layers[0],l=i.layout,p=i._unevaluatedLayout._values,g={layoutIconSize:p["icon-size"].possiblyEvaluate(new Lr(a.bucket.zoom+1),a.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new Lr(a.bucket.zoom+1),a.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new Lr(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:D}=a.bucket.textSizeData;g.compositeTextSizes=[p["text-size"].possiblyEvaluate(new Lr(M),a.canonical),p["text-size"].possiblyEvaluate(new Lr(D),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:D}=a.bucket.iconSizeData;g.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new Lr(M),a.canonical),p["icon-size"].possiblyEvaluate(new Lr(D),a.canonical)]}const _=l.get("text-line-height")*Yi,x=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",E=l.get("text-keep-upright"),T=l.get("text-size");for(const M of a.bucket.features){const D=l.get("text-font").evaluate(M,{},a.canonical).join(","),B=T.evaluate(M,{},a.canonical),U=g.layoutTextSize.evaluate(M,{},a.canonical),H=g.layoutIconSize.evaluate(M,{},a.canonical),K={horizontal:{},vertical:void 0},it=M.text;let ht,mt=[0,0];if(it){const Lt=it.toString(),Vt=l.get("text-letter-spacing").evaluate(M,{},a.canonical)*Yi,ee=Ru(Lt)?Vt:0,ke=l.get("text-anchor").evaluate(M,{},a.canonical),Ve=Kb(i,M,a.canonical);if(!Ve){const we=l.get("text-radial-offset").evaluate(M,{},a.canonical);mt=we?Yb(ke,[we*Yi,a0]):l.get("text-offset").evaluate(M,{},a.canonical).map(le=>le*Yi)}let Ae=x?"center":l.get("text-justify").evaluate(M,{},a.canonical);const Ce=l.get("symbol-placement"),_e=Ce==="point"?l.get("text-max-width").evaluate(M,{},a.canonical)*Yi:0,Re=()=>{a.bucket.allowVerticalPlacement&&wh(Lt)&&(K.vertical=hy(it,a.glyphMap,a.glyphPositions,a.imagePositions,D,_e,_,ke,"left",ee,mt,u.ai.vertical,!0,Ce,U,B))};if(!x&&Ve){const we=new Set;if(Ae==="auto")for(let Je=0;Je<Ve.values.length;Je+=2)we.add(l0(Ve.values[Je]));else we.add(Ae);let le=!1;for(const Je of we)if(!K.horizontal[Je])if(le)K.horizontal[Je]=K.horizontal[0];else{const je=hy(it,a.glyphMap,a.glyphPositions,a.imagePositions,D,_e,_,"center",Je,ee,mt,u.ai.horizontal,!1,Ce,U,B);je&&(K.horizontal[Je]=je,le=je.positionedLines.length===1)}Re()}else{Ae==="auto"&&(Ae=l0(ke));const we=hy(it,a.glyphMap,a.glyphPositions,a.imagePositions,D,_e,_,ke,Ae,ee,mt,u.ai.horizontal,!1,Ce,U,B);we&&(K.horizontal[Ae]=we),Re(),wh(Lt)&&x&&E&&(K.vertical=hy(it,a.glyphMap,a.glyphPositions,a.imagePositions,D,_e,_,ke,Ae,ee,mt,u.ai.vertical,!1,Ce,U,B))}}let Tt=!1;if(M.icon&&M.icon.name){const Lt=a.imageMap[M.icon.name];Lt&&(ht=dM(a.imagePositions[M.icon.name],l.get("icon-offset").evaluate(M,{},a.canonical),l.get("icon-anchor").evaluate(M,{},a.canonical)),Tt=!!Lt.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=Tt:a.bucket.sdfIcons!==Tt&&Gt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Lt.pixelRatio!==a.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const xt=Qb(K.horizontal)||K.vertical;a.bucket.iconsInText=!!xt&&xt.iconsInText,(xt||ht)&&AM(a.bucket,M,K,ht,a.imageMap,g,U,H,mt,Tt,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},u.br=Zv,u.bs=Gv,u.bt=qv,u.bu=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},u.bv=Wv,u.bw=Ch,u.bx=function(a,i,l,p,g){return w(this,void 0,void 0,function*(){if(Q())try{return yield _n(a,i,l,p,g)}catch{}return function(_,x,E,T,M){const D=_.width,B=_.height;mn&&Ke||(mn=new OffscreenCanvas(D,B),Ke=mn.getContext("2d",{willReadFrequently:!0})),mn.width=D,mn.height=B,Ke.drawImage(_,0,0,D,B);const U=Ke.getImageData(x,E,T,M);return Ke.clearRect(0,0,D,B),U.data}(a,i,l,p,g)})},u.by=Ob,u.bz=S,u.c=_o,u.d=function(a,i){const l=new Image;l.onload=()=>{i(null,l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=Qe})},l.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(a)],{type:"image/png"});l.src=a.byteLength?URL.createObjectURL(p):Qe},u.e=At,u.f=function(a,i){return es(At(a,{type:"json"}),i)},u.g=Oe,u.h=Wn,u.i=hn,u.j=Ui,u.k=Di,u.l=xi,u.m=es,u.n=function(a){return new Wv(a).readFields(lM,[])},u.o=function(a,i,l){if(!a.length)return l(null,[]);let p=a.length;const g=new Array(a.length);let _=null;a.forEach((x,E)=>{i(x,(T,M)=>{T&&(_=T),g[E]=M,--p==0&&l(_,g)})})},u.p=gb,u.q=hg,u.r=bi,u.s=Dn,u.t=gr,u.u=xe,u.v=qt,u.w=Gt,u.x=Vs,u.y=Fa,u.z=function([a,i,l]){return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:a*Math.cos(i)*Math.sin(l),y:a*Math.sin(i)*Math.sin(l),z:a*Math.cos(l)}}}),c(["./shared"],function(u){class w{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,G){for(const at of V){this._layerConfigs[at.id]=at;const lt=this._layers[at.id]=u.aC(at);lt._featureFilter=u.a6(lt.filter),this.keyCache[at.id]&&delete this.keyCache[at.id]}for(const at of G)delete this.keyCache[at],delete this._layerConfigs[at],delete this._layers[at];this.familiesBySource={};const et=u.bl(Object.values(this._layerConfigs),this.keyCache);for(const at of et){const lt=at.map(Kt=>this._layers[Kt.id]),It=lt[0];if(It.visibility==="none")continue;const vt=It.source||"";let dt=this.familiesBySource[vt];dt||(dt=this.familiesBySource[vt]={});const bt=It.sourceLayer||"_geojsonTileLayer";let Yt=dt[bt];Yt||(Yt=dt[bt]=[]),Yt.push(lt)}}}class S{constructor(V){const G={},et=[];for(const vt in V){const dt=V[vt],bt=G[vt]={};for(const Yt in dt){const Kt=dt[+Yt];if(!Kt||Kt.bitmap.width===0||Kt.bitmap.height===0)continue;const Jt={x:0,y:0,w:Kt.bitmap.width+2,h:Kt.bitmap.height+2};et.push(Jt),bt[Yt]={rect:Jt,metrics:Kt.metrics}}}const{w:at,h:lt}=u.p(et),It=new u.q({width:at||1,height:lt||1});for(const vt in V){const dt=V[vt];for(const bt in dt){const Yt=dt[+bt];if(!Yt||Yt.bitmap.width===0||Yt.bitmap.height===0)continue;const Kt=G[vt][bt].rect;u.q.copy(Yt.bitmap,It,{x:0,y:0},{x:Kt.x+1,y:Kt.y+1},Yt.bitmap)}}this.image=It,this.positions=G}}u.bm("GlyphAtlas",S);class A{constructor(V){this.tileID=new u.O(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(V,G,et,at,lt){this.status="parsing",this.data=V,this.collisionBoxArray=new u.a3;const It=new u.bn(Object.keys(V.layers).sort()),vt=new u.bo(this.tileID,this.promoteId);vt.bucketLayerIDs=[];const dt={},bt={featureIndex:vt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:et},Yt=G.familiesBySource[this.source];for(const Qt in Yt){const Ut=V.layers[Qt];if(!Ut)continue;Ut.version===1&&u.w(`Vector tile source "${this.source}" layer "${Qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ie=It.encode(Qt),oe=[];for(let ze=0;ze<Ut.length;ze++){const qe=Ut.feature(ze),fn=vt.getId(qe,Qt);oe.push({feature:qe,id:fn,index:ze,sourceLayerIndex:ie})}for(const ze of Yt[Qt]){const qe=ze[0];qe.source!==this.source&&u.w(`layer.source = ${qe.source} does not equal this.source = ${this.source}`),qe.minzoom&&this.zoom<Math.floor(qe.minzoom)||qe.maxzoom&&this.zoom>=qe.maxzoom||qe.visibility!=="none"&&(N(ze,this.zoom,et),(dt[qe.id]=qe.createBucket({index:vt.bucketLayerIDs.length,layers:ze,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ie,sourceID:this.source})).populate(oe,bt,this.tileID.canonical),vt.bucketLayerIDs.push(ze.map(fn=>fn.id)))}}let Kt,Jt,z,$;const Y=u.aH(bt.glyphDependencies,Qt=>Object.keys(Qt).map(Number));this.inFlightDependencies.forEach(Qt=>Qt==null?void 0:Qt.cancel()),this.inFlightDependencies=[];const yt=++this.dependencySentinel;Object.keys(Y).length?this.inFlightDependencies.push(at.send("getGlyphs",{uid:this.uid,stacks:Y,source:this.source,tileID:this.tileID,type:"glyphs"},(Qt,Ut)=>{yt===this.dependencySentinel&&(Kt||(Kt=Qt,Jt=Ut,Nt.call(this)))})):Jt={};const gt=Object.keys(bt.iconDependencies);gt.length?this.inFlightDependencies.push(at.send("getImages",{icons:gt,source:this.source,tileID:this.tileID,type:"icons"},(Qt,Ut)=>{yt===this.dependencySentinel&&(Kt||(Kt=Qt,z=Ut,Nt.call(this)))})):z={};const Mt=Object.keys(bt.patternDependencies);function Nt(){if(Kt)return lt(Kt);if(Jt&&z&&$){const Qt=new S(Jt),Ut=new u.bp(z,$);for(const ie in dt){const oe=dt[ie];oe instanceof u.a4?(N(oe.layers,this.zoom,et),u.bq({bucket:oe,glyphMap:Jt,glyphPositions:Qt.positions,imageMap:z,imagePositions:Ut.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):oe.hasPattern&&(oe instanceof u.br||oe instanceof u.bs||oe instanceof u.bt)&&(N(oe.layers,this.zoom,et),oe.addFeatures(bt,this.tileID.canonical,Ut.patternPositions))}this.status="done",lt(null,{buckets:Object.values(dt).filter(ie=>!ie.isEmpty()),featureIndex:vt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Qt.image,imageAtlas:Ut,glyphMap:this.returnDependencies?Jt:null,iconMap:this.returnDependencies?z:null,glyphPositions:this.returnDependencies?Qt.positions:null})}}Mt.length?this.inFlightDependencies.push(at.send("getImages",{icons:Mt,source:this.source,tileID:this.tileID,type:"patterns"},(Qt,Ut)=>{yt===this.dependencySentinel&&(Kt||(Kt=Qt,$=Ut,Nt.call(this)))})):$={},Nt.call(this)}}function N(q,V,G){const et=new u.a8(V);for(const at of q)at.recalculate(et,G)}function O(q,V){const G=u.l(q.request,(et,at,lt,It)=>{if(et)V(et);else if(at)try{const vt=new u.bw.VectorTile(new u.bv(at));V(null,{vectorTile:vt,rawData:at,cacheControl:lt,expires:It})}catch(vt){const dt=new Uint8Array(at);let bt=`Unable to parse the tile at ${q.request.url}, `;bt+=dt[0]===31&&dt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${vt.messge}`,V(new Error(bt))}});return()=>{G.cancel(),V()}}class j{constructor(V,G,et,at){this.actor=V,this.layerIndex=G,this.availableImages=et,this.loadVectorData=at||O,this.fetching={},this.loading={},this.loaded={}}loadTile(V,G){const et=V.uid;this.loading||(this.loading={});const at=!!(V&&V.request&&V.request.collectResourceTiming)&&new u.bu(V.request),lt=this.loading[et]=new A(V);lt.abort=this.loadVectorData(V,(It,vt)=>{if(delete this.loading[et],It||!vt)return lt.status="done",this.loaded[et]=lt,G(It);const dt=vt.rawData,bt={};vt.expires&&(bt.expires=vt.expires),vt.cacheControl&&(bt.cacheControl=vt.cacheControl);const Yt={};if(at){const Kt=at.finish();Kt&&(Yt.resourceTiming=JSON.parse(JSON.stringify(Kt)))}lt.vectorTile=vt.vectorTile,lt.parse(vt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Kt,Jt)=>{if(delete this.fetching[et],Kt||!Jt)return G(Kt);G(null,u.e({rawTileData:dt.slice(0)},Jt,bt,Yt))}),this.loaded=this.loaded||{},this.loaded[et]=lt,this.fetching[et]={rawTileData:dt,cacheControl:bt,resourceTiming:Yt}})}reloadTile(V,G){const et=this.loaded,at=V.uid;if(et&&et[at]){const lt=et[at];lt.showCollisionBoxes=V.showCollisionBoxes,lt.status==="parsing"?lt.parse(lt.vectorTile,this.layerIndex,this.availableImages,this.actor,(It,vt)=>{if(It||!vt)return G(It,vt);let dt;if(this.fetching[at]){const{rawTileData:bt,cacheControl:Yt,resourceTiming:Kt}=this.fetching[at];delete this.fetching[at],dt=u.e({rawTileData:bt.slice(0)},vt,Yt,Kt)}else dt=vt;G(null,dt)}):lt.status==="done"&&(lt.vectorTile?lt.parse(lt.vectorTile,this.layerIndex,this.availableImages,this.actor,G):G())}}abortTile(V,G){const et=this.loading,at=V.uid;et&&et[at]&&et[at].abort&&(et[at].abort(),delete et[at]),G()}removeTile(V,G){const et=this.loaded,at=V.uid;et&&et[at]&&delete et[at],G()}}class W{constructor(){this.loaded={}}loadTile(V,G){return u._(this,void 0,void 0,function*(){const{uid:et,encoding:at,rawImageData:lt,redFactor:It,greenFactor:vt,blueFactor:dt,baseShift:bt}=V,Yt=lt.width+2,Kt=lt.height+2,Jt=u.a(lt)?new u.R({width:Yt,height:Kt},yield u.bx(lt,-1,-1,Yt,Kt)):lt,z=new u.by(et,Jt,at,It,vt,dt,bt);this.loaded=this.loaded||{},this.loaded[et]=z,G(null,z)})}removeTile(V){const G=this.loaded,et=V.uid;G&&G[et]&&delete G[et]}}function nt(q,V){if(q.length!==0){pt(q[0],V);for(var G=1;G<q.length;G++)pt(q[G],!V)}}function pt(q,V){for(var G=0,et=0,at=0,lt=q.length,It=lt-1;at<lt;It=at++){var vt=(q[at][0]-q[It][0])*(q[It][1]+q[at][1]),dt=G+vt;et+=Math.abs(G)>=Math.abs(vt)?G-dt+vt:vt-dt+G,G=dt}G+et>=0!=!!V&&q.reverse()}var J=u.bz(function q(V,G){var et,at=V&&V.type;if(at==="FeatureCollection")for(et=0;et<V.features.length;et++)q(V.features[et],G);else if(at==="GeometryCollection")for(et=0;et<V.geometries.length;et++)q(V.geometries[et],G);else if(at==="Feature")q(V.geometry,G);else if(at==="Polygon")nt(V.coordinates,G);else if(at==="MultiPolygon")for(et=0;et<V.coordinates.length;et++)nt(V.coordinates[et],G);return V});const tt=u.bw.VectorTileFeature.prototype.toGeoJSON;var Q={exports:{}},_t=u.bA,Ot=u.bw.VectorTileFeature,zt=Rt;function Rt(q,V){this.options=V||{},this.features=q,this.length=q.length}function At(q,V){this.id=typeof q.id=="number"?q.id:void 0,this.type=q.type,this.rawGeometry=q.type===1?[q.geometry]:q.geometry,this.properties=q.tags,this.extent=V||4096}Rt.prototype.feature=function(q){return new At(this.features[q],this.options.extent)},At.prototype.loadGeometry=function(){var q=this.rawGeometry;this.geometry=[];for(var V=0;V<q.length;V++){for(var G=q[V],et=[],at=0;at<G.length;at++)et.push(new _t(G[at][0],G[at][1]));this.geometry.push(et)}return this.geometry},At.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var q=this.geometry,V=1/0,G=-1/0,et=1/0,at=-1/0,lt=0;lt<q.length;lt++)for(var It=q[lt],vt=0;vt<It.length;vt++){var dt=It[vt];V=Math.min(V,dt.x),G=Math.max(G,dt.x),et=Math.min(et,dt.y),at=Math.max(at,dt.y)}return[V,et,G,at]},At.prototype.toGeoJSON=Ot.prototype.toGeoJSON;var Ht=u.bB,Xt=zt;function De(q){var V=new Ht;return function(G,et){for(var at in G.layers)et.writeMessage(3,ue,G.layers[at])}(q,V),V.finish()}function ue(q,V){var G;V.writeVarintField(15,q.version||1),V.writeStringField(1,q.name||""),V.writeVarintField(5,q.extent||4096);var et={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<q.length;G++)et.feature=q.feature(G),V.writeMessage(2,on,et);var at=et.keys;for(G=0;G<at.length;G++)V.writeStringField(3,at[G]);var lt=et.values;for(G=0;G<lt.length;G++)V.writeMessage(4,he,lt[G])}function on(q,V){var G=q.feature;G.id!==void 0&&V.writeVarintField(1,G.id),V.writeMessage(2,Gt,q),V.writeVarintField(3,G.type),V.writeMessage(4,hn,G)}function Gt(q,V){var G=q.feature,et=q.keys,at=q.values,lt=q.keycache,It=q.valuecache;for(var vt in G.properties){var dt=G.properties[vt],bt=lt[vt];if(dt!==null){bt===void 0&&(et.push(vt),lt[vt]=bt=et.length-1),V.writeVarint(bt);var Yt=typeof dt;Yt!=="string"&&Yt!=="boolean"&&Yt!=="number"&&(dt=JSON.stringify(dt));var Kt=Yt+":"+dt,Jt=It[Kt];Jt===void 0&&(at.push(dt),It[Kt]=Jt=at.length-1),V.writeVarint(Jt)}}}function ye(q,V){return(V<<3)+(7&q)}function Ue(q){return q<<1^q>>31}function hn(q,V){for(var G=q.loadGeometry(),et=q.type,at=0,lt=0,It=G.length,vt=0;vt<It;vt++){var dt=G[vt],bt=1;et===1&&(bt=dt.length),V.writeVarint(ye(1,bt));for(var Yt=et===3?dt.length-1:dt.length,Kt=0;Kt<Yt;Kt++){Kt===1&&et!==1&&V.writeVarint(ye(2,Yt-1));var Jt=dt[Kt].x-at,z=dt[Kt].y-lt;V.writeVarint(Ue(Jt)),V.writeVarint(Ue(z)),at+=Jt,lt+=z}et===3&&V.writeVarint(ye(7,1))}}function he(q,V){var G=typeof q;G==="string"?V.writeStringField(1,q):G==="boolean"?V.writeBooleanField(7,q):G==="number"&&(q%1!=0?V.writeDoubleField(3,q):q<0?V.writeSVarintField(6,q):V.writeVarintField(5,q))}Q.exports=De,Q.exports.fromVectorTileJs=De,Q.exports.fromGeojsonVt=function(q,V){V=V||{};var G={};for(var et in q)G[et]=new Xt(q[et].features,V),G[et].name=et,G[et].version=V.version,G[et].extent=V.extent;return De({layers:G})},Q.exports.GeoJSONWrapper=Xt;var Fe=u.bz(Q.exports);const Qe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:q=>q},_n=Math.fround||(mn=new Float32Array(1),q=>(mn[0]=+q,mn[0]));var mn;const Ke=3,pn=5,Xn=6;class Wn{constructor(V){this.options=Object.assign(Object.create(Qe),V),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(V){const{log:G,minZoom:et,maxZoom:at}=this.options;G&&console.time("total time");const lt=`prepare ${V.length} points`;G&&console.time(lt),this.points=V;const It=[];for(let dt=0;dt<V.length;dt++){const bt=V[dt];if(!bt.geometry)continue;const[Yt,Kt]=bt.geometry.coordinates,Jt=_n(Te(Yt)),z=_n(Oe(Kt));It.push(Jt,z,1/0,dt,-1,1),this.options.reduce&&It.push(0)}let vt=this.trees[at+1]=this._createTree(It);G&&console.timeEnd(lt);for(let dt=at;dt>=et;dt--){const bt=+Date.now();vt=this.trees[dt]=this._createTree(this._cluster(vt,dt)),G&&console.log("z%d: %d clusters in %dms",dt,vt.numItems,+Date.now()-bt)}return G&&console.timeEnd("total time"),this}getClusters(V,G){let et=((V[0]+180)%360+360)%360-180;const at=Math.max(-90,Math.min(90,V[1]));let lt=V[2]===180?180:((V[2]+180)%360+360)%360-180;const It=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)et=-180,lt=180;else if(et>lt){const Kt=this.getClusters([et,at,180,It],G),Jt=this.getClusters([-180,at,lt,It],G);return Kt.concat(Jt)}const vt=this.trees[this._limitZoom(G)],dt=vt.range(Te(et),Oe(It),Te(lt),Oe(at)),bt=vt.data,Yt=[];for(const Kt of dt){const Jt=this.stride*Kt;Yt.push(bt[Jt+pn]>1?_o(bt,Jt,this.clusterProps):this.points[bt[Jt+Ke]])}return Yt}getChildren(V){const G=this._getOriginId(V),et=this._getOriginZoom(V),at="No cluster with the specified id.",lt=this.trees[et];if(!lt)throw new Error(at);const It=lt.data;if(G*this.stride>=It.length)throw new Error(at);const vt=this.options.radius/(this.options.extent*Math.pow(2,et-1)),dt=lt.within(It[G*this.stride],It[G*this.stride+1],vt),bt=[];for(const Yt of dt){const Kt=Yt*this.stride;It[Kt+4]===V&&bt.push(It[Kt+pn]>1?_o(It,Kt,this.clusterProps):this.points[It[Kt+Ke]])}if(bt.length===0)throw new Error(at);return bt}getLeaves(V,G,et){const at=[];return this._appendLeaves(at,V,G=G||10,et=et||0,0),at}getTile(V,G,et){const at=this.trees[this._limitZoom(V)],lt=Math.pow(2,V),{extent:It,radius:vt}=this.options,dt=vt/It,bt=(et-dt)/lt,Yt=(et+1+dt)/lt,Kt={features:[]};return this._addTileFeatures(at.range((G-dt)/lt,bt,(G+1+dt)/lt,Yt),at.data,G,et,lt,Kt),G===0&&this._addTileFeatures(at.range(1-dt/lt,bt,1,Yt),at.data,lt,et,lt,Kt),G===lt-1&&this._addTileFeatures(at.range(0,bt,dt/lt,Yt),at.data,-1,et,lt,Kt),Kt.features.length?Kt:null}getClusterExpansionZoom(V){let G=this._getOriginZoom(V)-1;for(;G<=this.options.maxZoom;){const et=this.getChildren(V);if(G++,et.length!==1)break;V=et[0].properties.cluster_id}return G}_appendLeaves(V,G,et,at,lt){const It=this.getChildren(G);for(const vt of It){const dt=vt.properties;if(dt&&dt.cluster?lt+dt.point_count<=at?lt+=dt.point_count:lt=this._appendLeaves(V,dt.cluster_id,et,at,lt):lt<at?lt++:V.push(vt),V.length===et)break}return lt}_createTree(V){const G=new u.av(V.length/this.stride|0,this.options.nodeSize,Float32Array);for(let et=0;et<V.length;et+=this.stride)G.add(V[et],V[et+1]);return G.finish(),G.data=V,G}_addTileFeatures(V,G,et,at,lt,It){for(const vt of V){const dt=vt*this.stride,bt=G[dt+pn]>1;let Yt,Kt,Jt;if(bt)Yt=Dr(G,dt,this.clusterProps),Kt=G[dt],Jt=G[dt+1];else{const Y=this.points[G[dt+Ke]];Yt=Y.properties;const[yt,gt]=Y.geometry.coordinates;Kt=Te(yt),Jt=Oe(gt)}const z={type:1,geometry:[[Math.round(this.options.extent*(Kt*lt-et)),Math.round(this.options.extent*(Jt*lt-at))]],tags:Yt};let $;$=bt||this.options.generateId?G[dt+Ke]:this.points[G[dt+Ke]].id,$!==void 0&&(z.id=$),It.features.push(z)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(Math.floor(+V),this.options.maxZoom+1))}_cluster(V,G){const{radius:et,extent:at,reduce:lt,minPoints:It}=this.options,vt=et/(at*Math.pow(2,G)),dt=V.data,bt=[],Yt=this.stride;for(let Kt=0;Kt<dt.length;Kt+=Yt){if(dt[Kt+2]<=G)continue;dt[Kt+2]=G;const Jt=dt[Kt],z=dt[Kt+1],$=V.within(dt[Kt],dt[Kt+1],vt),Y=dt[Kt+pn];let yt=Y;for(const gt of $){const Mt=gt*Yt;dt[Mt+2]>G&&(yt+=dt[Mt+pn])}if(yt>Y&&yt>=It){let gt,Mt=Jt*Y,Nt=z*Y,Qt=-1;const Ut=((Kt/Yt|0)<<5)+(G+1)+this.points.length;for(const ie of $){const oe=ie*Yt;if(dt[oe+2]<=G)continue;dt[oe+2]=G;const ze=dt[oe+pn];Mt+=dt[oe]*ze,Nt+=dt[oe+1]*ze,dt[oe+4]=Ut,lt&&(gt||(gt=this._map(dt,Kt,!0),Qt=this.clusterProps.length,this.clusterProps.push(gt)),lt(gt,this._map(dt,oe)))}dt[Kt+4]=Ut,bt.push(Mt/yt,Nt/yt,1/0,Ut,-1,yt),lt&&bt.push(Qt)}else{for(let gt=0;gt<Yt;gt++)bt.push(dt[Kt+gt]);if(yt>1)for(const gt of $){const Mt=gt*Yt;if(!(dt[Mt+2]<=G)){dt[Mt+2]=G;for(let Nt=0;Nt<Yt;Nt++)bt.push(dt[Mt+Nt])}}}}return bt}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,G,et){if(V[G+pn]>1){const It=this.clusterProps[V[G+Xn]];return et?Object.assign({},It):It}const at=this.points[V[G+Ke]].properties,lt=this.options.map(at);return et&&lt===at?Object.assign({},lt):lt}}function _o(q,V,G){return{type:"Feature",id:q[V+Ke],properties:Dr(q,V,G),geometry:{type:"Point",coordinates:[(et=q[V],360*(et-.5)),bn(q[V+1])]}};var et}function Dr(q,V,G){const et=q[V+pn],at=et>=1e4?`${Math.round(et/1e3)}k`:et>=1e3?Math.round(et/100)/10+"k":et,lt=q[V+Xn],It=lt===-1?{}:Object.assign({},G[lt]);return Object.assign(It,{cluster:!0,cluster_id:q[V+Ke],point_count:et,point_count_abbreviated:at})}function Te(q){return q/360+.5}function Oe(q){const V=Math.sin(q*Math.PI/180),G=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return G<0?0:G>1?1:G}function bn(q){const V=(180-360*q)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function es(q,V,G,et){for(var at,lt=et,It=G-V>>1,vt=G-V,dt=q[V],bt=q[V+1],Yt=q[G],Kt=q[G+1],Jt=V+3;Jt<G;Jt+=3){var z=xi(q[Jt],q[Jt+1],dt,bt,Yt,Kt);if(z>lt)at=Jt,lt=z;else if(z===lt){var $=Math.abs(Jt-It);$<vt&&(at=Jt,vt=$)}}lt>et&&(at-V>3&&es(q,V,at,et),q[at+2]=lt,G-at>3&&es(q,at,G,et))}function xi(q,V,G,et,at,lt){var It=at-G,vt=lt-et;if(It!==0||vt!==0){var dt=((q-G)*It+(V-et)*vt)/(It*It+vt*vt);dt>1?(G=at,et=lt):dt>0&&(G+=It*dt,et+=vt*dt)}return(It=q-G)*It+(vt=V-et)*vt}function Dn(q,V,G,et){var at={id:q===void 0?null:q,type:V,geometry:G,tags:et,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(lt){var It=lt.geometry,vt=lt.type;if(vt==="Point"||vt==="MultiPoint"||vt==="LineString")hr(lt,It);else if(vt==="Polygon"||vt==="MultiLineString")for(var dt=0;dt<It.length;dt++)hr(lt,It[dt]);else if(vt==="MultiPolygon")for(dt=0;dt<It.length;dt++)for(var bt=0;bt<It[dt].length;bt++)hr(lt,It[dt][bt])}(at),at}function hr(q,V){for(var G=0;G<V.length;G+=3)q.minX=Math.min(q.minX,V[G]),q.minY=Math.min(q.minY,V[G+1]),q.maxX=Math.max(q.maxX,V[G]),q.maxY=Math.max(q.maxY,V[G+1])}function vn(q,V,G,et){if(V.geometry){var at=V.geometry.coordinates,lt=V.geometry.type,It=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2),vt=[],dt=V.id;if(G.promoteId?dt=V.properties[G.promoteId]:G.generateId&&(dt=et||0),lt==="Point")Di(at,vt);else if(lt==="MultiPoint")for(var bt=0;bt<at.length;bt++)Di(at[bt],vt);else if(lt==="LineString")Ui(at,vt,It,!1);else if(lt==="MultiLineString"){if(G.lineMetrics){for(bt=0;bt<at.length;bt++)Ui(at[bt],vt=[],It,!1),q.push(Dn(dt,"LineString",vt,V.properties));return}ko(at,vt,It,!1)}else if(lt==="Polygon")ko(at,vt,It,!0);else{if(lt!=="MultiPolygon"){if(lt==="GeometryCollection"){for(bt=0;bt<V.geometry.geometries.length;bt++)vn(q,{id:dt,geometry:V.geometry.geometries[bt],properties:V.properties},G,et);return}throw new Error("Input data is not a valid GeoJSON object.")}for(bt=0;bt<at.length;bt++){var Yt=[];ko(at[bt],Yt,It,!0),vt.push(Yt)}}q.push(Dn(dt,lt,vt,V.properties))}}function Di(q,V){V.push(qt(q[0])),V.push(Ri(q[1])),V.push(0)}function Ui(q,V,G,et){for(var at,lt,It=0,vt=0;vt<q.length;vt++){var dt=qt(q[vt][0]),bt=Ri(q[vt][1]);V.push(dt),V.push(bt),V.push(0),vt>0&&(It+=et?(at*bt-dt*lt)/2:Math.sqrt(Math.pow(dt-at,2)+Math.pow(bt-lt,2))),at=dt,lt=bt}var Yt=V.length-3;V[2]=1,es(V,0,Yt,G),V[Yt+2]=1,V.size=Math.abs(It),V.start=0,V.end=V.size}function ko(q,V,G,et){for(var at=0;at<q.length;at++){var lt=[];Ui(q[at],lt,G,et),V.push(lt)}}function qt(q){return q/360+.5}function Ri(q){var V=Math.sin(q*Math.PI/180),G=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return G<0?0:G>1?1:G}function Rr(q,V,G,et,at,lt,It,vt){if(et/=V,lt>=(G/=V)&&It<et)return q;if(It<G||lt>=et)return null;for(var dt=[],bt=0;bt<q.length;bt++){var Yt=q[bt],Kt=Yt.geometry,Jt=Yt.type,z=at===0?Yt.minX:Yt.minY,$=at===0?Yt.maxX:Yt.maxY;if(z>=G&&$<et)dt.push(Yt);else if(!($<G||z>=et)){var Y=[];if(Jt==="Point"||Jt==="MultiPoint")Vn(Kt,Y,G,et,at);else if(Jt==="LineString")En(Kt,Y,G,et,at,!1,vt.lineMetrics);else if(Jt==="MultiLineString")ao(Kt,Y,G,et,at,!1);else if(Jt==="Polygon")ao(Kt,Y,G,et,at,!0);else if(Jt==="MultiPolygon")for(var yt=0;yt<Kt.length;yt++){var gt=[];ao(Kt[yt],gt,G,et,at,!0),gt.length&&Y.push(gt)}if(Y.length){if(vt.lineMetrics&&Jt==="LineString"){for(yt=0;yt<Y.length;yt++)dt.push(Dn(Yt.id,Jt,Y[yt],Yt.tags));continue}Jt!=="LineString"&&Jt!=="MultiLineString"||(Y.length===1?(Jt="LineString",Y=Y[0]):Jt="MultiLineString"),Jt!=="Point"&&Jt!=="MultiPoint"||(Jt=Y.length===3?"Point":"MultiPoint"),dt.push(Dn(Yt.id,Jt,Y,Yt.tags))}}}return dt.length?dt:null}function Vn(q,V,G,et,at){for(var lt=0;lt<q.length;lt+=3){var It=q[lt+at];It>=G&&It<=et&&(V.push(q[lt]),V.push(q[lt+1]),V.push(q[lt+2]))}}function En(q,V,G,et,at,lt,It){for(var vt,dt,bt=$i(q),Yt=at===0?Rs:No,Kt=q.start,Jt=0;Jt<q.length-3;Jt+=3){var z=q[Jt],$=q[Jt+1],Y=q[Jt+2],yt=q[Jt+3],gt=q[Jt+4],Mt=at===0?z:$,Nt=at===0?yt:gt,Qt=!1;It&&(vt=Math.sqrt(Math.pow(z-yt,2)+Math.pow($-gt,2))),Mt<G?Nt>G&&(dt=Yt(bt,z,$,yt,gt,G),It&&(bt.start=Kt+vt*dt)):Mt>et?Nt<et&&(dt=Yt(bt,z,$,yt,gt,et),It&&(bt.start=Kt+vt*dt)):vo(bt,z,$,Y),Nt<G&&Mt>=G&&(dt=Yt(bt,z,$,yt,gt,G),Qt=!0),Nt>et&&Mt<=et&&(dt=Yt(bt,z,$,yt,gt,et),Qt=!0),!lt&&Qt&&(It&&(bt.end=Kt+vt*dt),V.push(bt),bt=$i(q)),It&&(Kt+=vt)}var Ut=q.length-3;z=q[Ut],$=q[Ut+1],Y=q[Ut+2],(Mt=at===0?z:$)>=G&&Mt<=et&&vo(bt,z,$,Y),Ut=bt.length-3,lt&&Ut>=3&&(bt[Ut]!==bt[0]||bt[Ut+1]!==bt[1])&&vo(bt,bt[0],bt[1],bt[2]),bt.length&&V.push(bt)}function $i(q){var V=[];return V.size=q.size,V.start=q.start,V.end=q.end,V}function ao(q,V,G,et,at,lt){for(var It=0;It<q.length;It++)En(q[It],V,G,et,at,lt,!1)}function vo(q,V,G,et){q.push(V),q.push(G),q.push(et)}function Rs(q,V,G,et,at,lt){var It=(lt-V)/(et-V);return q.push(lt),q.push(G+(at-G)*It),q.push(1),It}function No(q,V,G,et,at,lt){var It=(lt-G)/(at-G);return q.push(V+(et-V)*It),q.push(lt),q.push(1),It}function Kr(q,V){for(var G=[],et=0;et<q.length;et++){var at,lt=q[et],It=lt.type;if(It==="Point"||It==="MultiPoint"||It==="LineString")at=wi(lt.geometry,V);else if(It==="MultiLineString"||It==="Polygon"){at=[];for(var vt=0;vt<lt.geometry.length;vt++)at.push(wi(lt.geometry[vt],V))}else if(It==="MultiPolygon")for(at=[],vt=0;vt<lt.geometry.length;vt++){for(var dt=[],bt=0;bt<lt.geometry[vt].length;bt++)dt.push(wi(lt.geometry[vt][bt],V));at.push(dt)}G.push(Dn(lt.id,It,at,lt.tags))}return G}function wi(q,V){var G=[];G.size=q.size,q.start!==void 0&&(G.start=q.start,G.end=q.end);for(var et=0;et<q.length;et+=3)G.push(q[et]+V,q[et+1],q[et+2]);return G}function ce(q,V){if(q.transformed)return q;var G,et,at,lt=1<<q.z,It=q.x,vt=q.y;for(G=0;G<q.features.length;G++){var dt=q.features[G],bt=dt.geometry,Yt=dt.type;if(dt.geometry=[],Yt===1)for(et=0;et<bt.length;et+=2)dt.geometry.push(Gi(bt[et],bt[et+1],V,lt,It,vt));else for(et=0;et<bt.length;et++){var Kt=[];for(at=0;at<bt[et].length;at+=2)Kt.push(Gi(bt[et][at],bt[et][at+1],V,lt,It,vt));dt.geometry.push(Kt)}}return q.transformed=!0,q}function Gi(q,V,G,et,at,lt){return[Math.round(G*(q*et-at)),Math.round(G*(V*et-lt))]}function pr(q,V,G,et,at){for(var lt=V===at.maxZoom?0:at.tolerance/((1<<V)*at.extent),It={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:G,y:et,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},vt=0;vt<q.length;vt++){It.numFeatures++,Os(It,q[vt],lt,at);var dt=q[vt].minX,bt=q[vt].minY,Yt=q[vt].maxX,Kt=q[vt].maxY;dt<It.minX&&(It.minX=dt),bt<It.minY&&(It.minY=bt),Yt>It.maxX&&(It.maxX=Yt),Kt>It.maxY&&(It.maxY=Kt)}return It}function Os(q,V,G,et){var at=V.geometry,lt=V.type,It=[];if(lt==="Point"||lt==="MultiPoint")for(var vt=0;vt<at.length;vt+=3)It.push(at[vt]),It.push(at[vt+1]),q.numPoints++,q.numSimplified++;else if(lt==="LineString")Oi(It,at,q,G,!1,!1);else if(lt==="MultiLineString"||lt==="Polygon")for(vt=0;vt<at.length;vt++)Oi(It,at[vt],q,G,lt==="Polygon",vt===0);else if(lt==="MultiPolygon")for(var dt=0;dt<at.length;dt++){var bt=at[dt];for(vt=0;vt<bt.length;vt++)Oi(It,bt[vt],q,G,!0,vt===0)}if(It.length){var Yt=V.tags||null;if(lt==="LineString"&&et.lineMetrics){for(var Kt in Yt={},V.tags)Yt[Kt]=V.tags[Kt];Yt.mapbox_clip_start=at.start/at.size,Yt.mapbox_clip_end=at.end/at.size}var Jt={geometry:It,type:lt==="Polygon"||lt==="MultiPolygon"?3:lt==="LineString"||lt==="MultiLineString"?2:1,tags:Yt};V.id!==null&&(Jt.id=V.id),q.features.push(Jt)}}function Oi(q,V,G,et,at,lt){var It=et*et;if(et>0&&V.size<(at?It:et))G.numPoints+=V.length/3;else{for(var vt=[],dt=0;dt<V.length;dt+=3)(et===0||V[dt+2]>It)&&(G.numSimplified++,vt.push(V[dt]),vt.push(V[dt+1])),G.numPoints++;at&&function(bt,Yt){for(var Kt=0,Jt=0,z=bt.length,$=z-2;Jt<z;$=Jt,Jt+=2)Kt+=(bt[Jt]-bt[$])*(bt[Jt+1]+bt[$+1]);if(Kt>0===Yt)for(Jt=0,z=bt.length;Jt<z/2;Jt+=2){var Y=bt[Jt],yt=bt[Jt+1];bt[Jt]=bt[z-2-Jt],bt[Jt+1]=bt[z-1-Jt],bt[z-2-Jt]=Y,bt[z-1-Jt]=yt}}(vt,lt),q.push(vt)}}function pe(q,V){var G=(V=this.options=function(at,lt){for(var It in lt)at[It]=lt[It];return at}(Object.create(this.options),V)).debug;if(G&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");var et=function(at,lt){var It=[];if(at.type==="FeatureCollection")for(var vt=0;vt<at.features.length;vt++)vn(It,at.features[vt],lt,vt);else vn(It,at.type==="Feature"?at:{geometry:at},lt);return It}(q,V);this.tiles={},this.tileCoords=[],G&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),et=function(at,lt){var It=lt.buffer/lt.extent,vt=at,dt=Rr(at,1,-1-It,It,0,-1,2,lt),bt=Rr(at,1,1-It,2+It,0,-1,2,lt);return(dt||bt)&&(vt=Rr(at,1,-It,1+It,0,-1,2,lt)||[],dt&&(vt=Kr(dt,1).concat(vt)),bt&&(vt=vt.concat(Kr(bt,-1)))),vt}(et,V),et.length&&this.splitTile(et,0,0,0),G&&(et.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ln(q,V,G){return 32*((1<<q)*G+V)+q}function tn(q,V){return V?q.properties[V]:q.id}function li(q,V){if(q==null)return!0;if(q.type==="Feature")return tn(q,V)!=null;if(q.type==="FeatureCollection"){const G=new Set;for(const et of q.features){const at=tn(et,V);if(at==null||G.has(at))return!1;G.add(at)}return!0}return!1}function ji(q,V){const G=new Map;if(q!=null)if(q.type==="Feature")G.set(tn(q,V),q);else for(const et of q.features)G.set(tn(et,V),et);return G}pe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},pe.prototype.splitTile=function(q,V,G,et,at,lt,It){for(var vt=[q,V,G,et],dt=this.options,bt=dt.debug;vt.length;){et=vt.pop(),G=vt.pop(),V=vt.pop(),q=vt.pop();var Yt=1<<V,Kt=ln(V,G,et),Jt=this.tiles[Kt];if(!Jt&&(bt>1&&console.time("creation"),Jt=this.tiles[Kt]=pr(q,V,G,et,dt),this.tileCoords.push({z:V,x:G,y:et}),bt)){bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,G,et,Jt.numFeatures,Jt.numPoints,Jt.numSimplified),console.timeEnd("creation"));var z="z"+V;this.stats[z]=(this.stats[z]||0)+1,this.total++}if(Jt.source=q,at){if(V===dt.maxZoom||V===at)continue;var $=1<<at-V;if(G!==Math.floor(lt/$)||et!==Math.floor(It/$))continue}else if(V===dt.indexMaxZoom||Jt.numPoints<=dt.indexMaxPoints)continue;if(Jt.source=null,q.length!==0){bt>1&&console.time("clipping");var Y,yt,gt,Mt,Nt,Qt,Ut=.5*dt.buffer/dt.extent,ie=.5-Ut,oe=.5+Ut,ze=1+Ut;Y=yt=gt=Mt=null,Nt=Rr(q,Yt,G-Ut,G+oe,0,Jt.minX,Jt.maxX,dt),Qt=Rr(q,Yt,G+ie,G+ze,0,Jt.minX,Jt.maxX,dt),q=null,Nt&&(Y=Rr(Nt,Yt,et-Ut,et+oe,1,Jt.minY,Jt.maxY,dt),yt=Rr(Nt,Yt,et+ie,et+ze,1,Jt.minY,Jt.maxY,dt),Nt=null),Qt&&(gt=Rr(Qt,Yt,et-Ut,et+oe,1,Jt.minY,Jt.maxY,dt),Mt=Rr(Qt,Yt,et+ie,et+ze,1,Jt.minY,Jt.maxY,dt),Qt=null),bt>1&&console.timeEnd("clipping"),vt.push(Y||[],V+1,2*G,2*et),vt.push(yt||[],V+1,2*G,2*et+1),vt.push(gt||[],V+1,2*G+1,2*et),vt.push(Mt||[],V+1,2*G+1,2*et+1)}}},pe.prototype.getTile=function(q,V,G){var et=this.options,at=et.extent,lt=et.debug;if(q<0||q>24)return null;var It=1<<q,vt=ln(q,V=(V%It+It)%It,G);if(this.tiles[vt])return ce(this.tiles[vt],at);lt>1&&console.log("drilling down to z%d-%d-%d",q,V,G);for(var dt,bt=q,Yt=V,Kt=G;!dt&&bt>0;)bt--,Yt=Math.floor(Yt/2),Kt=Math.floor(Kt/2),dt=this.tiles[ln(bt,Yt,Kt)];return dt&&dt.source?(lt>1&&console.log("found parent tile z%d-%d-%d",bt,Yt,Kt),lt>1&&console.time("drilling down"),this.splitTile(dt.source,bt,Yt,Kt,q,V,G),lt>1&&console.timeEnd("drilling down"),this.tiles[vt]?ce(this.tiles[vt],at):null):null};class Xe extends j{constructor(V,G,et,at){super(V,G,et),this._dataUpdateable=new Map,this.loadGeoJSON=(lt,It)=>{const{promoteId:vt}=lt;if(lt.request)return u.f(lt.request,(dt,bt,Yt,Kt)=>{this._dataUpdateable=li(bt,vt)?ji(bt,vt):void 0,It(dt,bt,Yt,Kt)});if(typeof lt.data=="string")try{const dt=JSON.parse(lt.data);this._dataUpdateable=li(dt,vt)?ji(dt,vt):void 0,It(null,dt)}catch{It(new Error(`Input data given to '${lt.source}' is not a valid GeoJSON object.`))}else lt.dataDiff?this._dataUpdateable?(function(dt,bt,Yt){var Kt,Jt,z,$;if(bt.removeAll&&dt.clear(),bt.remove)for(const Y of bt.remove)dt.delete(Y);if(bt.add)for(const Y of bt.add){const yt=tn(Y,Yt);yt!=null&&dt.set(yt,Y)}if(bt.update)for(const Y of bt.update){let yt=dt.get(Y.id);if(yt==null)continue;const gt=!Y.removeAllProperties&&(((Kt=Y.removeProperties)===null||Kt===void 0?void 0:Kt.length)>0||((Jt=Y.addOrUpdateProperties)===null||Jt===void 0?void 0:Jt.length)>0);if((Y.newGeometry||Y.removeAllProperties||gt)&&(yt=Object.assign({},yt),dt.set(Y.id,yt),gt&&(yt.properties=Object.assign({},yt.properties))),Y.newGeometry&&(yt.geometry=Y.newGeometry),Y.removeAllProperties)yt.properties={};else if(((z=Y.removeProperties)===null||z===void 0?void 0:z.length)>0)for(const Mt of Y.removeProperties)Object.prototype.hasOwnProperty.call(yt.properties,Mt)&&delete yt.properties[Mt];if((($=Y.addOrUpdateProperties)===null||$===void 0?void 0:$.length)>0)for(const{key:Mt,value:Nt}of Y.addOrUpdateProperties)yt.properties[Mt]=Nt}}(this._dataUpdateable,lt.dataDiff,vt),It(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):It(new Error(`Cannot update existing geojson data in ${lt.source}`)):It(new Error(`Input data given to '${lt.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,at&&(this.loadGeoJSON=at)}loadGeoJSONTile(V,G){const et=V.tileID.canonical;if(!this._geoJSONIndex)return G(null,null);const at=this._geoJSONIndex.getTile(et.z,et.x,et.y);if(!at)return G(null,null);const lt=new class{constructor(vt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.N,this.length=vt.length,this._features=vt}feature(vt){return new class{constructor(dt){this._feature=dt,this.extent=u.N,this.type=dt.type,this.properties=dt.tags,"id"in dt&&!isNaN(dt.id)&&(this.id=parseInt(dt.id,10))}loadGeometry(){if(this._feature.type===1){const dt=[];for(const bt of this._feature.geometry)dt.push([new u.P(bt[0],bt[1])]);return dt}{const dt=[];for(const bt of this._feature.geometry){const Yt=[];for(const Kt of bt)Yt.push(new u.P(Kt[0],Kt[1]));dt.push(Yt)}return dt}}toGeoJSON(dt,bt,Yt){return tt.call(this,dt,bt,Yt)}}(this._features[vt])}}(at.features);let It=Fe(lt);It.byteOffset===0&&It.byteLength===It.buffer.byteLength||(It=new Uint8Array(It)),G(null,{vectorTile:lt,rawData:It.buffer})}loadData(V,G){var et;(et=this._pendingRequest)===null||et===void 0||et.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const at=!!(V&&V.request&&V.request.collectResourceTiming)&&new u.bu(V.request);this._pendingCallback=G,this._pendingRequest=this.loadGeoJSON(V,(lt,It)=>{if(delete this._pendingCallback,delete this._pendingRequest,lt||!It)return G(lt);if(typeof It!="object")return G(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));{J(It,!0);try{if(V.filter){const dt=u.bC(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(dt.result==="error")throw new Error(dt.value.map(Yt=>`${Yt.key}: ${Yt.message}`).join(", "));It={type:"FeatureCollection",features:It.features.filter(Yt=>dt.value.evaluate({zoom:0},Yt))}}this._geoJSONIndex=V.cluster?new Wn(function({superclusterOptions:dt,clusterProperties:bt}){if(!bt||!dt)return dt;const Yt={},Kt={},Jt={accumulated:null,zoom:0},z={properties:null},$=Object.keys(bt);for(const Y of $){const[yt,gt]=bt[Y],Mt=u.bC(gt),Nt=u.bC(typeof yt=="string"?[yt,["accumulated"],["get",Y]]:yt);Yt[Y]=Mt.value,Kt[Y]=Nt.value}return dt.map=Y=>{z.properties=Y;const yt={};for(const gt of $)yt[gt]=Yt[gt].evaluate(Jt,z);return yt},dt.reduce=(Y,yt)=>{z.properties=yt;for(const gt of $)Jt.accumulated=Y[gt],Y[gt]=Kt[gt].evaluate(Jt,z)},dt}(V)).load(It.features):function(dt,bt){return new pe(dt,bt)}(It,V.geojsonVtOptions)}catch(dt){return G(dt)}this.loaded={};const vt={};if(at){const dt=at.finish();dt&&(vt.resourceTiming={},vt.resourceTiming[V.source]=JSON.parse(JSON.stringify(dt)))}G(null,vt)}})}reloadTile(V,G){const et=this.loaded;return et&&et[V.uid]?super.reloadTile(V,G):this.loadTile(V,G)}removeSource(V,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),G()}getClusterExpansionZoom(V,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(et){G(et)}}getClusterChildren(V,G){try{G(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(et){G(et)}}getClusterLeaves(V,G){try{G(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(et){G(et)}}}class qi{constructor(V){this.self=V,this.actor=new u.C(V,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:j,geojson:Xe},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(G,et)=>{if(this.workerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.workerSourceTypes[G]=et},this.self.registerRTLTextPlugin=G=>{if(u.bD.isParsed())throw new Error("RTL text plugin already registered.");u.bD.applyArabicShaping=G.applyArabicShaping,u.bD.processBidirectionalText=G.processBidirectionalText,u.bD.processStyledBidirectionalText=G.processStyledBidirectionalText}}setReferrer(V,G){this.referrer=G}setImages(V,G,et){this.availableImages[V]=G;for(const at in this.workerSources[V]){const lt=this.workerSources[V][at];for(const It in lt)lt[It].availableImages=G}et()}setLayers(V,G,et){this.getLayerIndex(V).replace(G),et()}updateLayers(V,G,et){this.getLayerIndex(V).update(G.layers,G.removedIds),et()}loadTile(V,G,et){this.getWorkerSource(V,G.type,G.source).loadTile(G,et)}loadDEMTile(V,G,et){this.getDEMWorkerSource(V,G.source).loadTile(G,et)}reloadTile(V,G,et){this.getWorkerSource(V,G.type,G.source).reloadTile(G,et)}abortTile(V,G,et){this.getWorkerSource(V,G.type,G.source).abortTile(G,et)}removeTile(V,G,et){this.getWorkerSource(V,G.type,G.source).removeTile(G,et)}removeDEMTile(V,G){this.getDEMWorkerSource(V,G.source).removeTile(G)}removeSource(V,G,et){if(!this.workerSources[V]||!this.workerSources[V][G.type]||!this.workerSources[V][G.type][G.source])return;const at=this.workerSources[V][G.type][G.source];delete this.workerSources[V][G.type][G.source],at.removeSource!==void 0?at.removeSource(G,et):et()}loadWorkerSource(V,G,et){try{this.self.importScripts(G.url),et()}catch(at){et(at.toString())}}syncRTLPluginState(V,G,et){try{u.bD.setState(G);const at=u.bD.getPluginURL();if(u.bD.isLoaded()&&!u.bD.isParsed()&&at!=null){this.self.importScripts(at);const lt=u.bD.isParsed();et(lt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${at}`),lt)}}catch(at){et(at.toString())}}getAvailableImages(V){let G=this.availableImages[V];return G||(G=[]),G}getLayerIndex(V){let G=this.layerIndexes[V];return G||(G=this.layerIndexes[V]=new w),G}getWorkerSource(V,G,et){return this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][G]||(this.workerSources[V][G]={}),this.workerSources[V][G][et]||(this.workerSources[V][G][et]=new this.workerSourceTypes[G]({send:(at,lt,It)=>{this.actor.send(at,lt,It,V)}},this.getLayerIndex(V),this.getAvailableImages(V))),this.workerSources[V][G][et]}getDEMWorkerSource(V,G){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][G]||(this.demWorkerSources[V][G]=new W),this.demWorkerSources[V][G]}}return u.i()&&(self.worker=new qi(self)),qi}),c(["./shared"],function(u){var w="3.6.2";class S{static testProp(o){if(!S.docStyle)return o[0];for(let h=0;h<o.length;h++)if(o[h]in S.docStyle)return o[h];return o[0]}static create(o,h,d){const m=window.document.createElement(o);return h!==void 0&&(m.className=h),d&&d.appendChild(m),m}static createNS(o,h){return window.document.createElementNS(o,h)}static disableDrag(){S.docStyle&&S.selectProp&&(S.userSelect=S.docStyle[S.selectProp],S.docStyle[S.selectProp]="none")}static enableDrag(){S.docStyle&&S.selectProp&&(S.docStyle[S.selectProp]=S.userSelect)}static setTransform(o,h){o.style[S.transformProp]=h}static addEventListener(o,h,d,m={}){o.addEventListener(h,d,"passive"in m?m:m.capture)}static removeEventListener(o,h,d,m={}){o.removeEventListener(h,d,"passive"in m?m:m.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",S.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",S.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",S.suppressClickInternal,!0)},0)}static mousePos(o,h){const d=o.getBoundingClientRect();return new u.P(h.clientX-d.left-o.clientLeft,h.clientY-d.top-o.clientTop)}static touchPos(o,h){const d=o.getBoundingClientRect(),m=[];for(let v=0;v<h.length;v++)m.push(new u.P(h[v].clientX-d.left-o.clientLeft,h[v].clientY-d.top-o.clientTop));return m}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}S.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,S.selectProp=S.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),S.transformProp=S.testProp(["transform","WebkitTransform"]);const A={supported:!1,testSupport:function(y){!j&&O&&(W?nt(y):N=y)}};let N,O,j=!1,W=!1;function nt(y){const o=y.createTexture();y.bindTexture(y.TEXTURE_2D,o);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,O),y.isContextLost())return;A.supported=!0}catch{}y.deleteTexture(o),j=!0}var pt,J;typeof document<"u"&&(O=document.createElement("img"),O.onload=function(){N&&nt(N),N=null,W=!0},O.onerror=function(){j=!0,N=null},O.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let o,h,d,m;y.resetRequestQueue=()=>{o=[],h=0,d=0,m={}},y.addThrottleControl=k=>{const R=d++;return m[R]=k,R},y.removeThrottleControl=k=>{delete m[k],C()},y.getImage=(k,R,F=!0)=>{A.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*");const Z={requestParameters:k,supportImageRefresh:F,callback:R,cancelled:!1,completed:!1,cancel:()=>{Z.completed||Z.cancelled||(Z.cancelled=!0,Z.innerRequest&&(Z.innerRequest.cancel(),h--),C())}};return o.push(Z),C(),Z};const v=k=>{const{requestParameters:R,supportImageRefresh:F,callback:Z}=k;return u.e(R,{type:"image"}),(F!==!1||u.i()||u.g(R.url)||R.headers&&!Object.keys(R.headers).reduce((st,ot)=>st&&ot==="accept",!0)?u.m:P)(R,(st,ot,ut,rt)=>{I(k,Z,st,ot,ut,rt)})},I=(k,R,F,Z,st,ot)=>{F?R(F):Z instanceof HTMLImageElement||u.a(Z)?R(null,Z):Z&&((ut,rt)=>{typeof createImageBitmap=="function"?u.b(ut,rt):u.d(ut,rt)})(Z,(ut,rt)=>{ut!=null?R(ut):rt!=null&&R(null,rt,{cacheControl:st,expires:ot})}),k.cancelled||(k.completed=!0,h--,C())},C=()=>{const k=(()=>{const R=Object.keys(m);let F=!1;if(R.length>0){for(const Z of R)if(F=m[Z](),F)break}return F})()?u.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let R=h;R<k&&o.length>0;R++){const F=o.shift();if(F.cancelled){R--;continue}const Z=v(F);h++,F.innerRequest=Z}},P=(k,R)=>{const F=new Image,Z=k.url;let st=!1;const ot=k.credentials;return ot&&ot==="include"?F.crossOrigin="use-credentials":(ot&&ot==="same-origin"||!u.s(Z))&&(F.crossOrigin="anonymous"),F.fetchPriority="high",F.onload=()=>{R(null,F),F.onerror=F.onload=null},F.onerror=()=>{st||R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),F.onerror=F.onload=null},F.src=Z,{cancel:()=>{st=!0,F.src=""}}}}(pt||(pt={})),pt.resetRequestQueue(),function(y){y.Glyphs="Glyphs",y.Image="Image",y.Source="Source",y.SpriteImage="SpriteImage",y.SpriteJSON="SpriteJSON",y.Style="Style",y.Tile="Tile",y.Unknown="Unknown"}(J||(J={}));class tt{constructor(o){this._transformRequestFn=o}transformRequest(o,h){return this._transformRequestFn&&this._transformRequestFn(o,h)||{url:o}}normalizeSpriteURL(o,h,d){const m=function(v){const I=v.match(Q);if(!I)throw new Error(`Unable to parse URL "${v}"`);return{protocol:I[1],authority:I[2],path:I[3]||"/",params:I[4]?I[4].split("&"):[]}}(o);return m.path+=`${h}${d}`,function(v){const I=v.params.length?`?${v.params.join("&")}`:"";return`${v.protocol}://${v.authority}${v.path}${I}`}(m)}setTransformRequest(o){this._transformRequestFn=o}}const Q=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function _t(y){var o=new u.A(3);return o[0]=y[0],o[1]=y[1],o[2]=y[2],o}var Ot,zt=function(y,o,h){return y[0]=o[0]-h[0],y[1]=o[1]-h[1],y[2]=o[2]-h[2],y};Ot=new u.A(3),u.A!=Float32Array&&(Ot[0]=0,Ot[1]=0,Ot[2]=0);var Rt=function(y){var o=y[0],h=y[1];return o*o+h*h};function At(y){const o=[];if(typeof y=="string")o.push({id:"default",url:y});else if(y&&y.length>0){const h=[];for(const{id:d,url:m}of y){const v=`${d}${m}`;h.indexOf(v)===-1&&(h.push(v),o.push({id:d,url:m}))}}return o}function Ht(y,o,h,d,m){if(d)return void y(d);if(m!==Object.values(o).length||m!==Object.values(h).length)return;const v={};for(const I in o){v[I]={};const C=u.h.getImageCanvasContext(h[I]),P=o[I];for(const k in P){const{width:R,height:F,x:Z,y:st,sdf:ot,pixelRatio:ut,stretchX:rt,stretchY:St,content:Ft}=P[k];v[I][k]={data:null,pixelRatio:ut,sdf:ot,stretchX:rt,stretchY:St,content:Ft,spriteData:{width:R,height:F,x:Z,y:st,context:C}}}}y(null,v)}(function(){var y=new u.A(2);u.A!=Float32Array&&(y[0]=0,y[1]=0)})();class Xt{constructor(o,h,d,m){this.context=o,this.format=d,this.texture=o.gl.createTexture(),this.update(h,m)}update(o,h,d){const{width:m,height:v}=o,I=!(this.size&&this.size[0]===m&&this.size[1]===v||d),{context:C}=this,{gl:P}=C;if(this.useMipmap=!!(h&&h.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!h||h.premultiply!==!1)),I)this.size=[m,v],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||u.a(o)?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,o):P.texImage2D(P.TEXTURE_2D,0,this.format,m,v,0,this.format,P.UNSIGNED_BYTE,o.data);else{const{x:k,y:R}=d||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||u.a(o)?P.texSubImage2D(P.TEXTURE_2D,0,k,R,P.RGBA,P.UNSIGNED_BYTE,o):P.texSubImage2D(P.TEXTURE_2D,0,k,R,m,v,P.RGBA,P.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)}bind(o,h,d){const{context:m}=this,{gl:v}=m;v.bindTexture(v.TEXTURE_2D,this.texture),d!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=v.LINEAR),o!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,o),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,d||o),this.filter=o),h!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,h),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function De(y){const{userImage:o}=y;return!!(o&&o.render&&o.render())&&(y.data.replace(new Uint8Array(o.data.buffer)),!0)}class ue extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:h,callback:d}of this.requestors)this._notify(h,d);this.requestors=[]}}getImage(o){const h=this.images[o];if(h&&!h.data&&h.spriteData){const d=h.spriteData;h.data=new u.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),h.spriteData=null}return h}addImage(o,h){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,h)&&(this.images[o]=h)}_validate(o,h){let d=!0;const m=h.data||h.spriteData;return this._validateStretch(h.stretchX,m&&m.width)||(this.fire(new u.j(new Error(`Image "${o}" has invalid "stretchX" value`))),d=!1),this._validateStretch(h.stretchY,m&&m.height)||(this.fire(new u.j(new Error(`Image "${o}" has invalid "stretchY" value`))),d=!1),this._validateContent(h.content,h)||(this.fire(new u.j(new Error(`Image "${o}" has invalid "content" value`))),d=!1),d}_validateStretch(o,h){if(!o)return!0;let d=0;for(const m of o){if(m[0]<d||m[1]<m[0]||h<m[1])return!1;d=m[1]}return!0}_validateContent(o,h){if(!o)return!0;if(o.length!==4)return!1;const d=h.spriteData,m=d&&d.width||h.data.width,v=d&&d.height||h.data.height;return!(o[0]<0||m<o[0]||o[1]<0||v<o[1]||o[2]<0||m<o[2]||o[3]<0||v<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,h,d=!0){const m=this.getImage(o);if(d&&(m.data.width!==h.data.width||m.data.height!==h.data.height))throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${h.data.width}x${h.data.height}).`);h.version=m.version+1,this.images[o]=h,this.updatedImages[o]=!0}removeImage(o){const h=this.images[o];delete this.images[o],delete this.patterns[o],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,h){let d=!0;if(!this.isLoaded())for(const m of o)this.images[m]||(d=!1);this.isLoaded()||d?this._notify(o,h):this.requestors.push({ids:o,callback:h})}_notify(o,h){const d={};for(const m of o){let v=this.getImage(m);v||(this.fire(new u.k("styleimagemissing",{id:m})),v=this.getImage(m)),v?d[m]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:u.w(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,d)}getPixelSize(){const{width:o,height:h}=this.atlasImage;return{width:o,height:h}}getPattern(o){const h=this.patterns[o],d=this.getImage(o);if(!d)return null;if(h&&h.position.version===d.version)return h.position;if(h)h.position.version=d.version;else{const m={w:d.data.width+2,h:d.data.height+2,x:0,y:0},v=new u.I(m,d);this.patterns[o]={bin:m,position:v}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const h=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Xt(o,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const v in this.patterns)o.push(this.patterns[v].bin);const{w:h,h:d}=u.p(o),m=this.atlasImage;m.resize({width:h||1,height:d||1});for(const v in this.patterns){const{bin:I}=this.patterns[v],C=I.x+1,P=I.y+1,k=this.getImage(v).data,R=k.width,F=k.height;u.R.copy(k,m,{x:0,y:0},{x:C,y:P},{width:R,height:F}),u.R.copy(k,m,{x:0,y:F-1},{x:C,y:P-1},{width:R,height:1}),u.R.copy(k,m,{x:0,y:0},{x:C,y:P+F},{width:R,height:1}),u.R.copy(k,m,{x:R-1,y:0},{x:C-1,y:P},{width:1,height:F}),u.R.copy(k,m,{x:0,y:0},{x:C+R,y:P},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const h of o){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const d=this.getImage(h);d||u.w(`Image with ID: "${h}" was not found`),De(d)&&this.updateImage(h,d)}}}const on=1e20;function Gt(y,o,h,d,m,v,I,C,P){for(let k=o;k<o+d;k++)ye(y,h*v+k,v,m,I,C,P);for(let k=h;k<h+m;k++)ye(y,k*v+o,1,d,I,C,P)}function ye(y,o,h,d,m,v,I){v[0]=0,I[0]=-on,I[1]=on,m[0]=y[o];for(let C=1,P=0,k=0;C<d;C++){m[C]=y[o+C*h];const R=C*C;do{const F=v[P];k=(m[C]-m[F]+R-F*F)/(C-F)/2}while(k<=I[P]&&--P>-1);P++,v[P]=C,I[P]=k,I[P+1]=on}for(let C=0,P=0;C<d;C++){for(;I[P+1]<C;)P++;const k=v[P],R=C-k;y[o+C*h]=m[k]+R*R}}class Ue{constructor(o,h){this.requestManager=o,this.localIdeographFontFamily=h,this.entries={}}setURL(o){this.url=o}getGlyphs(o,h){const d=[];for(const m in o)for(const v of o[m])d.push({stack:m,id:v});u.o(d,({stack:m,id:v},I)=>{let C=this.entries[m];C||(C=this.entries[m]={glyphs:{},requests:{},ranges:{}});let P=C.glyphs[v];if(P!==void 0)return void I(null,{stack:m,id:v,glyph:P});if(P=this._tinySDF(C,m,v),P)return C.glyphs[v]=P,void I(null,{stack:m,id:v,glyph:P});const k=Math.floor(v/256);if(256*k>65535)return void I(new Error("glyphs > 65535 not supported"));if(C.ranges[k])return void I(null,{stack:m,id:v,glyph:P});if(!this.url)return void I(new Error("glyphsUrl is not set"));let R=C.requests[k];R||(R=C.requests[k]=[],Ue.loadGlyphRange(m,k,this.url,this.requestManager,(F,Z)=>{if(Z){for(const st in Z)this._doesCharSupportLocalGlyph(+st)||(C.glyphs[+st]=Z[+st]);C.ranges[k]=!0}for(const st of R)st(F,Z);delete C.requests[k]})),R.push((F,Z)=>{F?I(F):Z&&I(null,{stack:m,id:v,glyph:Z[v]||null})})},(m,v)=>{if(m)h(m);else if(v){const I={};for(const{stack:C,id:P,glyph:k}of v)(I[C]||(I[C]={}))[P]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};h(null,I)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(u.u["CJK Unified Ideographs"](o)||u.u["Hangul Syllables"](o)||u.u.Hiragana(o)||u.u.Katakana(o))}_tinySDF(o,h,d){const m=this.localIdeographFontFamily;if(!m||!this._doesCharSupportLocalGlyph(d))return;let v=o.tinySDF;if(!v){let C="400";/bold/i.test(h)?C="900":/medium/i.test(h)?C="500":/light/i.test(h)&&(C="200"),v=o.tinySDF=new Ue.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:m,fontWeight:C})}const I=v.draw(String.fromCharCode(d));return{id:d,bitmap:new u.q({width:I.width||60,height:I.height||60},I.data),metrics:{width:I.glyphWidth/2||24,height:I.glyphHeight/2||24,left:I.glyphLeft/2+.5||0,top:I.glyphTop/2-27.5||-8,advance:I.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ue.loadGlyphRange=function(y,o,h,d,m){const v=256*o,I=v+255,C=d.transformRequest(h.replace("{fontstack}",y).replace("{range}",`${v}-${I}`),J.Glyphs);u.l(C,(P,k)=>{if(P)m(P);else if(k){const R={};for(const F of u.n(k))R[F.id]=F;m(null,R)}})},Ue.TinySDF=class{constructor({fontSize:y=24,buffer:o=3,radius:h=8,cutoff:d=.25,fontFamily:m="sans-serif",fontWeight:v="normal",fontStyle:I="normal"}={}){this.buffer=o,this.cutoff=d,this.radius=h;const C=this.size=y+4*o,P=this._createCanvas(C),k=this.ctx=P.getContext("2d",{willReadFrequently:!0});k.font=`${I} ${v} ${y}px ${m}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(y){const o=document.createElement("canvas");return o.width=o.height=y,o}draw(y){const{width:o,actualBoundingBoxAscent:h,actualBoundingBoxDescent:d,actualBoundingBoxLeft:m,actualBoundingBoxRight:v}=this.ctx.measureText(y),I=Math.ceil(h),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-m))),P=Math.min(this.size-this.buffer,I+Math.ceil(d)),k=C+2*this.buffer,R=P+2*this.buffer,F=Math.max(k*R,0),Z=new Uint8ClampedArray(F),st={data:Z,width:k,height:R,glyphWidth:C,glyphHeight:P,glyphTop:I,glyphLeft:0,glyphAdvance:o};if(C===0||P===0)return st;const{ctx:ot,buffer:ut,gridInner:rt,gridOuter:St}=this;ot.clearRect(ut,ut,C,P),ot.fillText(y,ut,ut+I);const Ft=ot.getImageData(ut,ut,C,P);St.fill(on,0,F),rt.fill(0,0,F);for(let ft=0;ft<P;ft++)for(let Ct=0;Ct<C;Ct++){const $t=Ft.data[4*(ft*C+Ct)+3]/255;if($t===0)continue;const jt=(ft+ut)*k+Ct+ut;if($t===1)St[jt]=0,rt[jt]=on;else{const te=.5-$t;St[jt]=te>0?te*te:0,rt[jt]=te<0?te*te:0}}Gt(St,0,0,k,R,k,this.f,this.v,this.z),Gt(rt,ut,ut,C,P,k,this.f,this.v,this.z);for(let ft=0;ft<F;ft++){const Ct=Math.sqrt(St[ft])-Math.sqrt(rt[ft]);Z[ft]=Math.round(255-255*(Ct/this.radius+this.cutoff))}return st}};class hn{constructor(){this.specification=u.v.light.position}possiblyEvaluate(o,h){return u.z(o.expression.evaluate(h))}interpolate(o,h,d){return{x:u.B.number(o.x,h.x,d),y:u.B.number(o.y,h.y,d),z:u.B.number(o.z,h.z,d)}}}let he;class Fe extends u.E{constructor(o){super(),he=he||new u.r({anchor:new u.D(u.v.light.anchor),position:new hn,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(he),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h={}){if(!this._validate(u.t,o,h))for(const d in o){const m=o[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),m):this._transitionable.setValue(d,m)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,d){return(!d||d.validate!==!1)&&u.x(this,o.call(u.y,u.e({value:h,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}}class Qe{constructor(o,h){this.width=o,this.height=h,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,h){const d=o.join(",")+String(h);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(o,h)),this.dashEntry[d]}getDashRanges(o,h,d){const m=[];let v=o.length%2==1?-o[o.length-1]*d:0,I=o[0]*d,C=!0;m.push({left:v,right:I,isDash:C,zeroLength:o[0]===0});let P=o[0];for(let k=1;k<o.length;k++){C=!C;const R=o[k];v=P*d,P+=R,I=P*d,m.push({left:v,right:I,isDash:C,zeroLength:R===0})}return m}addRoundDash(o,h,d){const m=h/2;for(let v=-d;v<=d;v++){const I=this.width*(this.nextRow+d+v);let C=0,P=o[C];for(let k=0;k<this.width;k++){k/P.right>1&&(P=o[++C]);const R=Math.abs(k-P.left),F=Math.abs(k-P.right),Z=Math.min(R,F);let st;const ot=v/d*(m+1);if(P.isDash){const ut=m-Math.abs(ot);st=Math.sqrt(Z*Z+ut*ut)}else st=m-Math.sqrt(Z*Z+ot*ot);this.data[I+k]=Math.max(0,Math.min(255,st+128))}}}addRegularDash(o){for(let C=o.length-1;C>=0;--C){const P=o[C],k=o[C+1];P.zeroLength?o.splice(C,1):k&&k.isDash===P.isDash&&(k.left=P.left,o.splice(C,1))}const h=o[0],d=o[o.length-1];h.isDash===d.isDash&&(h.left=d.left-this.width,d.right=h.right+this.width);const m=this.width*this.nextRow;let v=0,I=o[v];for(let C=0;C<this.width;C++){C/I.right>1&&(I=o[++v]);const P=Math.abs(C-I.left),k=Math.abs(C-I.right),R=Math.min(P,k);this.data[m+C]=Math.max(0,Math.min(255,(I.isDash?R:-R)+128))}}addDash(o,h){const d=h?7:0,m=2*d+1;if(this.nextRow+m>this.height)return u.w("LineAtlas out of space"),null;let v=0;for(let C=0;C<o.length;C++)v+=o[C];if(v!==0){const C=this.width/v,P=this.getDashRanges(o,this.width,C);h?this.addRoundDash(P,C,d):this.addRegularDash(P)}const I={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:v};return this.nextRow+=m,this.dirty=!0,I}bind(o){const h=o.gl;this.texture?(h.bindTexture(h.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,h.texSubImage2D(h.TEXTURE_2D,0,0,0,this.width,this.height,h.ALPHA,h.UNSIGNED_BYTE,this.data))):(this.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,this.texture),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,this.width,this.height,0,h.ALPHA,h.UNSIGNED_BYTE,this.data))}}class _n{constructor(o,h,d){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=d;const m=this.workerPool.acquire(d);for(let v=0;v<m.length;v++){const I=new u.C(m[v],h,d);I.name=`Worker ${v}`,this.actors.push(I)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,h,d){u.o(this.actors,(m,v)=>{m.send(o,h,v)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(h=>{h.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}}function mn(y,o,h){const d=function(m,v){if(m)return h(m);if(v){const I=u.F(u.e(v,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);v.vector_layers&&(I.vectorLayers=v.vector_layers,I.vectorLayerIds=I.vectorLayers.map(C=>C.id)),h(null,I)}};return y.url?u.f(o.transformRequest(y.url,J.Source),d):u.h.frame(()=>d(null,y))}class Ke{constructor(o,h){o&&(h?this.setSouthWest(o).setNorthEast(h):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof u.L?new u.L(o.lng,o.lat):u.L.convert(o),this}setSouthWest(o){return this._sw=o instanceof u.L?new u.L(o.lng,o.lat):u.L.convert(o),this}extend(o){const h=this._sw,d=this._ne;let m,v;if(o instanceof u.L)m=o,v=o;else{if(!(o instanceof Ke))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(Ke.convert(o)):this.extend(u.L.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(u.L.convert(o)):this;if(m=o._sw,v=o._ne,!m||!v)return this}return h||d?(h.lng=Math.min(m.lng,h.lng),h.lat=Math.min(m.lat,h.lat),d.lng=Math.max(v.lng,d.lng),d.lat=Math.max(v.lat,d.lat)):(this._sw=new u.L(m.lng,m.lat),this._ne=new u.L(v.lng,v.lat)),this}getCenter(){return new u.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.L(this.getWest(),this.getNorth())}getSouthEast(){return new u.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:h,lat:d}=u.L.convert(o);let m=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&m}static convert(o){return o instanceof Ke?o:o&&new Ke(o)}static fromLngLat(o,h=0){const d=360*h/40075017,m=d/Math.cos(Math.PI/180*o.lat);return new Ke(new u.L(o.lng-m,o.lat-d),new u.L(o.lng+m,o.lat+d))}}class pn{constructor(o,h,d){this.bounds=Ke.convert(this.validateBounds(o)),this.minzoom=h||0,this.maxzoom=d||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const h=Math.pow(2,o.z),d=Math.floor(u.G(this.bounds.getWest())*h),m=Math.floor(u.H(this.bounds.getNorth())*h),v=Math.ceil(u.G(this.bounds.getEast())*h),I=Math.ceil(u.H(this.bounds.getSouth())*h);return o.x>=d&&o.x<v&&o.y>=m&&o.y<I}}class Xn extends u.E{constructor(o,h,d,m){if(super(),this.load=()=>{this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=mn(this._options,this.map._requestManager,(v,I)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),v?this.fire(new u.j(v)):I&&(u.e(this,I),I.bounds&&(this.tileBounds=new pn(I.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>u.e({},this._options),this.id=o,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.F(h,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(o,h){const d=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m={request:this.map._requestManager.transformRequest(d,J.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function v(I,C){return delete o.request,o.aborted?h(null):I&&I.status!==404?h(I):(C&&C.resourceTiming&&(o.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&o.setExpiryData(C),o.loadVectorData(C,this.map.painter),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}m.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",m,v.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",m,v.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Wn extends u.E{constructor(o,h,d,m){super(),this.id=o,this.dispatcher=d,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},h),u.e(this,u.F(h,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=mn(this._options,this.map._requestManager,(o,h)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new u.j(o)):h&&(u.e(this,h),h.bounds&&(this.tileBounds=new pn(h.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}serialize(){return u.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){const d=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=pt.getImage(this.map._requestManager.transformRequest(d,J.Tile),(m,v,I)=>{if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(m)o.state="errored",h(m);else if(v){this.map._refreshExpiredTiles&&I&&o.setExpiryData(I);const C=this.map.painter.context,P=C.gl;o.texture=this.map.painter.getTileTexture(v.width),o.texture?o.texture.update(v,{useMipmap:!0}):(o.texture=new Xt(C,v,P.RGBA,{useMipmap:!0}),o.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&P.texParameterf(P.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),o.state="loaded",h(null)}},this.map._refreshExpiredTiles)}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h()}unloadTile(o,h){o.texture&&this.map.painter.saveTileTexture(o.texture),h()}hasTransition(){return!1}}class _o extends Wn{constructor(o,h,d,m){super(o,h,d,m),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox",this.redFactor=h.redFactor,this.greenFactor=h.greenFactor,this.blueFactor=h.blueFactor,this.baseShift=h.baseShift}loadTile(o,h){const d=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m=this.map._requestManager.transformRequest(d,J.Tile);function v(I,C){I&&(o.state="errored",h(I)),C&&(o.dem=C,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded",h(null))}o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.request=pt.getImage(m,(I,C,P)=>u._(this,void 0,void 0,function*(){if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(I)o.state="errored",h(I);else if(C){this.map._refreshExpiredTiles&&o.setExpiryData(P);const k=u.a(C)&&u.J()?C:yield function(F){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.K()){const Z=F.width+2,st=F.height+2;try{return new u.R({width:Z,height:st},yield u.M(F,-1,-1,Z,st))}catch{}}return u.h.getImageData(F,1)})}(C),R={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:k,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",R,v))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(o){const h=o.canonical,d=Math.pow(2,h.z),m=(h.x-1+d)%d,v=h.x===0?o.wrap-1:o.wrap,I=(h.x+1+d)%d,C=h.x+1===d?o.wrap+1:o.wrap,P={};return P[new u.O(o.overscaledZ,v,h.z,m,h.y).key]={backfilled:!1},P[new u.O(o.overscaledZ,C,h.z,I,h.y).key]={backfilled:!1},h.y>0&&(P[new u.O(o.overscaledZ,v,h.z,m,h.y-1).key]={backfilled:!1},P[new u.O(o.overscaledZ,o.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},P[new u.O(o.overscaledZ,C,h.z,I,h.y-1).key]={backfilled:!1}),h.y+1<d&&(P[new u.O(o.overscaledZ,v,h.z,m,h.y+1).key]={backfilled:!1},P[new u.O(o.overscaledZ,o.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},P[new u.O(o.overscaledZ,C,h.z,I,h.y+1).key]={backfilled:!1}),P}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class Dr extends u.E{constructor(o,h,d,m){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>u.e({},this._options,{type:this.type,data:this._data}),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(m),this._data=h.data,this._options=u.e({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const v=u.N/this.tileSize;this.workerOptions=u.e({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*v,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*v,extent:u.N,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:u.N,radius:(h.clusterRadius||50)*v,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},h),this}getClusterChildren(o,h){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},h),this}getClusterLeaves(o,h,d,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:h,offset:d},m),this}_updateWorkerData(o){const h=u.e({},this.workerOptions);o?h.dataDiff=o:typeof this._data=="string"?(h.request=this.map._requestManager.transformRequest(u.h.resolveURL(this._data),J.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,h,(d,m)=>{if(this._pendingLoads--,this._removed||m&&m.abandoned)return void this.fire(new u.k("dataabort",{dataType:"source"}));let v=null;if(m&&m.resourceTiming&&m.resourceTiming[this.id]&&(v=m.resourceTiming[this.id].slice(0)),d)return void this.fire(new u.j(d));const I={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&u.e(I,{resourceTiming:v}),this.fire(new u.k("data",Object.assign(Object.assign({},I),{sourceDataType:"metadata"}))),this.fire(new u.k("data",Object.assign(Object.assign({},I),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(o,h){const d=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const m={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(d,m,(v,I)=>(delete o.request,o.unloadVectorData(),o.aborted?h(null):v?h(v):(o.loadVectorData(I,this.map.painter,d==="reloadTile"),h(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Te=u.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Oe extends u.E{constructor(o,h,d,m){super(),this.load=(v,I)=>{this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=pt.getImage(this.map._requestManager.transformRequest(this.url,J.Image),(C,P)=>{this._request=null,this._loaded=!0,C?this.fire(new u.j(C)):P&&(this.image=P,v&&(this.coordinates=v),I&&I(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const v=this.map.painter.context,I=v.gl;this.boundsBuffer||(this.boundsBuffer=v.createVertexBuffer(this._boundsArray,Te.members)),this.boundsSegments||(this.boundsSegments=u.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Xt(v,this.image,I.RGBA),this.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE));let C=!1;for(const P in this.tiles){const k=this.tiles[P];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture,C=!0)}C&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=o,this.dispatcher=d,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=h}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(o){this.coordinates=o;const h=o.map(u.U.fromLngLat);this.tileID=function(m){let v=1/0,I=1/0,C=-1/0,P=-1/0;for(const Z of m)v=Math.min(v,Z.x),I=Math.min(I,Z.y),C=Math.max(C,Z.x),P=Math.max(P,Z.y);const k=Math.max(C-v,P-I),R=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),F=Math.pow(2,R);return new u.W(R,Math.floor((v+C)/2*F),Math.floor((I+P)/2*F))}(h),this.minzoom=this.maxzoom=this.tileID.z;const d=h.map(m=>this.tileID.getTilePoint(m)._round());return this._boundsArray=new u.V,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,u.N,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,u.N),this._boundsArray.emplaceBack(d[2].x,d[2].y,u.N,u.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(o,h){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},h(null)):(o.state="errored",h(null))}hasTransition(){return!1}}class bn extends Oe{constructor(o,h,d,m){super(o,h,d,m),this.load=()=>{this._loaded=!1;const v=this.options;this.urls=[];for(const I of v.urls)this.urls.push(this.map._requestManager.transformRequest(I,J.Source).url);u.X(this.urls,(I,C)=>{this._loaded=!0,I?this.fire(new u.j(I)):C&&(this.video=C,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const v=this.map.painter.context,I=v.gl;this.boundsBuffer||(this.boundsBuffer=v.createVertexBuffer(this._boundsArray,Te.members)),this.boundsSegments||(this.boundsSegments=u.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE),I.texSubImage2D(I.TEXTURE_2D,0,0,0,I.RGBA,I.UNSIGNED_BYTE,this.video)):(this.texture=new Xt(v,this.video,I.RGBA),this.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE));let C=!1;for(const P in this.tiles){const k=this.tiles[P];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture,C=!0)}C&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=h}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const h=this.video.seekable;o<h.start(0)||o>h.end(0)?this.fire(new u.j(new u.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class es extends Oe{constructor(o,h,d,m){super(o,h,d,m),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const I=this.map.painter.context,C=I.gl;this.boundsBuffer||(this.boundsBuffer=I.createVertexBuffer(this._boundsArray,Te.members)),this.boundsSegments||(this.boundsSegments=u.S.simpleSegment(0,0,4,2)),this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Xt(I,this.canvas,C.RGBA,{premultiply:!0});let P=!1;for(const k in this.tiles){const R=this.tiles[k];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,P=!0)}P&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(I=>typeof I!="number"))||this.fire(new u.j(new u.Y(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.j(new u.Y(`sources.${o}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new u.j(new u.Y(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof HTMLCanvasElement||this.fire(new u.j(new u.Y(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.j(new u.Y(`sources.${o}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const xi={},Dn=y=>{switch(y){case"geojson":return Dr;case"image":return Oe;case"raster":return Wn;case"raster-dem":return _o;case"vector":return Xn;case"video":return bn;case"canvas":return es}return xi[y]};function hr(y,o){const h=u.Z();return u.$(h,h,[1,1,0]),u.a0(h,h,[.5*y.width,.5*y.height,1]),u.a1(h,h,y.calculatePosMatrix(o.toUnwrapped()))}function vn(y,o,h,d,m,v){const I=function(F,Z,st){if(F)for(const ot of F){const ut=Z[ot];if(ut&&ut.source===st&&ut.type==="fill-extrusion")return!0}else for(const ot in Z){const ut=Z[ot];if(ut.source===st&&ut.type==="fill-extrusion")return!0}return!1}(m&&m.layers,o,y.id),C=v.maxPitchScaleFactor(),P=y.tilesIn(d,C,I);P.sort(Di);const k=[];for(const F of P)k.push({wrappedTileID:F.tileID.wrapped().key,queryResults:F.tile.queryRenderedFeatures(o,h,y._state,F.queryGeometry,F.cameraQueryGeometry,F.scale,m,v,C,hr(y.transform,F.tileID))});const R=function(F){const Z={},st={};for(const ot of F){const ut=ot.queryResults,rt=ot.wrappedTileID,St=st[rt]=st[rt]||{};for(const Ft in ut){const ft=ut[Ft],Ct=St[Ft]=St[Ft]||{},$t=Z[Ft]=Z[Ft]||[];for(const jt of ft)Ct[jt.featureIndex]||(Ct[jt.featureIndex]=!0,$t.push(jt))}}return Z}(k);for(const F in R)R[F].forEach(Z=>{const st=Z.feature,ot=y.getFeatureState(st.layer["source-layer"],st.id);st.source=st.layer.source,st.layer["source-layer"]&&(st.sourceLayer=st.layer["source-layer"]),st.state=ot});return R}function Di(y,o){const h=y.tileID,d=o.tileID;return h.overscaledZ-d.overscaledZ||h.canonical.y-d.canonical.y||h.wrap-d.wrap||h.canonical.x-d.canonical.x}class Ui{constructor(o,h){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=u.a2(),this.uses=0,this.tileSize=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const h=o+this.timeAdded;h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,h,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(m,v){const I={};if(!v)return I;for(const C of m){const P=C.layerIds.map(k=>v.getLayer(k)).filter(Boolean);if(P.length!==0){C.layers=P,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(k=>P.filter(R=>R.id===k)[0]));for(const k of P)I[k.id]=C}}return I}(o.buckets,h.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const v=this.buckets[m];if(v instanceof u.a4){if(this.hasSymbolBuckets=!0,!d)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const v=this.buckets[m];if(v instanceof u.a4&&v.hasRTLText){this.hasRTLText=!0,u.a5();break}}this.queryPadding=0;for(const m in this.buckets){const v=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,h.style.getLayer(m).queryRadius(v))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new u.a3}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const d in this.buckets){const m=this.buckets[d];m.uploadPending()&&m.upload(o)}const h=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Xt(o,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Xt(o,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,h,d,m,v,I,C,P,k,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:v,scale:I,tileSize:this.tileSize,pixelPosMatrix:R,transform:P,params:C,queryPadding:this.queryPadding*k},o,h,d):{}}querySourceFeatures(o,h){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const m=d.loadVTLayers(),v=h&&h.sourceLayer?h.sourceLayer:"",I=m._geojsonTileLayer||m[v];if(!I)return;const C=u.a6(h&&h.filter),{z:P,x:k,y:R}=this.tileID.canonical,F={z:P,x:k,y:R};for(let Z=0;Z<I.length;Z++){const st=I.feature(Z);if(C.needGeometry){const rt=u.a7(st,!0);if(!C.filter(new u.a8(this.tileID.overscaledZ),rt,this.tileID.canonical))continue}else if(!C.filter(new u.a8(this.tileID.overscaledZ),st))continue;const ot=d.getId(st,v),ut=new u.a9(st,P,k,R,ot);ut.tile=F,o.push(ut)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const h=this.expirationTime;if(o.cacheControl){const d=u.aa(o.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const d=Date.now();let m=!1;if(this.expirationTime>d)m=!1;else if(h)if(this.expirationTime<h)m=!0;else{const v=this.expirationTime-h;v?this.expirationTime=d+Math.max(v,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,h){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const m in this.buckets){if(!h.style.hasLayer(m))continue;const v=this.buckets[m],I=v.layers[0].sourceLayer||"_geojsonTileLayer",C=d[I],P=o[I];if(!C||!P||Object.keys(P).length===0)continue;v.update(P,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=h&&h.style&&h.style.getLayer(m);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<u.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=u.h.now()+o}setDependencies(o,h){const d={};for(const m of h)d[m]=!0;this.dependencies[o]=d}hasDependency(o,h){for(const d of o){const m=this.dependencies[d];if(m){for(const v of h)if(m[v])return!0}}return!1}}class ko{constructor(o,h){this.max=o,this.onRemove=h,this.reset()}reset(){for(const o in this.data)for(const h of this.data[o])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(o,h,d){const m=o.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const v={value:h,timeout:void 0};if(d!==void 0&&(v.timeout=setTimeout(()=>{this.remove(o,v)},d)),this.data[m].push(v),this.order.push(m),this.order.length>this.max){const I=this._getAndRemoveByKey(this.order[0]);I&&this.onRemove(I)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const h=this.data[o].shift();return h.timeout&&clearTimeout(h.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),h.value}getByKey(o){const h=this.data[o];return h?h[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,h){if(!this.has(o))return this;const d=o.wrapped().key,m=h===void 0?0:this.data[d].indexOf(h),v=this.data[d][m];return this.data[d].splice(m,1),v.timeout&&clearTimeout(v.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(v.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(o){const h=[];for(const d in this.data)for(const m of this.data[d])o(m.value)||h.push(m);for(const d of h)this.remove(d.value.tileID,d)}}class qt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,h,d){const m=String(h);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][m]=this.stateChanges[o][m]||{},u.e(this.stateChanges[o][m],d),this.deletedStates[o]===null){this.deletedStates[o]={};for(const v in this.state[o])v!==m&&(this.deletedStates[o][v]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][m]===null){this.deletedStates[o][m]={};for(const v in this.state[o][m])d[v]||(this.deletedStates[o][m][v]=null)}else for(const v in d)this.deletedStates[o]&&this.deletedStates[o][m]&&this.deletedStates[o][m][v]===null&&delete this.deletedStates[o][m][v]}removeFeatureState(o,h,d){if(this.deletedStates[o]===null)return;const m=String(h);if(this.deletedStates[o]=this.deletedStates[o]||{},d&&h!==void 0)this.deletedStates[o][m]!==null&&(this.deletedStates[o][m]=this.deletedStates[o][m]||{},this.deletedStates[o][m][d]=null);else if(h!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][m])for(d in this.deletedStates[o][m]={},this.stateChanges[o][m])this.deletedStates[o][m][d]=null;else this.deletedStates[o][m]=null;else this.deletedStates[o]=null}getState(o,h){const d=String(h),m=u.e({},(this.state[o]||{})[d],(this.stateChanges[o]||{})[d]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const v=this.deletedStates[o][h];if(v===null)return{};for(const I in v)delete m[I]}return m}initializeTileState(o,h){o.setFeatureState(this.state,h)}coalesceChanges(o,h){const d={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const v={};for(const I in this.stateChanges[m])this.state[m][I]||(this.state[m][I]={}),u.e(this.state[m][I],this.stateChanges[m][I]),v[I]=this.state[m][I];d[m]=v}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const v={};if(this.deletedStates[m]===null)for(const I in this.state[m])v[I]={},this.state[m][I]={};else for(const I in this.deletedStates[m]){if(this.deletedStates[m][I]===null)this.state[m][I]={};else for(const C of Object.keys(this.deletedStates[m][I]))delete this.state[m][I][C];v[I]=this.state[m][I]}d[m]=d[m]||{},u.e(d[m],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const m in o)o[m].setFeatureState(d,h)}}class Ri extends u.E{constructor(o,h,d){super(),this.id=o,this.dispatcher=d,this.on("data",m=>{m.dataType==="source"&&m.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&m.dataType==="source"&&m.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((m,v,I,C)=>{const P=new(Dn(v.type))(m,v,I,C);if(P.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${P.id}`);return P})(o,h,d,this),this._tiles={},this._cache=new ko(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new qt,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const h=this._tiles[o];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,h){return this._source.loadTile(o,h)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new u.k("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const d=this._tiles[h];d.upload(o),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Rr).map(o=>o.key)}getRenderableIds(o){const h=[];for(const d in this._tiles)this._isIdRenderable(d,o)&&h.push(this._tiles[d]);return o?h.sort((d,m)=>{const v=d.tileID,I=m.tileID,C=new u.P(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),P=new u.P(I.canonical.x,I.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-I.overscaledZ||P.y-C.y||P.x-C.x}).map(d=>d.tileID.key):h.map(d=>d.tileID).sort(Rr).map(d=>d.key)}hasRenderableParent(o){const h=this.findLoadedParent(o,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(o,h){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(h||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,h){const d=this._tiles[o];d&&(d.state!=="loading"&&(d.state=h),this._loadTile(d,this._tileLoaded.bind(this,d,o,h)))}_tileLoaded(o,h,d,m){if(m)return o.state="errored",void(m.status!==404?this._source.fire(new u.j(m,{tile:o})):this.update(this.transform,this.terrain));o.timeAdded=u.h.now(),d==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(h,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new u.k("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const h=this.getRenderableIds();for(let m=0;m<h.length;m++){const v=h[m];if(o.neighboringTiles&&o.neighboringTiles[v]){const I=this.getTileByID(v);d(o,I),d(I,o)}}function d(m,v){m.needsHillshadePrepare=!0,m.needsTerrainPrepare=!0;let I=v.tileID.canonical.x-m.tileID.canonical.x;const C=v.tileID.canonical.y-m.tileID.canonical.y,P=Math.pow(2,m.tileID.canonical.z),k=v.tileID.key;I===0&&C===0||Math.abs(C)>1||(Math.abs(I)>1&&(Math.abs(I+P)===1?I+=P:Math.abs(I-P)===1&&(I-=P)),v.dem&&m.dem&&(m.dem.backfillBorder(v.dem,I,C),m.neighboringTiles&&m.neighboringTiles[k]&&(m.neighboringTiles[k].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,h,d,m){for(const v in this._tiles){let I=this._tiles[v];if(m[v]||!I.hasData()||I.tileID.overscaledZ<=h||I.tileID.overscaledZ>d)continue;let C=I.tileID;for(;I&&I.tileID.overscaledZ>h+1;){const k=I.tileID.scaledTo(I.tileID.overscaledZ-1);I=this._tiles[k.key],I&&I.hasData()&&(C=k)}let P=C;for(;P.overscaledZ>h;)if(P=P.scaledTo(P.overscaledZ-1),o[P.key]){m[C.key]=C;break}}}findLoadedParent(o,h){if(o.key in this._loadedParentTiles){const d=this._loadedParentTiles[o.key];return d&&d.tileID.overscaledZ>=h?d:null}for(let d=o.overscaledZ-1;d>=h;d--){const m=o.scaledTo(d),v=this._getLoadedTile(m);if(v)return v}}_getLoadedTile(o){const h=this._tiles[o.key];return h&&h.hasData()?h:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const h=Math.ceil(o.width/this._source.tileSize)+1,d=Math.ceil(o.height/this._source.tileSize)+1,m=Math.floor(h*d*(this._maxTileCacheZoomLevels===null?u.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(v)}handleWrapJump(o){const h=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,h){const d={};for(const m in this._tiles){const v=this._tiles[m];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+h),d[v.tileID.key]=v}this._tiles=d;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(m,this._tiles[m])}}update(o,h){if(this.transform=o,this.terrain=h,!this._sourceLoaded||this._paused)return;let d;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(R=>new u.O(R.canonical.z,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y)):(d=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:h}),this._source.hasTile&&(d=d.filter(R=>this._source.hasTile(R)))):d=[];const m=o.coveringZoomLevel(this._source),v=Math.max(m-Ri.maxOverzooming,this._source.minzoom),I=Math.max(m+Ri.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const R={};for(const F of d)if(F.canonical.z>this._source.minzoom){const Z=F.scaledTo(F.canonical.z-1);R[Z.key]=Z;const st=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));R[st.key]=st}d=d.concat(Object.values(R))}const C=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new u.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=this._updateRetainedTiles(d,m);if(Vn(this._source.type)){const R={},F={},Z=Object.keys(P),st=u.h.now();for(const ot of Z){const ut=P[ot],rt=this._tiles[ot];if(!rt||rt.fadeEndTime!==0&&rt.fadeEndTime<=st)continue;const St=this.findLoadedParent(ut,v);St&&(this._addTile(St.tileID),R[St.tileID.key]=St.tileID),F[ot]=ut}this._retainLoadedChildren(F,m,I,P);for(const ot in R)P[ot]||(this._coveredTiles[ot]=!0,P[ot]=R[ot]);if(h){const ot={},ut={};for(const rt of d)this._tiles[rt.key].hasData()?ot[rt.key]=rt:ut[rt.key]=rt;for(const rt in ut){const St=ut[rt].children(this._source.maxzoom);this._tiles[St[0].key]&&this._tiles[St[1].key]&&this._tiles[St[2].key]&&this._tiles[St[3].key]&&(ot[St[0].key]=P[St[0].key]=St[0],ot[St[1].key]=P[St[1].key]=St[1],ot[St[2].key]=P[St[2].key]=St[2],ot[St[3].key]=P[St[3].key]=St[3],delete ut[rt])}for(const rt in ut){const St=this.findLoadedParent(ut[rt],this._source.minzoom);if(St){ot[St.tileID.key]=P[St.tileID.key]=St.tileID;for(const Ft in ot)ot[Ft].isChildOf(St.tileID)&&delete ot[Ft]}}for(const rt in this._tiles)ot[rt]||(this._coveredTiles[rt]=!0)}}for(const R in P)this._tiles[R].clearFadeHold();const k=u.ab(this._tiles,P);for(const R of k){const F=this._tiles[R];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(R)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,h){const d={},m={},v=Math.max(h-Ri.maxOverzooming,this._source.minzoom),I=Math.max(h+Ri.maxUnderzooming,this._source.minzoom),C={};for(const P of o){const k=this._addTile(P);d[P.key]=P,k.hasData()||h<this._source.maxzoom&&(C[P.key]=P)}this._retainLoadedChildren(C,h,I,d);for(const P of o){let k=this._tiles[P.key];if(k.hasData())continue;if(h+1>this._source.maxzoom){const F=P.children(this._source.maxzoom)[0],Z=this.getTile(F);if(Z&&Z.hasData()){d[F.key]=F;continue}}else{const F=P.children(this._source.maxzoom);if(d[F[0].key]&&d[F[1].key]&&d[F[2].key]&&d[F[3].key])continue}let R=k.wasRequested();for(let F=P.overscaledZ-1;F>=v;--F){const Z=P.scaledTo(F);if(m[Z.key])break;if(m[Z.key]=!0,k=this.getTile(Z),!k&&R&&(k=this._addTile(Z)),k){const st=k.hasData();if((R||st)&&(d[Z.key]=Z),R=k.wasRequested(),st)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const h=[];let d,m=this._tiles[o].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){d=this._loadedParentTiles[m.key];break}h.push(m.key);const v=m.scaledTo(m.overscaledZ-1);if(d=this._getLoadedTile(v),d)break;m=v}for(const v of h)this._loadedParentTiles[v]=d}}_addTile(o){let h=this._tiles[o.key];if(h)return h;h=this._cache.getAndRemove(o),h&&(this._setTileReloadTimer(o.key,h),h.tileID=o,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,h)));const d=h;return h||(h=new Ui(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(h,this._tileLoaded.bind(this,h,o.key,h.state))),h.uses++,this._tiles[o.key]=h,d||this._source.fire(new u.k("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(o,h){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const d=h.getExpiryTimeout();d&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},d))}_removeTile(o){const h=this._tiles[o];h&&(h.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,h,d){const m=[],v=this.transform;if(!v)return m;const I=d?v.getCameraQueryGeometry(o):o,C=o.map(ot=>v.pointCoordinate(ot,this.terrain)),P=I.map(ot=>v.pointCoordinate(ot,this.terrain)),k=this.getIds();let R=1/0,F=1/0,Z=-1/0,st=-1/0;for(const ot of P)R=Math.min(R,ot.x),F=Math.min(F,ot.y),Z=Math.max(Z,ot.x),st=Math.max(st,ot.y);for(let ot=0;ot<k.length;ot++){const ut=this._tiles[k[ot]];if(ut.holdingForFade())continue;const rt=ut.tileID,St=Math.pow(2,v.zoom-ut.tileID.overscaledZ),Ft=h*ut.queryPadding*u.N/ut.tileSize/St,ft=[rt.getTilePoint(new u.U(R,F)),rt.getTilePoint(new u.U(Z,st))];if(ft[0].x-Ft<u.N&&ft[0].y-Ft<u.N&&ft[1].x+Ft>=0&&ft[1].y+Ft>=0){const Ct=C.map(jt=>rt.getTilePoint(jt)),$t=P.map(jt=>rt.getTilePoint(jt));m.push({tile:ut,tileID:rt,queryGeometry:Ct,cameraQueryGeometry:$t,scale:St})}}return m}getVisibleCoordinates(o){const h=this.getRenderableIds(o).map(d=>this._tiles[d].tileID);for(const d of h)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return h}hasTransition(){if(this._source.hasTransition())return!0;if(Vn(this._source.type)){const o=u.h.now();for(const h in this._tiles)if(this._tiles[h].fadeEndTime>=o)return!0}return!1}setFeatureState(o,h,d){this._state.updateState(o=o||"_geojsonTileLayer",h,d)}removeFeatureState(o,h,d){this._state.removeFeatureState(o=o||"_geojsonTileLayer",h,d)}getFeatureState(o,h){return this._state.getState(o=o||"_geojsonTileLayer",h)}setDependencies(o,h,d){const m=this._tiles[o];m&&m.setDependencies(h,d)}reloadTilesForDependencies(o,h){for(const d in this._tiles)this._tiles[d].hasDependency(o,h)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(o,h))}}function Rr(y,o){const h=Math.abs(2*y.wrap)-+(y.wrap<0),d=Math.abs(2*o.wrap)-+(o.wrap<0);return y.overscaledZ-o.overscaledZ||d-h||o.canonical.y-y.canonical.y||o.canonical.x-y.canonical.x}function Vn(y){return y==="raster"||y==="image"||y==="video"}Ri.maxOverzooming=10,Ri.maxUnderzooming=3;const En="mapboxgl_preloaded_worker_pool";class $i{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<$i.workerCount;)this.workers.push(new Worker(u.c.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[En]}numActive(){return Object.keys(this.active).length}}const ao=Math.floor(u.h.hardwareConcurrency/2);let vo;function Rs(){return vo||(vo=new $i),vo}$i.workerCount=u.ac(globalThis)?Math.max(Math.min(ao,3),1):1;class No{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=u.ad(o,0,1);let h=1,d=this._distances[h];const m=o*this.paddedLength+this.padding;for(;d<m&&h<this._distances.length;)d=this._distances[++h];const v=h-1,I=this._distances[v],C=d-I,P=C>0?(m-I)/C:0;return this.points[v].mult(1-P).add(this.points[h].mult(P))}}function Kr(y,o){let h=!0;return y==="always"||y!=="never"&&o!=="never"||(h=!1),h}class wi{constructor(o,h,d){const m=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(o/d),this.yCellCount=Math.ceil(h/d);for(let I=0;I<this.xCellCount*this.yCellCount;I++)m.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,d,m,v){this._forEachCell(h,d,m,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(v)}insertCircle(o,h,d,m){this._forEachCell(h-m,d-m,h+m,d+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(d),this.circles.push(m)}_insertBoxCell(o,h,d,m,v,I){this.boxCells[v].push(I)}_insertCircleCell(o,h,d,m,v,I){this.circleCells[v].push(I)}_query(o,h,d,m,v,I,C){if(d<0||o>this.width||m<0||h>this.height)return[];const P=[];if(o<=0&&h<=0&&this.width<=d&&this.height<=m){if(v)return[{key:null,x1:o,y1:h,x2:d,y2:m}];for(let k=0;k<this.boxKeys.length;k++)P.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const R=this.circles[3*k],F=this.circles[3*k+1],Z=this.circles[3*k+2];P.push({key:this.circleKeys[k],x1:R-Z,y1:F-Z,x2:R+Z,y2:F+Z})}}else this._forEachCell(o,h,d,m,this._queryCell,P,{hitTest:v,overlapMode:I,seenUids:{box:{},circle:{}}},C);return P}query(o,h,d,m){return this._query(o,h,d,m,!1,null)}hitTest(o,h,d,m,v,I){return this._query(o,h,d,m,!0,v,I).length>0}hitTestCircle(o,h,d,m,v){const I=o-d,C=o+d,P=h-d,k=h+d;if(C<0||I>this.width||k<0||P>this.height)return!1;const R=[];return this._forEachCell(I,P,C,k,this._queryCellCircle,R,{hitTest:!0,overlapMode:m,circle:{x:o,y:h,radius:d},seenUids:{box:{},circle:{}}},v),R.length>0}_queryCell(o,h,d,m,v,I,C,P){const{seenUids:k,hitTest:R,overlapMode:F}=C,Z=this.boxCells[v];if(Z!==null){const ot=this.bboxes;for(const ut of Z)if(!k.box[ut]){k.box[ut]=!0;const rt=4*ut,St=this.boxKeys[ut];if(o<=ot[rt+2]&&h<=ot[rt+3]&&d>=ot[rt+0]&&m>=ot[rt+1]&&(!P||P(St))&&(!R||!Kr(F,St.overlapMode))&&(I.push({key:St,x1:ot[rt],y1:ot[rt+1],x2:ot[rt+2],y2:ot[rt+3]}),R))return!0}}const st=this.circleCells[v];if(st!==null){const ot=this.circles;for(const ut of st)if(!k.circle[ut]){k.circle[ut]=!0;const rt=3*ut,St=this.circleKeys[ut];if(this._circleAndRectCollide(ot[rt],ot[rt+1],ot[rt+2],o,h,d,m)&&(!P||P(St))&&(!R||!Kr(F,St.overlapMode))){const Ft=ot[rt],ft=ot[rt+1],Ct=ot[rt+2];if(I.push({key:St,x1:Ft-Ct,y1:ft-Ct,x2:Ft+Ct,y2:ft+Ct}),R)return!0}}}return!1}_queryCellCircle(o,h,d,m,v,I,C,P){const{circle:k,seenUids:R,overlapMode:F}=C,Z=this.boxCells[v];if(Z!==null){const ot=this.bboxes;for(const ut of Z)if(!R.box[ut]){R.box[ut]=!0;const rt=4*ut,St=this.boxKeys[ut];if(this._circleAndRectCollide(k.x,k.y,k.radius,ot[rt+0],ot[rt+1],ot[rt+2],ot[rt+3])&&(!P||P(St))&&!Kr(F,St.overlapMode))return I.push(!0),!0}}const st=this.circleCells[v];if(st!==null){const ot=this.circles;for(const ut of st)if(!R.circle[ut]){R.circle[ut]=!0;const rt=3*ut,St=this.circleKeys[ut];if(this._circlesCollide(ot[rt],ot[rt+1],ot[rt+2],k.x,k.y,k.radius)&&(!P||P(St))&&!Kr(F,St.overlapMode))return I.push(!0),!0}}}_forEachCell(o,h,d,m,v,I,C,P){const k=this._convertToXCellCoord(o),R=this._convertToYCellCoord(h),F=this._convertToXCellCoord(d),Z=this._convertToYCellCoord(m);for(let st=k;st<=F;st++)for(let ot=R;ot<=Z;ot++)if(v.call(this,o,h,d,m,this.xCellCount*ot+st,I,C,P))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,d,m,v,I){const C=m-o,P=v-h,k=d+I;return k*k>C*C+P*P}_circleAndRectCollide(o,h,d,m,v,I,C){const P=(I-m)/2,k=Math.abs(o-(m+P));if(k>P+d)return!1;const R=(C-v)/2,F=Math.abs(h-(v+R));if(F>R+d)return!1;if(k<=P||F<=R)return!0;const Z=k-P,st=F-R;return Z*Z+st*st<=d*d}}function ce(y,o,h,d,m){const v=u.Z();return o?(u.a0(v,v,[1/m,1/m,1]),h||u.ae(v,v,d.angle)):u.a1(v,d.labelPlaneMatrix,y),v}function Gi(y,o,h,d,m){if(o){const v=u.af(y);return u.a0(v,v,[m,m,1]),h||u.ae(v,v,-d.angle),v}return d.glCoordMatrix}function pr(y,o,h){let d;h?(d=[y.x,y.y,h(y.x,y.y),1],u.ag(d,d,o)):(d=[y.x,y.y,0,1],at(d,d,o));const m=d[3];return{point:new u.P(d[0]/m,d[1]/m),signedDistanceFromCamera:m}}function Os(y,o){return .5+y/o*.5}function Oi(y,o){const h=y[0]/y[3],d=y[1]/y[3];return h>=-o[0]&&h<=o[0]&&d>=-o[1]&&d<=o[1]}function pe(y,o,h,d,m,v,I,C,P,k){const R=d?y.textSizeData:y.iconSizeData,F=u.ah(R,h.transform.zoom),Z=[256/h.width*2+1,256/h.height*2+1],st=d?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;st.clear();const ot=y.lineVertexArray,ut=d?y.text.placedSymbolArray:y.icon.placedSymbolArray,rt=h.transform.width/h.transform.height;let St=!1;for(let Ft=0;Ft<ut.length;Ft++){const ft=ut.get(Ft);if(ft.hidden||ft.writingMode===u.ai.vertical&&!St){et(ft.numGlyphs,st);continue}let Ct;if(St=!1,k?(Ct=[ft.anchorX,ft.anchorY,k(ft.anchorX,ft.anchorY),1],u.ag(Ct,Ct,o)):(Ct=[ft.anchorX,ft.anchorY,0,1],at(Ct,Ct,o)),!Oi(Ct,Z)){et(ft.numGlyphs,st);continue}const $t=Os(h.transform.cameraToCenterDistance,Ct[3]),jt=u.aj(R,F,ft),te=I?jt/$t:jt*$t,ae=new u.P(ft.anchorX,ft.anchorY),re=pr(ae,m,k).point,ge={projections:{},offsets:{}},Be=li(ft,te,!1,C,o,m,v,y.glyphOffsetArray,ot,st,re,ae,ge,rt,P,k);St=Be.useVertical,(Be.notEnoughRoom||St||Be.needsFlipping&&li(ft,te,!0,C,o,m,v,y.glyphOffsetArray,ot,st,re,ae,ge,rt,P,k).notEnoughRoom)&&et(ft.numGlyphs,st)}d?y.text.dynamicLayoutVertexBuffer.updateData(st):y.icon.dynamicLayoutVertexBuffer.updateData(st)}function ln(y,o,h,d,m,v,I,C,P,k,R,F,Z){const st=C.glyphStartIndex+C.numGlyphs,ot=C.lineStartIndex,ut=C.lineStartIndex+C.lineLength,rt=o.getoffsetX(C.glyphStartIndex),St=o.getoffsetX(st-1),Ft=V(y*rt,h,d,m,v,I,C.segment,ot,ut,P,k,R,F,Z);if(!Ft)return null;const ft=V(y*St,h,d,m,v,I,C.segment,ot,ut,P,k,R,F,Z);return ft?{first:Ft,last:ft}:null}function tn(y,o,h,d){return y===u.ai.horizontal&&Math.abs(h.y-o.y)>Math.abs(h.x-o.x)*d?{useVertical:!0}:(y===u.ai.vertical?o.y<h.y:o.x>h.x)?{needsFlipping:!0}:null}function li(y,o,h,d,m,v,I,C,P,k,R,F,Z,st,ot,ut){const rt=o/24,St=y.lineOffsetX*rt,Ft=y.lineOffsetY*rt;let ft;if(y.numGlyphs>1){const Ct=y.glyphStartIndex+y.numGlyphs,$t=y.lineStartIndex,jt=y.lineStartIndex+y.lineLength,te=ln(rt,C,St,Ft,h,R,F,y,P,v,Z,ot,ut);if(!te)return{notEnoughRoom:!0};const ae=pr(te.first.point,I,ut).point,re=pr(te.last.point,I,ut).point;if(d&&!h){const ge=tn(y.writingMode,ae,re,st);if(ge)return ge}ft=[te.first];for(let ge=y.glyphStartIndex+1;ge<Ct-1;ge++)ft.push(V(rt*C.getoffsetX(ge),St,Ft,h,R,F,y.segment,$t,jt,P,v,Z,ot,ut));ft.push(te.last)}else{if(d&&!h){const $t=pr(F,m,ut).point,jt=y.lineStartIndex+y.segment+1,te=new u.P(P.getx(jt),P.gety(jt)),ae=pr(te,m,ut),re=ae.signedDistanceFromCamera>0?ae.point:ji(F,te,$t,1,m,ut),ge=tn(y.writingMode,$t,re,st);if(ge)return ge}const Ct=V(rt*C.getoffsetX(y.glyphStartIndex),St,Ft,h,R,F,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,P,v,Z,ot,ut);if(!Ct)return{notEnoughRoom:!0};ft=[Ct]}for(const Ct of ft)u.ak(k,Ct.point,Ct.angle);return{}}function ji(y,o,h,d,m,v){const I=pr(y.add(y.sub(o)._unit()),m,v).point,C=h.sub(I);return h.add(C._mult(d/C.mag()))}function Xe(y,o){const{projectionCache:h,lineVertexArray:d,labelPlaneMatrix:m,tileAnchorPoint:v,distanceFromAnchor:I,getElevation:C,previousVertex:P,direction:k,absOffsetX:R}=o;if(h.projections[y])return h.projections[y];const F=new u.P(d.getx(y),d.gety(y)),Z=pr(F,m,C);if(Z.signedDistanceFromCamera>0)return h.projections[y]=Z.point,Z.point;const st=y-k;return ji(I===0?v:new u.P(d.getx(st),d.gety(st)),F,P,R-I+1,m,C)}function qi(y,o,h){return y._unit()._perp()._mult(o*h)}function q(y,o,h,d,m,v,I,C){const{projectionCache:P,direction:k}=C;if(P.offsets[y])return P.offsets[y];const R=h.add(o);if(y+k<d||y+k>=m)return P.offsets[y]=R,R;const F=Xe(y+k,C),Z=qi(F.sub(h),I,k),st=h.add(Z),ot=F.add(Z);return P.offsets[y]=u.al(v,R,st,ot)||R,P.offsets[y]}function V(y,o,h,d,m,v,I,C,P,k,R,F,Z,st){const ot=d?y-o:y+o;let ut=ot>0?1:-1,rt=0;d&&(ut*=-1,rt=Math.PI),ut<0&&(rt+=Math.PI);let St,Ft,ft=ut>0?C+I:C+I+1,Ct=m,$t=m,jt=0,te=0;const ae=Math.abs(ot),re=[];let ge;for(;jt+te<=ae;){if(ft+=ut,ft<C||ft>=P)return null;jt+=te,$t=Ct,Ft=St;const Ie={projectionCache:F,lineVertexArray:k,labelPlaneMatrix:R,tileAnchorPoint:v,distanceFromAnchor:jt,getElevation:st,previousVertex:$t,direction:ut,absOffsetX:ae};if(Ct=Xe(ft,Ie),h===0)re.push($t),ge=Ct.sub($t);else{let rn;const Ge=Ct.sub($t);rn=Ge.mag()===0?qi(Xe(ft+ut,Ie).sub(Ct),h,ut):qi(Ge,h,ut),Ft||(Ft=$t.add(rn)),St=q(ft,rn,Ct,C,P,Ft,h,Ie),re.push(Ft),ge=St.sub(Ft)}te=ge.mag()}const Be=ge._mult((ae-jt)/te)._add(Ft||$t),kn=rt+Math.atan2(Ct.y-$t.y,Ct.x-$t.x);return re.push(Be),{point:Be,angle:Z?kn:0,path:re}}const G=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function et(y,o){for(let h=0;h<y;h++){const d=o.length;o.resize(d+4),o.float32.set(G,3*d)}}function at(y,o,h){const d=o[0],m=o[1];return y[0]=h[0]*d+h[4]*m+h[12],y[1]=h[1]*d+h[5]*m+h[13],y[3]=h[3]*d+h[7]*m+h[15],y}const lt=100;class It{constructor(o,h=new wi(o.width+200,o.height+200,25),d=new wi(o.width+200,o.height+200,25)){this.transform=o,this.grid=h,this.ignoredGrid=d,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+lt,this.screenBottomBoundary=o.height+lt,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,h,d,m,v,I){const C=this.projectAndGetPerspectiveRatio(m,o.anchorPointX,o.anchorPointY,I),P=d*C.perspectiveRatio,k=o.x1*P+C.point.x,R=o.y1*P+C.point.y,F=o.x2*P+C.point.x,Z=o.y2*P+C.point.y;return!this.isInsideGrid(k,R,F,Z)||h!=="always"&&this.grid.hitTest(k,R,F,Z,h,v)||C.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[k,R,F,Z],offscreen:this.isOffscreen(k,R,F,Z)}}placeCollisionCircles(o,h,d,m,v,I,C,P,k,R,F,Z,st,ot){const ut=[],rt=new u.P(h.anchorX,h.anchorY),St=pr(rt,I,ot),Ft=Os(this.transform.cameraToCenterDistance,St.signedDistanceFromCamera),ft=(R?v/Ft:v*Ft)/u.ap,Ct=pr(rt,C,ot).point,$t=ln(ft,m,h.lineOffsetX*ft,h.lineOffsetY*ft,!1,Ct,rt,h,d,C,{projections:{},offsets:{}},!1,ot);let jt=!1,te=!1,ae=!0;if($t){const re=.5*Z*Ft+st,ge=new u.P(-100,-100),Be=new u.P(this.screenRightBoundary,this.screenBottomBoundary),kn=new No,Ie=$t.first,rn=$t.last;let Ge=[];for(let wn=Ie.path.length-1;wn>=1;wn--)Ge.push(Ie.path[wn]);for(let wn=1;wn<rn.path.length;wn++)Ge.push(rn.path[wn]);const ur=2.5*re;if(P){const wn=Ge.map(Nn=>pr(Nn,P,ot));Ge=wn.some(Nn=>Nn.signedDistanceFromCamera<=0)?[]:wn.map(Nn=>Nn.point)}let Ln=[];if(Ge.length>0){const wn=Ge[0].clone(),Nn=Ge[0].clone();for(let pi=1;pi<Ge.length;pi++)wn.x=Math.min(wn.x,Ge[pi].x),wn.y=Math.min(wn.y,Ge[pi].y),Nn.x=Math.max(Nn.x,Ge[pi].x),Nn.y=Math.max(Nn.y,Ge[pi].y);Ln=wn.x>=ge.x&&Nn.x<=Be.x&&wn.y>=ge.y&&Nn.y<=Be.y?[Ge]:Nn.x<ge.x||wn.x>Be.x||Nn.y<ge.y||wn.y>Be.y?[]:u.am([Ge],ge.x,ge.y,Be.x,Be.y)}for(const wn of Ln){kn.reset(wn,.25*re);let Nn=0;Nn=kn.length<=.5*re?1:Math.ceil(kn.paddedLength/ur)+1;for(let pi=0;pi<Nn;pi++){const br=pi/Math.max(Nn-1,1),bo=kn.lerp(br),Wi=bo.x+lt,Ei=bo.y+lt;ut.push(Wi,Ei,re,0);const Gs=Wi-re,Ar=Ei-re,gl=Wi+re,ml=Ei+re;if(ae=ae&&this.isOffscreen(Gs,Ar,gl,ml),te=te||this.isInsideGrid(Gs,Ar,gl,ml),o!=="always"&&this.grid.hitTestCircle(Wi,Ei,re,o,F)&&(jt=!0,!k))return{circles:[],offscreen:!1,collisionDetected:jt}}}}return{circles:!k&&jt||!te||Ft<this.perspectiveRatioCutoff?[]:ut,offscreen:ae,collisionDetected:jt}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let d=1/0,m=1/0,v=-1/0,I=-1/0;for(const R of o){const F=new u.P(R.x+lt,R.y+lt);d=Math.min(d,F.x),m=Math.min(m,F.y),v=Math.max(v,F.x),I=Math.max(I,F.y),h.push(F)}const C=this.grid.query(d,m,v,I).concat(this.ignoredGrid.query(d,m,v,I)),P={},k={};for(const R of C){const F=R.key;if(P[F.bucketInstanceId]===void 0&&(P[F.bucketInstanceId]={}),P[F.bucketInstanceId][F.featureIndex])continue;const Z=[new u.P(R.x1,R.y1),new u.P(R.x2,R.y1),new u.P(R.x2,R.y2),new u.P(R.x1,R.y2)];u.an(h,Z)&&(P[F.bucketInstanceId][F.featureIndex]=!0,k[F.bucketInstanceId]===void 0&&(k[F.bucketInstanceId]=[]),k[F.bucketInstanceId].push(F.featureIndex))}return k}insertCollisionBox(o,h,d,m,v,I){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:v,collisionGroupID:I,overlapMode:h},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,d,m,v,I){const C=d?this.ignoredGrid:this.grid,P={bucketInstanceId:m,featureIndex:v,collisionGroupID:I,overlapMode:h};for(let k=0;k<o.length;k+=4)C.insertCircle(P,o[k],o[k+1],o[k+2])}projectAndGetPerspectiveRatio(o,h,d,m){let v;return m?(v=[h,d,m(h,d),1],u.ag(v,v,o)):(v=[h,d,0,1],at(v,v,o)),{point:new u.P((v[0]/v[3]+1)/2*this.transform.width+lt,(-v[1]/v[3]+1)/2*this.transform.height+lt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/v[3]*.5}}isOffscreen(o,h,d,m){return d<lt||o>=this.screenRightBoundary||m<lt||h>this.screenBottomBoundary}isInsideGrid(o,h,d,m){return d>=0&&o<this.gridRightBoundary&&m>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const o=u.ao([]);return u.$(o,o,[-100,-100,0]),o}}function vt(y,o,h){return o*(u.N/(y.tileSize*Math.pow(2,h-y.tileID.overscaledZ)))}class dt{constructor(o,h,d,m){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):m&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class bt{constructor(o,h,d,m,v){this.text=new dt(o?o.text:null,h,d,v),this.icon=new dt(o?o.icon:null,h,m,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Yt{constructor(o,h,d){this.text=o,this.icon=h,this.skipFade=d}}class Kt{constructor(){this.invProjMatrix=u.Z(),this.viewportMatrix=u.Z(),this.circles=[]}}class Jt{constructor(o,h,d,m,v){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=d,this.bucketIndex=m,this.tileID=v}}class z{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:d=>d.collisionGroupID===h}}return this.collisionGroups[o]}}function $(y,o,h,d,m){const{horizontalAlign:v,verticalAlign:I}=u.au(y);return new u.P(-(v-.5)*o+d[0]*m,-(I-.5)*h+d[1]*m)}function Y(y,o,h,d,m,v){const{x1:I,x2:C,y1:P,y2:k,anchorPointX:R,anchorPointY:F}=y,Z=new u.P(o,h);return d&&Z._rotate(m?v:-v),{x1:I+Z.x,y1:P+Z.y,x2:C+Z.x,y2:k+Z.y,anchorPointX:R,anchorPointY:F}}class yt{constructor(o,h,d,m,v){this.transform=o.clone(),this.terrain=h,this.collisionIndex=new It(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new z(m),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,d,m){const v=d.getBucket(h),I=d.latestFeatureIndex;if(!v||!I||h.id!==v.layerIds[0])return;const C=d.collisionBoxArray,P=v.layers[0].layout,k=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),R=d.tileSize/u.N,F=this.transform.calculatePosMatrix(d.tileID.toUnwrapped()),Z=P.get("text-pitch-alignment")==="map",st=P.get("text-rotation-alignment")==="map",ot=vt(d,1,this.transform.zoom),ut=ce(F,Z,st,this.transform,ot);let rt=null;if(Z){const Ft=Gi(F,Z,st,this.transform,ot);rt=u.a1([],this.transform.labelPlaneMatrix,Ft)}this.retainedQueryData[v.bucketInstanceId]=new Jt(v.bucketInstanceId,I,v.sourceLayerIndex,v.index,d.tileID);const St={bucket:v,layout:P,posMatrix:F,textLabelPlaneMatrix:ut,labelToScreenMatrix:rt,scale:k,textPixelRatio:R,holdingForFade:d.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:u.ah(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(m)for(const Ft of v.sortKeyRanges){const{sortKey:ft,symbolInstanceStart:Ct,symbolInstanceEnd:$t}=Ft;o.push({sortKey:ft,symbolInstanceStart:Ct,symbolInstanceEnd:$t,parameters:St})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:St})}attemptAnchorPlacement(o,h,d,m,v,I,C,P,k,R,F,Z,st,ot,ut,rt){const St=u.aq[o.textAnchor],Ft=[o.textOffset0,o.textOffset1],ft=$(St,d,m,Ft,v),Ct=this.collisionIndex.placeCollisionBox(Y(h,ft.x,ft.y,I,C,this.transform.angle),F,P,k,R.predicate,rt);if((!ut||this.collisionIndex.placeCollisionBox(Y(ut,ft.x,ft.y,I,C,this.transform.angle),F,P,k,R.predicate,rt).box.length!==0)&&Ct.box.length>0){let $t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&($t=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),Z.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Z.crossTileID]={textOffset:Ft,width:d,height:m,anchor:St,textBoxScale:v,prevAnchor:$t},this.markUsedJustification(st,St,Z,ot),st.allowVerticalPlacement&&(this.markUsedOrientation(st,ot,Z),this.placedOrientations[Z.crossTileID]=ot),{shift:ft,placedGlyphBoxes:Ct}}}placeLayerBucketPart(o,h,d){const{bucket:m,layout:v,posMatrix:I,textLabelPlaneMatrix:C,labelToScreenMatrix:P,textPixelRatio:k,holdingForFade:R,collisionBoxArray:F,partiallyEvaluatedTextSize:Z,collisionGroup:st}=o.parameters,ot=v.get("text-optional"),ut=v.get("icon-optional"),rt=u.ar(v,"text-overlap","text-allow-overlap"),St=rt==="always",Ft=u.ar(v,"icon-overlap","icon-allow-overlap"),ft=Ft==="always",Ct=v.get("text-rotation-alignment")==="map",$t=v.get("text-pitch-alignment")==="map",jt=v.get("icon-text-fit")!=="none",te=v.get("symbol-z-order")==="viewport-y",ae=St&&(ft||!m.hasIconData()||ut),re=ft&&(St||!m.hasTextData()||ot);!m.collisionArrays&&F&&m.deserializeCollisionBoxes(F);const ge=this.retainedQueryData[m.bucketInstanceId].tileID,Be=this.terrain?(Ie,rn)=>this.terrain.getElevation(ge,Ie,rn):null,kn=(Ie,rn)=>{var Ge,ur;if(h[Ie.crossTileID])return;if(R)return void(this.placements[Ie.crossTileID]=new Yt(!1,!1,!1));let Ln=!1,wn=!1,Nn=!0,pi=null,br={box:null,offscreen:null},bo={box:null,offscreen:null},Wi=null,Ei=null,Gs=null,Ar=0,gl=0,ml=0;rn.textFeatureIndex?Ar=rn.textFeatureIndex:Ie.useRuntimeCollisionCircles&&(Ar=Ie.featureIndex),rn.verticalTextFeatureIndex&&(gl=rn.verticalTextFeatureIndex);const Fu=rn.textBox;if(Fu){const Bo=fi=>{let Hi=u.ai.horizontal;if(m.allowVerticalPlacement&&!fi&&this.prevPlacement){const xs=this.prevPlacement.placedOrientations[Ie.crossTileID];xs&&(this.placedOrientations[Ie.crossTileID]=xs,Hi=xs,this.markUsedOrientation(m,Hi,Ie))}return Hi},Eo=(fi,Hi)=>{if(m.allowVerticalPlacement&&Ie.numVerticalGlyphVertices>0&&rn.verticalTextBox){for(const xs of m.writingModes)if(xs===u.ai.vertical?(br=Hi(),bo=br):br=fi(),br&&br.box&&br.box.length)break}else br=fi()},os=Ie.textAnchorOffsetStartIndex,Ec=Ie.textAnchorOffsetEndIndex;if(Ec===os){const fi=(Hi,xs)=>{const di=this.collisionIndex.placeCollisionBox(Hi,rt,k,I,st.predicate,Be);return di&&di.box&&di.box.length&&(this.markUsedOrientation(m,xs,Ie),this.placedOrientations[Ie.crossTileID]=xs),di};Eo(()=>fi(Fu,u.ai.horizontal),()=>{const Hi=rn.verticalTextBox;return m.allowVerticalPlacement&&Ie.numVerticalGlyphVertices>0&&Hi?fi(Hi,u.ai.vertical):{box:null,offscreen:null}}),Bo(br&&br.box&&br.box.length)}else{let fi=u.aq[(ur=(Ge=this.prevPlacement)===null||Ge===void 0?void 0:Ge.variableOffsets[Ie.crossTileID])===null||ur===void 0?void 0:ur.anchor];const Hi=(di,Sc,Cf)=>{const Qm=di.x2-di.x1,ty=di.y2-di.y1,Pv=Ie.textBoxScale,ag=jt&&Ft==="never"?Sc:null;let yl={box:[],offscreen:!1},Ic=rt==="never"?1:2,_l="never";fi&&Ic++;for(let _a=0;_a<Ic;_a++){for(let vl=os;vl<Ec;vl++){const lg=m.textAnchorOffsets.get(vl);if(fi&&lg.textAnchor!==fi)continue;const eu=this.attemptAnchorPlacement(lg,di,Qm,ty,Pv,Ct,$t,k,I,st,_l,Ie,m,Cf,ag,Be);if(eu&&(yl=eu.placedGlyphBoxes,yl&&yl.box&&yl.box.length))return Ln=!0,pi=eu.shift,yl}fi?fi=null:_l=rt}return yl};Eo(()=>Hi(Fu,rn.iconBox,u.ai.horizontal),()=>{const di=rn.verticalTextBox;return m.allowVerticalPlacement&&!(br&&br.box&&br.box.length)&&Ie.numVerticalGlyphVertices>0&&di?Hi(di,rn.verticalIconBox,u.ai.vertical):{box:null,offscreen:null}}),br&&(Ln=br.box,Nn=br.offscreen);const xs=Bo(br&&br.box);if(!Ln&&this.prevPlacement){const di=this.prevPlacement.variableOffsets[Ie.crossTileID];di&&(this.variableOffsets[Ie.crossTileID]=di,this.markUsedJustification(m,di.anchor,Ie,xs))}}}if(Wi=br,Ln=Wi&&Wi.box&&Wi.box.length>0,Nn=Wi&&Wi.offscreen,Ie.useRuntimeCollisionCircles){const Bo=m.text.placedSymbolArray.get(Ie.centerJustifiedTextSymbolIndex),Eo=u.aj(m.textSizeData,Z,Bo),os=v.get("text-padding");Ei=this.collisionIndex.placeCollisionCircles(rt,Bo,m.lineVertexArray,m.glyphOffsetArray,Eo,I,C,P,d,$t,st.predicate,Ie.collisionCircleDiameter,os,Be),Ei.circles.length&&Ei.collisionDetected&&!d&&u.w("Collisions detected, but collision boxes are not shown"),Ln=St||Ei.circles.length>0&&!Ei.collisionDetected,Nn=Nn&&Ei.offscreen}if(rn.iconFeatureIndex&&(ml=rn.iconFeatureIndex),rn.iconBox){const Bo=Eo=>{const os=jt&&pi?Y(Eo,pi.x,pi.y,Ct,$t,this.transform.angle):Eo;return this.collisionIndex.placeCollisionBox(os,Ft,k,I,st.predicate,Be)};bo&&bo.box&&bo.box.length&&rn.verticalIconBox?(Gs=Bo(rn.verticalIconBox),wn=Gs.box.length>0):(Gs=Bo(rn.iconBox),wn=Gs.box.length>0),Nn=Nn&&Gs.offscreen}const bc=ot||Ie.numHorizontalGlyphVertices===0&&Ie.numVerticalGlyphVertices===0,Ih=ut||Ie.numIconVertices===0;if(bc||Ih?Ih?bc||(wn=wn&&Ln):Ln=wn&&Ln:wn=Ln=wn&&Ln,Ln&&Wi&&Wi.box&&this.collisionIndex.insertCollisionBox(Wi.box,rt,v.get("text-ignore-placement"),m.bucketInstanceId,bo&&bo.box&&gl?gl:Ar,st.ID),wn&&Gs&&this.collisionIndex.insertCollisionBox(Gs.box,Ft,v.get("icon-ignore-placement"),m.bucketInstanceId,ml,st.ID),Ei&&(Ln&&this.collisionIndex.insertCollisionCircles(Ei.circles,rt,v.get("text-ignore-placement"),m.bucketInstanceId,Ar,st.ID),d)){const Bo=m.bucketInstanceId;let Eo=this.collisionCircleArrays[Bo];Eo===void 0&&(Eo=this.collisionCircleArrays[Bo]=new Kt);for(let os=0;os<Ei.circles.length;os+=4)Eo.circles.push(Ei.circles[os+0]),Eo.circles.push(Ei.circles[os+1]),Eo.circles.push(Ei.circles[os+2]),Eo.circles.push(Ei.collisionDetected?1:0)}if(Ie.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(m.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ie.crossTileID]=new Yt(Ln||ae,wn||re,Nn||m.justReloaded),h[Ie.crossTileID]=!0};if(te){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ie=m.getSortedSymbolIndexes(this.transform.angle);for(let rn=Ie.length-1;rn>=0;--rn){const Ge=Ie[rn];kn(m.symbolInstances.get(Ge),m.collisionArrays[Ge])}}else for(let Ie=o.symbolInstanceStart;Ie<o.symbolInstanceEnd;Ie++)kn(m.symbolInstances.get(Ie),m.collisionArrays[Ie]);if(d&&m.bucketInstanceId in this.collisionCircleArrays){const Ie=this.collisionCircleArrays[m.bucketInstanceId];u.as(Ie.invProjMatrix,I),Ie.viewportMatrix=this.collisionIndex.getViewportMatrix()}m.justReloaded=!1}markUsedJustification(o,h,d,m){let v;v=m===u.ai.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[u.at(h)];const I=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const C of I)C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=v>=0&&C!==v?0:d.crossTileID)}markUsedOrientation(o,h,d){const m=h===u.ai.horizontal||h===u.ai.horizontalOnly?h:0,v=h===u.ai.vertical?h:0,I=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const C of I)o.text.placedSymbolArray.get(C).placedOrientation=m;d.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let d=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const m=h?h.symbolFadeChange(o):1,v=h?h.opacities:{},I=h?h.variableOffsets:{},C=h?h.placedOrientations:{};for(const P in this.placements){const k=this.placements[P],R=v[P];R?(this.opacities[P]=new bt(R,m,k.text,k.icon),d=d||k.text!==R.text.placed||k.icon!==R.icon.placed):(this.opacities[P]=new bt(null,m,k.text,k.icon,k.skipFade),d=d||k.text||k.icon)}for(const P in v){const k=v[P];if(!this.opacities[P]){const R=new bt(k,m,!1,!1);R.isHidden()||(this.opacities[P]=R,d=d||k.text.placed||k.icon.placed)}}for(const P in I)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=I[P]);for(const P in C)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=C[P]);if(h&&h.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h){const d={};for(const m of h){const v=m.getBucket(o);v&&m.latestFeatureIndex&&o.id===v.layerIds[0]&&this.updateBucketOpacities(v,d,m.collisionBoxArray)}}updateBucketOpacities(o,h,d){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const m=o.layers[0],v=m.layout,I=new bt(null,0,!1,!1,!0),C=v.get("text-allow-overlap"),P=v.get("icon-allow-overlap"),k=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),R=v.get("text-rotation-alignment")==="map",F=v.get("text-pitch-alignment")==="map",Z=v.get("icon-text-fit")!=="none",st=new bt(null,0,C&&(P||!o.hasIconData()||v.get("icon-optional")),P&&(C||!o.hasTextData()||v.get("text-optional")),!0);!o.collisionArrays&&d&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(d);const ot=(ut,rt,St)=>{for(let Ft=0;Ft<rt/4;Ft++)ut.opacityVertexArray.emplaceBack(St);ut.hasVisibleVertices=ut.hasVisibleVertices||St!==fn};for(let ut=0;ut<o.symbolInstances.length;ut++){const rt=o.symbolInstances.get(ut),{numHorizontalGlyphVertices:St,numVerticalGlyphVertices:Ft,crossTileID:ft}=rt;let Ct=this.opacities[ft];h[ft]?Ct=I:Ct||(Ct=st,this.opacities[ft]=Ct),h[ft]=!0;const $t=rt.numIconVertices>0,jt=this.placedOrientations[rt.crossTileID],te=jt===u.ai.vertical,ae=jt===u.ai.horizontal||jt===u.ai.horizontalOnly;if(St>0||Ft>0){const re=qe(Ct.text);ot(o.text,St,te?fn:re),ot(o.text,Ft,ae?fn:re);const ge=Ct.text.isHidden();[rt.rightJustifiedTextSymbolIndex,rt.centerJustifiedTextSymbolIndex,rt.leftJustifiedTextSymbolIndex].forEach(Ie=>{Ie>=0&&(o.text.placedSymbolArray.get(Ie).hidden=ge||te?1:0)}),rt.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(rt.verticalPlacedTextSymbolIndex).hidden=ge||ae?1:0);const Be=this.variableOffsets[rt.crossTileID];Be&&this.markUsedJustification(o,Be.anchor,rt,jt);const kn=this.placedOrientations[rt.crossTileID];kn&&(this.markUsedJustification(o,"left",rt,kn),this.markUsedOrientation(o,kn,rt))}if($t){const re=qe(Ct.icon),ge=!(Z&&rt.verticalPlacedIconSymbolIndex&&te);rt.placedIconSymbolIndex>=0&&(ot(o.icon,rt.numIconVertices,ge?re:fn),o.icon.placedSymbolArray.get(rt.placedIconSymbolIndex).hidden=Ct.icon.isHidden()),rt.verticalPlacedIconSymbolIndex>=0&&(ot(o.icon,rt.numVerticalIconVertices,ge?fn:re),o.icon.placedSymbolArray.get(rt.verticalPlacedIconSymbolIndex).hidden=Ct.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const re=o.collisionArrays[ut];if(re){let ge=new u.P(0,0);if(re.textBox||re.verticalTextBox){let kn=!0;if(k){const Ie=this.variableOffsets[ft];Ie?(ge=$(Ie.anchor,Ie.width,Ie.height,Ie.textOffset,Ie.textBoxScale),R&&ge._rotate(F?this.transform.angle:-this.transform.angle)):kn=!1}re.textBox&&gt(o.textCollisionBox.collisionVertexArray,Ct.text.placed,!kn||te,ge.x,ge.y),re.verticalTextBox&&gt(o.textCollisionBox.collisionVertexArray,Ct.text.placed,!kn||ae,ge.x,ge.y)}const Be=!!(!ae&&re.verticalIconBox);re.iconBox&&gt(o.iconCollisionBox.collisionVertexArray,Ct.icon.placed,Be,Z?ge.x:0,Z?ge.y:0),re.verticalIconBox&&gt(o.iconCollisionBox.collisionVertexArray,Ct.icon.placed,!Be,Z?ge.x:0,Z?ge.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const ut=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=ut.invProjMatrix,o.placementViewportMatrix=ut.viewportMatrix,o.collisionCircleArray=ut.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){const d=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*d>o}setStale(){this.stale=!0}}function gt(y,o,h,d,m){y.emplaceBack(o?1:0,h?1:0,d||0,m||0),y.emplaceBack(o?1:0,h?1:0,d||0,m||0),y.emplaceBack(o?1:0,h?1:0,d||0,m||0),y.emplaceBack(o?1:0,h?1:0,d||0,m||0)}const Mt=Math.pow(2,25),Nt=Math.pow(2,24),Qt=Math.pow(2,17),Ut=Math.pow(2,16),ie=Math.pow(2,9),oe=Math.pow(2,8),ze=Math.pow(2,1);function qe(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const o=y.placed?1:0,h=Math.floor(127*y.opacity);return h*Mt+o*Nt+h*Qt+o*Ut+h*ie+o*oe+h*ze+o}const fn=0;class vr{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,h,d,m,v){const I=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(I,m,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((C,P)=>C.sortKey-P.sortKey));this._currentPartIndex<I.length;)if(h.placeLayerBucketPart(I[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,v())return!0;return!1}}class Hn{constructor(o,h,d,m,v,I,C,P){this.placement=new yt(o,h,I,C,P),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(o,h,d){const m=u.h.now(),v=()=>!this._forceFullPlacement&&u.h.now()-m>2;for(;this._currentPlacementIndex>=0;){const I=h[o[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(I.type==="symbol"&&(!I.minzoom||I.minzoom<=C)&&(!I.maxzoom||I.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new vr(I)),this._inProgressLayer.continuePlacement(d[I.source],this.placement,this._showCollisionBoxes,I,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const fr=512/u.N/2;class In{constructor(o,h,d){this.tileID=o,this.bucketInstanceId=d,this._symbolsByKey={};const m=new Map;for(let v=0;v<h.length;v++){const I=h.get(v),C=I.key,P=m.get(C);P?P.push(I):m.set(C,[I])}for(const[v,I]of m){const C={positions:I.map(P=>({x:Math.floor(P.anchorX*fr),y:Math.floor(P.anchorY*fr)})),crossTileIDs:I.map(P=>P.crossTileID)};if(C.positions.length>128){const P=new u.av(C.positions.length,16,Uint16Array);for(const{x:k,y:R}of C.positions)P.add(k,R);P.finish(),delete C.positions,C.index=P}this._symbolsByKey[v]=C}}getScaledCoordinates(o,h){const{x:d,y:m,z:v}=this.tileID.canonical,{x:I,y:C,z:P}=h.canonical,k=fr/Math.pow(2,P-v),R=(C*u.N+o.anchorY)*k,F=m*u.N*fr;return{x:Math.floor((I*u.N+o.anchorX)*k-d*u.N*fr),y:Math.floor(R-F)}}findMatches(o,h,d){const m=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let v=0;v<o.length;v++){const I=o.get(v);if(I.crossTileID)continue;const C=this._symbolsByKey[I.key];if(!C)continue;const P=this.getScaledCoordinates(I,h);if(C.index){const k=C.index.range(P.x-m,P.y-m,P.x+m,P.y+m).sort();for(const R of k){const F=C.crossTileIDs[R];if(!d[F]){d[F]=!0,I.crossTileID=F;break}}}else if(C.positions)for(let k=0;k<C.positions.length;k++){const R=C.positions[k],F=C.crossTileIDs[k];if(Math.abs(R.x-P.x)<=m&&Math.abs(R.y-P.y)<=m&&!d[F]){d[F]=!0,I.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class Sn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Or{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const h=Math.round((o-this.lng)/360);if(h!==0)for(const d in this.indexes){const m=this.indexes[d],v={};for(const I in m){const C=m[I];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+h),v[C.tileID.key]=C}this.indexes[d]=v}this.lng=o}addBucket(o,h,d){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let v=0;v<h.symbolInstances.length;v++)h.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const m=this.usedCrossTileIDs[o.overscaledZ];for(const v in this.indexes){const I=this.indexes[v];if(Number(v)>o.overscaledZ)for(const C in I){const P=I[C];P.tileID.isChildOf(o)&&P.findMatches(h.symbolInstances,o,m)}else{const C=I[o.scaledTo(Number(v)).key];C&&C.findMatches(h.symbolInstances,o,m)}}for(let v=0;v<h.symbolInstances.length;v++){const I=h.symbolInstances.get(v);I.crossTileID||(I.crossTileID=d.generate(),m[I.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new In(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(const d of h.getCrossTileIDsLists())for(const m of d)delete this.usedCrossTileIDs[o][m]}removeStaleBuckets(o){let h=!1;for(const d in this.indexes){const m=this.indexes[d];for(const v in m)o[m[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,m[v]),delete m[v],h=!0)}return h}}class nr{constructor(){this.layerIndexes={},this.crossTileIDs=new Sn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,d){let m=this.layerIndexes[o.id];m===void 0&&(m=this.layerIndexes[o.id]=new Or);let v=!1;const I={};m.handleWrapJump(d);for(const C of h){const P=C.getBucket(o);P&&o.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(C.tileID,P,this.crossTileIDs)&&(v=!0),I[P.bucketInstanceId]=!0)}return m.removeStaleBuckets(I)&&(v=!0),v}pruneUnusedLayers(o){const h={};o.forEach(d=>{h[d]=!0});for(const d in this.layerIndexes)h[d]||delete this.layerIndexes[d]}}const Fn=(y,o)=>u.x(y,o&&o.filter(h=>h.identifier!=="source.canvas")),ui=u.F(u.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),dr=u.F(u.ax,["setCenter","setZoom","setBearing","setPitch"]),jr=u.aw();class qr extends u.E{constructor(o,h={}){super(),this.map=o,this.dispatcher=new _n(Rs(),this,o._getMapId()),this.imageManager=new ue,this.imageManager.setEventedParent(this),this.glyphManager=new Ue(o._requestManager,h.localIdeographFontFamily),this.lineAtlas=new Qe(256,512),this.crossTileSymbolIndex=new nr,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.az());const d=this;this._rtlTextPluginCallback=qr.registerForPluginStateChange(m=>{d.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:m.pluginStatus,pluginURL:m.pluginURL},(v,I)=>{if(u.aA(v),I&&I.every(C=>C))for(const C in d.sourceCaches){const P=d.sourceCaches[C].getSource().type;P!=="vector"&&P!=="geojson"||d.sourceCaches[C].reload()}})}),this.on("data",m=>{if(m.dataType!=="source"||m.sourceDataType!=="metadata")return;const v=this.sourceCaches[m.sourceId];if(!v)return;const I=v.getSource();if(I&&I.vectorLayerIds)for(const C in this._layers){const P=this._layers[C];P.source===I.id&&this._validateLayer(P)}})}loadURL(o,h={},d){this.fire(new u.k("dataloading",{dataType:"style"})),h.validate=typeof h.validate!="boolean"||h.validate;const m=this.map._requestManager.transformRequest(o,J.Style);this._request=u.f(m,(v,I)=>{this._request=null,v?this.fire(new u.j(v)):I&&this._load(I,h,d)})}loadJSON(o,h={},d){this.fire(new u.k("dataloading",{dataType:"style"})),this._request=u.h.frame(()=>{this._request=null,h.validate=h.validate!==!1,this._load(o,h,d)})}loadEmpty(){this.fire(new u.k("dataloading",{dataType:"style"})),this._load(jr,{validate:!1})}_load(o,h,d){var m;const v=h.transformStyle?h.transformStyle(d,o):o;if(!h.validate||!Fn(this,u.y(v))){this._loaded=!0,this.stylesheet=v;for(const I in v.sources)this.addSource(I,v.sources[I],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new Fe(this.stylesheet.light),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new u.k("data",{dataType:"style"})),this.fire(new u.k("style.load"))}}_createLayers(){const o=u.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",o),this._order=o.map(h=>h.id),this._layers={},this._serializedLayers=null;for(const h of o){const d=u.aC(h);d.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=d}}_loadSprite(o,h=!1,d=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(m,v,I,C){const P=At(m),k=P.length,R=I>1?"@2x":"",F={},Z={},st={};for(const{id:ot,url:ut}of P){const rt=v.transformRequest(v.normalizeSpriteURL(ut,R,".json"),J.SpriteJSON),St=`${ot}_${rt.url}`;F[St]=u.f(rt,(Ct,$t)=>{delete F[St],Z[ot]=$t,Ht(C,Z,st,Ct,k)});const Ft=v.transformRequest(v.normalizeSpriteURL(ut,R,".png"),J.SpriteImage),ft=`${ot}_${Ft.url}`;F[ft]=pt.getImage(Ft,(Ct,$t)=>{delete F[ft],st[ot]=$t,Ht(C,Z,st,Ct,k)})}return{cancel(){for(const ot of Object.values(F))ot.cancel()}}}(o,this.map._requestManager,this.map.getPixelRatio(),(m,v)=>{if(this._spriteRequest=null,m)this.fire(new u.j(m));else if(v)for(const I in v){this._spritesImagesIds[I]=[];const C=this._spritesImagesIds[I]?this._spritesImagesIds[I].filter(P=>!(P in v)):[];for(const P of C)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in v[I]){const k=I==="default"?P:`${I}:${P}`;this._spritesImagesIds[I].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,v[I][P],!1):this.imageManager.addImage(k,v[I][P]),h&&(this._changedImages[k]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),h&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"})),d&&d(m)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}_validateLayer(o){const h=this.sourceCaches[o.source];if(!h)return;const d=o.sourceLayer;if(!d)return;const m=h.getSource();(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(d)===-1)&&this.fire(new u.j(new Error(`Source layer "${d}" does not exist on source "${m.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o){const h=this._serializedAllLayers();if(!o||o.length===0)return Object.values(h);const d=[];for(const m of o)h[m]&&d.push(h[m]);return d}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const h=Object.keys(this._layers);for(const d of h){const m=this._layers[d];m.type!=="custom"&&(o[d]=m.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const h=this._changed;if(this._changed){const m=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(m.length||v.length)&&this._updateWorkerLayers(m,v);for(const I in this._updatedSources){const C=this._updatedSources[I];if(C==="reload")this._reloadSource(I);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(I)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const I in this._updatedPaintProps)this._layers[I].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const d={};for(const m in this.sourceCaches){const v=this.sourceCaches[m];d[m]=v.used,v.used=!1}for(const m of this._order){const v=this._layers[m];v.recalculate(o,this._availableImages),!v.isHidden(o.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const m in d){const v=this.sourceCaches[m];d[m]!==v.used&&v.fire(new u.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:m}))}this.light.recalculate(o),this.z=o.zoom,h&&this.fire(new u.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(o),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,h={}){this._checkLoaded();const d=this.serialize();if(o=h.transformStyle?h.transformStyle(d,o):o,Fn(this,u.y(o)))return!1;(o=u.aD(o)).layers=u.aB(o.layers);const m=u.aE(d,o).filter(I=>!(I.command in dr));if(m.length===0)return!1;const v=m.filter(I=>!(I.command in ui));if(v.length>0)throw new Error(`Unimplemented: ${v.map(I=>I.command).join(", ")}.`);for(const I of m)I.command!=="setTransition"&&this[I.command].apply(this,I.args);return this.stylesheet=o,this._serializedLayers=null,!0}addImage(o,h){if(this.getImage(o))return this.fire(new u.j(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,h),this._afterImageUpdated(o)}updateImage(o,h){this.imageManager.updateImage(o,h)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new u.j(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,h,d={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(u.y.source,`sources.${o}`,h,null,d))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const m=this.sourceCaches[o]=new Ri(o,h,this.dispatcher);m.style=this,m.setEventedParent(this,()=>({isSourceLoaded:m.loaded(),source:m.serialize(),sourceId:o})),m.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===o)return this.fire(new u.j(new Error(`Source "${o}" cannot be removed while layer "${d}" is using it.`)));const h=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],h.fire(new u.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),h.setEventedParent(null),h.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,h){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const d=this.sourceCaches[o].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(h),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,h,d={}){this._checkLoaded();const m=o.id;if(this.getLayer(m))return void this.fire(new u.j(new Error(`Layer "${m}" already exists on this map.`)));let v;if(o.type==="custom"){if(Fn(this,u.aF(o)))return;v=u.aC(o)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(m,o.source),o=u.aD(o),o=u.e(o,{source:m})),this._validate(u.y.layer,`layers.${m}`,o,{arrayIndex:-1},d))return;v=u.aC(o),this._validateLayer(v),v.setEventedParent(this,{layer:{id:m}})}const I=h?this._order.indexOf(h):this._order.length;if(h&&I===-1)this.fire(new u.j(new Error(`Cannot add layer "${m}" before non-existing layer "${h}".`)));else{if(this._order.splice(I,0,m),this._layerOrderChanged=!0,this._layers[m]=v,this._removedLayers[m]&&v.source&&v.type!=="custom"){const C=this._removedLayers[m];delete this._removedLayers[m],C.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(o,h){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new u.j(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===h)return;const d=this._order.indexOf(o);this._order.splice(d,1);const m=h?this._order.indexOf(h):this._order.length;h&&m===-1?this.fire(new u.j(new Error(`Cannot move layer "${o}" before non-existing layer "${h}".`))):(this._order.splice(m,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const h=this._layers[o];if(!h)return void this.fire(new u.j(new Error(`Cannot remove non-existing layer "${o}".`)));h.setEventedParent(null);const d=this._order.indexOf(o);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=h,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],h.onRemove&&h.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,h,d){this._checkLoaded();const m=this.getLayer(o);m?m.minzoom===h&&m.maxzoom===d||(h!=null&&(m.minzoom=h),d!=null&&(m.maxzoom=d),this._updateLayer(m)):this.fire(new u.j(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,h,d={}){this._checkLoaded();const m=this.getLayer(o);if(m){if(!u.aG(m.filter,h))return h==null?(m.filter=void 0,void this._updateLayer(m)):void(this._validate(u.y.filter,`layers.${m.id}.filter`,h,null,d)||(m.filter=u.aD(h),this._updateLayer(m)))}else this.fire(new u.j(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return u.aD(this.getLayer(o).filter)}setLayoutProperty(o,h,d,m={}){this._checkLoaded();const v=this.getLayer(o);v?u.aG(v.getLayoutProperty(h),d)||(v.setLayoutProperty(h,d,m),this._updateLayer(v)):this.fire(new u.j(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,h){const d=this.getLayer(o);if(d)return d.getLayoutProperty(h);this.fire(new u.j(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,h,d,m={}){this._checkLoaded();const v=this.getLayer(o);v?u.aG(v.getPaintProperty(h),d)||(v.setPaintProperty(h,d,m)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new u.j(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,h){return this.getLayer(o).getPaintProperty(h)}setFeatureState(o,h){this._checkLoaded();const d=o.source,m=o.sourceLayer,v=this.sourceCaches[d];if(v===void 0)return void this.fire(new u.j(new Error(`The source '${d}' does not exist in the map's style.`)));const I=v.getSource().type;I==="geojson"&&m?this.fire(new u.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):I!=="vector"||m?(o.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),v.setFeatureState(m,o.id,h)):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,h){this._checkLoaded();const d=o.source,m=this.sourceCaches[d];if(m===void 0)return void this.fire(new u.j(new Error(`The source '${d}' does not exist in the map's style.`)));const v=m.getSource().type,I=v==="vector"?o.sourceLayer:void 0;v!=="vector"||I?h&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new u.j(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(I,o.id,h):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const h=o.source,d=o.sourceLayer,m=this.sourceCaches[h];if(m!==void 0)return m.getSource().type!=="vector"||d?(o.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),m.getFeatureState(d,o.id)):void this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.j(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=u.aH(this.sourceCaches,v=>v.serialize()),h=this._serializeByIds(this._order),d=this.map.getTerrain()||void 0,m=this.stylesheet;return u.aI({version:m.version,name:m.name,metadata:m.metadata,light:m.light,center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,sprite:m.sprite,glyphs:m.glyphs,transition:m.transition,sources:o,layers:h,terrain:d},v=>v!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const h=I=>this._layers[I].type==="fill-extrusion",d={},m=[];for(let I=this._order.length-1;I>=0;I--){const C=this._order[I];if(h(C)){d[C]=I;for(const P of o){const k=P[C];if(k)for(const R of k)m.push(R)}}}m.sort((I,C)=>C.intersectionZ-I.intersectionZ);const v=[];for(let I=this._order.length-1;I>=0;I--){const C=this._order[I];if(h(C))for(let P=m.length-1;P>=0;P--){const k=m[P].feature;if(d[k.layer.id]<I)break;v.push(k),m.pop()}else for(const P of o){const k=P[C];if(k)for(const R of k)v.push(R.feature)}}return v}queryRenderedFeatures(o,h,d){h&&h.filter&&this._validate(u.y.filter,"queryRenderedFeatures.filter",h.filter,null,h);const m={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new u.j(new Error("parameters.layers must be an Array."))),[];for(const C of h.layers){const P=this._layers[C];if(!P)return this.fire(new u.j(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];m[P.source]=!0}}const v=[];h.availableImages=this._availableImages;const I=this._serializedAllLayers();for(const C in this.sourceCaches)h.layers&&!m[C]||v.push(vn(this.sourceCaches[C],this._layers,I,o,h,d));return this.placement&&v.push(function(C,P,k,R,F,Z,st){const ot={},ut=Z.queryRenderedSymbols(R),rt=[];for(const St of Object.keys(ut).map(Number))rt.push(st[St]);rt.sort(Di);for(const St of rt){const Ft=St.featureIndex.lookupSymbolFeatures(ut[St.bucketInstanceId],P,St.bucketIndex,St.sourceLayerIndex,F.filter,F.layers,F.availableImages,C);for(const ft in Ft){const Ct=ot[ft]=ot[ft]||[],$t=Ft[ft];$t.sort((jt,te)=>{const ae=St.featureSortOrder;if(ae){const re=ae.indexOf(jt.featureIndex);return ae.indexOf(te.featureIndex)-re}return te.featureIndex-jt.featureIndex});for(const jt of $t)Ct.push(jt)}}for(const St in ot)ot[St].forEach(Ft=>{const ft=Ft.feature,Ct=k[C[St].source].getFeatureState(ft.layer["source-layer"],ft.id);ft.source=ft.layer.source,ft.layer["source-layer"]&&(ft.sourceLayer=ft.layer["source-layer"]),ft.state=Ct});return ot}(this._layers,I,this.sourceCaches,o,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(o,h){h&&h.filter&&this._validate(u.y.filter,"querySourceFeatures.filter",h.filter,null,h);const d=this.sourceCaches[o];return d?function(m,v){const I=m.getRenderableIds().map(k=>m.getTileByID(k)),C=[],P={};for(let k=0;k<I.length;k++){const R=I[k],F=R.tileID.canonical.key;P[F]||(P[F]=!0,R.querySourceFeatures(C,v))}return C}(d,h):[]}addSourceType(o,h,d){return Dn(o)?d(new Error(`A source type called "${o}" already exists.`)):(((m,v)=>{xi[m]=v})(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},d):d(null,null))}getLight(){return this.light.getLight()}setLight(o,h={}){this._checkLoaded();const d=this.light.getLight();let m=!1;for(const I in o)if(!u.aG(o[I],d[I])){m=!0;break}if(!m)return;const v={now:u.h.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,h),this.light.updateTransitions(v)}_validate(o,h,d,m,v={}){return(!v||v.validate!==!1)&&Fn(this,o.call(u.y,u.e({key:h,style:this.serialize(),value:d,styleSpec:u.v},m)))}_remove(o=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this.sourceCaches){const d=this.sourceCaches[h];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const h in this.sourceCaches)this.sourceCaches[h].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,h,d,m,v=!1){let I=!1,C=!1;const P={};for(const k of this._order){const R=this._layers[k];if(R.type!=="symbol")continue;if(!P[R.source]){const Z=this.sourceCaches[R.source];P[R.source]=Z.getRenderableIds(!0).map(st=>Z.getTileByID(st)).sort((st,ot)=>ot.tileID.overscaledZ-st.tileID.overscaledZ||(st.tileID.isLessThan(ot.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(R,P[R.source],o.center.lng);I=I||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.h.now(),o.zoom))&&(this.pauseablePlacement=new Hn(o,this.map.terrain,this._order,v,h,d,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.h.now()),C=!0),I&&this.pauseablePlacement.placement.setStale()),C||I)for(const k of this._order){const R=this._layers[k];R.type==="symbol"&&this.placement.updateLayerOpacities(R,P[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.h.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,h,d){this.imageManager.getImages(h.icons,d),this._updateTilesForChangedImages();const m=this.sourceCaches[h.source];m&&m.setDependencies(h.tileID.key,h.type,h.icons)}getGlyphs(o,h,d){this.glyphManager.getGlyphs(h.stacks,d);const m=this.sourceCaches[h.source];m&&m.setDependencies(h.tileID.key,h.type,[""])}getResource(o,h,d){return u.m(h,d)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,h={}){this._checkLoaded(),o&&this._validate(u.y.glyphs,"glyphs",o,null,h)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,h,d={},m){this._checkLoaded();const v=[{id:o,url:h}],I=[...At(this.stylesheet.sprite),...v];this._validate(u.y.sprite,"sprite",I,null,d)||(this.stylesheet.sprite=I,this._loadSprite(v,!0,m))}removeSprite(o){this._checkLoaded();const h=At(this.stylesheet.sprite);if(h.find(d=>d.id===o)){if(this._spritesImagesIds[o])for(const d of this._spritesImagesIds[o])this.imageManager.removeImage(d),this._changedImages[d]=!0;h.splice(h.findIndex(d=>d.id===o),1),this.stylesheet.sprite=h.length>0?h:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}else this.fire(new u.j(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return At(this.stylesheet.sprite)}setSprite(o,h={},d){this._checkLoaded(),o&&this._validate(u.y.sprite,"sprite",o,null,h)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,d):(this._unloadSprite(),d&&d(null)))}}qr.registerForPluginStateChange=u.aK;var Da=u.Q([{name:"a_pos",type:"Int16",components:2}]),la="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const ir={prelude:xn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:xn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:xn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:xn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:xn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:xn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:xn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:xn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:xn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:xn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:xn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:xn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:xn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:xn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:xn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:xn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:xn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:xn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:xn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:xn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:xn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:xn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:xn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:xn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:xn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:xn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",la),terrainDepth:xn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",la),terrainCoords:xn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",la)};function xn(y,o){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=o.match(/attribute ([\w]+) ([\w]+)/g),m=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),I=v?v.concat(m):m,C={};return{fragmentSource:y=y.replace(h,(P,k,R,F,Z)=>(C[Z]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
varying ${R} ${F} ${Z};
#else
uniform ${R} ${F} u_${Z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Z}
    ${R} ${F} ${Z} = u_${Z};
#endif
`)),vertexSource:o=o.replace(h,(P,k,R,F,Z)=>{const st=F==="float"?"vec2":"vec4",ot=Z.match(/color/)?"color":st;return C[Z]?k==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${R} ${st} a_${Z};
varying ${R} ${F} ${Z};
#else
uniform ${R} ${F} u_${Z};
#endif
`:ot==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = a_${Z};
#else
    ${R} ${F} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = unpack_mix_${ot}(a_${Z}, u_${Z}_t);
#else
    ${R} ${F} ${Z} = u_${Z};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${R} ${st} a_${Z};
#else
uniform ${R} ${F} u_${Z};
#endif
`:ot==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${R} ${F} ${Z} = a_${Z};
#else
    ${R} ${F} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${R} ${F} ${Z} = unpack_mix_${ot}(a_${Z}, u_${Z}_t);
#else
    ${R} ${F} ${Z} = u_${Z};
#endif
`}),staticAttributes:d,staticUniforms:I}}class Zi{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,h,d,m,v,I,C,P,k){this.context=o;let R=this.boundPaintVertexBuffers.length!==m.length;for(let F=0;!R&&F<m.length;F++)this.boundPaintVertexBuffers[F]!==m[F]&&(R=!0);!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==d||R||this.boundIndexBuffer!==v||this.boundVertexOffset!==I||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==k?this.freshBind(h,d,m,v,I,C,P,k):(o.bindVertexArray.set(this.vao),C&&C.bind(),v&&v.dynamicDraw&&v.bind(),P&&P.bind(),k&&k.bind())}freshBind(o,h,d,m,v,I,C,P){const k=o.numAttributes,R=this.context,F=R.gl;this.vao&&this.destroy(),this.vao=R.createVertexArray(),R.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=m,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=I,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=P,h.enableAttributes(F,o);for(const Z of d)Z.enableAttributes(F,o);I&&I.enableAttributes(F,o),C&&C.enableAttributes(F,o),P&&P.enableAttributes(F,o),h.bind(),h.setVertexAttribPointers(F,o,v);for(const Z of d)Z.bind(),Z.setVertexAttribPointers(F,o,v);I&&(I.bind(),I.setVertexAttribPointers(F,o,v)),m&&m.bind(),C&&(C.bind(),C.setVertexAttribPointers(F,o,v)),P&&(P.bind(),P.setVertexAttribPointers(F,o,v)),R.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ar(y){const o=[];for(let h=0;h<y.length;h++){if(y[h]===null)continue;const d=y[h].split(" ");o.push(d.pop())}return o}class ua{constructor(o,h,d,m,v,I){const C=o.gl;this.program=C.createProgram();const P=ar(h.staticAttributes),k=d?d.getBinderAttributes():[],R=P.concat(k),F=ir.prelude.staticUniforms?ar(ir.prelude.staticUniforms):[],Z=h.staticUniforms?ar(h.staticUniforms):[],st=d?d.getBinderUniforms():[],ot=F.concat(Z).concat(st),ut=[];for(const jt of ot)ut.indexOf(jt)<0&&ut.push(jt);const rt=d?d.defines():[];v&&rt.push("#define OVERDRAW_INSPECTOR;"),I&&rt.push("#define TERRAIN3D;");const St=rt.concat(ir.prelude.fragmentSource,h.fragmentSource).join(`
`),Ft=rt.concat(ir.prelude.vertexSource,h.vertexSource).join(`
`),ft=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(ft,St),C.compileShader(ft),!C.getShaderParameter(ft,C.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${C.getShaderInfoLog(ft)}`);C.attachShader(this.program,ft);const Ct=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(Ct,Ft),C.compileShader(Ct),!C.getShaderParameter(Ct,C.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${C.getShaderInfoLog(Ct)}`);C.attachShader(this.program,Ct),this.attributes={};const $t={};this.numAttributes=R.length;for(let jt=0;jt<this.numAttributes;jt++)R[jt]&&(C.bindAttribLocation(this.program,jt,R[jt]),this.attributes[R[jt]]=jt);if(C.linkProgram(this.program),!C.getProgramParameter(this.program,C.LINK_STATUS))throw new Error(`Program failed to link: ${C.getProgramInfoLog(this.program)}`);C.deleteShader(Ct),C.deleteShader(ft);for(let jt=0;jt<ut.length;jt++){const te=ut[jt];if(te&&!$t[te]){const ae=C.getUniformLocation(this.program,te);ae&&($t[te]=ae)}}this.fixedUniforms=m(o,$t),this.terrainUniforms=((jt,te)=>({u_depth:new u.aL(jt,te.u_depth),u_terrain:new u.aL(jt,te.u_terrain),u_terrain_dim:new u.aM(jt,te.u_terrain_dim),u_terrain_matrix:new u.aN(jt,te.u_terrain_matrix),u_terrain_unpack:new u.aO(jt,te.u_terrain_unpack),u_terrain_exaggeration:new u.aM(jt,te.u_terrain_exaggeration)}))(o,$t),this.binderUniforms=d?d.getUniforms(o,$t):[]}draw(o,h,d,m,v,I,C,P,k,R,F,Z,st,ot,ut,rt,St,Ft){const ft=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(d),o.setStencilMode(m),o.setColorMode(v),o.setCullFace(I),P){o.activeTexture.set(ft.TEXTURE2),ft.bindTexture(ft.TEXTURE_2D,P.depthTexture),o.activeTexture.set(ft.TEXTURE3),ft.bindTexture(ft.TEXTURE_2D,P.texture);for(const $t in this.terrainUniforms)this.terrainUniforms[$t].set(P[$t])}for(const $t in this.fixedUniforms)this.fixedUniforms[$t].set(C[$t]);ut&&ut.setUniforms(o,this.binderUniforms,st,{zoom:ot});let Ct=0;switch(h){case ft.LINES:Ct=2;break;case ft.TRIANGLES:Ct=3;break;case ft.LINE_STRIP:Ct=1}for(const $t of Z.get()){const jt=$t.vaos||($t.vaos={});(jt[k]||(jt[k]=new Zi)).bind(o,this,R,ut?ut.getPaintVertexBuffers():[],F,$t.vertexOffset,rt,St,Ft),ft.drawElements(h,$t.primitiveLength*Ct,ft.UNSIGNED_SHORT,$t.primitiveOffset*Ct*2)}}}function zi(y,o,h){const d=1/vt(h,1,o.transform.tileZoom),m=Math.pow(2,h.tileID.overscaledZ),v=h.tileSize*Math.pow(2,o.transform.tileZoom)/m,I=v*(h.tileID.canonical.x+h.tileID.wrap*m),C=v*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[d,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[I>>16,C>>16],u_pixel_coord_lower:[65535&I,65535&C]}}const zs=(y,o,h,d)=>{const m=o.style.light,v=m.properties.get("position"),I=[v.x,v.y,v.z],C=function(){var k=new u.A(9);return u.A!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[5]=0,k[6]=0,k[7]=0),k[0]=1,k[4]=1,k[8]=1,k}();m.properties.get("anchor")==="viewport"&&function(k,R){var F=Math.sin(R),Z=Math.cos(R);k[0]=Z,k[1]=F,k[2]=0,k[3]=-F,k[4]=Z,k[5]=0,k[6]=0,k[7]=0,k[8]=1}(C,-o.transform.angle),function(k,R,F){var Z=R[0],st=R[1],ot=R[2];k[0]=Z*F[0]+st*F[3]+ot*F[6],k[1]=Z*F[1]+st*F[4]+ot*F[7],k[2]=Z*F[2]+st*F[5]+ot*F[8]}(I,I,C);const P=m.properties.get("color");return{u_matrix:y,u_lightpos:I,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+h,u_opacity:d}},Ir=(y,o,h,d,m,v,I)=>u.e(zs(y,o,h,d),zi(v,o,I),{u_height_factor:-Math.pow(2,m.overscaledZ)/I.tileSize/8}),ca=y=>({u_matrix:y}),b=(y,o,h,d)=>u.e(ca(y),zi(h,o,d)),L=(y,o)=>({u_matrix:y,u_world:o}),X=(y,o,h,d,m)=>u.e(b(y,o,h,d),{u_world:m}),ct=(y,o,h,d)=>{const m=y.transform;let v,I;if(d.paint.get("circle-pitch-alignment")==="map"){const C=vt(h,1,m.zoom);v=!0,I=[C,C]}else v=!1,I=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(o.posMatrix,h,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:I}},wt=(y,o,h)=>{const d=vt(h,1,o.zoom),m=Math.pow(2,o.zoom-h.tileID.overscaledZ),v=h.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[o.pixelsToGLUnits[0]/(d*m),o.pixelsToGLUnits[1]/(d*m)],u_overscale_factor:v}},Et=(y,o,h=1)=>({u_matrix:y,u_color:o,u_overlay:0,u_overlay_scale:h}),kt=y=>({u_matrix:y}),se=(y,o,h,d)=>({u_matrix:y,u_extrude_scale:vt(o,1,h),u_intensity:d});function de(y,o){const h=Math.pow(2,o.canonical.z),d=o.canonical.y;return[new u.U(0,d/h).toLngLat().lat,new u.U(0,(d+1)/h).toLngLat().lat]}const Me=(y,o,h,d)=>{const m=y.transform;return{u_matrix:dn(y,o,h,d),u_ratio:1/vt(o,1,m.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Le=(y,o,h,d,m)=>u.e(Me(y,o,h,m),{u_image:0,u_image_height:d}),Ee=(y,o,h,d,m)=>{const v=y.transform,I=Cr(o,v);return{u_matrix:dn(y,o,h,m),u_texsize:o.imageAtlasTexture.size,u_ratio:1/vt(o,1,v.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[I,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},un=(y,o,h,d,m,v)=>{const I=y.lineAtlas,C=Cr(o,y.transform),P=h.layout.get("line-cap")==="round",k=I.getDash(d.from,P),R=I.getDash(d.to,P),F=k.width*m.fromScale,Z=R.width*m.toScale;return u.e(Me(y,o,h,v),{u_patternscale_a:[C/F,-k.height/2],u_patternscale_b:[C/Z,-R.height/2],u_sdfgamma:I.width/(256*Math.min(F,Z)*y.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:R.y,u_mix:m.t})};function Cr(y,o){return 1/vt(y,1,o.tileZoom)}function dn(y,o,h,d){return y.translatePosMatrix(d?d.posMatrix:o.tileID.posMatrix,o,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const Jr=(y,o,h,d,m)=>{return{u_matrix:y,u_tl_parent:o,u_scale_parent:h,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(I=m.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(v=m.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:ne(m.paint.get("raster-hue-rotate"))};var v,I};function ne(y){y*=Math.PI/180;const o=Math.sin(y),h=Math.cos(y);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}const $e=(y,o,h,d,m,v,I,C,P,k)=>{const R=m.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:R.cameraToCenterDistance,u_pitch:R.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:R.width/R.height,u_fade_change:m.options.fadeDuration?m.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:I,u_coord_matrix:C,u_is_text:+P,u_pitch_with_map:+d,u_texsize:k,u_texture:0}},Yn=(y,o,h,d,m,v,I,C,P,k,R)=>{const F=m.transform;return u.e($e(y,o,h,d,m,v,I,C,P,k),{u_gamma_scale:d?Math.cos(F._pitch)*F.cameraToCenterDistance:1,u_device_pixel_ratio:m.pixelRatio,u_is_halo:+R})},Tr=(y,o,h,d,m,v,I,C,P,k)=>u.e(Yn(y,o,h,d,m,v,I,C,!0,P,!0),{u_texsize_icon:k,u_texture_icon:1}),zr=(y,o,h)=>({u_matrix:y,u_opacity:o,u_color:h}),Do=(y,o,h,d,m,v)=>u.e(function(I,C,P,k){const R=P.imageManager.getPattern(I.from.toString()),F=P.imageManager.getPattern(I.to.toString()),{width:Z,height:st}=P.imageManager.getPixelSize(),ot=Math.pow(2,k.tileID.overscaledZ),ut=k.tileSize*Math.pow(2,P.transform.tileZoom)/ot,rt=ut*(k.tileID.canonical.x+k.tileID.wrap*ot),St=ut*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:R.tl,u_pattern_br_a:R.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[Z,st],u_mix:C.t,u_pattern_size_a:R.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/vt(k,1,P.transform.tileZoom),u_pixel_coord_upper:[rt>>16,St>>16],u_pixel_coord_lower:[65535&rt,65535&St]}}(d,v,h,m),{u_matrix:y,u_opacity:o}),eh={fillExtrusion:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_lightpos:new u.aP(y,o.u_lightpos),u_lightintensity:new u.aM(y,o.u_lightintensity),u_lightcolor:new u.aP(y,o.u_lightcolor),u_vertical_gradient:new u.aM(y,o.u_vertical_gradient),u_opacity:new u.aM(y,o.u_opacity)}),fillExtrusionPattern:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_lightpos:new u.aP(y,o.u_lightpos),u_lightintensity:new u.aM(y,o.u_lightintensity),u_lightcolor:new u.aP(y,o.u_lightcolor),u_vertical_gradient:new u.aM(y,o.u_vertical_gradient),u_height_factor:new u.aM(y,o.u_height_factor),u_image:new u.aL(y,o.u_image),u_texsize:new u.aQ(y,o.u_texsize),u_pixel_coord_upper:new u.aQ(y,o.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(y,o.u_pixel_coord_lower),u_scale:new u.aP(y,o.u_scale),u_fade:new u.aM(y,o.u_fade),u_opacity:new u.aM(y,o.u_opacity)}),fill:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix)}),fillPattern:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_image:new u.aL(y,o.u_image),u_texsize:new u.aQ(y,o.u_texsize),u_pixel_coord_upper:new u.aQ(y,o.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(y,o.u_pixel_coord_lower),u_scale:new u.aP(y,o.u_scale),u_fade:new u.aM(y,o.u_fade)}),fillOutline:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_world:new u.aQ(y,o.u_world)}),fillOutlinePattern:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_world:new u.aQ(y,o.u_world),u_image:new u.aL(y,o.u_image),u_texsize:new u.aQ(y,o.u_texsize),u_pixel_coord_upper:new u.aQ(y,o.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(y,o.u_pixel_coord_lower),u_scale:new u.aP(y,o.u_scale),u_fade:new u.aM(y,o.u_fade)}),circle:(y,o)=>({u_camera_to_center_distance:new u.aM(y,o.u_camera_to_center_distance),u_scale_with_map:new u.aL(y,o.u_scale_with_map),u_pitch_with_map:new u.aL(y,o.u_pitch_with_map),u_extrude_scale:new u.aQ(y,o.u_extrude_scale),u_device_pixel_ratio:new u.aM(y,o.u_device_pixel_ratio),u_matrix:new u.aN(y,o.u_matrix)}),collisionBox:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_camera_to_center_distance:new u.aM(y,o.u_camera_to_center_distance),u_pixels_to_tile_units:new u.aM(y,o.u_pixels_to_tile_units),u_extrude_scale:new u.aQ(y,o.u_extrude_scale),u_overscale_factor:new u.aM(y,o.u_overscale_factor)}),collisionCircle:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_inv_matrix:new u.aN(y,o.u_inv_matrix),u_camera_to_center_distance:new u.aM(y,o.u_camera_to_center_distance),u_viewport_size:new u.aQ(y,o.u_viewport_size)}),debug:(y,o)=>({u_color:new u.aR(y,o.u_color),u_matrix:new u.aN(y,o.u_matrix),u_overlay:new u.aL(y,o.u_overlay),u_overlay_scale:new u.aM(y,o.u_overlay_scale)}),clippingMask:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix)}),heatmap:(y,o)=>({u_extrude_scale:new u.aM(y,o.u_extrude_scale),u_intensity:new u.aM(y,o.u_intensity),u_matrix:new u.aN(y,o.u_matrix)}),heatmapTexture:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_world:new u.aQ(y,o.u_world),u_image:new u.aL(y,o.u_image),u_color_ramp:new u.aL(y,o.u_color_ramp),u_opacity:new u.aM(y,o.u_opacity)}),hillshade:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_image:new u.aL(y,o.u_image),u_latrange:new u.aQ(y,o.u_latrange),u_light:new u.aQ(y,o.u_light),u_shadow:new u.aR(y,o.u_shadow),u_highlight:new u.aR(y,o.u_highlight),u_accent:new u.aR(y,o.u_accent)}),hillshadePrepare:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_image:new u.aL(y,o.u_image),u_dimension:new u.aQ(y,o.u_dimension),u_zoom:new u.aM(y,o.u_zoom),u_unpack:new u.aO(y,o.u_unpack)}),line:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_ratio:new u.aM(y,o.u_ratio),u_device_pixel_ratio:new u.aM(y,o.u_device_pixel_ratio),u_units_to_pixels:new u.aQ(y,o.u_units_to_pixels)}),lineGradient:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_ratio:new u.aM(y,o.u_ratio),u_device_pixel_ratio:new u.aM(y,o.u_device_pixel_ratio),u_units_to_pixels:new u.aQ(y,o.u_units_to_pixels),u_image:new u.aL(y,o.u_image),u_image_height:new u.aM(y,o.u_image_height)}),linePattern:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_texsize:new u.aQ(y,o.u_texsize),u_ratio:new u.aM(y,o.u_ratio),u_device_pixel_ratio:new u.aM(y,o.u_device_pixel_ratio),u_image:new u.aL(y,o.u_image),u_units_to_pixels:new u.aQ(y,o.u_units_to_pixels),u_scale:new u.aP(y,o.u_scale),u_fade:new u.aM(y,o.u_fade)}),lineSDF:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_ratio:new u.aM(y,o.u_ratio),u_device_pixel_ratio:new u.aM(y,o.u_device_pixel_ratio),u_units_to_pixels:new u.aQ(y,o.u_units_to_pixels),u_patternscale_a:new u.aQ(y,o.u_patternscale_a),u_patternscale_b:new u.aQ(y,o.u_patternscale_b),u_sdfgamma:new u.aM(y,o.u_sdfgamma),u_image:new u.aL(y,o.u_image),u_tex_y_a:new u.aM(y,o.u_tex_y_a),u_tex_y_b:new u.aM(y,o.u_tex_y_b),u_mix:new u.aM(y,o.u_mix)}),raster:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_tl_parent:new u.aQ(y,o.u_tl_parent),u_scale_parent:new u.aM(y,o.u_scale_parent),u_buffer_scale:new u.aM(y,o.u_buffer_scale),u_fade_t:new u.aM(y,o.u_fade_t),u_opacity:new u.aM(y,o.u_opacity),u_image0:new u.aL(y,o.u_image0),u_image1:new u.aL(y,o.u_image1),u_brightness_low:new u.aM(y,o.u_brightness_low),u_brightness_high:new u.aM(y,o.u_brightness_high),u_saturation_factor:new u.aM(y,o.u_saturation_factor),u_contrast_factor:new u.aM(y,o.u_contrast_factor),u_spin_weights:new u.aP(y,o.u_spin_weights)}),symbolIcon:(y,o)=>({u_is_size_zoom_constant:new u.aL(y,o.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aL(y,o.u_is_size_feature_constant),u_size_t:new u.aM(y,o.u_size_t),u_size:new u.aM(y,o.u_size),u_camera_to_center_distance:new u.aM(y,o.u_camera_to_center_distance),u_pitch:new u.aM(y,o.u_pitch),u_rotate_symbol:new u.aL(y,o.u_rotate_symbol),u_aspect_ratio:new u.aM(y,o.u_aspect_ratio),u_fade_change:new u.aM(y,o.u_fade_change),u_matrix:new u.aN(y,o.u_matrix),u_label_plane_matrix:new u.aN(y,o.u_label_plane_matrix),u_coord_matrix:new u.aN(y,o.u_coord_matrix),u_is_text:new u.aL(y,o.u_is_text),u_pitch_with_map:new u.aL(y,o.u_pitch_with_map),u_texsize:new u.aQ(y,o.u_texsize),u_texture:new u.aL(y,o.u_texture)}),symbolSDF:(y,o)=>({u_is_size_zoom_constant:new u.aL(y,o.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aL(y,o.u_is_size_feature_constant),u_size_t:new u.aM(y,o.u_size_t),u_size:new u.aM(y,o.u_size),u_camera_to_center_distance:new u.aM(y,o.u_camera_to_center_distance),u_pitch:new u.aM(y,o.u_pitch),u_rotate_symbol:new u.aL(y,o.u_rotate_symbol),u_aspect_ratio:new u.aM(y,o.u_aspect_ratio),u_fade_change:new u.aM(y,o.u_fade_change),u_matrix:new u.aN(y,o.u_matrix),u_label_plane_matrix:new u.aN(y,o.u_label_plane_matrix),u_coord_matrix:new u.aN(y,o.u_coord_matrix),u_is_text:new u.aL(y,o.u_is_text),u_pitch_with_map:new u.aL(y,o.u_pitch_with_map),u_texsize:new u.aQ(y,o.u_texsize),u_texture:new u.aL(y,o.u_texture),u_gamma_scale:new u.aM(y,o.u_gamma_scale),u_device_pixel_ratio:new u.aM(y,o.u_device_pixel_ratio),u_is_halo:new u.aL(y,o.u_is_halo)}),symbolTextAndIcon:(y,o)=>({u_is_size_zoom_constant:new u.aL(y,o.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aL(y,o.u_is_size_feature_constant),u_size_t:new u.aM(y,o.u_size_t),u_size:new u.aM(y,o.u_size),u_camera_to_center_distance:new u.aM(y,o.u_camera_to_center_distance),u_pitch:new u.aM(y,o.u_pitch),u_rotate_symbol:new u.aL(y,o.u_rotate_symbol),u_aspect_ratio:new u.aM(y,o.u_aspect_ratio),u_fade_change:new u.aM(y,o.u_fade_change),u_matrix:new u.aN(y,o.u_matrix),u_label_plane_matrix:new u.aN(y,o.u_label_plane_matrix),u_coord_matrix:new u.aN(y,o.u_coord_matrix),u_is_text:new u.aL(y,o.u_is_text),u_pitch_with_map:new u.aL(y,o.u_pitch_with_map),u_texsize:new u.aQ(y,o.u_texsize),u_texsize_icon:new u.aQ(y,o.u_texsize_icon),u_texture:new u.aL(y,o.u_texture),u_texture_icon:new u.aL(y,o.u_texture_icon),u_gamma_scale:new u.aM(y,o.u_gamma_scale),u_device_pixel_ratio:new u.aM(y,o.u_device_pixel_ratio),u_is_halo:new u.aL(y,o.u_is_halo)}),background:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_opacity:new u.aM(y,o.u_opacity),u_color:new u.aR(y,o.u_color)}),backgroundPattern:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_opacity:new u.aM(y,o.u_opacity),u_image:new u.aL(y,o.u_image),u_pattern_tl_a:new u.aQ(y,o.u_pattern_tl_a),u_pattern_br_a:new u.aQ(y,o.u_pattern_br_a),u_pattern_tl_b:new u.aQ(y,o.u_pattern_tl_b),u_pattern_br_b:new u.aQ(y,o.u_pattern_br_b),u_texsize:new u.aQ(y,o.u_texsize),u_mix:new u.aM(y,o.u_mix),u_pattern_size_a:new u.aQ(y,o.u_pattern_size_a),u_pattern_size_b:new u.aQ(y,o.u_pattern_size_b),u_scale_a:new u.aM(y,o.u_scale_a),u_scale_b:new u.aM(y,o.u_scale_b),u_pixel_coord_upper:new u.aQ(y,o.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(y,o.u_pixel_coord_lower),u_tile_units_to_pixels:new u.aM(y,o.u_tile_units_to_pixels)}),terrain:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_texture:new u.aL(y,o.u_texture),u_ele_delta:new u.aM(y,o.u_ele_delta)}),terrainDepth:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_ele_delta:new u.aM(y,o.u_ele_delta)}),terrainCoords:(y,o)=>({u_matrix:new u.aN(y,o.u_matrix),u_texture:new u.aL(y,o.u_texture),u_terrain_coords_id:new u.aM(y,o.u_terrain_coords_id),u_ele_delta:new u.aM(y,o.u_ele_delta)})};class lr{constructor(o,h,d){this.context=o;const m=o.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Pu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class nh{constructor(o,h,d,m){this.length=h.length,this.attributes=d,this.itemSize=h.bytesPerElement,this.dynamicDraw=m,this.context=o;const v=o.gl;this.buffer=v.createBuffer(),o.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let d=0;d<this.attributes.length;d++){const m=h.attributes[this.attributes[d].name];m!==void 0&&o.enableVertexAttribArray(m)}}setVertexAttribPointers(o,h,d){for(let m=0;m<this.attributes.length;m++){const v=this.attributes[m],I=h.attributes[v.name];I!==void 0&&o.vertexAttribPointer(I,v.components,o[Pu[v.type]],!1,this.itemSize,v.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ro=new WeakMap;function Ra(y){var o;if(Ro.has(y))return Ro.get(y);{const h=(o=y.getParameter(y.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return Ro.set(y,h),h}}class Mn{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class lc extends Mn{getDefault(){return u.aT.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class xo extends Mn{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Oo extends Mn{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class rh extends Mn{getDefault(){return[!0,!0,!0,!0]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class ih extends Mn{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class oh extends Mn{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class wp extends Mn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class sh extends Mn{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class uc extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class ah extends Mn{getDefault(){return[0,1]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class bp extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class lh extends Mn{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class cc extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class uh extends Mn{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Yl extends Mn{getDefault(){return u.aT.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class ha extends Mn{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class yf extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class _f extends Mn{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class qd extends Mn{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class vf extends Mn{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class ch extends Mn{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class hh extends Mn{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class hc extends Mn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Ep extends Mn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Oa extends Mn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Kl extends Mn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class xf extends Mn{getDefault(){return null}set(o){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class wf extends Mn{getDefault(){return null}set(o){var h;if(o===this.current&&!this.dirty)return;const d=this.gl;Ra(d)?d.bindVertexArray(o):(h=d.getExtension("OES_vertex_array_object"))===null||h===void 0||h.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class pc extends Mn{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Fs extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class ph extends Mn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class pa extends Mn{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class ll extends pa{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Mu extends pa{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Sp extends pa{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Un{constructor(o,h,d,m,v){this.context=o,this.width=h,this.height=d;const I=o.gl,C=this.framebuffer=I.createFramebuffer();if(this.colorAttachment=new ll(o,C),m)this.depthAttachment=v?new Sp(o,C):new Mu(o,C);else if(v)throw new Error("Stencil cannot be setted without depth");if(I.checkFramebufferStatus(I.FRAMEBUFFER)!==I.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,h=this.colorAttachment.get();if(h&&o.deleteTexture(h),this.depthAttachment){const d=this.depthAttachment.get();d&&o.deleteRenderbuffer(d)}o.deleteFramebuffer(this.framebuffer)}}class Pr{constructor(o,h,d){this.blendFunction=o,this.blendColor=h,this.mask=d}}Pr.Replace=[1,0],Pr.disabled=new Pr(Pr.Replace,u.aT.transparent,[!1,!1,!1,!1]),Pr.unblended=new Pr(Pr.Replace,u.aT.transparent,[!0,!0,!0,!0]),Pr.alphaBlended=new Pr([1,771],u.aT.transparent,[!0,!0,!0,!0]);class Zd{constructor(o){var h,d;if(this.gl=o,this.clearColor=new lc(this),this.clearDepth=new xo(this),this.clearStencil=new Oo(this),this.colorMask=new rh(this),this.depthMask=new ih(this),this.stencilMask=new oh(this),this.stencilFunc=new wp(this),this.stencilOp=new sh(this),this.stencilTest=new uc(this),this.depthRange=new ah(this),this.depthTest=new bp(this),this.depthFunc=new lh(this),this.blend=new cc(this),this.blendFunc=new uh(this),this.blendColor=new Yl(this),this.blendEquation=new ha(this),this.cullFace=new yf(this),this.cullFaceSide=new _f(this),this.frontFace=new qd(this),this.program=new vf(this),this.activeTexture=new ch(this),this.viewport=new hh(this),this.bindFramebuffer=new hc(this),this.bindRenderbuffer=new Ep(this),this.bindTexture=new Oa(this),this.bindVertexBuffer=new Kl(this),this.bindElementBuffer=new xf(this),this.bindVertexArray=new wf(this),this.pixelStoreUnpack=new pc(this),this.pixelStoreUnpackPremultiplyAlpha=new Fs(this),this.pixelStoreUnpackFlipY=new ph(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),Ra(o)){this.HALF_FLOAT=o.HALF_FLOAT;const m=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(h=o.RGBA16F)!==null&&h!==void 0?h:m==null?void 0:m.RGBA16F_EXT,this.RGB16F=(d=o.RGB16F)!==null&&d!==void 0?d:m==null?void 0:m.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const m=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=m==null?void 0:m.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h){return new lr(this,o,h)}createVertexBuffer(o,h,d){return new nh(this,o,h,d)}createRenderbuffer(o,h,d){const m=this.gl,v=m.createRenderbuffer();return this.bindRenderbuffer.set(v),m.renderbufferStorage(m.RENDERBUFFER,o,h,d),this.bindRenderbuffer.set(null),v}createFramebuffer(o,h,d,m){return new Un(this,o,h,d,m)}clear({color:o,depth:h,stencil:d}){const m=this.gl;let v=0;o&&(v|=m.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(v|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),d!==void 0&&(v|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),m.clear(v)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){u.aG(o.blendFunction,Pr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return Ra(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var h;return Ra(this.gl)?this.gl.deleteVertexArray(o):(h=this.gl.getExtension("OES_vertex_array_object"))===null||h===void 0?void 0:h.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class An{constructor(o,h,d){this.func=o,this.mask=h,this.range=d}}An.ReadOnly=!1,An.ReadWrite=!0,An.disabled=new An(519,An.ReadOnly,[0,1]);const ul=7680;class xr{constructor(o,h,d,m,v,I){this.test=o,this.ref=h,this.mask=d,this.fail=m,this.depthFail=v,this.pass=I}}xr.disabled=new xr({func:519,mask:0},0,0,ul,ul,ul);class Kn{constructor(o,h,d){this.enable=o,this.mode=h,this.frontFace=d}}let ns;function cl(y,o,h,d,m,v,I){const C=y.context,P=C.gl,k=y.useProgram("collisionBox"),R=[];let F=0,Z=0;for(let ft=0;ft<d.length;ft++){const Ct=d[ft],$t=o.getTile(Ct),jt=$t.getBucket(h);if(!jt)continue;let te=Ct.posMatrix;m[0]===0&&m[1]===0||(te=y.translatePosMatrix(Ct.posMatrix,$t,m,v));const ae=I?jt.textCollisionBox:jt.iconCollisionBox,re=jt.collisionCircleArray;if(re.length>0){const ge=u.Z(),Be=te;u.aU(ge,jt.placementInvProjMatrix,y.transform.glCoordMatrix),u.aU(ge,ge,jt.placementViewportMatrix),R.push({circleArray:re,circleOffset:Z,transform:Be,invTransform:ge,coord:Ct}),F+=re.length/4,Z=F}ae&&k.draw(C,P.LINES,An.disabled,xr.disabled,y.colorModeForRenderPass(),Kn.disabled,wt(te,y.transform,$t),y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ct),h.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,null,y.transform.zoom,null,null,ae.collisionVertexBuffer)}if(!I||!R.length)return;const st=y.useProgram("collisionCircle"),ot=new u.aV;ot.resize(4*F),ot._trim();let ut=0;for(const ft of R)for(let Ct=0;Ct<ft.circleArray.length/4;Ct++){const $t=4*Ct,jt=ft.circleArray[$t+0],te=ft.circleArray[$t+1],ae=ft.circleArray[$t+2],re=ft.circleArray[$t+3];ot.emplace(ut++,jt,te,ae,re,0),ot.emplace(ut++,jt,te,ae,re,1),ot.emplace(ut++,jt,te,ae,re,2),ot.emplace(ut++,jt,te,ae,re,3)}(!ns||ns.length<2*F)&&(ns=function(ft){const Ct=2*ft,$t=new u.aX;$t.resize(Ct),$t._trim();for(let jt=0;jt<Ct;jt++){const te=6*jt;$t.uint16[te+0]=4*jt+0,$t.uint16[te+1]=4*jt+1,$t.uint16[te+2]=4*jt+2,$t.uint16[te+3]=4*jt+2,$t.uint16[te+4]=4*jt+3,$t.uint16[te+5]=4*jt+0}return $t}(F));const rt=C.createIndexBuffer(ns,!0),St=C.createVertexBuffer(ot,u.aW.members,!0);for(const ft of R){const Ct={u_matrix:ft.transform,u_inv_matrix:ft.invTransform,u_camera_to_center_distance:(Ft=y.transform).cameraToCenterDistance,u_viewport_size:[Ft.width,Ft.height]};st.draw(C,P.TRIANGLES,An.disabled,xr.disabled,y.colorModeForRenderPass(),Kn.disabled,Ct,y.style.map.terrain&&y.style.map.terrain.getTerrainData(ft.coord),h.id,St,rt,u.S.simpleSegment(0,2*ft.circleOffset,ft.circleArray.length,ft.circleArray.length/2),null,y.transform.zoom,null,null,null)}var Ft;St.destroy(),rt.destroy()}Kn.disabled=new Kn(!1,1029,2305),Kn.backCCW=new Kn(!0,1029,2305);const Lu=u.ao(new Float32Array(16));function Bs(y,o,h,d,m,v){const{horizontalAlign:I,verticalAlign:C}=u.au(y);return new u.P((-(I-.5)*o/m+d[0])*v,(-(C-.5)*h/m+d[1])*v)}function fh(y,o,h,d,m,v,I,C,P,k,R){const F=y.text.placedSymbolArray,Z=y.text.dynamicLayoutVertexArray,st=y.icon.dynamicLayoutVertexArray,ot={};Z.clear();for(let ut=0;ut<F.length;ut++){const rt=F.get(ut),St=rt.hidden||!rt.crossTileID||y.allowVerticalPlacement&&!rt.placedOrientation?null:d[rt.crossTileID];if(St){const Ft=new u.P(rt.anchorX,rt.anchorY),ft=pr(Ft,h?I:v,R),Ct=Os(m.cameraToCenterDistance,ft.signedDistanceFromCamera);let $t=u.aj(y.textSizeData,P,rt)*Ct/u.ap;h&&($t*=y.tilePixelRatio/C);const{width:jt,height:te,anchor:ae,textOffset:re,textBoxScale:ge}=St,Be=Bs(ae,jt,te,re,ge,$t),kn=h?pr(Ft.add(Be),v,R).point:ft.point.add(o?Be.rotate(-m.angle):Be),Ie=y.allowVerticalPlacement&&rt.placedOrientation===u.ai.vertical?Math.PI/2:0;for(let rn=0;rn<rt.numGlyphs;rn++)u.ak(Z,kn,Ie);k&&rt.associatedIconIndex>=0&&(ot[rt.associatedIconIndex]={shiftedAnchor:kn,angle:Ie})}else et(rt.numGlyphs,Z)}if(k){st.clear();const ut=y.icon.placedSymbolArray;for(let rt=0;rt<ut.length;rt++){const St=ut.get(rt);if(St.hidden)et(St.numGlyphs,st);else{const Ft=ot[rt];if(Ft)for(let ft=0;ft<St.numGlyphs;ft++)u.ak(st,Ft.shiftedAnchor,Ft.angle);else et(St.numGlyphs,st)}}y.icon.dynamicLayoutVertexBuffer.updateData(st)}y.text.dynamicLayoutVertexBuffer.updateData(Z)}function Au(y,o,h){return h.iconsInText&&o?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function hl(y,o,h,d,m,v,I,C,P,k,R,F){const Z=y.context,st=Z.gl,ot=y.transform,ut=C==="map",rt=P==="map",St=C!=="viewport"&&h.layout.get("symbol-placement")!=="point",Ft=ut&&!rt&&!St,ft=!h.layout.get("symbol-sort-key").isConstant();let Ct=!1;const $t=y.depthModeForSublayer(0,An.ReadOnly),jt=h._unevaluatedLayout.hasValue("text-variable-anchor")||h._unevaluatedLayout.hasValue("text-variable-anchor-offset"),te=[];for(const ae of d){const re=o.getTile(ae),ge=re.getBucket(h);if(!ge)continue;const Be=m?ge.text:ge.icon;if(!Be||!Be.segments.get().length||!Be.hasVisibleVertices)continue;const kn=Be.programConfigurations.get(h.id),Ie=m||ge.sdfIcons,rn=m?ge.textSizeData:ge.iconSizeData,Ge=rt||ot.pitch!==0,ur=y.useProgram(Au(Ie,m,ge),kn),Ln=u.ah(rn,ot.zoom),wn=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ae);let Nn,pi,br,bo,Wi=[0,0],Ei=null;if(m)pi=re.glyphAtlasTexture,br=st.LINEAR,Nn=re.glyphAtlasTexture.size,ge.iconsInText&&(Wi=re.imageAtlasTexture.size,Ei=re.imageAtlasTexture,bo=Ge||y.options.rotating||y.options.zooming||rn.kind==="composite"||rn.kind==="camera"?st.LINEAR:st.NEAREST);else{const fi=h.layout.get("icon-size").constantOr(0)!==1||ge.iconsNeedLinear;pi=re.imageAtlasTexture,br=Ie||y.options.rotating||y.options.zooming||fi||Ge?st.LINEAR:st.NEAREST,Nn=re.imageAtlasTexture.size}const Gs=vt(re,1,y.transform.zoom),Ar=ce(ae.posMatrix,rt,ut,y.transform,Gs),gl=Gi(ae.posMatrix,rt,ut,y.transform,Gs),ml=jt&&ge.hasTextData(),Fu=h.layout.get("icon-text-fit")!=="none"&&ml&&ge.hasIconData();if(St){const fi=y.style.map.terrain?(xs,di)=>y.style.map.terrain.getElevation(ae,xs,di):null,Hi=h.layout.get("text-rotation-alignment")==="map";pe(ge,ae.posMatrix,y,m,Ar,gl,rt,k,Hi,fi)}const bc=y.translatePosMatrix(ae.posMatrix,re,v,I),Ih=St||m&&jt||Fu?Lu:Ar,Bo=y.translatePosMatrix(gl,re,v,I,!0),Eo=Ie&&h.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let os;os=Ie?ge.iconsInText?Tr(rn.kind,Ln,Ft,rt,y,bc,Ih,Bo,Nn,Wi):Yn(rn.kind,Ln,Ft,rt,y,bc,Ih,Bo,m,Nn,!0):$e(rn.kind,Ln,Ft,rt,y,bc,Ih,Bo,m,Nn);const Ec={program:ur,buffers:Be,uniformValues:os,atlasTexture:pi,atlasTextureIcon:Ei,atlasInterpolation:br,atlasInterpolationIcon:bo,isSDF:Ie,hasHalo:Eo};if(ft&&ge.canOverlap){Ct=!0;const fi=Be.segments.get();for(const Hi of fi)te.push({segments:new u.S([Hi]),sortKey:Hi.sortKey,state:Ec,terrainData:wn})}else te.push({segments:Be.segments,sortKey:0,state:Ec,terrainData:wn})}Ct&&te.sort((ae,re)=>ae.sortKey-re.sortKey);for(const ae of te){const re=ae.state;if(Z.activeTexture.set(st.TEXTURE0),re.atlasTexture.bind(re.atlasInterpolation,st.CLAMP_TO_EDGE),re.atlasTextureIcon&&(Z.activeTexture.set(st.TEXTURE1),re.atlasTextureIcon&&re.atlasTextureIcon.bind(re.atlasInterpolationIcon,st.CLAMP_TO_EDGE)),re.isSDF){const ge=re.uniformValues;re.hasHalo&&(ge.u_is_halo=1,dh(re.buffers,ae.segments,h,y,re.program,$t,R,F,ge,ae.terrainData)),ge.u_is_halo=0}dh(re.buffers,ae.segments,h,y,re.program,$t,R,F,re.uniformValues,ae.terrainData)}}function dh(y,o,h,d,m,v,I,C,P,k){const R=d.context;m.draw(R,R.gl.TRIANGLES,v,I,C,Kn.disabled,P,k,h.id,y.layoutVertexBuffer,y.indexBuffer,o,h.paint,d.transform.zoom,y.programConfigurations.get(h.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function ku(y,o,h,d,m){if(!h||!d||!d.imageAtlas)return;const v=d.imageAtlas.patternPositions;let I=v[h.to.toString()],C=v[h.from.toString()];if(!I&&C&&(I=C),!C&&I&&(C=I),!I||!C){const P=m.getPaintProperty(o);I=v[P],C=v[P]}I&&C&&y.setConstantPatternPositions(I,C)}function fc(y,o,h,d,m,v,I){const C=y.context.gl,P="fill-pattern",k=h.paint.get(P),R=k&&k.constantOr(1),F=h.getCrossfadeParameters();let Z,st,ot,ut,rt;I?(st=R&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=C.LINES):(st=R?"fillPattern":"fill",Z=C.TRIANGLES);const St=k.constantOr(null);for(const Ft of d){const ft=o.getTile(Ft);if(R&&!ft.patternsLoaded())continue;const Ct=ft.getBucket(h);if(!Ct)continue;const $t=Ct.programConfigurations.get(h.id),jt=y.useProgram(st,$t),te=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ft);R&&(y.context.activeTexture.set(C.TEXTURE0),ft.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),$t.updatePaintBuffers(F)),ku($t,P,St,ft,h);const ae=te?Ft:null,re=y.translatePosMatrix(ae?ae.posMatrix:Ft.posMatrix,ft,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(I){ut=Ct.indexBuffer2,rt=Ct.segments2;const ge=[C.drawingBufferWidth,C.drawingBufferHeight];ot=st==="fillOutlinePattern"&&R?X(re,y,F,ft,ge):L(re,ge)}else ut=Ct.indexBuffer,rt=Ct.segments,ot=R?b(re,y,F,ft):ca(re);jt.draw(y.context,Z,m,y.stencilModeForClipping(Ft),v,Kn.disabled,ot,te,h.id,Ct.layoutVertexBuffer,ut,rt,h.paint,y.transform.zoom,$t)}}function dc(y,o,h,d,m,v,I){const C=y.context,P=C.gl,k="fill-extrusion-pattern",R=h.paint.get(k),F=R.constantOr(1),Z=h.getCrossfadeParameters(),st=h.paint.get("fill-extrusion-opacity"),ot=R.constantOr(null);for(const ut of d){const rt=o.getTile(ut),St=rt.getBucket(h);if(!St)continue;const Ft=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ut),ft=St.programConfigurations.get(h.id),Ct=y.useProgram(F?"fillExtrusionPattern":"fillExtrusion",ft);F&&(y.context.activeTexture.set(P.TEXTURE0),rt.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),ft.updatePaintBuffers(Z)),ku(ft,k,ot,rt,h);const $t=y.translatePosMatrix(ut.posMatrix,rt,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),jt=h.paint.get("fill-extrusion-vertical-gradient"),te=F?Ir($t,y,jt,st,ut,Z,rt):zs($t,y,jt,st);Ct.draw(C,C.gl.TRIANGLES,m,v,I,Kn.backCCW,te,Ft,h.id,St.layoutVertexBuffer,St.indexBuffer,St.segments,h.paint,y.transform.zoom,ft,y.style.map.terrain&&St.centroidVertexBuffer)}}function bf(y,o,h,d,m,v,I){const C=y.context,P=C.gl,k=h.fbo;if(!k)return;const R=y.useProgram("hillshade"),F=y.style.map.terrain&&y.style.map.terrain.getTerrainData(o);C.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,k.colorAttachment.get()),R.draw(C,P.TRIANGLES,m,v,I,Kn.disabled,((Z,st,ot,ut)=>{const rt=ot.paint.get("hillshade-shadow-color"),St=ot.paint.get("hillshade-highlight-color"),Ft=ot.paint.get("hillshade-accent-color");let ft=ot.paint.get("hillshade-illumination-direction")*(Math.PI/180);ot.paint.get("hillshade-illumination-anchor")==="viewport"&&(ft-=Z.transform.angle);const Ct=!Z.options.moving;return{u_matrix:ut?ut.posMatrix:Z.transform.calculatePosMatrix(st.tileID.toUnwrapped(),Ct),u_image:0,u_latrange:de(0,st.tileID),u_light:[ot.paint.get("hillshade-exaggeration"),ft],u_shadow:rt,u_highlight:St,u_accent:Ft}})(y,h,d,F?o:null),F,d.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function gh(y,o,h,d,m,v){const I=y.context,C=I.gl,P=o.dem;if(P&&P.data){const k=P.dim,R=P.stride,F=P.getPixels();if(I.activeTexture.set(C.TEXTURE1),I.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||y.getTileTexture(R),o.demTexture){const st=o.demTexture;st.update(F,{premultiply:!1}),st.bind(C.NEAREST,C.CLAMP_TO_EDGE)}else o.demTexture=new Xt(I,F,C.RGBA,{premultiply:!1}),o.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);I.activeTexture.set(C.TEXTURE0);let Z=o.fbo;if(!Z){const st=new Xt(I,{width:k,height:k,data:null},C.RGBA);st.bind(C.LINEAR,C.CLAMP_TO_EDGE),Z=o.fbo=I.createFramebuffer(k,k,!0,!1),Z.colorAttachment.set(st.texture)}I.bindFramebuffer.set(Z.framebuffer),I.viewport.set([0,0,k,k]),y.useProgram("hillshadePrepare").draw(I,C.TRIANGLES,d,m,v,Kn.disabled,((st,ot)=>{const ut=ot.stride,rt=u.Z();return u.aS(rt,0,u.N,-u.N,0,0,1),u.$(rt,rt,[0,-u.N,0]),{u_matrix:rt,u_image:1,u_dimension:[ut,ut],u_zoom:st.overscaledZ,u_unpack:ot.getUnpackVector()}})(o.tileID,P),null,h.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function mh(y,o,h,d,m,v){const I=d.paint.get("raster-fade-duration");if(!v&&I>0){const C=u.h.now(),P=(C-y.timeAdded)/I,k=o?(C-o.timeAdded)/I:-1,R=h.getSource(),F=m.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),Z=!o||Math.abs(o.tileID.overscaledZ-F)>Math.abs(y.tileID.overscaledZ-F),st=Z&&y.refreshedUponExpiration?1:u.ad(Z?P:1-k,0,1);return y.refreshedUponExpiration&&P>=1&&(y.refreshedUponExpiration=!1),o?{opacity:1,mix:1-st}:{opacity:st,mix:0}}return{opacity:1,mix:0}}const Jl=new u.aT(1,0,0,1),yh=new u.aT(0,1,0,1),fa=new u.aT(0,0,1,1),Ef=new u.aT(1,0,1,1),pl=new u.aT(0,1,1,1);function Nu(y,o,h,d){Ql(y,0,o+h/2,y.transform.width,h,d)}function _h(y,o,h,d){Ql(y,o-h/2,0,h,y.transform.height,d)}function Ql(y,o,h,d,m,v){const I=y.context,C=I.gl;C.enable(C.SCISSOR_TEST),C.scissor(o*y.pixelRatio,h*y.pixelRatio,d*y.pixelRatio,m*y.pixelRatio),I.clear({color:v}),C.disable(C.SCISSOR_TEST)}function vh(y,o,h){const d=y.context,m=d.gl,v=h.posMatrix,I=y.useProgram("debug"),C=An.disabled,P=xr.disabled,k=y.colorModeForRenderPass(),R="$debug",F=y.style.map.terrain&&y.style.map.terrain.getTerrainData(h);d.activeTexture.set(m.TEXTURE0);const Z=o.getTileByID(h.key).latestRawTileData,st=Math.floor((Z&&Z.byteLength||0)/1024),ot=o.getTile(h).tileSize,ut=512/Math.min(ot,512)*(h.overscaledZ/y.transform.zoom)*.5;let rt=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(rt+=` => ${h.overscaledZ}`),function(St,Ft){St.initDebugOverlayCanvas();const ft=St.debugOverlayCanvas,Ct=St.context.gl,$t=St.debugOverlayCanvas.getContext("2d");$t.clearRect(0,0,ft.width,ft.height),$t.shadowColor="white",$t.shadowBlur=2,$t.lineWidth=1.5,$t.strokeStyle="white",$t.textBaseline="top",$t.font="bold 36px Open Sans, sans-serif",$t.fillText(Ft,5,5),$t.strokeText(Ft,5,5),St.debugOverlayTexture.update(ft),St.debugOverlayTexture.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE)}(y,`${rt} ${st}kB`),I.draw(d,m.TRIANGLES,C,P,Pr.alphaBlended,Kn.disabled,Et(v,u.aT.transparent,ut),null,R,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),I.draw(d,m.LINE_STRIP,C,P,k,Kn.disabled,Et(v,u.aT.red),F,R,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function Mr(y,o,h){const d=y.context,m=d.gl,v=y.colorModeForRenderPass(),I=new An(m.LEQUAL,An.ReadWrite,y.depthRangeFor3D),C=y.useProgram("terrain"),P=o.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,y.width,y.height]);for(const k of h){const R=y.renderToTexture.getTexture(k),F=o.getTerrainData(k.tileID);d.activeTexture.set(m.TEXTURE0),m.bindTexture(m.TEXTURE_2D,R.texture);const Z={u_matrix:y.transform.calculatePosMatrix(k.tileID.toUnwrapped()),u_texture:0,u_ele_delta:o.getMeshFrameDelta(y.transform.zoom)};C.draw(d,m.TRIANGLES,I,xr.disabled,v,Kn.backCCW,Z,F,"terrain",P.vertexBuffer,P.indexBuffer,P.segments)}}class fl{constructor(o,h){this.context=new Zd(o),this.transform=h,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.Z(),renderTime:0},this.setup(),this.numSublayers=Ri.maxUnderzooming+Ri.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new nr}resize(o,h,d){if(this.width=Math.floor(o*d),this.height=Math.floor(h*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style._order)this.style._layers[m].resize()}setup(){const o=this.context,h=new u.a_;h.emplaceBack(0,0),h.emplaceBack(u.N,0),h.emplaceBack(0,u.N),h.emplaceBack(u.N,u.N),this.tileExtentBuffer=o.createVertexBuffer(h,Da.members),this.tileExtentSegments=u.S.simpleSegment(0,0,4,2);const d=new u.a_;d.emplaceBack(0,0),d.emplaceBack(u.N,0),d.emplaceBack(0,u.N),d.emplaceBack(u.N,u.N),this.debugBuffer=o.createVertexBuffer(d,Da.members),this.debugSegments=u.S.simpleSegment(0,0,4,5);const m=new u.V;m.emplaceBack(0,0,0,0),m.emplaceBack(u.N,0,u.N,0),m.emplaceBack(0,u.N,0,u.N),m.emplaceBack(u.N,u.N,u.N,u.N),this.rasterBoundsBuffer=o.createVertexBuffer(m,Te.members),this.rasterBoundsSegments=u.S.simpleSegment(0,0,4,2);const v=new u.a_;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(v,Da.members),this.viewportSegments=u.S.simpleSegment(0,0,4,2);const I=new u.a$;I.emplaceBack(0),I.emplaceBack(1),I.emplaceBack(3),I.emplaceBack(2),I.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(I);const C=new u.b0;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(C);const P=this.context.gl;this.stencilClearMode=new xr({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO)}clearStencil(){const o=this.context,h=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=u.Z();u.aS(d,0,this.width,this.height,0,0,1),u.a0(d,d,[h.drawingBufferWidth,h.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,h.TRIANGLES,An.disabled,this.stencilClearMode,Pr.disabled,Kn.disabled,kt(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,h){if(this.currentStencilSource===o.source||!o.isTileClipped()||!h||!h.length)return;this.currentStencilSource=o.source;const d=this.context,m=d.gl;this.nextStencilID+h.length>256&&this.clearStencil(),d.setColorMode(Pr.disabled),d.setDepthMode(An.disabled);const v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of h){const C=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,P=this.style.map.terrain&&this.style.map.terrain.getTerrainData(I);v.draw(d,m.TRIANGLES,An.disabled,new xr({func:m.ALWAYS,mask:0},C,255,m.KEEP,m.KEEP,m.REPLACE),Pr.disabled,Kn.disabled,kt(I.posMatrix),P,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,h=this.context.gl;return new xr({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){const h=this.context.gl;return new xr({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){const h=this.context.gl,d=o.sort((I,C)=>C.overscaledZ-I.overscaledZ),m=d[d.length-1].overscaledZ,v=d[0].overscaledZ-m+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const I={};for(let C=0;C<v;C++)I[C+m]=new xr({func:h.GEQUAL,mask:255},C+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=v,[I,d]}return[{[m]:xr.disabled},d]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Pr([o.CONSTANT_COLOR,o.ONE],new u.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Pr.unblended:Pr.alphaBlended}depthModeForSublayer(o,h,d){if(!this.opaquePassEnabledForLayer())return An.disabled;const m=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new An(d||this.context.gl.LEQUAL,h,[m,m])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,h){this.style=o,this.options=h,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(u.h.now()),this.imageManager.beginFrame();const d=this.style._order,m=this.style.sourceCaches,v={},I={},C={};for(const P in m){const k=m[P];k.used&&k.prepare(this.context),v[P]=k.getVisibleCoordinates(),I[P]=v[P].slice().reverse(),C[P]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let P=0;P<d.length;P++)if(this.style._layers[d[P]].is3D()){this.opaquePassCutoff=P;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const P=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!u.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||P.length)&&(u.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(k,R){const F=k.context,Z=F.gl,st=Pr.unblended,ot=new An(Z.LEQUAL,An.ReadWrite,[0,1]),ut=R.getTerrainMesh(),rt=R.sourceCache.getRenderableTiles(),St=k.useProgram("terrainDepth");F.bindFramebuffer.set(R.getFramebuffer("depth").framebuffer),F.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),F.clear({color:u.aT.transparent,depth:1});for(const Ft of rt){const ft=R.getTerrainData(Ft.tileID),Ct={u_matrix:k.transform.calculatePosMatrix(Ft.tileID.toUnwrapped()),u_ele_delta:R.getMeshFrameDelta(k.transform.zoom)};St.draw(F,Z.TRIANGLES,ot,xr.disabled,st,Kn.backCCW,Ct,ft,"terrain",ut.vertexBuffer,ut.indexBuffer,ut.segments)}F.bindFramebuffer.set(null),F.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain),function(k,R){const F=k.context,Z=F.gl,st=Pr.unblended,ot=new An(Z.LEQUAL,An.ReadWrite,[0,1]),ut=R.getTerrainMesh(),rt=R.getCoordsTexture(),St=R.sourceCache.getRenderableTiles(),Ft=k.useProgram("terrainCoords");F.bindFramebuffer.set(R.getFramebuffer("coords").framebuffer),F.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),F.clear({color:u.aT.transparent,depth:1}),R.coordsIndex=[];for(const ft of St){const Ct=R.getTerrainData(ft.tileID);F.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,rt.texture);const $t={u_matrix:k.transform.calculatePosMatrix(ft.tileID.toUnwrapped()),u_terrain_coords_id:(255-R.coordsIndex.length)/255,u_texture:0,u_ele_delta:R.getMeshFrameDelta(k.transform.zoom)};Ft.draw(F,Z.TRIANGLES,ot,xr.disabled,st,Kn.backCCW,$t,Ct,"terrain",ut.vertexBuffer,ut.indexBuffer,ut.segments),R.coordsIndex.push(ft.tileID.key)}F.bindFramebuffer.set(null),F.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const P of d){const k=this.style._layers[P];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const R=I[k.source];(k.type==="custom"||R.length)&&this.renderLayer(this,m[k.source],k,R)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:h.showOverdrawInspector?u.aT.black:u.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const P=this.style._layers[d[this.currentLayer]],k=m[P.source],R=v[P.source];this._renderTileClippingMasks(P,R),this.renderLayer(this,k,P,R)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const P=this.style._layers[d[this.currentLayer]],k=m[P.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(P))continue;const R=(P.type==="symbol"?C:I)[P.source];this._renderTileClippingMasks(P,v[P.source]),this.renderLayer(this,k,P,R)}if(this.options.showTileBoundaries){const P=function(k,R){let F=null;const Z=Object.values(k._layers).flatMap(rt=>rt.source&&!rt.isHidden(R)?[k.sourceCaches[rt.source]]:[]),st=Z.filter(rt=>rt.getSource().type==="vector"),ot=Z.filter(rt=>rt.getSource().type!=="vector"),ut=rt=>{(!F||F.getSource().maxzoom<rt.getSource().maxzoom)&&(F=rt)};return st.forEach(rt=>ut(rt)),F||ot.forEach(rt=>ut(rt)),F}(this.style,this.transform.zoom);P&&function(k,R,F){for(let Z=0;Z<F.length;Z++)vh(k,R,F[Z])}(this,P,P.getVisibleCoordinates())}this.options.showPadding&&function(P){const k=P.transform.padding;Nu(P,P.transform.height-(k.top||0),3,Jl),Nu(P,k.bottom||0,3,yh),_h(P,k.left||0,3,fa),_h(P,P.transform.width-(k.right||0),3,Ef);const R=P.transform.centerPoint;(function(F,Z,st,ot){Ql(F,Z-1,st-10,2,20,ot),Ql(F,Z-10,st-1,20,2,ot)})(P,R.x,P.transform.height-R.y,pl)}(this),this.context.setDefault()}renderLayer(o,h,d,m){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(m||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(v,I,C,P,k){if(v.renderPass!=="translucent")return;const R=xr.disabled,F=v.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Z,st,ot,ut,rt,St,Ft){const ft=st.transform,Ct=rt==="map",$t=St==="map";for(const jt of Z){const te=ut.getTile(jt),ae=te.getBucket(ot);if(!ae||!ae.text||!ae.text.segments.get().length)continue;const re=u.ah(ae.textSizeData,ft.zoom),ge=vt(te,1,st.transform.zoom),Be=ce(jt.posMatrix,$t,Ct,st.transform,ge),kn=ot.layout.get("icon-text-fit")!=="none"&&ae.hasIconData();if(re){const Ie=Math.pow(2,ft.zoom-te.tileID.overscaledZ);fh(ae,Ct,$t,Ft,ft,Be,jt.posMatrix,Ie,re,kn,st.style.map.terrain?(rn,Ge)=>st.style.map.terrain.getElevation(jt,rn,Ge):null)}}}(P,v,C,I,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),k),C.paint.get("icon-opacity").constantOr(1)!==0&&hl(v,I,C,P,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),R,F),C.paint.get("text-opacity").constantOr(1)!==0&&hl(v,I,C,P,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),R,F),I.map.showCollisionBoxes&&(cl(v,I,C,P,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),!0),cl(v,I,C,P,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),!1))})(o,h,d,m,this.style.placement.variableOffsets);break;case"circle":(function(v,I,C,P){if(v.renderPass!=="translucent")return;const k=C.paint.get("circle-opacity"),R=C.paint.get("circle-stroke-width"),F=C.paint.get("circle-stroke-opacity"),Z=!C.layout.get("circle-sort-key").isConstant();if(k.constantOr(1)===0&&(R.constantOr(1)===0||F.constantOr(1)===0))return;const st=v.context,ot=st.gl,ut=v.depthModeForSublayer(0,An.ReadOnly),rt=xr.disabled,St=v.colorModeForRenderPass(),Ft=[];for(let ft=0;ft<P.length;ft++){const Ct=P[ft],$t=I.getTile(Ct),jt=$t.getBucket(C);if(!jt)continue;const te=jt.programConfigurations.get(C.id),ae=v.useProgram("circle",te),re=jt.layoutVertexBuffer,ge=jt.indexBuffer,Be=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ct),kn={programConfiguration:te,program:ae,layoutVertexBuffer:re,indexBuffer:ge,uniformValues:ct(v,Ct,$t,C),terrainData:Be};if(Z){const Ie=jt.segments.get();for(const rn of Ie)Ft.push({segments:new u.S([rn]),sortKey:rn.sortKey,state:kn})}else Ft.push({segments:jt.segments,sortKey:0,state:kn})}Z&&Ft.sort((ft,Ct)=>ft.sortKey-Ct.sortKey);for(const ft of Ft){const{programConfiguration:Ct,program:$t,layoutVertexBuffer:jt,indexBuffer:te,uniformValues:ae,terrainData:re}=ft.state;$t.draw(st,ot.TRIANGLES,ut,rt,St,Kn.disabled,ae,re,C.id,jt,te,ft.segments,C.paint,v.transform.zoom,Ct)}})(o,h,d,m);break;case"heatmap":(function(v,I,C,P){if(C.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const k=v.context,R=k.gl,F=xr.disabled,Z=new Pr([R.ONE,R.ONE],u.aT.transparent,[!0,!0,!0,!0]);(function(st,ot,ut){const rt=st.gl;st.activeTexture.set(rt.TEXTURE1),st.viewport.set([0,0,ot.width/4,ot.height/4]);let St=ut.heatmapFbo;if(St)rt.bindTexture(rt.TEXTURE_2D,St.colorAttachment.get()),st.bindFramebuffer.set(St.framebuffer);else{const Ft=rt.createTexture();rt.bindTexture(rt.TEXTURE_2D,Ft),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_WRAP_S,rt.CLAMP_TO_EDGE),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_WRAP_T,rt.CLAMP_TO_EDGE),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_MIN_FILTER,rt.LINEAR),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_MAG_FILTER,rt.LINEAR),St=ut.heatmapFbo=st.createFramebuffer(ot.width/4,ot.height/4,!1,!1),function(ft,Ct,$t,jt){var te,ae;const re=ft.gl,ge=(te=ft.HALF_FLOAT)!==null&&te!==void 0?te:re.UNSIGNED_BYTE,Be=(ae=ft.RGBA16F)!==null&&ae!==void 0?ae:re.RGBA;re.texImage2D(re.TEXTURE_2D,0,Be,Ct.width/4,Ct.height/4,0,re.RGBA,ge,null),jt.colorAttachment.set($t)}(st,ot,Ft,St)}})(k,v,C),k.clear({color:u.aT.transparent});for(let st=0;st<P.length;st++){const ot=P[st];if(I.hasRenderableParent(ot))continue;const ut=I.getTile(ot),rt=ut.getBucket(C);if(!rt)continue;const St=rt.programConfigurations.get(C.id),Ft=v.useProgram("heatmap",St),{zoom:ft}=v.transform;Ft.draw(k,R.TRIANGLES,An.disabled,F,Z,Kn.disabled,se(ot.posMatrix,ut,ft,C.paint.get("heatmap-intensity")),null,C.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,C.paint,v.transform.zoom,St)}k.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(k,R){const F=k.context,Z=F.gl,st=R.heatmapFbo;if(!st)return;F.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,st.colorAttachment.get()),F.activeTexture.set(Z.TEXTURE1);let ot=R.colorRampTexture;ot||(ot=R.colorRampTexture=new Xt(F,R.colorRamp,Z.RGBA)),ot.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),k.useProgram("heatmapTexture").draw(F,Z.TRIANGLES,An.disabled,xr.disabled,k.colorModeForRenderPass(),Kn.disabled,((ut,rt,St,Ft)=>{const ft=u.Z();u.aS(ft,0,ut.width,ut.height,0,0,1);const Ct=ut.context.gl;return{u_matrix:ft,u_world:[Ct.drawingBufferWidth,Ct.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:rt.paint.get("heatmap-opacity")}})(k,R),null,R.id,k.viewportBuffer,k.quadTriangleIndexBuffer,k.viewportSegments,R.paint,k.transform.zoom)}(v,C))})(o,h,d,m);break;case"line":(function(v,I,C,P){if(v.renderPass!=="translucent")return;const k=C.paint.get("line-opacity"),R=C.paint.get("line-width");if(k.constantOr(1)===0||R.constantOr(1)===0)return;const F=v.depthModeForSublayer(0,An.ReadOnly),Z=v.colorModeForRenderPass(),st=C.paint.get("line-dasharray"),ot=C.paint.get("line-pattern"),ut=ot.constantOr(1),rt=C.paint.get("line-gradient"),St=C.getCrossfadeParameters(),Ft=ut?"linePattern":st?"lineSDF":rt?"lineGradient":"line",ft=v.context,Ct=ft.gl;let $t=!0;for(const jt of P){const te=I.getTile(jt);if(ut&&!te.patternsLoaded())continue;const ae=te.getBucket(C);if(!ae)continue;const re=ae.programConfigurations.get(C.id),ge=v.context.program.get(),Be=v.useProgram(Ft,re),kn=$t||Be.program!==ge,Ie=v.style.map.terrain&&v.style.map.terrain.getTerrainData(jt),rn=ot.constantOr(null);if(rn&&te.imageAtlas){const Ln=te.imageAtlas,wn=Ln.patternPositions[rn.to.toString()],Nn=Ln.patternPositions[rn.from.toString()];wn&&Nn&&re.setConstantPatternPositions(wn,Nn)}const Ge=Ie?jt:null,ur=ut?Ee(v,te,C,St,Ge):st?un(v,te,C,st,St,Ge):rt?Le(v,te,C,ae.lineClipsArray.length,Ge):Me(v,te,C,Ge);if(ut)ft.activeTexture.set(Ct.TEXTURE0),te.imageAtlasTexture.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE),re.updatePaintBuffers(St);else if(st&&(kn||v.lineAtlas.dirty))ft.activeTexture.set(Ct.TEXTURE0),v.lineAtlas.bind(ft);else if(rt){const Ln=ae.gradients[C.id];let wn=Ln.texture;if(C.gradientVersion!==Ln.version){let Nn=256;if(C.stepInterpolant){const pi=I.getSource().maxzoom,br=jt.canonical.z===pi?Math.ceil(1<<v.transform.maxZoom-jt.canonical.z):1;Nn=u.ad(u.aY(ae.maxLineLength/u.N*1024*br),256,ft.maxTextureSize)}Ln.gradient=u.aZ({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:Nn,image:Ln.gradient||void 0,clips:ae.lineClipsArray}),Ln.texture?Ln.texture.update(Ln.gradient):Ln.texture=new Xt(ft,Ln.gradient,Ct.RGBA),Ln.version=C.gradientVersion,wn=Ln.texture}ft.activeTexture.set(Ct.TEXTURE0),wn.bind(C.stepInterpolant?Ct.NEAREST:Ct.LINEAR,Ct.CLAMP_TO_EDGE)}Be.draw(ft,Ct.TRIANGLES,F,v.stencilModeForClipping(jt),Z,Kn.disabled,ur,Ie,C.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,C.paint,v.transform.zoom,re,ae.layoutVertexBuffer2),$t=!1}})(o,h,d,m);break;case"fill":(function(v,I,C,P){const k=C.paint.get("fill-color"),R=C.paint.get("fill-opacity");if(R.constantOr(1)===0)return;const F=v.colorModeForRenderPass(),Z=C.paint.get("fill-pattern"),st=v.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&k.constantOr(u.aT.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===st){const ot=v.depthModeForSublayer(1,v.renderPass==="opaque"?An.ReadWrite:An.ReadOnly);fc(v,I,C,P,ot,F,!1)}if(v.renderPass==="translucent"&&C.paint.get("fill-antialias")){const ot=v.depthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,An.ReadOnly);fc(v,I,C,P,ot,F,!0)}})(o,h,d,m);break;case"fill-extrusion":(function(v,I,C,P){const k=C.paint.get("fill-extrusion-opacity");if(k!==0&&v.renderPass==="translucent"){const R=new An(v.context.gl.LEQUAL,An.ReadWrite,v.depthRangeFor3D);if(k!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))dc(v,I,C,P,R,xr.disabled,Pr.disabled),dc(v,I,C,P,R,v.stencilModeFor3D(),v.colorModeForRenderPass());else{const F=v.colorModeForRenderPass();dc(v,I,C,P,R,xr.disabled,F)}}})(o,h,d,m);break;case"hillshade":(function(v,I,C,P){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const k=v.context,R=v.depthModeForSublayer(0,An.ReadOnly),F=v.colorModeForRenderPass(),[Z,st]=v.renderPass==="translucent"?v.stencilConfigForOverlap(P):[{},P];for(const ot of st){const ut=I.getTile(ot);ut.needsHillshadePrepare!==void 0&&ut.needsHillshadePrepare&&v.renderPass==="offscreen"?gh(v,ut,C,R,xr.disabled,F):v.renderPass==="translucent"&&bf(v,ot,ut,C,R,Z[ot.overscaledZ],F)}k.viewport.set([0,0,v.width,v.height])})(o,h,d,m);break;case"raster":(function(v,I,C,P){if(v.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!P.length)return;const k=v.context,R=k.gl,F=I.getSource(),Z=v.useProgram("raster"),st=v.colorModeForRenderPass(),[ot,ut]=F instanceof Oe?[{},P]:v.stencilConfigForOverlap(P),rt=ut[ut.length-1].overscaledZ,St=!v.options.moving;for(const Ft of ut){const ft=v.depthModeForSublayer(Ft.overscaledZ-rt,C.paint.get("raster-opacity")===1?An.ReadWrite:An.ReadOnly,R.LESS),Ct=I.getTile(Ft);Ct.registerFadeDuration(C.paint.get("raster-fade-duration"));const $t=I.findLoadedParent(Ft,0),jt=mh(Ct,$t,I,C,v.transform,v.style.map.terrain);let te,ae;const re=C.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;k.activeTexture.set(R.TEXTURE0),Ct.texture.bind(re,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(R.TEXTURE1),$t?($t.texture.bind(re,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),te=Math.pow(2,$t.tileID.overscaledZ-Ct.tileID.overscaledZ),ae=[Ct.tileID.canonical.x*te%1,Ct.tileID.canonical.y*te%1]):Ct.texture.bind(re,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);const ge=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ft),Be=ge?Ft:null,kn=Be?Be.posMatrix:v.transform.calculatePosMatrix(Ft.toUnwrapped(),St),Ie=Jr(kn,ae||[0,0],te||1,jt,C);F instanceof Oe?Z.draw(k,R.TRIANGLES,ft,xr.disabled,st,Kn.disabled,Ie,ge,C.id,F.boundsBuffer,v.quadTriangleIndexBuffer,F.boundsSegments):Z.draw(k,R.TRIANGLES,ft,ot[Ft.overscaledZ],st,Kn.disabled,Ie,ge,C.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}})(o,h,d,m);break;case"background":(function(v,I,C,P){const k=C.paint.get("background-color"),R=C.paint.get("background-opacity");if(R===0)return;const F=v.context,Z=F.gl,st=v.transform,ot=st.tileSize,ut=C.paint.get("background-pattern");if(v.isPatternMissing(ut))return;const rt=!ut&&k.a===1&&R===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==rt)return;const St=xr.disabled,Ft=v.depthModeForSublayer(0,rt==="opaque"?An.ReadWrite:An.ReadOnly),ft=v.colorModeForRenderPass(),Ct=v.useProgram(ut?"backgroundPattern":"background"),$t=P||st.coveringTiles({tileSize:ot,terrain:v.style.map.terrain});ut&&(F.activeTexture.set(Z.TEXTURE0),v.imageManager.bind(v.context));const jt=C.getCrossfadeParameters();for(const te of $t){const ae=P?te.posMatrix:v.transform.calculatePosMatrix(te.toUnwrapped()),re=ut?Do(ae,R,v,ut,{tileID:te,tileSize:ot},jt):zr(ae,R,k),ge=v.style.map.terrain&&v.style.map.terrain.getTerrainData(te);Ct.draw(F,Z.TRIANGLES,Ft,St,ft,Kn.disabled,re,ge,C.id,v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}})(o,0,d,m);break;case"custom":(function(v,I,C){const P=v.context,k=C.implementation;if(v.renderPass==="offscreen"){const R=k.prerender;R&&(v.setCustomLayerDefaults(),P.setColorMode(v.colorModeForRenderPass()),R.call(k,P.gl,v.transform.customLayerMatrix()),P.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),P.setColorMode(v.colorModeForRenderPass()),P.setStencilMode(xr.disabled);const R=k.renderingMode==="3d"?new An(v.context.gl.LEQUAL,An.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,An.ReadOnly);P.setDepthMode(R),k.render(P.gl,v.transform.customLayerMatrix()),P.setDirty(),v.setBaseState(),P.bindFramebuffer.set(null)}})(o,0,d)}}translatePosMatrix(o,h,d,m,v){if(!d[0]&&!d[1])return o;const I=v?m==="map"?this.transform.angle:0:m==="viewport"?-this.transform.angle:0;if(I){const k=Math.sin(I),R=Math.cos(I);d=[d[0]*R-d[1]*k,d[0]*k+d[1]*R]}const C=[v?d[0]:vt(h,d[0],this.transform.zoom),v?d[1]:vt(h,d[1],this.transform.zoom),0],P=new Float32Array(16);return u.$(P,o,C),P}saveTileTexture(o){const h=this._tileTextures[o.size[0]];h?h.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const h=this._tileTextures[o];return h&&h.length>0?h.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const h=this.imageManager.getPattern(o.from.toString()),d=this.imageManager.getPattern(o.to.toString());return!h||!d}useProgram(o,h){this.cache=this.cache||{};const d=o+(h?h.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new ua(this.context,ir[o],h,eh[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Xt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:h}=this.context.gl;return this.width!==o||this.height!==h}}class wo{constructor(o,h){this.points=o,this.planes=h}static fromInvProjectionMatrix(o,h,d){const m=Math.pow(2,d),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const P=1/(C=u.ag([],C,o))[3]/h*m;return u.b3(C,C,[P,P,1/C[3],P])}),I=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const P=function(Z,st){var ot=st[0],ut=st[1],rt=st[2],St=ot*ot+ut*ut+rt*rt;return St>0&&(St=1/Math.sqrt(St)),Z[0]=st[0]*St,Z[1]=st[1]*St,Z[2]=st[2]*St,Z}([],function(Z,st,ot){var ut=st[0],rt=st[1],St=st[2],Ft=ot[0],ft=ot[1],Ct=ot[2];return Z[0]=rt*Ct-St*ft,Z[1]=St*Ft-ut*Ct,Z[2]=ut*ft-rt*Ft,Z}([],zt([],v[C[0]],v[C[1]]),zt([],v[C[2]],v[C[1]]))),k=-((R=P)[0]*(F=v[C[1]])[0]+R[1]*F[1]+R[2]*F[2]);var R,F;return P.concat(k)});return new wo(v,I)}}class da{constructor(o,h){this.min=o,this.max=h,this.center=function(d,m,v){return d[0]=.5*m[0],d[1]=.5*m[1],d[2]=.5*m[2],d}([],function(d,m,v){return d[0]=m[0]+v[0],d[1]=m[1]+v[1],d[2]=m[2]+v[2],d}([],this.min,this.max))}quadrant(o){const h=[o%2==0,o<2],d=_t(this.min),m=_t(this.max);for(let v=0;v<h.length;v++)d[v]=h[v]?this.min[v]:this.center[v],m[v]=h[v]?this.center[v]:this.max[v];return m[2]=this.max[2],new da(d,m)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const h=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let m=0;m<o.planes.length;m++){const v=o.planes[m];let I=0;for(let C=0;C<h.length;C++)u.b4(v,h[C])>=0&&I++;if(I===0)return 0;I!==h.length&&(d=!1)}if(d)return 2;for(let m=0;m<3;m++){let v=Number.MAX_VALUE,I=-Number.MAX_VALUE;for(let C=0;C<o.points.length;C++){const P=o.points[C][m]-this.min[m];v=Math.min(v,P),I=Math.max(I,P)}if(I<0||v>this.max[m]-this.min[m])return 0}return 1}}class Du{constructor(o=0,h=0,d=0,m=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(d)||d<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=d,this.right=m}interpolate(o,h,d){return h.top!=null&&o.top!=null&&(this.top=u.B.number(o.top,h.top,d)),h.bottom!=null&&o.bottom!=null&&(this.bottom=u.B.number(o.bottom,h.bottom,d)),h.left!=null&&o.left!=null&&(this.left=u.B.number(o.left,h.left,d)),h.right!=null&&o.right!=null&&(this.right=u.B.number(o.right,h.right,d)),this}getCenter(o,h){const d=u.ad((this.left+o-this.right)/2,0,o),m=u.ad((this.top+h-this.bottom)/2,0,h);return new u.P(d,m)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Du(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class xh{constructor(o,h,d,m,v){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=v===void 0||!!v,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=d??0,this._maxPitch=m??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Du,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const o=new xh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this._minEleveationForCurrentTile=o._minEleveationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const h=-u.b5(o,-180,180)*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=function(){var d=new u.A(4);return u.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,m,v){var I=m[0],C=m[1],P=m[2],k=m[3],R=Math.sin(v),F=Math.cos(v);d[0]=I*F+P*R,d[1]=C*F+k*R,d[2]=I*-R+P*F,d[3]=C*-R+k*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const h=u.ad(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._zoom=h,this.tileZoom=Math.max(0,Math.floor(h)),this.scale=this.zoomScale(h),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,d){this._unmodified=!1,this._edgeInsets.interpolate(o,h,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){const h=[new u.b6(0,o)];if(this._renderWorldCopies){const d=this.pointCoordinate(new u.P(0,0)),m=this.pointCoordinate(new u.P(this.width,0)),v=this.pointCoordinate(new u.P(this.width,this.height)),I=this.pointCoordinate(new u.P(0,this.height)),C=Math.floor(Math.min(d.x,m.x,v.x,I.x)),P=Math.floor(Math.max(d.x,m.x,v.x,I.x)),k=1;for(let R=C-k;R<=P+k;R++)R!==0&&h.push(new u.b6(R,o))}return h}coveringTiles(o){var h,d;let m=this.coveringZoomLevel(o);const v=m;if(o.minzoom!==void 0&&m<o.minzoom)return[];o.maxzoom!==void 0&&m>o.maxzoom&&(m=o.maxzoom);const I=this.pointCoordinate(this.getCameraPoint()),C=u.U.fromLngLat(this.center),P=Math.pow(2,m),k=[P*I.x,P*I.y,0],R=[P*C.x,P*C.y,0],F=wo.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m);let Z=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(Z=m);const st=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,ot=ft=>({aabb:new da([ft*P,0,0],[(ft+1)*P,P,0]),zoom:0,x:0,y:0,wrap:ft,fullyVisible:!1}),ut=[],rt=[],St=m,Ft=o.reparseOverscaled?v:m;if(this._renderWorldCopies)for(let ft=1;ft<=3;ft++)ut.push(ot(-ft)),ut.push(ot(ft));for(ut.push(ot(0));ut.length>0;){const ft=ut.pop(),Ct=ft.x,$t=ft.y;let jt=ft.fullyVisible;if(!jt){const Be=ft.aabb.intersects(F);if(Be===0)continue;jt=Be===2}const te=o.terrain?k:R,ae=ft.aabb.distanceX(te),re=ft.aabb.distanceY(te),ge=Math.max(Math.abs(ae),Math.abs(re));if(ft.zoom===St||ge>st+(1<<St-ft.zoom)-2&&ft.zoom>=Z){const Be=St-ft.zoom,kn=k[0]-.5-(Ct<<Be),Ie=k[1]-.5-($t<<Be);rt.push({tileID:new u.O(ft.zoom===St?Ft:ft.zoom,ft.wrap,ft.zoom,Ct,$t),distanceSq:Rt([R[0]-.5-Ct,R[1]-.5-$t]),tileDistanceToCamera:Math.sqrt(kn*kn+Ie*Ie)})}else for(let Be=0;Be<4;Be++){const kn=(Ct<<1)+Be%2,Ie=($t<<1)+(Be>>1),rn=ft.zoom+1;let Ge=ft.aabb.quadrant(Be);if(o.terrain){const ur=new u.O(rn,ft.wrap,rn,kn,Ie),Ln=o.terrain.getMinMaxElevation(ur),wn=(h=Ln.minElevation)!==null&&h!==void 0?h:this.elevation,Nn=(d=Ln.maxElevation)!==null&&d!==void 0?d:this.elevation;Ge=new da([Ge.min[0],Ge.min[1],wn],[Ge.max[0],Ge.max[1],Nn])}ut.push({aabb:Ge,zoom:rn,x:kn,y:Ie,wrap:ft.wrap,fullyVisible:jt})}}return rt.sort((ft,Ct)=>ft.distanceSq-Ct.distanceSq).map(ft=>ft.tileID)}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const h=u.ad(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.P(u.G(o.lng)*this.worldSize,u.H(h)*this.worldSize)}unproject(o){return new u.U(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const h=this.pointLocation(this.centerPoint,o),d=o.getElevationForLngLatZoom(h,this.tileZoom);if(!(this.elevation-d))return;const m=this.getCameraPosition(),v=u.U.fromLngLat(m.lngLat,m.altitude),I=u.U.fromLngLat(h,d),C=v.x-I.x,P=v.y-I.y,k=v.z-I.z,R=Math.sqrt(C*C+P*P+k*k),F=this.scaleZoom(this.cameraToCenterDistance/R/this.tileSize);this._elevation=d,this._center=h,this.zoom=F}setLocationAtPoint(o,h){const d=this.pointCoordinate(h),m=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(o),I=new u.U(v.x-(d.x-m.x),v.y-(d.y-m.y));this.center=this.coordinateLocation(I),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,h){return h?this.coordinatePoint(this.locationCoordinate(o),h.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,h){return this.coordinateLocation(this.pointCoordinate(o,h))}locationCoordinate(o){return u.U.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,h){if(h){const Z=h.pointCoordinate(o);if(Z!=null)return Z}const d=[o.x,o.y,0,1],m=[o.x,o.y,1,1];u.ag(d,d,this.pixelMatrixInverse),u.ag(m,m,this.pixelMatrixInverse);const v=d[3],I=m[3],C=d[1]/v,P=m[1]/I,k=d[2]/v,R=m[2]/I,F=k===R?0:(0-k)/(R-k);return new u.U(u.B.number(d[0]/v,m[0]/I,F)/this.worldSize,u.B.number(C,P,F)/this.worldSize)}coordinatePoint(o,h=0,d=this.pixelMatrix){const m=[o.x*this.worldSize,o.y*this.worldSize,h,1];return u.ag(m,m,d),new u.P(m[0]/m[3],m[1]/m[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return new Ke().extend(this.pointLocation(new u.P(0,o))).extend(this.pointLocation(new u.P(this.width,o))).extend(this.pointLocation(new u.P(this.width,this.height))).extend(this.pointLocation(new u.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ke([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,h=!1){const d=o.key,m=h?this._alignedPosMatrixCache:this._posMatrixCache;if(m[d])return m[d];const v=o.canonical,I=this.worldSize/this.zoomScale(v.z),C=v.x+Math.pow(2,v.z)*o.wrap,P=u.ao(new Float64Array(16));return u.$(P,P,[C*I,v.y*I,0]),u.a0(P,P,[I/u.N,I/u.N,1]),u.a1(P,h?this.alignedProjMatrix:this.projMatrix,P),m[d]=new Float32Array(P),m[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,h,d,m,v=-90,I=90,C=-180,P=180;const k=this.size,R=this._unmodified;if(this.latRange){const st=this.latRange;v=u.H(st[1])*this.worldSize,I=u.H(st[0])*this.worldSize,o=I-v<k.y?k.y/(I-v):0}if(this.lngRange){const st=this.lngRange;C=u.b5(u.G(st[0])*this.worldSize,0,this.worldSize),P=u.b5(u.G(st[1])*this.worldSize,0,this.worldSize),P<C&&(P+=this.worldSize),h=P-C<k.x?k.x/(P-C):0}const F=this.point,Z=Math.max(h||0,o||0);if(Z)return this.center=this.unproject(new u.P(h?(P+C)/2:F.x,o?(I+v)/2:F.y)),this.zoom+=this.scaleZoom(Z),this._unmodified=R,void(this._constraining=!1);if(this.latRange){const st=F.y,ot=k.y/2;st-ot<v&&(m=v+ot),st+ot>I&&(m=I-ot)}if(this.lngRange){const st=(C+P)/2,ot=u.b5(F.x,st-this.worldSize/2,st+this.worldSize/2),ut=k.x/2;ot-ut<C&&(d=C+ut),ot+ut>P&&(d=P-ut)}d===void 0&&m===void 0||(this.center=this.unproject(new u.P(d!==void 0?d:F.x,m!==void 0?m:F.y)).wrap()),this._unmodified=R,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,h=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.b7(1,this.center.lat)*this.worldSize;let m=u.ao(new Float64Array(16));u.a0(m,m,[this.width/2,-this.height/2,1]),u.$(m,m,[1,-1,0]),this.labelPlaneMatrix=m,m=u.ao(new Float64Array(16)),u.a0(m,m,[1,-1,1]),u.$(m,m,[-1,-1,0]),u.a0(m,m,[2/this.width,2/this.height,1]),this.glCoordMatrix=m;const v=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),I=Math.min(this.elevation,this._minEleveationForCurrentTile),C=v-I*this._pixelPerMeter/Math.cos(this._pitch),P=I<0?C:v,k=Math.PI/2+this._pitch,R=this._fov*(.5+o.y/this.height),F=Math.sin(R)*P/Math.sin(u.ad(Math.PI-k-R,.01,Math.PI-.01)),Z=this.getHorizon(),st=2*Math.atan(Z/this.cameraToCenterDistance)*(.5+o.y/(2*Z)),ot=Math.sin(st)*P/Math.sin(u.ad(Math.PI-k-st,.01,Math.PI-.01)),ut=Math.min(F,ot),rt=1.01*(Math.cos(Math.PI/2-this._pitch)*ut+P),St=this.height/50;m=new Float64Array(16),u.b8(m,this._fov,this.width/this.height,St,rt),m[8]=2*-o.x/this.width,m[9]=2*o.y/this.height,u.a0(m,m,[1,-1,1]),u.$(m,m,[0,0,-this.cameraToCenterDistance]),u.b9(m,m,this._pitch),u.ae(m,m,this.angle),u.$(m,m,[-h,-d,0]),this.mercatorMatrix=u.a0([],m,[this.worldSize,this.worldSize,this.worldSize]),u.a0(m,m,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.a1(new Float64Array(16),this.labelPlaneMatrix,m),u.$(m,m,[0,0,-this.elevation]),this.projMatrix=m,this.invProjMatrix=u.as([],m),this.pixelMatrix3D=u.a1(new Float64Array(16),this.labelPlaneMatrix,m);const Ft=this.width%2/2,ft=this.height%2/2,Ct=Math.cos(this.angle),$t=Math.sin(this.angle),jt=h-Math.round(h)+Ct*Ft+$t*ft,te=d-Math.round(d)+Ct*ft+$t*Ft,ae=new Float64Array(m);if(u.$(ae,ae,[jt>.5?jt-1:jt,te>.5?te-1:te,0]),this.alignedProjMatrix=ae,m=u.as(new Float64Array(16),this.pixelMatrix),!m)throw new Error("failed to invert matrix");this.pixelMatrixInverse=m,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new u.P(0,0)),h=[o.x*this.worldSize,o.y*this.worldSize,0,1];return u.ag(h,h,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(0,o))}getCameraQueryGeometry(o){const h=this.getCameraPoint();if(o.length===1)return[o[0],h];{let d=h.x,m=h.y,v=h.x,I=h.y;for(const C of o)d=Math.min(d,C.x),m=Math.min(m,C.y),v=Math.max(v,C.x),I=Math.max(I,C.y);return[new u.P(d,m),new u.P(v,m),new u.P(v,I),new u.P(d,I),new u.P(d,m)]}}}function Pt(y,o){let h,d=!1,m=null,v=null;const I=()=>{m=null,d&&(y.apply(v,h),m=setTimeout(I,o),d=!1)};return(...C)=>(d=!0,v=this,h=C,m||I(),m)}class Wt{constructor(o){this._getCurrentHash=()=>{const h=window.location.hash.replace("#","");if(this._hashName){let d;return h.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(d=m)}),(d&&d[1]||"").split("/")}return h.split("/")},this._onHashChange=()=>{const h=this._getCurrentHash();if(h.length>=3&&!h.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(h[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:d,pitch:+(h[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const h=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,h)}catch{}},this._updateHash=Pt(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const h=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,m=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,m),I=Math.round(h.lng*v)/v,C=Math.round(h.lat*v)/v,P=this._map.getBearing(),k=this._map.getPitch();let R="";if(R+=o?`/${I}/${C}/${d}`:`${d}/${C}/${I}`,(P||k)&&(R+="/"+Math.round(10*P)/10),k&&(R+=`/${Math.round(k)}`),this._hashName){const F=this._hashName;let Z=!1;const st=window.location.hash.slice(1).split("&").map(ot=>{const ut=ot.split("=")[0];return ut===F?(Z=!0,`${ut}=${R}`):ot}).filter(ot=>ot);return Z||st.push(`${F}=${R}`),`#${st.join("&")}`}return`#${R}`}}const Se={linearity:.3,easing:u.ba(0,0,.3,1)},en=u.e({deceleration:2500,maxSpeed:1400},Se),wr=u.e({deceleration:20,maxSpeed:1400},Se),Rn=u.e({deceleration:1e3,maxSpeed:360},Se),Fr=u.e({deceleration:1e3,maxSpeed:90},Se);class Qr{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.h.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,h=u.h.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)h.zoom+=v.zoomDelta||0,h.bearing+=v.bearingDelta||0,h.pitch+=v.pitchDelta||0,v.panDelta&&h.pan._add(v.panDelta),v.around&&(h.around=v.around),v.pinchAround&&(h.pinchAround=v.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,m={};if(h.pan.mag()){const v=Br(h.pan.mag(),d,u.e({},en,o||{}));m.offset=h.pan.mult(v.amount/h.pan.mag()),m.center=this._map.transform.center,ci(m,v)}if(h.zoom){const v=Br(h.zoom,d,wr);m.zoom=this._map.transform.zoom+v.amount,ci(m,v)}if(h.bearing){const v=Br(h.bearing,d,Rn);m.bearing=this._map.transform.bearing+u.ad(v.amount,-179,179),ci(m,v)}if(h.pitch){const v=Br(h.pitch,d,Fr);m.pitch=this._map.transform.pitch+v.amount,ci(m,v)}if(m.zoom||m.bearing){const v=h.pinchAround===void 0?h.around:h.pinchAround;m.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),u.e(m,{noMoveStart:!0})}}function ci(y,o){(!y.duration||y.duration<o.duration)&&(y.duration=o.duration,y.easing=o.easing)}function Br(y,o,h){const{maxSpeed:d,linearity:m,deceleration:v}=h,I=u.ad(y*m/(o/1e3),-d,d),C=Math.abs(I)/(v*m);return{easing:h.easing,duration:1e3*C,amount:I*(C/2)}}class Jn extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,d,m={}){const v=S.mousePos(h.getCanvasContainer(),d),I=h.unproject(v);super(o,u.e({point:v,lngLat:I,originalEvent:d},m)),this._defaultPrevented=!1,this.target=h}}class zo extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,d){const m=o==="touchend"?d.changedTouches:d.touches,v=S.touchPos(h.getCanvasContainer(),m),I=v.map(P=>h.unproject(P)),C=v.reduce((P,k,R,F)=>P.add(k.div(F.length)),new u.P(0,0));super(o,{points:v,point:C,lngLats:I,lngLat:h.unproject(C),originalEvent:d}),this._defaultPrevented=!1}}class ga extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,d){super(o,{originalEvent:d}),this._defaultPrevented=!1}}class lo{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new ga(o.type,this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new Jn(o.type,this._map,o))}mouseup(o){this._map.fire(new Jn(o.type,this._map,o))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||this._map.fire(new Jn(o.type,this._map,o))}dblclick(o){return this._firePreventable(new Jn(o.type,this._map,o))}mouseover(o){this._map.fire(new Jn(o.type,this._map,o))}mouseout(o){this._map.fire(new Jn(o.type,this._map,o))}touchstart(o){return this._firePreventable(new zo(o.type,this._map,o))}touchmove(o){this._map.fire(new zo(o.type,this._map,o))}touchend(o){this._map.fire(new zo(o.type,this._map,o))}touchcancel(o){this._map.fire(new zo(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ma{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new Jn(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Jn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new Jn(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fo{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(u.P.convert(o),this._map.terrain)}}class gc{constructor(o,h){this._map=o,this._tr=new Fo(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(S.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;const d=h;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const m=this._startPos;this._lastPos=d,this._box||(this._box=S.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const v=Math.min(m.x,d.x),I=Math.max(m.x,d.x),C=Math.min(m.y,d.y),P=Math.max(m.y,d.y);S.setTransform(this._box,`translate(${v}px,${C}px)`),this._box.style.width=I-v+"px",this._box.style.height=P-C+"px"}mouseupWindow(o,h){if(!this._active||o.button!==0)return;const d=this._startPos,m=h;if(this.reset(),S.suppressClick(),d.x!==m.x||d.y!==m.y)return this._map.fire(new u.k("boxzoomend",{originalEvent:o})),{cameraAnimation:v=>v.fitScreenCoordinates(d,m,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(S.remove(this._box),this._box=null),S.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new u.k(o,{originalEvent:h}))}}function Xi(y,o){if(y.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${o.length}`);const h={};for(let d=0;d<y.length;d++)h[y[d].identifier]=o[d];return h}class rs{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,h,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),d.length===this.numTouches&&(this.centroid=function(m){const v=new u.P(0,0);for(const I of m)v._add(I);return v.div(m.length)}(h),this.touches=Xi(d,h)))}touchmove(o,h,d){if(this.aborted||!this.centroid)return;const m=Xi(d,h);for(const v in this.touches){const I=m[v];(!I||I.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(o,h,d){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const m=!this.aborted&&this.centroid;if(this.reset(),m)return m}}}class mc{constructor(o){this.singleTap=new rs(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,h,d){this.singleTap.touchstart(o,h,d)}touchmove(o,h,d){this.singleTap.touchmove(o,h,d)}touchend(o,h,d){const m=this.singleTap.touchend(o,h,d);if(m){const v=o.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(m)<30;if(v&&I||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}}}class za{constructor(o){this._tr=new Fo(o),this._zoomIn=new mc({numTouches:1,numTaps:2}),this._zoomOut=new mc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,d){this._zoomIn.touchstart(o,h,d),this._zoomOut.touchstart(o,h,d)}touchmove(o,h,d){this._zoomIn.touchmove(o,h,d),this._zoomOut.touchmove(o,h,d)}touchend(o,h,d){const m=this._zoomIn.touchend(o,h,d),v=this._zoomOut.touchend(o,h,d),I=this._tr;return m?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:I.zoom+1,around:I.unproject(m)},{originalEvent:o})}):v?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:I.zoom-1,around:I.unproject(v)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fa{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const h=this._moveFunction(...o);if(h.bearingDelta||h.pitchDelta||h.around||h.panDelta)return this._active=!0,h}dragStart(o,h){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=h.length?h[0]:h,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,h){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const m=h.length?h[0]:h;return!this._moved&&m.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=m,this._move(d,m))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&S.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const gr={0:1,2:2};class Qn{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const h=S.mouseButton(o);this._eventButton=h}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(h,d){const m=gr[d];return h.buttons===void 0||(h.buttons&m)!==m}(o,this._eventButton)}isValidEndEvent(o){return S.mouseButton(o)===this._eventButton}}class yc{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const Vs=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=function(o){o.preventDefault()}},dl=({enable:y,clickTolerance:o,bearingDegreesPerPixelMoved:h=.8})=>{const d=new Qn({checkCorrectEvent:m=>S.mouseButton(m)===0&&m.ctrlKey||S.mouseButton(m)===2});return new Fa({clickTolerance:o,move:(m,v)=>({bearingDelta:(v.x-m.x)*h}),moveStateManager:d,enable:y,assignEvents:Vs})},hi=({enable:y,clickTolerance:o,pitchDegreesPerPixelMoved:h=-.5})=>{const d=new Qn({checkCorrectEvent:m=>S.mouseButton(m)===0&&m.ctrlKey||S.mouseButton(m)===2});return new Fa({clickTolerance:o,move:(m,v)=>({pitchDelta:(v.y-m.y)*h}),moveStateManager:d,enable:y,assignEvents:Vs})};class Pe{constructor(o,h){this._minTouches=o.cooperativeGestures?2:1,this._clickTolerance=o.clickTolerance||1,this._map=h,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(o,h,d){return this._calculateTransform(o,h,d)}touchmove(o,h,d){if(this._map._cooperativeGestures&&(this._minTouches===2&&d.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(o,!1,d.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(d.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,h,d)}touchend(o,h,d){this._calculateTransform(o,h,d),this._active&&d.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,d){d.length>0&&(this._active=!0);const m=Xi(d,h),v=new u.P(0,0),I=new u.P(0,0);let C=0;for(const k in m){const R=m[k],F=this._touches[k];F&&(v._add(R),I._add(R.sub(F)),C++,m[k]=R)}if(this._touches=m,C<this._minTouches||!I.mag())return;const P=I.div(C);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(C),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Us{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,h,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,d){if(!this._firstTwoTouches)return;o.preventDefault();const[m,v]=this._firstTwoTouches,I=_s(d,h,m),C=_s(d,h,v);if(!I||!C)return;const P=this._aroundCenter?null:I.add(C).div(2);return this._move([I,C],P,o)}touchend(o,h,d){if(!this._firstTwoTouches)return;const[m,v]=this._firstTwoTouches,I=_s(d,h,m),C=_s(d,h,v);I&&C||(this._active&&S.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function _s(y,o,h){for(let d=0;d<y.length;d++)if(y[d].identifier===h)return o[d]}function Ba(y,o){return Math.log(y/o)/Math.LN2}class tu extends Us{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){const d=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Ba(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ba(this._distance,d),pinchAround:h}}}function xe(y,o){return 180*y.angleWith(o)/Math.PI}class wh extends Us{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){const d=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xe(this._vector,d),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const h=25/(Math.PI*this._minDiameter)*360,d=xe(o,this._startVector);return Math.abs(d)<h}}function Ru(y){return Math.abs(y.y)>Math.abs(y.x)}class Ip extends Us{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,h,d){super.touchstart(o,h,d),this._currentTouchCount=d.length}_start(o){this._lastPoints=o,Ru(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,d){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const m=o[0].sub(this._lastPoints[0]),v=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(m,v,d.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(m.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(o,h,d){if(this._valid!==void 0)return this._valid;const m=o.mag()>=2,v=h.mag()>=2;if(!m&&!v)return;if(!m||!v)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const I=o.y>0==h.y>0;return Ru(o)&&Ru(h)&&I}}const Ou={panStep:100,bearingStep:15,pitchStep:10};class _c{constructor(o){this._tr=new Fo(o);const h=Ou;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,d=0,m=0,v=0,I=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?d=-1:(o.preventDefault(),v=-1);break;case 39:o.shiftKey?d=1:(o.preventDefault(),v=1);break;case 38:o.shiftKey?m=1:(o.preventDefault(),I=-1);break;case 40:o.shiftKey?m=-1:(o.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(d=0,m=0),{cameraAnimation:C=>{const P=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:Cp,zoom:h?Math.round(P.zoom)+h*(o.shiftKey?2:1):P.zoom,bearing:P.bearing+d*this._bearingStep,pitch:P.pitch+m*this._pitchStep,offset:[-v*this._panStep,-I*this._panStep],center:P.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Cp(y){return y*(2-y)}const vc=4.000244140625;class bh{constructor(o,h){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=o,this._tr=new Fo(o),this._el=o.getCanvasContainer(),this._triggerRenderFrame=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!o[this._map._metaKey])return;o.preventDefault()}let h=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const d=u.h.now(),m=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,h!==0&&h%vc==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(m*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=S.mousePos(this._el,o),d=this._tr;this._around=u.L.convert(this._aroundCenter?d.center:d.unproject(h)),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>vc?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&P!==0&&(P=1/P);const k=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(k*P))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,d=this._startZoom,m=this._easing;let v,I=!1;if(this._type==="wheel"&&d&&m){const C=Math.min((u.h.now()-this._lastWheelEventTime)/200,1),P=m(C);v=u.B.number(d,h,P),C<1?this._frameId||(this._frameId=!0):I=!0}else v=h,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:v-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=u.bb;if(this._prevEase){const d=this._prevEase,m=(u.h.now()-d.start)/d.duration,v=d.easing(m+.01)-d.easing(m),I=.27/Math.sqrt(v*v+1e-4)*.01,C=Math.sqrt(.0729-I*I);h=u.ba(I,C,.25,1)}return this._prevEase={start:u.h.now(),duration:o,easing:h},h}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Xd{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wd{constructor(o){this._tr=new Fo(o),this.reset()}reset(){this._active=!1}dblclick(o,h){return o.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hd{constructor(){this._tap=new mc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,h,d){if(!this._swipePoint)if(this._tapTime){const m=h[0],v=o.timeStamp-this._tapTime<500,I=this._tapPoint.dist(m)<30;v&&I?d.length>0&&(this._swipePoint=m,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(o,h,d)}touchmove(o,h,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const m=h[0],v=m.y-this._swipePoint.y;return this._swipePoint=m,o.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(o,h,d)}touchend(o,h,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const m=this._tap.touchend(o,h,d);m&&(this._tapTime=o.timeStamp,this._tapPoint=m)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yd{constructor(o,h,d){this._el=o,this._mousePan=h,this._touchPan=d}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class vs{constructor(o,h,d){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class zu{constructor(o,h,d,m){this._el=o,this._touchZoom=h,this._touchRotate=d,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Tp=y=>y.zoom||y.drag||y.pitch||y.rotate;class Kd extends u.k{}function Pp(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class Jd{constructor(o,h){this.handleWindowEvent=m=>{this.handleEvent(m,`${m.type}Window`)},this.handleEvent=(m,v)=>{if(m.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const I=m.type==="renderFrame"?void 0:m,C={needsRenderFrame:!1},P={},k={},R=m.touches,F=R?this._getMapTouches(R):void 0,Z=F?S.touchPos(this._el,F):S.mousePos(this._el,m);for(const{handlerName:ut,handler:rt,allowed:St}of this._handlers){if(!rt.isEnabled())continue;let Ft;this._blockedByActive(k,St,ut)?rt.reset():rt[v||m.type]&&(Ft=rt[v||m.type](m,Z,F),this.mergeHandlerResult(C,P,Ft,ut,I),Ft&&Ft.needsRenderFrame&&this._triggerRenderFrame()),(Ft||rt.isActive())&&(k[ut]=rt)}const st={};for(const ut in this._previousActiveHandlers)k[ut]||(st[ut]=I);this._previousActiveHandlers=k,(Object.keys(st).length||Pp(C))&&(this._changes.push([C,P,st]),this._triggerRenderFrame()),(Object.keys(k).length||Pp(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ot}=C;ot&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ot(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Qr(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(h);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[m,v,I]of this._listeners)S.addEventListener(m,v,m===document?this.handleWindowEvent:this.handleEvent,I)}destroy(){for(const[o,h,d]of this._listeners)S.removeEventListener(o,h,o===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(o){const h=this._map,d=h.getCanvasContainer();this._add("mapEvent",new lo(h,o));const m=h.boxZoom=new gc(h,o);this._add("boxZoom",m),o.interactive&&o.boxZoom&&m.enable();const v=new za(h),I=new Wd(h);h.doubleClickZoom=new Xd(I,v),this._add("tapZoom",v),this._add("clickZoom",I),o.interactive&&o.doubleClickZoom&&h.doubleClickZoom.enable();const C=new Hd;this._add("tapDragZoom",C);const P=h.touchPitch=new Ip(h);this._add("touchPitch",P),o.interactive&&o.touchPitch&&h.touchPitch.enable(o.touchPitch);const k=dl(o),R=hi(o);h.dragRotate=new vs(o,k,R),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",R,["mouseRotate"]),o.interactive&&o.dragRotate&&h.dragRotate.enable();const F=(({enable:St,clickTolerance:Ft})=>{const ft=new Qn({checkCorrectEvent:Ct=>S.mouseButton(Ct)===0&&!Ct.ctrlKey});return new Fa({clickTolerance:Ft,move:(Ct,$t)=>({around:$t,panDelta:$t.sub(Ct)}),activateOnStart:!0,moveStateManager:ft,enable:St,assignEvents:Vs})})(o),Z=new Pe(o,h);h.dragPan=new Yd(d,F,Z),this._add("mousePan",F),this._add("touchPan",Z,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&h.dragPan.enable(o.dragPan);const st=new wh,ot=new tu;h.touchZoomRotate=new zu(d,ot,st,C),this._add("touchRotate",st,["touchPan","touchZoom"]),this._add("touchZoom",ot,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&h.touchZoomRotate.enable(o.touchZoomRotate);const ut=h.scrollZoom=new bh(h,()=>this._triggerRenderFrame());this._add("scrollZoom",ut,["mousePan"]),o.interactive&&o.scrollZoom&&h.scrollZoom.enable(o.scrollZoom);const rt=h.keyboard=new _c(h);this._add("keyboard",rt),o.interactive&&o.keyboard&&h.keyboard.enable(),this._add("blockableMapEvent",new ma(h))}_add(o,h,d){this._handlers.push({handlerName:o,handler:h,allowed:d}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Tp(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,h,d){for(const m in o)if(m!==d&&(!h||h.indexOf(m)<0))return!0;return!1}_getMapTouches(o){const h=[];for(const d of o)this._el.contains(d.target)&&h.push(d);return h}mergeHandlerResult(o,h,d,m,v){if(!d)return;u.e(o,d);const I={handlerName:m,originalEvent:d.originalEvent||v};d.zoomDelta!==void 0&&(h.zoom=I),d.panDelta!==void 0&&(h.drag=I),d.pitchDelta!==void 0&&(h.pitch=I),d.bearingDelta!==void 0&&(h.rotate=I)}_applyChanges(){const o={},h={},d={};for(const[m,v,I]of this._changes)m.panDelta&&(o.panDelta=(o.panDelta||new u.P(0,0))._add(m.panDelta)),m.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+m.zoomDelta),m.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+m.bearingDelta),m.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+m.pitchDelta),m.around!==void 0&&(o.around=m.around),m.pinchAround!==void 0&&(o.pinchAround=m.pinchAround),m.noInertia&&(o.noInertia=m.noInertia),u.e(h,v),u.e(d,I);this._updateMapTransform(o,h,d),this._changes=[]}_updateMapTransform(o,h,d){const m=this._map,v=m._getTransformForUpdate(),I=m.terrain;if(!(Pp(o)||I&&this._terrainMovement))return this._fireEvents(h,d,!0);let{panDelta:C,zoomDelta:P,bearingDelta:k,pitchDelta:R,around:F,pinchAround:Z}=o;Z!==void 0&&(F=Z),m._stop(!0),F=F||m.transform.centerPoint;const st=v.pointLocation(C?F.sub(C):F);k&&(v.bearing+=k),R&&(v.pitch+=R),P&&(v.zoom+=P),I?this._terrainMovement||!h.drag&&!h.zoom?h.drag&&this._terrainMovement?v.center=v.pointLocation(v.centerPoint.sub(C)):v.setLocationAtPoint(st,F):(this._terrainMovement=!0,this._map._elevationFreeze=!0,v.setLocationAtPoint(st,F),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,v.recalculateZoom(m.terrain)})):v.setLocationAtPoint(st,F),m._applyUpdatedTransform(v),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,d,!0)}_fireEvents(o,h,d){const m=Tp(this._eventsInProgress),v=Tp(o),I={};for(const R in o){const{originalEvent:F}=o[R];this._eventsInProgress[R]||(I[`${R}start`]=F),this._eventsInProgress[R]=o[R]}!m&&v&&this._fireEvent("movestart",v.originalEvent);for(const R in I)this._fireEvent(R,I[R]);v&&this._fireEvent("move",v.originalEvent);for(const R in o){const{originalEvent:F}=o[R];this._fireEvent(R,F)}const C={};let P;for(const R in this._eventsInProgress){const{handlerName:F,originalEvent:Z}=this._eventsInProgress[R];this._handlersById[F].isActive()||(delete this._eventsInProgress[R],P=h[F]||Z,C[`${R}end`]=P)}for(const R in C)this._fireEvent(R,C[R]);const k=Tp(this._eventsInProgress);if(d&&(m||v)&&!k){this._updatingCamera=!0;const R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),F=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;!R||!R.essential&&u.h.prefersReducedMotion?(this._map.fire(new u.k("moveend",{originalEvent:P})),F(this._map.getBearing())&&this._map.resetNorth()):(F(R.bearing||this._map.getBearing())&&(R.bearing=0),R.freezeElevation=!0,this._map.easeTo(R,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new u.k(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Kd("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Wm extends u.E{constructor(o,h){super(),this._renderFrameCallback=()=>{const d=Math.min((u.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.L(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,d){return o=u.P.convert(o).mult(-1),this.panTo(this.transform.center,u.e({offset:o},h),d)}panTo(o,h,d){return this.easeTo(u.e({center:o},h),d)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,d){return this.easeTo(u.e({zoom:o},h),d)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,d){return this.easeTo(u.e({bearing:o},h),d)}resetNorth(o,h){return this.rotateTo(0,u.e({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(u.e({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=Ke.convert(o);const d=h&&h.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),d,h)}_cameraForBoxAndBearing(o,h,d,m){const v={top:0,bottom:0,right:0,left:0};if(typeof(m=u.e({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){const $t=m.padding;m.padding={top:$t,bottom:$t,right:$t,left:$t}}m.padding=u.e(v,m.padding);const I=this.transform,C=I.padding,P=I.project(u.L.convert(o)),k=I.project(u.L.convert(h)),R=P.rotate(-d*Math.PI/180),F=k.rotate(-d*Math.PI/180),Z=new u.P(Math.max(R.x,F.x),Math.max(R.y,F.y)),st=new u.P(Math.min(R.x,F.x),Math.min(R.y,F.y)),ot=Z.sub(st),ut=(I.width-(C.left+C.right+m.padding.left+m.padding.right))/ot.x,rt=(I.height-(C.top+C.bottom+m.padding.top+m.padding.bottom))/ot.y;if(rt<0||ut<0)return void u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const St=Math.min(I.scaleZoom(I.scale*Math.min(ut,rt)),m.maxZoom),Ft=u.P.convert(m.offset),ft=new u.P((m.padding.left-m.padding.right)/2,(m.padding.top-m.padding.bottom)/2).rotate(d*Math.PI/180),Ct=Ft.add(ft).mult(I.scale/I.zoomScale(St));return{center:I.unproject(P.add(k).div(2).sub(Ct)),zoom:St,bearing:d}}fitBounds(o,h,d){return this._fitInternal(this.cameraForBounds(o,h),h,d)}fitScreenCoordinates(o,h,d,m,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.P.convert(o)),this.transform.pointLocation(u.P.convert(h)),d,m),m,v)}_fitInternal(o,h,d){return o?(delete(h=u.e(o,h)).padding,h.linear?this.easeTo(h,d):this.flyTo(h,d)):this}jumpTo(o,h){this.stop();const d=this._getTransformForUpdate();let m=!1,v=!1,I=!1;return"zoom"in o&&d.zoom!==+o.zoom&&(m=!0,d.zoom=+o.zoom),o.center!==void 0&&(d.center=u.L.convert(o.center)),"bearing"in o&&d.bearing!==+o.bearing&&(v=!0,d.bearing=+o.bearing),"pitch"in o&&d.pitch!==+o.pitch&&(I=!0,d.pitch=+o.pitch),o.padding==null||d.isPaddingEqual(o.padding)||(d.padding=o.padding),this._applyUpdatedTransform(d),this.fire(new u.k("movestart",h)).fire(new u.k("move",h)),m&&this.fire(new u.k("zoomstart",h)).fire(new u.k("zoom",h)).fire(new u.k("zoomend",h)),v&&this.fire(new u.k("rotatestart",h)).fire(new u.k("rotate",h)).fire(new u.k("rotateend",h)),I&&this.fire(new u.k("pitchstart",h)).fire(new u.k("pitch",h)).fire(new u.k("pitchend",h)),this.fire(new u.k("moveend",h))}calculateCameraOptionsFromTo(o,h,d,m=0){const v=u.U.fromLngLat(o,h),I=u.U.fromLngLat(d,m),C=I.x-v.x,P=I.y-v.y,k=I.z-v.z,R=Math.hypot(C,P,k);if(R===0)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(C,P),Z=this.transform.scaleZoom(this.transform.cameraToCenterDistance/R/this.transform.tileSize),st=180*Math.atan2(C,-P)/Math.PI;let ot=180*Math.acos(F/R)/Math.PI;return ot=k<0?90-ot:90+ot,{center:I.toLngLat(),zoom:Z,pitch:ot,bearing:st}}easeTo(o,h){this._stop(!1,o.easeId),((o=u.e({offset:[0,0],duration:500,easing:u.bb},o)).animate===!1||!o.essential&&u.h.prefersReducedMotion)&&(o.duration=0);const d=this._getTransformForUpdate(),m=this.getZoom(),v=this.getBearing(),I=this.getPitch(),C=this.getPadding(),P="zoom"in o?+o.zoom:m,k="bearing"in o?this._normalizeBearing(o.bearing,v):v,R="pitch"in o?+o.pitch:I,F="padding"in o?o.padding:d.padding,Z=u.P.convert(o.offset);let st=d.centerPoint.add(Z);const ot=d.pointLocation(st),ut=u.L.convert(o.center||ot);this._normalizeCenter(ut);const rt=d.project(ot),St=d.project(ut).sub(rt),Ft=d.zoomScale(P-m);let ft,Ct;o.around&&(ft=u.L.convert(o.around),Ct=d.locationPoint(ft));const $t={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||P!==m,this._rotating=this._rotating||v!==k,this._pitching=this._pitching||R!==I,this._padding=!d.isPaddingEqual(F),this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,$t),this.terrain&&this._prepareElevation(ut),this._ease(jt=>{if(this._zooming&&(d.zoom=u.B.number(m,P,jt)),this._rotating&&(d.bearing=u.B.number(v,k,jt)),this._pitching&&(d.pitch=u.B.number(I,R,jt)),this._padding&&(d.interpolatePadding(C,F,jt),st=d.centerPoint.add(Z)),this.terrain&&!o.freezeElevation&&this._updateElevation(jt),ft)d.setLocationAtPoint(ft,Ct);else{const te=d.zoomScale(d.zoom-m),ae=P>m?Math.min(2,Ft):Math.max(.5,Ft),re=Math.pow(ae,1-jt),ge=d.unproject(rt.add(St.mult(jt*re)).mult(te));d.setLocationAtPoint(d.renderWorldCopies?ge.wrap():ge,st)}this._applyUpdatedTransform(d),this._fireMoveEvents(h)},jt=>{this.terrain&&this._finalizeElevation(),this._afterEase(h,jt)},o),this}_prepareEase(o,h,d={}){this._moving=!0,h||d.moving||this.fire(new u.k("movestart",o)),this._zooming&&!d.zooming&&this.fire(new u.k("zoomstart",o)),this._rotating&&!d.rotating&&this.fire(new u.k("rotatestart",o)),this._pitching&&!d.pitching&&this.fire(new u.k("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const h=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&h!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(d-(h-(d*o+this._elevationStart))/(1-o)),this._elevationTarget=h}this.transform.elevation=u.B.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(o){if(!this.transformCameraUpdate)return;const h=o.clone(),{center:d,zoom:m,pitch:v,bearing:I,elevation:C}=this.transformCameraUpdate(h);d&&(h.center=d),m!==void 0&&(h.zoom=m),v!==void 0&&(h.pitch=v),I!==void 0&&(h.bearing=I),C!==void 0&&(h.elevation=C),this.transform.apply(h)}_fireMoveEvents(o){this.fire(new u.k("move",o)),this._zooming&&this.fire(new u.k("zoom",o)),this._rotating&&this.fire(new u.k("rotate",o)),this._pitching&&this.fire(new u.k("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;delete this._easeId;const d=this._zooming,m=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new u.k("zoomend",o)),m&&this.fire(new u.k("rotateend",o)),v&&this.fire(new u.k("pitchend",o)),this.fire(new u.k("moveend",o))}flyTo(o,h){if(!o.essential&&u.h.prefersReducedMotion){const Ge=u.F(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ge,h)}this.stop(),o=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.bb},o);const d=this._getTransformForUpdate(),m=this.getZoom(),v=this.getBearing(),I=this.getPitch(),C=this.getPadding(),P="zoom"in o?u.ad(+o.zoom,d.minZoom,d.maxZoom):m,k="bearing"in o?this._normalizeBearing(o.bearing,v):v,R="pitch"in o?+o.pitch:I,F="padding"in o?o.padding:d.padding,Z=d.zoomScale(P-m),st=u.P.convert(o.offset);let ot=d.centerPoint.add(st);const ut=d.pointLocation(ot),rt=u.L.convert(o.center||ut);this._normalizeCenter(rt);const St=d.project(ut),Ft=d.project(rt).sub(St);let ft=o.curve;const Ct=Math.max(d.width,d.height),$t=Ct/Z,jt=Ft.mag();if("minZoom"in o){const Ge=u.ad(Math.min(o.minZoom,m,P),d.minZoom,d.maxZoom),ur=Ct/d.zoomScale(Ge-m);ft=Math.sqrt(ur/jt*2)}const te=ft*ft;function ae(Ge){const ur=($t*$t-Ct*Ct+(Ge?-1:1)*te*te*jt*jt)/(2*(Ge?$t:Ct)*te*jt);return Math.log(Math.sqrt(ur*ur+1)-ur)}function re(Ge){return(Math.exp(Ge)-Math.exp(-Ge))/2}function ge(Ge){return(Math.exp(Ge)+Math.exp(-Ge))/2}const Be=ae(!1);let kn=function(Ge){return ge(Be)/ge(Be+ft*Ge)},Ie=function(Ge){return Ct*((ge(Be)*(re(ur=Be+ft*Ge)/ge(ur))-re(Be))/te)/jt;var ur},rn=(ae(!0)-Be)/ft;if(Math.abs(jt)<1e-6||!isFinite(rn)){if(Math.abs(Ct-$t)<1e-6)return this.easeTo(o,h);const Ge=$t<Ct?-1:1;rn=Math.abs(Math.log($t/Ct))/ft,Ie=function(){return 0},kn=function(ur){return Math.exp(Ge*ft*ur)}}return o.duration="duration"in o?+o.duration:1e3*rn/("screenSpeed"in o?+o.screenSpeed/ft:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=v!==k,this._pitching=R!==I,this._padding=!d.isPaddingEqual(F),this._prepareEase(h,!1),this.terrain&&this._prepareElevation(rt),this._ease(Ge=>{const ur=Ge*rn,Ln=1/kn(ur);d.zoom=Ge===1?P:m+d.scaleZoom(Ln),this._rotating&&(d.bearing=u.B.number(v,k,Ge)),this._pitching&&(d.pitch=u.B.number(I,R,Ge)),this._padding&&(d.interpolatePadding(C,F,Ge),ot=d.centerPoint.add(st)),this.terrain&&!o.freezeElevation&&this._updateElevation(Ge);const wn=Ge===1?rt:d.unproject(St.add(Ft.mult(Ie(ur))).mult(Ln));d.setLocationAtPoint(d.renderWorldCopies?wn.wrap():wn,ot),this._applyUpdatedTransform(d),this._fireMoveEvents(h)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(h)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,h)}if(!o){const d=this.handlers;d&&d.stop(!1)}return this}_ease(o,h,d){d.animate===!1||d.duration===0?(o(1),h()):(this._easeStart=u.h.now(),this._easeOptions=d,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,h){o=u.b5(o,-180,180);const d=Math.abs(o-h);return Math.abs(o-360-h)<d&&(o-=360),Math.abs(o+360-h)<d&&(o+=360),o}_normalizeCenter(o){const h=this.transform;if(!h.renderWorldCopies||h.lngRange)return;const d=o.lng-h.center.lng;o.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(u.L.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}class $s{constructor(o={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=h=>{!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"&&h.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=S.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=S.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=S.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){S.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,h){const d=this._map._getUIString(`AttributionControl.${h}`);o.title=d,o.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(m=>typeof m!="string"?"":m)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}const h=this._map.style.sourceCaches;for(const m in h){const v=h[m];if(v.used||v.usedForTerrain){const I=v.getSource();I.attribution&&o.indexOf(I.attribution)<0&&o.push(I.attribution)}}o=o.filter(m=>String(m).trim()),o.sort((m,v)=>m.length-v.length),o=o.filter((m,v)=>{for(let I=v+1;I<o.length;I++)if(o[I].indexOf(m)>=0)return!1;return!0});const d=o.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,o.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Lr{constructor(o={}){this._updateCompact=()=>{const h=this._container.children;if(h.length){const d=h[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=S.create("div","maplibregl-ctrl");const h=S.create("a","maplibregl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://maplibre.org/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){S.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Sf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){const h=this._currentlyRunning,d=h?this._queue.concat(h):this._queue;for(const m of d)if(m.id===o)return void(m.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const h=this._currentlyRunning=this._queue;this._queue=[];for(const d of h)if(!d.cancelled&&(d.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Qd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Hm=u.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Ym extends u.E{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,h){this.sourceCache.update(o,h),this._renderableTilesKeys=[];const d={};for(const m of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:h}))d[m.key]=!0,this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.posMatrix=new Float64Array(16),u.aS(m.posMatrix,0,u.N,0,u.N,0,1),this._tiles[m.key]=new Ui(m,this.tileSize));for(const m in this._tiles)d[m]||delete this._tiles[m]}freeRtt(o){for(const h in this._tiles){const d=this._tiles[h];(!o||d.tileID.equals(o)||d.tileID.isChildOf(o)||o.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const h={};for(const d of this._renderableTilesKeys){const m=this._tiles[d].tileID;if(m.canonical.equals(o.canonical)){const v=o.clone();v.posMatrix=new Float64Array(16),u.aS(v.posMatrix,0,u.N,0,u.N,0,1),h[d]=v}else if(m.canonical.isChildOf(o.canonical)){const v=o.clone();v.posMatrix=new Float64Array(16);const I=m.canonical.z-o.canonical.z,C=m.canonical.x-(m.canonical.x>>I<<I),P=m.canonical.y-(m.canonical.y>>I<<I),k=u.N>>I;u.aS(v.posMatrix,0,k,0,k,0,1),u.$(v.posMatrix,v.posMatrix,[-C*k,-P*k,0]),h[d]=v}else if(o.canonical.isChildOf(m.canonical)){const v=o.clone();v.posMatrix=new Float64Array(16);const I=o.canonical.z-m.canonical.z,C=o.canonical.x-(o.canonical.x>>I<<I),P=o.canonical.y-(o.canonical.y>>I<<I),k=u.N>>I;u.aS(v.posMatrix,0,u.N,0,u.N,0,1),u.$(v.posMatrix,v.posMatrix,[C*k,P*k,0]),u.a0(v.posMatrix,v.posMatrix,[1/2**I,1/2**I,0]),h[d]=v}}return h}getSourceTile(o,h){const d=this.sourceCache._source;let m=o.overscaledZ-this.deltaZoom;if(m>d.maxzoom&&(m=d.maxzoom),m<d.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(m).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!v||!v.dem)&&h)for(;m>=d.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(o.scaledTo(m--).key);return v}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(h=>h.timeAdded>=o)}}class Km{constructor(o,h,d){this.painter=o,this.sourceCache=new Ym(h),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,h,d,m=u.N){var v;if(!(h>=0&&h<m&&d>=0&&d<m))return 0;const I=this.getTerrainData(o),C=(v=I.tile)===null||v===void 0?void 0:v.dem;if(!C)return 0;const P=function(ot,ut,rt){var St=ut[0],Ft=ut[1];return ot[0]=rt[0]*St+rt[4]*Ft+rt[12],ot[1]=rt[1]*St+rt[5]*Ft+rt[13],ot}([],[h/m*u.N,d/m*u.N],I.u_terrain_matrix),k=[P[0]*C.dim,P[1]*C.dim],R=Math.floor(k[0]),F=Math.floor(k[1]),Z=k[0]-R,st=k[1]-F;return C.get(R,F)*(1-Z)*(1-st)+C.get(R+1,F)*Z*(1-st)+C.get(R,F+1)*(1-Z)*st+C.get(R+1,F+1)*Z*st}getElevationForLngLatZoom(o,h){const{tileID:d,mercatorX:m,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(o,h);return this.getElevation(d,m%u.N,v%u.N,u.N)}getElevation(o,h,d,m=u.N){return this.getDEMElevation(o,h,d,m)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const m=this.painter.context,v=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Xt(m,v,m.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Xt(m,new u.R({width:1,height:1}),m.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.ao([])}const h=this.sourceCache.getSourceTile(o,!0);if(h&&h.dem&&(!h.demTexture||h.needsTerrainPrepare)){const m=this.painter.context;h.demTexture=this.painter.getTileTexture(h.dem.stride),h.demTexture?h.demTexture.update(h.dem.getPixels(),{premultiply:!1}):h.demTexture=new Xt(m,h.dem.getPixels(),m.gl.RGBA,{premultiply:!1}),h.demTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),h.needsTerrainPrepare=!1}const d=h&&h+h.tileID.key+o.key;if(d&&!this._demMatrixCache[d]){const m=this.sourceCache.sourceCache._source.maxzoom;let v=o.canonical.z-h.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=m?v=o.canonical.z-m:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const I=o.canonical.x-(o.canonical.x>>v<<v),C=o.canonical.y-(o.canonical.y>>v<<v),P=u.bc(new Float64Array(16),[1/(u.N<<v),1/(u.N<<v),0]);u.$(P,P,[I*u.N,C*u.N,0]),this._demMatrixCache[o.key]={matrix:P,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:h&&h.dem&&h.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:h&&h.dem&&h.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(h&&h.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:h}}getFramebuffer(o){const h=this.painter,d=h.width/devicePixelRatio,m=h.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===m||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Xt(h.context,{width:d,height:m,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Xt(h.context,{width:d,height:m,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=h.context.createFramebuffer(d,m,!0,!1),this._fbo.depthAttachment.set(h.context.createRenderbuffer(h.context.gl.DEPTH_COMPONENT16,d,m))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const h=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,I=0;v<this._coordsTextureSize;v++)for(let C=0;C<this._coordsTextureSize;C++,I+=4)h[I+0]=255&C,h[I+1]=255&v,h[I+2]=C>>8<<4|v>>8,h[I+3]=0;const d=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(h.buffer)),m=new Xt(o,d,o.gl.RGBA,{premultiply:!1});return m.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=m,m}pointCoordinate(o){const h=new Uint8Array(4),d=this.painter.context,m=d.gl;d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),m.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,m.RGBA,m.UNSIGNED_BYTE,h),d.bindFramebuffer.set(null);const v=h[0]+(h[2]>>4<<8),I=h[1]+((15&h[2])<<8),C=this.coordsIndex[255-h[3]],P=C&&this.sourceCache.getTileByID(C);if(!P)return null;const k=this._coordsTextureSize,R=(1<<P.tileID.canonical.z)*k;return new u.U(this._allowMercatorOverflow(o,(P.tileID.canonical.x*k+v)/R),(P.tileID.canonical.y*k+I)/R,this.getElevation(P.tileID,v,I,k))}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,h=new u.bd,d=new u.b0,m=this.meshSize,v=u.N/m,I=m*m;for(let F=0;F<=m;F++)for(let Z=0;Z<=m;Z++)h.emplaceBack(Z*v,F*v,0);for(let F=0;F<I;F+=m+1)for(let Z=0;Z<m;Z++)d.emplaceBack(Z+F,m+Z+F+1,m+Z+F+2),d.emplaceBack(Z+F,m+Z+F+2,Z+F+1);const C=h.length,P=C+2*(m+1);for(const F of[0,1])for(let Z=0;Z<=m;Z++)for(const st of[0,1])h.emplaceBack(Z*v,F*u.N,st);for(let F=0;F<2*m;F+=2)d.emplaceBack(P+F,P+F+1,P+F+3),d.emplaceBack(P+F,P+F+3,P+F+2),d.emplaceBack(C+F,C+F+3,C+F+1),d.emplaceBack(C+F,C+F+2,C+F+3);const k=h.length,R=k+2*(m+1);for(const F of[0,1])for(let Z=0;Z<=m;Z++)for(const st of[0,1])h.emplaceBack(F*u.N,Z*v,st);for(let F=0;F<2*m;F+=2)d.emplaceBack(k+F,k+F+1,k+F+3),d.emplaceBack(k+F,k+F+3,k+F+2),d.emplaceBack(R+F,R+F+3,R+F+1),d.emplaceBack(R+F,R+F+2,R+F+3);return this._mesh={indexBuffer:o.createIndexBuffer(d),vertexBuffer:o.createVertexBuffer(h,Hm.members),segments:u.S.simpleSegment(0,0,h.length,d.length)},this._mesh}getMeshFrameDelta(o){return 2*Math.PI*u.be/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,h){var d;const{tileID:m}=this._getOverscaledTileIDFromLngLatZoom(o,h);return(d=this.getMinMaxElevation(m).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(o){const h=this.getTerrainData(o).tile,d={minElevation:null,maxElevation:null};return h&&h.dem&&(d.minElevation=h.dem.min*this.exaggeration,d.maxElevation=h.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(o,h){const d=u.U.fromLngLat(o.wrap()),m=(1<<h)*u.N,v=d.x*m,I=d.y*m,C=Math.floor(v/u.N),P=Math.floor(I/u.N);return{tileID:new u.O(h,0,h,C,P),mercatorX:v,mercatorY:I}}_allowMercatorOverflow(o,h){const d=o.x<this.painter.width/2;let m=u.bf(h);const v=this.painter.transform.center.lng;return d&&Math.sign(m)>0&&Math.sign(v)<0||!d&&Math.sign(m)<0&&Math.sign(v)>0?(m=360*Math.sign(v)+m,u.G(m)):h}}class Tv{constructor(o,h,d){this._context=o,this._size=h,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const h=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new Xt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),h.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),h.colorAttachment.set(d.texture),{id:o,fbo:h,texture:d,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(h=>o.id!==h),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const h of this._recentlyUsed)if(!this._objects[h].inUse)return this._objects[h];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const is={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class If{constructor(o,h){this.painter=o,this.terrain=h,this.pool=new Tv(o.context,30,h.sourceCache.tileSize*h.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,h){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(d=>!o._layers[d].isHidden(h)),this._coordsDescendingInv={};for(const d in o.sourceCaches){this._coordsDescendingInv[d]={};const m=o.sourceCaches[d].getVisibleCoordinates();for(const v of m){const I=this.terrain.sourceCache.getTerrainCoords(v);for(const C in I)this._coordsDescendingInv[d][C]||(this._coordsDescendingInv[d][C]=[]),this._coordsDescendingInv[d][C].push(I[C])}}this._coordsDescendingInvStr={};for(const d of o._order){const m=o._layers[d],v=m.source;if(is[m.type]&&!this._coordsDescendingInvStr[v]){this._coordsDescendingInvStr[v]={};for(const I in this._coordsDescendingInv[v])this._coordsDescendingInvStr[v][I]=this._coordsDescendingInv[v][I].map(C=>C.key).sort().join()}}for(const d of this._renderableTiles)for(const m in this._coordsDescendingInvStr){const v=this._coordsDescendingInvStr[m][d.tileID.key];v&&v!==d.rttCoords[m]&&(d.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const h=o.type,d=this.painter,m=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(is[h]&&(this._prevType&&is[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(o.id),!m))return!0;if(is[this._prevType]||is[h]&&m){this._prevType=h;const v=this._stacks.length-1,I=this._stacks[v]||[];for(const C of this._renderableTiles){if(this.pool.isFull()&&(Mr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(C),C.rtt[v]){const k=this.pool.getObjectForId(C.rtt[v].id);if(k.stamp===C.rtt[v].stamp){this.pool.useObject(k);continue}}const P=this.pool.getOrCreateFreeObject();this.pool.useObject(P),this.pool.stampObject(P),C.rtt[v]={id:P.id,stamp:P.stamp},d.context.bindFramebuffer.set(P.fbo.framebuffer),d.context.clear({color:u.aT.transparent,stencil:0}),d.currentStencilSource=void 0;for(let k=0;k<I.length;k++){const R=d.style._layers[I[k]],F=R.source?this._coordsDescendingInv[R.source][C.tileID.key]:[C.tileID];d.context.viewport.set([0,0,P.fbo.width,P.fbo.height]),d._renderTileClippingMasks(R,F),d.renderLayer(d,d.style.sourceCaches[R.source],R,F),R.source&&(C.rttCoords[R.source]=this._coordsDescendingInvStr[R.source][C.tileID.key])}}return Mr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),is[h]}return!1}}const Ze=w,nn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Mp=y=>{y.touchstart=y.dragStart,y.touchmoveWindow=y.dragMove,y.touchend=y.dragEnd},tg={showCompass:!0,showZoom:!0,visualizePitch:!1};class eg{constructor(o,h,d=!1){this.mousedown=I=>{this.startMouse(u.e({},I,{ctrlKey:!0,preventDefault:()=>I.preventDefault()}),S.mousePos(this.element,I)),S.addEventListener(window,"mousemove",this.mousemove),S.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=I=>{this.moveMouse(I,S.mousePos(this.element,I))},this.mouseup=I=>{this.mouseRotate.dragEnd(I),this.mousePitch&&this.mousePitch.dragEnd(I),this.offTemp()},this.touchstart=I=>{I.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=S.touchPos(this.element,I.targetTouches)[0],this.startTouch(I,this._startPos),S.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.addEventListener(window,"touchend",this.touchend))},this.touchmove=I=>{I.targetTouches.length!==1?this.reset():(this._lastPos=S.touchPos(this.element,I.targetTouches)[0],this.moveTouch(I,this._lastPos))},this.touchend=I=>{I.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const m=o.dragRotate._mouseRotate.getClickTolerance(),v=o.dragRotate._mousePitch.getClickTolerance();this.element=h,this.mouseRotate=dl({clickTolerance:m,enable:!0}),this.touchRotate=(({enable:I,clickTolerance:C,bearingDegreesPerPixelMoved:P=.8})=>{const k=new yc;return new Fa({clickTolerance:C,move:(R,F)=>({bearingDelta:(F.x-R.x)*P}),moveStateManager:k,enable:I,assignEvents:Mp})})({clickTolerance:m,enable:!0}),this.map=o,d&&(this.mousePitch=hi({clickTolerance:v,enable:!0}),this.touchPitch=(({enable:I,clickTolerance:C,pitchDegreesPerPixelMoved:P=-.5})=>{const k=new yc;return new Fa({clickTolerance:C,move:(R,F)=>({pitchDelta:(F.y-R.y)*P}),moveStateManager:k,enable:I,assignEvents:Mp})})({clickTolerance:v,enable:!0})),S.addEventListener(h,"mousedown",this.mousedown),S.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),S.addEventListener(h,"touchcancel",this.reset)}startMouse(o,h){this.mouseRotate.dragStart(o,h),this.mousePitch&&this.mousePitch.dragStart(o,h),S.disableDrag()}startTouch(o,h){this.touchRotate.dragStart(o,h),this.touchPitch&&this.touchPitch.dragStart(o,h),S.disableDrag()}moveMouse(o,h){const d=this.map,{bearingDelta:m}=this.mouseRotate.dragMove(o,h)||{};if(m&&d.setBearing(d.getBearing()+m),this.mousePitch){const{pitchDelta:v}=this.mousePitch.dragMove(o,h)||{};v&&d.setPitch(d.getPitch()+v)}}moveTouch(o,h){const d=this.map,{bearingDelta:m}=this.touchRotate.dragMove(o,h)||{};if(m&&d.setBearing(d.getBearing()+m),this.touchPitch){const{pitchDelta:v}=this.touchPitch.dragMove(o,h)||{};v&&d.setPitch(d.getPitch()+v)}}off(){const o=this.element;S.removeEventListener(o,"mousedown",this.mousedown),S.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend),S.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){S.enableDrag(),S.removeEventListener(window,"mousemove",this.mousemove),S.removeEventListener(window,"mouseup",this.mouseup),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend)}}let bi;function ng(y,o,h){if(y=new u.L(y.lng,y.lat),o){const d=new u.L(y.lng-360,y.lat),m=new u.L(y.lng+360,y.lat),v=h.locationPoint(y).distSqr(o);h.locationPoint(d).distSqr(o)<v?y=d:h.locationPoint(m).distSqr(o)<v&&(y=m)}for(;Math.abs(y.lng-h.center.lng)>180;){const d=h.locationPoint(y);if(d.x>=0&&d.y>=0&&d.x<=h.width&&d.y<=h.height)break;y.lng>h.center.lng?y.lng-=360:y.lng+=360}return y}const ya={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Jm(y,o,h){const d=y.classList;for(const m in ya)d.remove(`maplibregl-${h}-anchor-${m}`);d.add(`maplibregl-${h}-anchor-${o}`)}class xc extends u.E{constructor(o){if(super(),this._onKeyPress=h=>{const d=h.code,m=h.charCode||h.keyCode;d!=="Space"&&d!=="Enter"&&m!==32&&m!==13||this.togglePopup()},this._onMapClick=h=>{const d=h.originalEvent.target,m=this._element;this._popup&&(d===m||m.contains(d))&&this.togglePopup()},this._update=h=>{if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((h==null?void 0:h.type)==="terrain"||(h==null?void 0:h.type)==="render"&&!d)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=ng(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),h&&h.type!=="moveend"||(this._pos=this._pos.round()),S.setTransform(this._element,`${ya[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${m}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const I=this._map.unproject(this._pos),C=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=I.distanceTo(this._lngLat)>20*C?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=h=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.k("dragstart"))),this.fire(new u.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.k("dragend")),this._state="inactive"},this._addDragHandler=h=>{this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=u.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=S.create("div"),this._element.setAttribute("aria-label","Map marker");const h=S.createNS("http://www.w3.org/2000/svg","svg"),d=41,m=27;h.setAttributeNS(null,"display","block"),h.setAttributeNS(null,"height",`${d}px`),h.setAttributeNS(null,"width",`${m}px`),h.setAttributeNS(null,"viewBox",`0 0 ${m} ${d}`);const v=S.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const I=S.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill-rule","nonzero");const C=S.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const St of P){const Ft=S.createNS("http://www.w3.org/2000/svg","ellipse");Ft.setAttributeNS(null,"opacity","0.04"),Ft.setAttributeNS(null,"cx","10.5"),Ft.setAttributeNS(null,"cy","5.80029008"),Ft.setAttributeNS(null,"rx",St.rx),Ft.setAttributeNS(null,"ry",St.ry),C.appendChild(Ft)}const k=S.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const R=S.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(R);const F=S.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const Z=S.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(Z);const st=S.createNS("http://www.w3.org/2000/svg","g");st.setAttributeNS(null,"transform","translate(6.0, 7.0)"),st.setAttributeNS(null,"fill","#FFFFFF");const ot=S.createNS("http://www.w3.org/2000/svg","g");ot.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ut=S.createNS("http://www.w3.org/2000/svg","circle");ut.setAttributeNS(null,"fill","#000000"),ut.setAttributeNS(null,"opacity","0.25"),ut.setAttributeNS(null,"cx","5.5"),ut.setAttributeNS(null,"cy","5.5"),ut.setAttributeNS(null,"r","5.4999962");const rt=S.createNS("http://www.w3.org/2000/svg","circle");rt.setAttributeNS(null,"fill","#FFFFFF"),rt.setAttributeNS(null,"cx","5.5"),rt.setAttributeNS(null,"cy","5.5"),rt.setAttributeNS(null,"r","5.4999962"),ot.appendChild(ut),ot.appendChild(rt),I.appendChild(C),I.appendChild(k),I.appendChild(F),I.appendChild(st),I.appendChild(ot),h.appendChild(I),h.setAttributeNS(null,"height",d*this._scale+"px"),h.setAttributeNS(null,"width",m*this._scale+"px"),this._element.appendChild(h),this._offset=u.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",h=>{h.preventDefault()}),this._element.addEventListener("mousedown",h=>{h.preventDefault()}),Jm(this._element,this._anchor,"marker"),o&&o.className)for(const h of o.className.split(" "))this._element.classList.add(h);this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),S.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=u.L.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const m=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(38.1-13.5+m)],"bottom-right":[-m,-1*(38.1-13.5+m)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(o){return this._offset=u.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const ti={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Zr=0,Eh=!1;const Lp={maxWidth:100,unit:"metric"};function Ap(y,o,h){const d=h&&h.maxWidth||100,m=y._container.clientHeight/2,v=y.unproject([0,m]),I=y.unproject([d,m]),C=v.distanceTo(I);if(h&&h.unit==="imperial"){const P=3.2808*C;P>5280?wc(o,d,P/5280,y._getUIString("ScaleControl.Miles")):wc(o,d,P,y._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?wc(o,d,C/1852,y._getUIString("ScaleControl.NauticalMiles")):C>=1e3?wc(o,d,C/1e3,y._getUIString("ScaleControl.Kilometers")):wc(o,d,C,y._getUIString("ScaleControl.Meters"))}function wc(y,o,h,d){const m=function(v){const I=Math.pow(10,`${Math.floor(v)}`.length-1);let C=v/I;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(P){const k=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*k)/k}(C),I*C}(h);y.style.width=o*(m/h)+"px",y.innerHTML=`${m}&nbsp;${d}`}const rg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ig=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Sh(y){if(y){if(typeof y=="number"){const o=Math.round(Math.abs(y)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,y),"top-left":new u.P(o,o),"top-right":new u.P(-o,o),bottom:new u.P(0,-y),"bottom-left":new u.P(o,-o),"bottom-right":new u.P(-o,-o),left:new u.P(y,0),right:new u.P(-y,0)}}if(y instanceof u.P||Array.isArray(y)){const o=u.P.convert(y);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:u.P.convert(y.center||[0,0]),top:u.P.convert(y.top||[0,0]),"top-left":u.P.convert(y["top-left"]||[0,0]),"top-right":u.P.convert(y["top-right"]||[0,0]),bottom:u.P.convert(y.bottom||[0,0]),"bottom-left":u.P.convert(y["bottom-left"]||[0,0]),"bottom-right":u.P.convert(y["bottom-right"]||[0,0]),left:u.P.convert(y.left||[0,0]),right:u.P.convert(y.right||[0,0])}}return Sh(new u.P(0,0))}const og={extend:(y,...o)=>u.e(y,...o),run(y){y()},logToElement(y,o=!1,h="log"){const d=window.document.getElementById(h);d&&(o&&(d.innerHTML=""),d.innerHTML+=`<br>${y}`)}},sg=w;class tr{static get version(){return sg}static get workerCount(){return $i.workerCount}static set workerCount(o){$i.workerCount=o}static get maxParallelImageRequests(){return u.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(o){u.c.MAX_PARALLEL_IMAGE_REQUESTS=o}static get workerUrl(){return u.c.WORKER_URL}static set workerUrl(o){u.c.WORKER_URL=o}static addProtocol(o,h){u.c.REGISTERED_PROTOCOLS[o]=h}static removeProtocol(o){delete u.c.REGISTERED_PROTOCOLS[o]}}return tr.Map=class extends Wm{constructor(y){if(u.bg.mark(u.bh.create),(y=u.e({},nn,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new xh(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._cooperativeGesturesOnWheel=o=>{this._onCooperativeGesture(o,o[this._metaKey],1)},this._contextLost=o=>{o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.k("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.k("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=y.interactive,this._cooperativeGestures=y.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=y.maxTileCacheSize,this._maxTileCacheZoomLevels=y.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new Sf,this._controls=[],this._mapId=u.a2(),this._locale=u.e({},Qd,y.locale),this._clickTolerance=y.clickTolerance,this._overridePixelRatio=y.pixelRatio,this._maxCanvasSize=y.maxCanvasSize,this.transformCameraUpdate=y.transformCameraUpdate,this._imageQueueHandle=pt.addThrottleControl(()=>this.isMoving()),this._requestManager=new tt(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const h=Pt(d=>{this._trackResize&&!this._removed&&this.resize(d)._update()},50);this._resizeObserver=new ResizeObserver(d=>{o?h(d):o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Jd(this,y),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=y.hash&&new Wt(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,u.e({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,this._validateStyle=y.validateStyle,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new $s({customAttribution:y.customAttribution})),y.maplibreLogo&&this.addControl(new Lr,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new u.k(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new u.k(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new u.k("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(y,o){if(o===void 0&&(o=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new u.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=y.onAdd(this);this._controls.push(y);const d=this._controlPositions[o];return o.indexOf("bottom")!==-1?d.insertBefore(h,d.firstChild):d.appendChild(h),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new u.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(y);return o>-1&&this._controls.splice(o,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,o,h,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(h,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,o,h,d)}resize(y){var o;const h=this._containerDimensions(),d=h[0],m=h[1],v=this._getClampedPixelRatio(d,m);if(this._resizeCanvas(d,m,v),this.painter.resize(d,m,v),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const P=this._getClampedPixelRatio(d,m);this._resizeCanvas(d,m,P),this.painter.resize(d,m,P)}this.transform.resize(d,m),(o=this._requestedCameraState)===null||o===void 0||o.resize(d,m);const I=!this._moving;return I&&(this.stop(),this.fire(new u.k("movestart",y)).fire(new u.k("move",y))),this.fire(new u.k("resize",y)),I&&this.fire(new u.k("moveend",y)),this}_getClampedPixelRatio(y,o){const{0:h,1:d}=this._maxCanvasSize,m=this.getPixelRatio(),v=y*m,I=o*m;return Math.min(v>h?h/v:1,I>d?d/I:1)*m}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(Ke.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(y){return this._cooperativeGestures=y,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(y){return this.transform.locationPoint(u.L.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.pointLocation(u.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,o,h){if(y==="mouseenter"||y==="mouseover"){let d=!1;return{layer:o,listener:h,delegates:{mousemove:v=>{const I=this.getLayer(o)?this.queryRenderedFeatures(v.point,{layers:[o]}):[];I.length?d||(d=!0,h.call(this,new Jn(y,this,v.originalEvent,{features:I}))):d=!1},mouseout:()=>{d=!1}}}}if(y==="mouseleave"||y==="mouseout"){let d=!1;return{layer:o,listener:h,delegates:{mousemove:I=>{(this.getLayer(o)?this.queryRenderedFeatures(I.point,{layers:[o]}):[]).length?d=!0:d&&(d=!1,h.call(this,new Jn(y,this,I.originalEvent)))},mouseout:I=>{d&&(d=!1,h.call(this,new Jn(y,this,I.originalEvent)))}}}}{const d=m=>{const v=this.getLayer(o)?this.queryRenderedFeatures(m.point,{layers:[o]}):[];v.length&&(m.features=v,h.call(this,m),delete m.features)};return{layer:o,listener:h,delegates:{[y]:d}}}}on(y,o,h){if(h===void 0)return super.on(y,o);const d=this._createDelegatedListener(y,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(d);for(const m in d.delegates)this.on(m,d.delegates[m]);return this}once(y,o,h){if(h===void 0)return super.once(y,o);const d=this._createDelegatedListener(y,o,h);for(const m in d.delegates)this.once(m,d.delegates[m]);return this}off(y,o,h){return h===void 0?super.off(y,o):(this._delegatedListeners&&this._delegatedListeners[y]&&(d=>{const m=this._delegatedListeners[y];for(let v=0;v<m.length;v++){const I=m[v];if(I.layer===o&&I.listener===h){for(const C in I.delegates)this.off(C,I.delegates[C]);return m.splice(v,1),this}}})(),this)}queryRenderedFeatures(y,o){if(!this.style)return[];let h;const d=y instanceof u.P||Array.isArray(y),m=d?y:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(d?{}:y)||{},m instanceof u.P||typeof m[0]=="number")h=[u.P.convert(m)];else{const v=u.P.convert(m[0]),I=u.P.convert(m[1]);h=[v,new u.P(I.x,v.y),I,new u.P(v.x,I.y),v]}return this.style.queryRenderedFeatures(h,o,this.transform)}querySourceFeatures(y,o){return this.style.querySourceFeatures(y,o)}setStyle(y,o){return(o=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(y,o))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const o=this._locale[y];if(o==null)throw new Error(`Missing UI string '${y}'`);return o}_updateStyle(y,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,o));const h=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new qr(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,o,h):this.style.loadJSON(y,o,h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new qr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,o){if(typeof y=="string"){const h=this._requestManager.transformRequest(y,J.Style);u.f(h,(d,m)=>{d?this.fire(new u.j(d)):m&&this._updateDiff(m,o)})}else typeof y=="object"&&this._updateDiff(y,o)}_updateDiff(y,o){try{this.style.setState(y,o)&&this._update(!0)}catch(h){u.w(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(y,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(y,o){return this._lazyInitEmptyStyle(),this.style.addSource(y,o),this._update(!0)}isSourceLoaded(y){const o=this.style&&this.style.sourceCaches[y];if(o!==void 0)return o.loaded();this.fire(new u.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const o=this.style.sourceCaches[y.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);for(const h in this.style._layers){const d=this.style._layers[h];d.type==="hillshade"&&d.source===y.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Km(this.painter,o,y),this.painter.renderToTexture=new If(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=h=>{h.dataType==="style"?this.terrain.sourceCache.freeRtt():h.dataType==="source"&&h.tile&&(h.sourceId!==y.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(h.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new u.k("terrain",{terrain:y})),this}getTerrain(){var y,o;return(o=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const o in y){const h=y[o]._tiles;for(const d in h){const m=h[d];if(m.state!=="loaded"&&m.state!=="errored")return!1}}return!0}addSourceType(y,o,h){return this._lazyInitEmptyStyle(),this.style.addSourceType(y,o,h)}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,o,h={}){const{pixelRatio:d=1,sdf:m=!1,stretchX:v,stretchY:I,content:C}=h;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||u.a(o))){if(o.width===void 0||o.height===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:P,height:k,data:R}=o,F=o;return this.style.addImage(y,{data:new u.R({width:P,height:k},new Uint8Array(R)),pixelRatio:d,stretchX:v,stretchY:I,content:C,sdf:m,version:0,userImage:F}),F.onAdd&&F.onAdd(this,y),this}}{const{width:P,height:k,data:R}=u.h.getImageData(o);this.style.addImage(y,{data:new u.R({width:P,height:k},R),pixelRatio:d,stretchX:v,stretchY:I,content:C,sdf:m,version:0})}}updateImage(y,o){const h=this.style.getImage(y);if(!h)return this.fire(new u.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=o instanceof HTMLImageElement||u.a(o)?u.h.getImageData(o):o,{width:m,height:v,data:I}=d;if(m===void 0||v===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(m!==h.data.width||v!==h.data.height)return this.fire(new u.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(o instanceof HTMLImageElement||u.a(o));return h.data.replace(I,C),this.style.updateImage(y,h),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new u.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,o){pt.getImage(this._requestManager.transformRequest(y,J.Image),o)}listImages(){return this.style.listImages()}addLayer(y,o){return this._lazyInitEmptyStyle(),this.style.addLayer(y,o),this._update(!0)}moveLayer(y,o){return this.style.moveLayer(y,o),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,o,h){return this.style.setLayerZoomRange(y,o,h),this._update(!0)}setFilter(y,o,h={}){return this.style.setFilter(y,o,h),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,o,h,d={}){return this.style.setPaintProperty(y,o,h,d),this._update(!0)}getPaintProperty(y,o){return this.style.getPaintProperty(y,o)}setLayoutProperty(y,o,h,d={}){return this.style.setLayoutProperty(y,o,h,d),this._update(!0)}getLayoutProperty(y,o){return this.style.getLayoutProperty(y,o)}setGlyphs(y,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,o,h={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,o,h,d=>{d||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,o,h=>{h||this._update(!0)}),this}setLight(y,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,o){return this.style.setFeatureState(y,o),this._update()}removeFeatureState(y,o){return this.style.removeFeatureState(y,o),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,o=0;return this._container&&(y=this._container.clientWidth||400,o=this._container.clientHeight||300),[y,o]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const o=this._canvasContainer=S.create("div","maplibregl-canvas-container",y);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=S.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const h=this._containerDimensions(),d=this._getClampedPixelRatio(h[0],h[1]);this._resizeCanvas(h[0],h[1],d);const m=this._controlContainer=S.create("div","maplibregl-control-container",y),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(I=>{v[I]=S.create("div",`maplibregl-ctrl-${I} `,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=S.create("div","maplibregl-cooperative-gesture-screen",this._container);let y=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(y=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${y}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){S.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(y,o,h){this._canvas.width=Math.floor(h*y),this._canvas.height=Math.floor(h*o),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const y={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{o={requestedAttributes:y},d&&(o.statusMessage=d.statusMessage,o.type=d.type)},{once:!0});const h=this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y);if(!h){const d="Failed to initialize WebGL";throw o?(o.message=d,new Error(JSON.stringify(o))):new Error(d)}this.painter=new fl(h,this.transform),A.testSupport(h)}_onCooperativeGesture(y,o,h){return!o&&h<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const m=this.transform.zoom,v=u.h.now();this.style.zoomHistory.update(m,v);const I=new u.a8(m,{now:v,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),C=I.crossFadingFactor();C===1&&C===this._crossFadingFactor||(h=!0,this._crossFadingFactor=C),this.style.update(I)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new u.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.bg.mark(u.bh.load),this.fire(new u.k("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,u.bg.mark(u.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),pt.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),S.remove(this._canvasContainer),S.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),u.bg.clearMetrics(),this._removed=!0,this.fire(new u.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=u.h.frame(y=>{u.bg.frame(y),this._frame=null,this._render(y)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Ze}getCameraTargetElevation(){return this.transform.elevation}},tr.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const o=this._map.getZoom(),h=o===this._map.getMaxZoom(),d=o===this._map.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,h)=>{const d=this._map._getUIString(`NavigationControl.${h}`);o.title=d,o.setAttribute("aria-label",d)},this.options=u.e({},tg,y),this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),S.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),S.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=S.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new eg(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){S.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,o){const h=S.create("button",y,this._container);return h.type="button",h.addEventListener("click",o),h}},tr.GeolocateControl=class extends u.E{constructor(y){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new u.k("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.k("geolocate",o)),this._finish()}},this._updateCamera=o=>{const h=new u.L(o.coords.longitude,o.coords.latitude),d=o.coords.accuracy,m=this._map.getBearing(),v=u.e({bearing:m},this.options.fitBoundsOptions),I=Ke.fromLngLat(h,d);this._map.fitBounds(I,v,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const h=new u.L(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Eh)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.k("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=o=>{if(this._map){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=S.create("button","maplibregl-ctrl-geolocate",this._container),S.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",o===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=S.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new xc({element:this._dotElement}),this._circleElement=S.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new xc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.k("trackuserlocationend")))})}},this.options=u.e({},ti,y)}onAdd(y){return this._map=y,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(o,h=!1){bi===void 0||h?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(d=>{bi=d.state!=="denied",o(bi)}).catch(()=>{bi=!!window.navigator.geolocation,o(bi)}):(bi=!!window.navigator.geolocation,o(bi)):o(bi)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),S.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Zr=0,Eh=!1}_isOutOfMapMaxBounds(y){const o=this._map.getMaxBounds(),h=y.coords;return o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),o=y.getSouthEast(),h=y.getNorthEast(),d=o.distanceTo(h),m=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Zr--,Eh=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Zr++,Zr>1?(y={maximumAge:6e5,timeout:0},Eh=!0):(y=this.options.positionOptions,Eh=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},tr.AttributionControl=$s,tr.LogoControl=Lr,tr.ScaleControl=class{constructor(y){this._onMove=()=>{Ap(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,Ap(this._map,this._container,this.options)},this.options=u.e({},Lp,y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){S.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},tr.FullscreenControl=class extends u.E{constructor(y={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){S.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=S.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);S.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new u.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},tr.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=y}onAdd(y){return this._map=y,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=S.create("button","maplibregl-ctrl-terrain",this._container),S.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){S.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},tr.Popup=class extends u.E{constructor(y){super(),this.remove=()=>(this._content&&S.remove(this._content),this._container&&(S.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.k("close")),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=S.create("div","maplibregl-popup",this._map.getContainer()),this._tip=S.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const I of this.options.className.split(" "))this._container.classList.add(I);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ng(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!o)return;const h=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);let d=this.options.anchor;const m=Sh(this.options.offset);if(!d){const I=this._container.offsetWidth,C=this._container.offsetHeight;let P;P=h.y+m.bottom.y<C?["top"]:h.y>this._map.transform.height-C?["bottom"]:[],h.x<I/2?P.push("left"):h.x>this._map.transform.width-I/2&&P.push("right"),d=P.length===0?"bottom":P.join("-")}const v=h.add(m[d]).round();S.setTransform(this._container,`${ya[d]} translate(${v.x}px,${v.y}px)`),Jm(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(rg),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=u.L.convert(y),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const o=document.createDocumentFragment(),h=document.createElement("body");let d;for(h.innerHTML=y;d=h.firstChild,d;)o.appendChild(d);return this.setDOMContent(o)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=S.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}_createCloseButton(){this.options.closeButton&&(this._closeButton=S.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(ig);y&&y.focus()}},tr.Marker=xc,tr.Style=qr,tr.LngLat=u.L,tr.LngLatBounds=Ke,tr.Point=u.P,tr.MercatorCoordinate=u.U,tr.Evented=u.E,tr.AJAXError=u.bi,tr.config=u.c,tr.CanvasSource=es,tr.GeoJSONSource=Dr,tr.ImageSource=Oe,tr.RasterDEMTileSource=_o,tr.RasterTileSource=Wn,tr.VectorTileSource=Xn,tr.VideoSource=bn,tr.setRTLTextPlugin=u.bj,tr.getRTLTextPluginStatus=u.bk,tr.prewarm=function(){Rs().acquire(En)},tr.clearPrewarmedResources=function(){const y=vo;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(En),vo=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},og.extend(tr,{isSafari:u.ac,getPerformanceMetrics:u.bg.getPerformanceMetrics}),tr});var f=s;return f})})(NT);var pv=NT.exports;const RT=c1(pv),_k=qM({__proto__:null,default:RT},[pv]);function vk({children:t,svg:e,...n}){const r=Ml.useRef(null),[s,c]=Ml.useState(null),[f,u]=Ml.useState();return Ml.useEffect(()=>{f&&c(t(f,e))},[e,t,f]),Ml.useEffect(()=>{const w=r.current;if(!w||w.map)return;const S=w.map=new pv.Map({container:r.current,style:"https://api.maptiler.com/maps/streets/style.json?key=3s0f8momUZpYnD6bYw8L"});u(S)},[r,s,t,e]),Io.jsx("div",{...n,className:"create-document-map",ref:r,children:s})}const xk=({contourPaths:t,width:e,height:n,baseShapePaths:r,baseShape:s})=>{const c=JSON.stringify(s.features).replaceAll('"',"'");return`
    <svg 
      viewBox="0 0 ${e} ${n}"
      xmlns="http://www.w3.org/2000/svg">
      <g id="base" data-shapes="${c}">
      ${r.join(`
`)}
      </g>
      <g id="contour">
      ${t.join(`
`)}
      </g>
    </svg>
  `};function fv(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function wk(t,e,n){n===void 0&&(n={});for(var r=0,s=t;r<s.length;r++){var c=s[r];if(c.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var f=0;f<c[c.length-1].length;f++)if(c[c.length-1][f]!==c[0][f])throw new Error("First and last Position are not equivalent.")}var u={type:"Polygon",coordinates:t};return fv(u,e,n)}function bk(t,e,n){if(n===void 0&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:t};return fv(r,e,n)}function Ek(t,e,n){n===void 0&&(n={});var r={type:"MultiLineString",coordinates:t};return fv(r,e,n)}function Sk(t,e,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:t};return fv(r,e,n)}function Ik(t){return t.type==="Feature"?t.geometry:t}function Ck(t,e,n){var r=t.length,s=td(t[0],e),c=[],f,u,w,S,A;for(n||(n=[]),f=1;f<r;f++){for(S=t[f-1],A=t[f],u=w=td(A,e);;)if(s|u){if(s&u)break;s?(S=jx(S,A,s,e),s=td(S,e)):(A=jx(S,A,u,e),u=td(A,e))}else{c.push(S),u!==w?(c.push(A),f<r-1&&(n.push(c),c=[])):f===r-1&&c.push(A);break}s=w}return c.length&&n.push(c),n}function Tk(t,e){var n,r,s,c,f,u,w;for(r=1;r<=8;r*=2){for(n=[],s=t[t.length-1],c=!(td(s,e)&r),f=0;f<t.length;f++)u=t[f],w=!(td(u,e)&r),w!==c&&n.push(jx(s,u,r,e)),w&&n.push(u),s=u,c=w;if(t=n,!t.length)break}return n}function jx(t,e,n,r){return n&8?[t[0]+(e[0]-t[0])*(r[3]-t[1])/(e[1]-t[1]),r[3]]:n&4?[t[0]+(e[0]-t[0])*(r[1]-t[1])/(e[1]-t[1]),r[1]]:n&2?[r[2],t[1]+(e[1]-t[1])*(r[2]-t[0])/(e[0]-t[0])]:n&1?[r[0],t[1]+(e[1]-t[1])*(r[0]-t[0])/(e[0]-t[0])]:null}function td(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function OT(t,e){var n=Ik(t),r=n.type,s=t.type==="Feature"?t.properties:{},c=n.coordinates;switch(r){case"LineString":case"MultiLineString":{var f=[];return r==="LineString"&&(c=[c]),c.forEach(function(u){Ck(u,e,f)}),f.length===1?bk(f[0],s):Ek(f,s)}case"Polygon":return wk(mS(c,e),s);case"MultiPolygon":return Sk(c.map(function(u){return mS(u,e)}),s);default:throw new Error("geometry "+r+" not supported")}}function mS(t,e){for(var n=[],r=0,s=t;r<s.length;r++){var c=s[r],f=Tk(c,e);f.length>0&&((f[0][0]!==f[f.length-1][0]||f[0][1]!==f[f.length-1][1])&&f.push(f[0]),f.length>=4&&n.push(f))}return n}var Pk=function(t){var e,n;if(t.hasOwnProperty("type"))return e=i_(t),n=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],e.reduce(function(r,s){return[Math.min(s[0],r[0]),Math.min(s[1],r[1]),Math.max(s[0],r[2]),Math.max(s[1],r[3])]},n)};function i_(t){var e;return t.type=="Point"?e=[t.coordinates]:t.type=="LineString"||t.type=="MultiPoint"?e=t.coordinates:t.type=="Polygon"||t.type=="MultiLineString"?e=t.coordinates.reduce(function(n,r){return n.concat(r)},[]):t.type=="MultiPolygon"?e=t.coordinates.reduce(function(n,r){return n.concat(r.reduce(function(s,c){return s.concat(c)},[]))},[]):t.type=="Feature"?e=i_(t.geometry):t.type=="GeometryCollection"?e=t.geometries.reduce(function(n,r){return n.concat(i_(r))},[]):t.type=="FeatureCollection"&&(e=t.features.reduce(function(n,r){return n.concat(i_(r))},[])),e}var o_=Object.prototype.hasOwnProperty,zT=Object.prototype.toString,yS=Object.defineProperty,_S=Object.getOwnPropertyDescriptor,vS=function(e){return typeof Array.isArray=="function"?Array.isArray(e):zT.call(e)==="[object Array]"},xS=function(e){if(!e||zT.call(e)!=="[object Object]")return!1;var n=o_.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&o_.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var s;for(s in e);return typeof s>"u"||o_.call(e,s)},wS=function(e,n){yS&&n.name==="__proto__"?yS(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},bS=function(e,n){if(n==="__proto__")if(o_.call(e,n)){if(_S)return _S(e,n).value}else return;return e[n]},Mk=function t(){var e,n,r,s,c,f,u=arguments[0],w=1,S=arguments.length,A=!1;for(typeof u=="boolean"&&(A=u,u=arguments[1]||{},w=2),(u==null||typeof u!="object"&&typeof u!="function")&&(u={});w<S;++w)if(e=arguments[w],e!=null)for(n in e)r=bS(u,n),s=bS(e,n),u!==s&&(A&&s&&(xS(s)||(c=vS(s)))?(c?(c=!1,f=r&&vS(r)?r:[]):f=r&&xS(r)?r:{},wS(u,{name:n,newValue:t(A,f,s)})):typeof s<"u"&&wS(u,{name:n,newValue:s}));return u},FT={exports:{}};(function(t){(function(){var e=["Point","LineString","Polygon"],n=["MultiPoint","MultiLineString","MultiPolygon"];function r(f){return n.indexOf(f.type)>-1?f.coordinates.map(function(u){var w={};return w.type=f.type.replace("Multi",""),w.coordinates=u,f.crs&&(w.crs=f.crs),w}):!1}function s(f){var u=f.every(function(N){return e.indexOf(N.type)>-1}),w=f[0].crs||0,S=f.every(function(N){var O=N.crs||0;return O==w});if(u&&S){var A={};return A.type="Multi"+f[0].type,A.coordinates=[],w!=0&&(A.crs=w),f.forEach(function(N){A.coordinates.push(N.coordinates)}),A}else return!1}var c={explode:r,implode:s};t.exports?t.exports=c:window&&(window.multigeojson=c)})()})(FT);var Lk=FT.exports,ow=Lk;function O_(t,e,n,r,s){var c=t.map(function(u){return s.coordinateConverter&&(u=s.coordinateConverter(u)),[(u[0]-n.x)/e,(n.y-u[1])/e]}),f=c.map(function(u){return r?u[0].toFixed(r)+","+u[1].toFixed(r):u[0]+","+u[1]});return f.join(" ")}function BT(t,e,n,r){var s=r&&r.r?r.r:1,c=r&&r.hasOwnProperty("pointAsCircle")?r.pointAsCircle:!1,f=O_([t.coordinates],e,n,r.precision,r);return c?[f]:["M"+f+" m"+-s+",0 a"+s+","+s+" 0 1,1 "+2*s+",0 a"+s+","+s+" 0 1,1 "+-2*s+",0"]}function Ak(t,e,n,r){var s=r&&r.hasOwnProperty("explode")?r.explode:!1,c=ow.explode(t).map(function(f){return BT(f,e,n,r)[0]});return s?c:[c.join(" ")]}function VT(t,e,n,r){var s=O_(t.coordinates,e,n,r.precision,r),c="M"+s;return[c]}function kk(t,e,n,r){var s=r&&r.hasOwnProperty("explode")?r.explode:!1,c=ow.explode(t).map(function(f){return VT(f,e,n,r)[0]});return s?c:[c.join(" ")]}function UT(t,e,n,r){var s,c;s=O_(t.coordinates[0],e,n,r.precision,r),t.coordinates.length>1&&(c=t.coordinates.slice(1,t.coordinates.length));var f="M"+s;if(c)for(var u=0;u<c.length;u++)f+=" M"+O_(c[u],e,n,r.precision,r);return f+="Z",[f]}function Nk(t,e,n,r){var s=r.hasOwnProperty("explode")?r.explode:!1,c=ow.explode(t).map(function(f){return UT(f,e,n,r)[0]});return s?c:[c.join(" ").replace(/Z/g,"")+"Z"]}var Dk={Point:BT,MultiPoint:Ak,LineString:VT,MultiLineString:kk,Polygon:UT,MultiPolygon:Nk},Rk=Pk,sw=Mk,qx=Dk,Vm=function(t={}){if(t.mapExtent?this.mapExtentFromGeojson=t.mapExtentFromGeojson:this.mapExtentFromGeojson=!0,t.fitTo&&!/^(width|height)$/i.test(t.fitTo))throw new Error('"fitTo" option should be "width" or "height" ');if(this.options=t,this.viewportSize=t.viewportSize||{width:256,height:256},t.coordinateCoverter&&typeof t.coordinateConverter!="function")throw new Error('"coordinateConverter" option should be function');if(console.log(t),this.coordinateConverter=t.coordinateConverter,t.mapExtent&&this.coordinateConverter){var e=this.coordinateConverter([t.mapExtent.right,t.mapExtent.top]),n=this.coordinateConverter([t.mapExtent.left,t.mapExtent.bottom]);this.mapExtent={left:n[0],bottom:n[1],right:e[0],top:e[1]}}else this.mapExtent=t.mapExtent;this.mapExtent&&(this.res=this.calResolution(this.mapExtent,this.viewportSize,this.options.fitTo))};function Ok(t,e){var n=e([t[0],t[1]]),r=e([t[2],t[3]]);return[...n,...r]}Vm.prototype.calResolution=function(t,e,n){var r=(t.right-t.left)/e.width,s=(t.top-t.bottom)/e.height;if(n){if(n.toLowerCase()==="width")return r;if(n.toLowerCase()==="height")return s;throw new Error('"fitTo" option should be "width" or "height" ')}else return Math.max(r,s)};Vm.prototype.convert=function(t,e){var n=!1;if(!this.res&&this.mapExtentFromGeojson){var n=!0,r=Rk(t);this.coordinateConverter&&(r=Ok(r,this.coordinateConverter)),this.mapExtent={left:r[0],bottom:r[1],right:r[2],top:r[3]},this.res=this.calResolution(this.mapExtent,this.viewportSize,this.options.fitTo)}var s=sw(!0,{},this.options,e||{}),c=[];if(t.type=="FeatureCollection")for(var f=0;f<t.features.length;f++)c=c.concat(this.convertFeature(t.features[f],s));else if(t.type=="Feature")c=this.convertFeature(t,s);else if(t.type=="GeometryCollection")for(var f=0;f<t.geometries.length;f++)c=c.concat(this.convertGeometry(t.geometries[f],s));else if(qx[t.type])c=this.convertGeometry(t,s);else throw new Error("Geojson type not supported.");return n&&(this.res=null,this.mapExtent=null),s.callback&&s.callback.call(this,c),c};Vm.prototype.convertFeature=function(t,e){if(!(!t&&!t.geometry)){var n=sw(!0,{},this.options,e||{});if(n.attributes&&n.attributes instanceof Array){var r=n.attributes;n.attributes=r.reduce(function(c,f){if(typeof f=="string"){var u,w=f.split(".").pop();try{u=ES(t,f)}catch{u=!1}u&&(c[w]=u)}else if(typeof f=="object"&&f.type&&f.property)if(f.type==="dynamic"){var u,w=f.key?f.key:f.property.split(".").pop();try{u=ES(t,f.property)}catch{u=!1}u&&(c[w]=u)}else f.type==="static"&&f.value&&(c[f.property]=f.value);return c},{})}else n.attributes=n.attributes||{};var s=n.attributes.id||t.id||(t.properties&&t.properties.id?t.properties.id:null);return s&&(n.attributes.id=s),this.convertGeometry(t.geometry,n)}};Vm.prototype.convertGeometry=function(t,e){if(qx[t.type]){var n=sw(!0,{},this.options,e||{}),r=n.output||"svg",s=qx[t.type].call(this,t,this.res,{x:this.mapExtent.left,y:this.mapExtent.top},n),c,f;return r.toLowerCase()=="svg"?(c=s.map(function(u){return zk(u,t.type,n.attributes,n)}),f=c.map(function(u){return Fk(u,t.type,n)}),f):s}else throw new Error("Geojson type not supported.")};function zk(t,e,n,r){var s={},c=r&&r.hasOwnProperty("pointAsCircle")?r.pointAsCircle:!1;(e=="Point"||e=="MultiPoint")&&c?(s.cx=t.split(",")[0],s.cy=t.split(",")[1],s.r=r&&r.r?r.r:"1"):(s={d:t},(e=="Polygon"||e=="MultiPolygon")&&s["fill-rule"]=="evenodd");for(var f in n)s[f]=n[f];return s}function Fk(t,e,n){var r=n&&n.hasOwnProperty("pointAsCircle")?n.pointAsCircle:!1,s="<path";(e=="Point"||e=="MultiPoint")&&r&&(s="<circle");for(var c in t)s+=" "+c+'="'+t[c]+'"';return s+="/>",s}function ES(t,e){function n(r,s,c,f){if(r.hasOwnProperty(s))return r[s];throw new Error(f.slice(0,c+1).join(".")+" is not a valid property path")}return e.split(".").reduce(n,t)}var $T={GeoJSON2SVG:Vm};function GT(t,e,n){if(t!==null)for(var r,s,c,f,u,w,S,A=0,N=0,O,j=t.type,W=j==="FeatureCollection",nt=j==="Feature",pt=W?t.features.length:1,J=0;J<pt;J++){S=W?t.features[J].geometry:nt?t.geometry:t,O=S?S.type==="GeometryCollection":!1,u=O?S.geometries.length:1;for(var tt=0;tt<u;tt++){var Q=0,_t=0;if(f=O?S.geometries[tt]:S,f!==null){w=f.coordinates;var Ot=f.type;switch(A=n&&(Ot==="Polygon"||Ot==="MultiPolygon")?1:0,Ot){case null:break;case"Point":if(e(w,N,J,Q,_t)===!1)return!1;N++,Q++;break;case"LineString":case"MultiPoint":for(r=0;r<w.length;r++){if(e(w[r],N,J,Q,_t)===!1)return!1;N++,Ot==="MultiPoint"&&Q++}Ot==="LineString"&&Q++;break;case"Polygon":case"MultiLineString":for(r=0;r<w.length;r++){for(s=0;s<w[r].length-A;s++){if(e(w[r][s],N,J,Q,_t)===!1)return!1;N++}Ot==="MultiLineString"&&Q++,Ot==="Polygon"&&_t++}Ot==="Polygon"&&Q++;break;case"MultiPolygon":for(r=0;r<w.length;r++){for(_t=0,s=0;s<w[r].length;s++){for(c=0;c<w[r][s].length-A;c++){if(e(w[r][s][c],N,J,Q,_t)===!1)return!1;N++}_t++}Q++}break;case"GeometryCollection":for(r=0;r<f.geometries.length;r++)if(GT(f.geometries[r],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function ym(t){var e=[1/0,1/0,-1/0,-1/0];return GT(t,function(n){e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])}),e}ym.default=ym;const Bk=(t,e,n,r,s)=>{const c=t.querySourceFeatures("contourSourceFeet",{sourceLayer:"contours"}),f=t.draw.getAll(),u=ym(f),w={type:"FeatureCollection",features:c.map(A=>OT(A,u))};return new $T.GeoJSON2SVG({mapExtent:s,viewportSize:{width:n,height:r},coordinateConverter:e,output:"path"}).convert(w).filter(Boolean).map(A=>`<path d="${A}" fill="none" stroke="black" />`)},Vk=(t,e,n,r,s)=>{const c=t.draw.getAll(),f=t.getBounds(),u={type:"FeatureCollection",features:c.features.map(S=>OT(S,f.toArray()))};return new $T.GeoJSON2SVG({mapExtent:s,viewportSize:{width:n,height:r},coordinateConverter:e,output:"path"}).convert(u).filter(Boolean).map(S=>`<path d="${S}" fill="none" stroke="red" />`)},Uk=t=>{const e=t.draw.getAll(),n=ym(e),r=new pv.LngLatBounds(n),s=j=>parseFloat((j-r.getWest()).toPrecision(10)),c=j=>parseFloat((j-r.getSouth()).toPrecision(10)),f=([j,W])=>[s(j),c(W)],u=t.project(r._ne),w=t.project(r._sw),S=u.x-w.x,A=(w.y-u.y)*.67,N={left:r.getWest(),right:r.getEast(),top:r.getNorth(),bottom:r.getSouth()};return xk({width:S,height:A,baseShapePaths:Vk(t,f,S,A,N),contourPaths:Bk(t,f,S,A,N),baseShape:e})};var jT={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(Bf,function(){var n=function(b,L){var X={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},ct={on:function(Et,kt,se){if(X[Et]===void 0)throw new Error("Invalid event type: "+Et);X[Et].push({selector:kt,fn:se})},render:function(Et){L.store.featureChanged(Et)}},wt=function(Et,kt){for(var se=X[Et],de=se.length;de--;){var Me=se[de];if(Me.selector(kt)){Me.fn.call(ct,kt)||L.store.render(),L.ui.updateMapClasses();break}}};return b.start.call(ct),{render:b.render,stop:function(){b.stop&&b.stop()},trash:function(){b.trash&&(b.trash(),L.store.render())},combineFeatures:function(){b.combineFeatures&&b.combineFeatures()},uncombineFeatures:function(){b.uncombineFeatures&&b.uncombineFeatures()},drag:function(Et){wt("drag",Et)},click:function(Et){wt("click",Et)},mousemove:function(Et){wt("mousemove",Et)},mousedown:function(Et){wt("mousedown",Et)},mouseup:function(Et){wt("mouseup",Et)},mouseout:function(Et){wt("mouseout",Et)},keydown:function(Et){wt("keydown",Et)},keyup:function(Et){wt("keyup",Et)},touchstart:function(Et){wt("touchstart",Et)},touchmove:function(Et){wt("touchmove",Et)},touchend:function(Et){wt("touchend",Et)},tap:function(Et){wt("tap",Et)}}};function r(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}function s(b){if(b.__esModule)return b;var L=b.default;if(typeof L=="function"){var X=function ct(){if(this instanceof ct){var wt=[null];wt.push.apply(wt,arguments);var Et=Function.bind.apply(L,wt);return new Et}return L.apply(this,arguments)};X.prototype=L.prototype}else X={};return Object.defineProperty(X,"__esModule",{value:!0}),Object.keys(b).forEach(function(ct){var wt=Object.getOwnPropertyDescriptor(b,ct);Object.defineProperty(X,ct,wt.get?wt:{enumerable:!0,get:function(){return b[ct]}})}),X}var c={},f={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},u=f;function w(b){var L=0;if(b&&b.length>0){L+=Math.abs(S(b[0]));for(var X=1;X<b.length;X++)L-=Math.abs(S(b[X]))}return L}function S(b){var L,X,ct,wt,Et,kt,se=0,de=b.length;if(de>2){for(kt=0;kt<de;kt++)kt===de-2?(ct=de-2,wt=de-1,Et=0):kt===de-1?(ct=de-1,wt=0,Et=1):(ct=kt,wt=kt+1,Et=kt+2),L=b[ct],X=b[wt],se+=(A(b[Et][0])-A(L[0]))*Math.sin(A(X[1]));se=se*u.RADIUS*u.RADIUS/2}return se}function A(b){return b*Math.PI/180}c.geometry=function b(L){var X,ct=0;switch(L.type){case"Polygon":return w(L.coordinates);case"MultiPolygon":for(X=0;X<L.coordinates.length;X++)ct+=w(L.coordinates[X]);return ct;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(X=0;X<L.geometries.length;X++)ct+=b(L.geometries[X]);return ct}},c.ring=S;var N={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},O={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},j={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},W={POLYGON:"polygon",LINE:"line_string",POINT:"point"},nt={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},pt={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},J={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},tt={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},Q={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},_t={ACTIVE:"true",INACTIVE:"false"},Ot=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],zt=-85,Rt=Object.freeze({__proto__:null,classes:N,sources:O,cursors:j,types:W,geojsonTypes:nt,modes:pt,events:J,updateActions:tt,meta:Q,activeStates:_t,interactions:Ot,LAT_MIN:-90,LAT_RENDERED_MIN:zt,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),At={Point:0,LineString:1,MultiLineString:1,Polygon:2};function Ht(b,L){var X=At[b.geometry.type]-At[L.geometry.type];return X===0&&b.geometry.type===nt.POLYGON?b.area-L.area:X}function Xt(b){return b.map(function(L){return L.geometry.type===nt.POLYGON&&(L.area=c.geometry({type:nt.FEATURE,property:{},geometry:L.geometry})),L}).sort(Ht).map(function(L){return delete L.area,L})}function De(b,L){return L===void 0&&(L=0),[[b.point.x-L,b.point.y-L],[b.point.x+L,b.point.y+L]]}function ue(b){if(this._items={},this._nums={},this._length=b?b.length:0,b)for(var L=0,X=b.length;L<X;L++)this.add(b[L]),b[L]!==void 0&&(typeof b[L]=="string"?this._items[b[L]]=L:this._nums[b[L]]=L)}ue.prototype.add=function(b){return this.has(b)||(this._length++,typeof b=="string"?this._items[b]=this._length:this._nums[b]=this._length),this},ue.prototype.delete=function(b){return this.has(b)===!1||(this._length--,delete this._items[b],delete this._nums[b]),this},ue.prototype.has=function(b){return(typeof b=="string"||typeof b=="number")&&(this._items[b]!==void 0||this._nums[b]!==void 0)},ue.prototype.values=function(){var b=this,L=[];return Object.keys(this._items).forEach(function(X){L.push({k:X,v:b._items[X]})}),Object.keys(this._nums).forEach(function(X){L.push({k:JSON.parse(X),v:b._nums[X]})}),L.sort(function(X,ct){return X.v-ct.v}).map(function(X){return X.k})},ue.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var on=[Q.FEATURE,Q.MIDPOINT,Q.VERTEX],Gt={click:function(b,L,X){return ye(b,L,X,X.options.clickBuffer)},touch:function(b,L,X){return ye(b,L,X,X.options.touchBuffer)}};function ye(b,L,X,ct){if(X.map===null)return[];var wt=b?De(b,ct):L,Et={};X.options.styles&&(Et.layers=X.options.styles.map(function(Me){return Me.id}).filter(function(Me){return X.map.getLayer(Me)!=null}));var kt=X.map.queryRenderedFeatures(wt,Et).filter(function(Me){return on.indexOf(Me.properties.meta)!==-1}),se=new ue,de=[];return kt.forEach(function(Me){var Le=Me.properties.id;se.has(Le)||(se.add(Le),de.push(Me))}),Xt(de)}function Ue(b,L){var X=Gt.click(b,null,L),ct={mouse:j.NONE};return X[0]&&(ct.mouse=X[0].properties.active===_t.ACTIVE?j.MOVE:j.POINTER,ct.feature=X[0].properties.meta),L.events.currentModeName().indexOf("draw")!==-1&&(ct.mouse=j.ADD),L.ui.queueMapClasses(ct),L.ui.updateMapClasses(),X[0]}function hn(b,L){var X=b.x-L.x,ct=b.y-L.y;return Math.sqrt(X*X+ct*ct)}function he(b,L,X){X===void 0&&(X={});var ct=X.fineTolerance!=null?X.fineTolerance:4,wt=X.grossTolerance!=null?X.grossTolerance:12,Et=X.interval!=null?X.interval:500;b.point=b.point||L.point,b.time=b.time||L.time;var kt=hn(b.point,L.point);return kt<ct||kt<wt&&L.time-b.time<Et}function Fe(b,L,X){X===void 0&&(X={});var ct=X.tolerance!=null?X.tolerance:25,wt=X.interval!=null?X.interval:250;return b.point=b.point||L.point,b.time=b.time||L.time,hn(b.point,L.point)<ct&&L.time-b.time<wt}var Qe={exports:{}},_n=Qe.exports=function(b,L){if(L||(L=16),b===void 0&&(b=128),b<=0)return"0";for(var X=Math.log(Math.pow(2,b))/Math.log(L),ct=2;X===1/0;ct*=2)X=Math.log(Math.pow(2,b/ct))/Math.log(L)*ct;var wt=X-Math.floor(X),Et="";for(ct=0;ct<Math.floor(X);ct++)Et=Math.floor(Math.random()*L).toString(L)+Et;if(wt){var kt=Math.pow(L,wt);Et=Math.floor(Math.random()*kt).toString(L)+Et}var se=parseInt(Et,L);return se!==1/0&&se>=Math.pow(2,b)?_n(b,L):Et};_n.rack=function(b,L,X){var ct=function(Et){var kt=0;do{if(kt++>10){if(!X)throw new Error("too many ID collisions, use more bits");b+=X}var se=_n(b,L)}while(Object.hasOwnProperty.call(wt,se));return wt[se]=Et,se},wt=ct.hats={};return ct.get=function(Et){return ct.hats[Et]},ct.set=function(Et,kt){return ct.hats[Et]=kt,ct},ct.bits=b||128,ct.base=L||16,ct};var mn=r(Qe.exports),Ke=function(b,L){this.ctx=b,this.properties=L.properties||{},this.coordinates=L.geometry.coordinates,this.id=L.id||mn(),this.type=L.geometry.type};Ke.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Ke.prototype.incomingCoords=function(b){this.setCoordinates(b)},Ke.prototype.setCoordinates=function(b){this.coordinates=b,this.changed()},Ke.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Ke.prototype.setProperty=function(b,L){this.properties[b]=L},Ke.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:nt.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Ke.prototype.internal=function(b){var L={id:this.id,meta:Q.FEATURE,"meta:type":this.type,active:_t.INACTIVE,mode:b};if(this.ctx.options.userProperties)for(var X in this.properties)L["user_"+X]=this.properties[X];return{type:nt.FEATURE,properties:L,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var pn=function(b,L){Ke.call(this,b,L)};(pn.prototype=Object.create(Ke.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},pn.prototype.updateCoordinate=function(b,L,X){this.coordinates=arguments.length===3?[L,X]:[b,L],this.changed()},pn.prototype.getCoordinate=function(){return this.getCoordinates()};var Xn=function(b,L){Ke.call(this,b,L)};(Xn.prototype=Object.create(Ke.prototype)).isValid=function(){return this.coordinates.length>1},Xn.prototype.addCoordinate=function(b,L,X){this.changed();var ct=parseInt(b,10);this.coordinates.splice(ct,0,[L,X])},Xn.prototype.getCoordinate=function(b){var L=parseInt(b,10);return JSON.parse(JSON.stringify(this.coordinates[L]))},Xn.prototype.removeCoordinate=function(b){this.changed(),this.coordinates.splice(parseInt(b,10),1)},Xn.prototype.updateCoordinate=function(b,L,X){var ct=parseInt(b,10);this.coordinates[ct]=[L,X],this.changed()};var Wn=function(b,L){Ke.call(this,b,L),this.coordinates=this.coordinates.map(function(X){return X.slice(0,-1)})};(Wn.prototype=Object.create(Ke.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(b){return b.length>2})},Wn.prototype.incomingCoords=function(b){this.coordinates=b.map(function(L){return L.slice(0,-1)}),this.changed()},Wn.prototype.setCoordinates=function(b){this.coordinates=b,this.changed()},Wn.prototype.addCoordinate=function(b,L,X){this.changed();var ct=b.split(".").map(function(wt){return parseInt(wt,10)});this.coordinates[ct[0]].splice(ct[1],0,[L,X])},Wn.prototype.removeCoordinate=function(b){this.changed();var L=b.split(".").map(function(ct){return parseInt(ct,10)}),X=this.coordinates[L[0]];X&&(X.splice(L[1],1),X.length<3&&this.coordinates.splice(L[0],1))},Wn.prototype.getCoordinate=function(b){var L=b.split(".").map(function(ct){return parseInt(ct,10)}),X=this.coordinates[L[0]];return JSON.parse(JSON.stringify(X[L[1]]))},Wn.prototype.getCoordinates=function(){return this.coordinates.map(function(b){return b.concat([b[0]])})},Wn.prototype.updateCoordinate=function(b,L,X){this.changed();var ct=b.split("."),wt=parseInt(ct[0],10),Et=parseInt(ct[1],10);this.coordinates[wt]===void 0&&(this.coordinates[wt]=[]),this.coordinates[wt][Et]=[L,X]};var _o={MultiPoint:pn,MultiLineString:Xn,MultiPolygon:Wn},Dr=function(b,L,X,ct,wt){var Et=X.split("."),kt=parseInt(Et[0],10),se=Et[1]?Et.slice(1).join("."):null;return b[kt][L](se,ct,wt)},Te=function(b,L){if(Ke.call(this,b,L),delete this.coordinates,this.model=_o[L.geometry.type],this.model===void 0)throw new TypeError(L.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(L.geometry.coordinates)};function Oe(b){this.map=b.map,this.drawConfig=JSON.parse(JSON.stringify(b.options||{})),this._ctx=b}(Te.prototype=Object.create(Ke.prototype))._coordinatesToFeatures=function(b){var L=this,X=this.model.bind(this);return b.map(function(ct){return new X(L.ctx,{id:mn(),type:nt.FEATURE,properties:{},geometry:{coordinates:ct,type:L.type.replace("Multi","")}})})},Te.prototype.isValid=function(){return this.features.every(function(b){return b.isValid()})},Te.prototype.setCoordinates=function(b){this.features=this._coordinatesToFeatures(b),this.changed()},Te.prototype.getCoordinate=function(b){return Dr(this.features,"getCoordinate",b)},Te.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(b){return b.type===nt.POLYGON?b.getCoordinates():b.coordinates})))},Te.prototype.updateCoordinate=function(b,L,X){Dr(this.features,"updateCoordinate",b,L,X),this.changed()},Te.prototype.addCoordinate=function(b,L,X){Dr(this.features,"addCoordinate",b,L,X),this.changed()},Te.prototype.removeCoordinate=function(b){Dr(this.features,"removeCoordinate",b),this.changed()},Te.prototype.getFeatures=function(){return this.features},Oe.prototype.setSelected=function(b){return this._ctx.store.setSelected(b)},Oe.prototype.setSelectedCoordinates=function(b){var L=this;this._ctx.store.setSelectedCoordinates(b),b.reduce(function(X,ct){return X[ct.feature_id]===void 0&&(X[ct.feature_id]=!0,L._ctx.store.get(ct.feature_id).changed()),X},{})},Oe.prototype.getSelected=function(){return this._ctx.store.getSelected()},Oe.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Oe.prototype.isSelected=function(b){return this._ctx.store.isSelected(b)},Oe.prototype.getFeature=function(b){return this._ctx.store.get(b)},Oe.prototype.select=function(b){return this._ctx.store.select(b)},Oe.prototype.deselect=function(b){return this._ctx.store.deselect(b)},Oe.prototype.deleteFeature=function(b,L){return L===void 0&&(L={}),this._ctx.store.delete(b,L)},Oe.prototype.addFeature=function(b){return this._ctx.store.add(b)},Oe.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Oe.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Oe.prototype.setActionableState=function(b){b===void 0&&(b={});var L={trash:b.trash||!1,combineFeatures:b.combineFeatures||!1,uncombineFeatures:b.uncombineFeatures||!1};return this._ctx.events.actionable(L)},Oe.prototype.changeMode=function(b,L,X){return L===void 0&&(L={}),X===void 0&&(X={}),this._ctx.events.changeMode(b,L,X)},Oe.prototype.updateUIClasses=function(b){return this._ctx.ui.queueMapClasses(b)},Oe.prototype.activateUIButton=function(b){return this._ctx.ui.setActiveButton(b)},Oe.prototype.featuresAt=function(b,L,X){if(X===void 0&&(X="click"),X!=="click"&&X!=="touch")throw new Error("invalid buffer type");return Gt[X](b,L,this._ctx)},Oe.prototype.newFeature=function(b){var L=b.geometry.type;return L===nt.POINT?new pn(this._ctx,b):L===nt.LINE_STRING?new Xn(this._ctx,b):L===nt.POLYGON?new Wn(this._ctx,b):new Te(this._ctx,b)},Oe.prototype.isInstanceOf=function(b,L){if(b===nt.POINT)return L instanceof pn;if(b===nt.LINE_STRING)return L instanceof Xn;if(b===nt.POLYGON)return L instanceof Wn;if(b==="MultiFeature")return L instanceof Te;throw new Error("Unknown feature class: "+b)},Oe.prototype.doRender=function(b){return this._ctx.store.featureChanged(b)},Oe.prototype.onSetup=function(){},Oe.prototype.onDrag=function(){},Oe.prototype.onClick=function(){},Oe.prototype.onMouseMove=function(){},Oe.prototype.onMouseDown=function(){},Oe.prototype.onMouseUp=function(){},Oe.prototype.onMouseOut=function(){},Oe.prototype.onKeyUp=function(){},Oe.prototype.onKeyDown=function(){},Oe.prototype.onTouchStart=function(){},Oe.prototype.onTouchMove=function(){},Oe.prototype.onTouchEnd=function(){},Oe.prototype.onTap=function(){},Oe.prototype.onStop=function(){},Oe.prototype.onTrash=function(){},Oe.prototype.onCombineFeature=function(){},Oe.prototype.onUncombineFeature=function(){},Oe.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var bn={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},es=Object.keys(bn);function xi(b){var L=Object.keys(b);return function(X,ct){ct===void 0&&(ct={});var wt={},Et=L.reduce(function(kt,se){return kt[se]=b[se],kt},new Oe(X));return{start:function(){var kt=this;wt=Et.onSetup(ct),es.forEach(function(se){var de,Me=bn[se],Le=function(){return!1};b[Me]&&(Le=function(){return!0}),kt.on(se,Le,(de=Me,function(Ee){return Et[de](wt,Ee)}))})},stop:function(){Et.onStop(wt)},trash:function(){Et.onTrash(wt)},combineFeatures:function(){Et.onCombineFeatures(wt)},uncombineFeatures:function(){Et.onUncombineFeatures(wt)},render:function(kt,se){Et.toDisplayFeatures(wt,kt,se)}}}}function Dn(b){return[].concat(b).filter(function(L){return L!==void 0})}function hr(){var b=this;if(!(b.ctx.map&&b.ctx.map.getSource(O.HOT)!==void 0))return de();var L=b.ctx.events.currentModeName();b.ctx.ui.queueMapClasses({mode:L});var X=[],ct=[];b.isDirty?ct=b.getAllIds():(X=b.getChangedIds().filter(function(Me){return b.get(Me)!==void 0}),ct=b.sources.hot.filter(function(Me){return Me.properties.id&&X.indexOf(Me.properties.id)===-1&&b.get(Me.properties.id)!==void 0}).map(function(Me){return Me.properties.id})),b.sources.hot=[];var wt=b.sources.cold.length;b.sources.cold=b.isDirty?[]:b.sources.cold.filter(function(Me){var Le=Me.properties.id||Me.properties.parent;return X.indexOf(Le)===-1});var Et=wt!==b.sources.cold.length||ct.length>0;function kt(Me,Le){var Ee=b.get(Me).internal(L);b.ctx.events.currentModeRender(Ee,function(un){b.sources[Le].push(un)})}if(X.forEach(function(Me){return kt(Me,"hot")}),ct.forEach(function(Me){return kt(Me,"cold")}),Et&&b.ctx.map.getSource(O.COLD).setData({type:nt.FEATURE_COLLECTION,features:b.sources.cold}),b.ctx.map.getSource(O.HOT).setData({type:nt.FEATURE_COLLECTION,features:b.sources.hot}),b._emitSelectionChange&&(b.ctx.map.fire(J.SELECTION_CHANGE,{features:b.getSelected().map(function(Me){return Me.toGeoJSON()}),points:b.getSelectedCoordinates().map(function(Me){return{type:nt.FEATURE,properties:{},geometry:{type:nt.POINT,coordinates:Me.coordinates}}})}),b._emitSelectionChange=!1),b._deletedFeaturesToEmit.length){var se=b._deletedFeaturesToEmit.map(function(Me){return Me.toGeoJSON()});b._deletedFeaturesToEmit=[],b.ctx.map.fire(J.DELETE,{features:se})}function de(){b.isDirty=!1,b.clearChangedIds()}de(),b.ctx.map.fire(J.RENDER,{})}function vn(b){var L,X=this;this._features={},this._featureIds=new ue,this._selectedFeatureIds=new ue,this._selectedCoordinates=[],this._changedFeatureIds=new ue,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=b,this.sources={hot:[],cold:[]},this.render=function(){L||(L=requestAnimationFrame(function(){L=null,hr.call(X)}))},this.isDirty=!1}function Di(b,L){var X=b._selectedCoordinates.filter(function(ct){return b._selectedFeatureIds.has(ct.feature_id)});b._selectedCoordinates.length===X.length||L.silent||(b._emitSelectionChange=!0),b._selectedCoordinates=X}vn.prototype.createRenderBatch=function(){var b=this,L=this.render,X=0;return this.render=function(){X++},function(){b.render=L,X>0&&b.render()}},vn.prototype.setDirty=function(){return this.isDirty=!0,this},vn.prototype.featureChanged=function(b){return this._changedFeatureIds.add(b),this},vn.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},vn.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},vn.prototype.getAllIds=function(){return this._featureIds.values()},vn.prototype.add=function(b){return this.featureChanged(b.id),this._features[b.id]=b,this._featureIds.add(b.id),this},vn.prototype.delete=function(b,L){var X=this;return L===void 0&&(L={}),Dn(b).forEach(function(ct){X._featureIds.has(ct)&&(X._featureIds.delete(ct),X._selectedFeatureIds.delete(ct),L.silent||X._deletedFeaturesToEmit.indexOf(X._features[ct])===-1&&X._deletedFeaturesToEmit.push(X._features[ct]),delete X._features[ct],X.isDirty=!0)}),Di(this,L),this},vn.prototype.get=function(b){return this._features[b]},vn.prototype.getAll=function(){var b=this;return Object.keys(this._features).map(function(L){return b._features[L]})},vn.prototype.select=function(b,L){var X=this;return L===void 0&&(L={}),Dn(b).forEach(function(ct){X._selectedFeatureIds.has(ct)||(X._selectedFeatureIds.add(ct),X._changedFeatureIds.add(ct),L.silent||(X._emitSelectionChange=!0))}),this},vn.prototype.deselect=function(b,L){var X=this;return L===void 0&&(L={}),Dn(b).forEach(function(ct){X._selectedFeatureIds.has(ct)&&(X._selectedFeatureIds.delete(ct),X._changedFeatureIds.add(ct),L.silent||(X._emitSelectionChange=!0))}),Di(this,L),this},vn.prototype.clearSelected=function(b){return b===void 0&&(b={}),this.deselect(this._selectedFeatureIds.values(),{silent:b.silent}),this},vn.prototype.setSelected=function(b,L){var X=this;return L===void 0&&(L={}),b=Dn(b),this.deselect(this._selectedFeatureIds.values().filter(function(ct){return b.indexOf(ct)===-1}),{silent:L.silent}),this.select(b.filter(function(ct){return!X._selectedFeatureIds.has(ct)}),{silent:L.silent}),this},vn.prototype.setSelectedCoordinates=function(b){return this._selectedCoordinates=b,this._emitSelectionChange=!0,this},vn.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},vn.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},vn.prototype.getSelected=function(){var b=this;return this._selectedFeatureIds.values().map(function(L){return b.get(L)})},vn.prototype.getSelectedCoordinates=function(){var b=this;return this._selectedCoordinates.map(function(L){return{coordinates:b.get(L.feature_id).getCoordinate(L.coord_path)}})},vn.prototype.isSelected=function(b){return this._selectedFeatureIds.has(b)},vn.prototype.setFeatureProperty=function(b,L,X){this.get(b).setProperty(L,X),this.featureChanged(b)},vn.prototype.storeMapConfig=function(){var b=this;Ot.forEach(function(L){b.ctx.map[L]&&(b._mapInitialConfig[L]=b.ctx.map[L].isEnabled())})},vn.prototype.restoreMapConfig=function(){var b=this;Object.keys(this._mapInitialConfig).forEach(function(L){b._mapInitialConfig[L]?b.ctx.map[L].enable():b.ctx.map[L].disable()})},vn.prototype.getInitialConfigValue=function(b){return this._mapInitialConfig[b]===void 0||this._mapInitialConfig[b]};var Ui=function(){for(var b=arguments,L={},X=0;X<arguments.length;X++){var ct=b[X];for(var wt in ct)ko.call(ct,wt)&&(L[wt]=ct[wt])}return L},ko=Object.prototype.hasOwnProperty,qt=r(Ui),Ri=["mode","feature","mouse"];function Rr(b){var L=null,X=null,ct={onRemove:function(){return b.map.off("load",ct.connect),clearInterval(X),ct.removeLayers(),b.store.restoreMapConfig(),b.ui.removeButtons(),b.events.removeEventListeners(),b.ui.clearMapClasses(),b.boxZoomInitial&&b.map.boxZoom.enable(),b.map=null,b.container=null,b.store=null,L&&L.parentNode&&L.parentNode.removeChild(L),L=null,this},connect:function(){b.map.off("load",ct.connect),clearInterval(X),ct.addLayers(),b.store.storeMapConfig(),b.events.addEventListeners()},onAdd:function(wt){var Et=wt.fire;return wt.fire=function(kt,se){var de=arguments;return Et.length===1&&arguments.length!==1&&(de=[qt({},{type:kt},se)]),Et.apply(wt,de)},b.map=wt,b.events=function(kt){var se=Object.keys(kt.options.modes).reduce(function(ne,$e){return ne[$e]=xi(kt.options.modes[$e]),ne},{}),de={},Me={},Le={},Ee=null,un=null;Le.drag=function(ne,$e){$e({point:ne.point,time:new Date().getTime()})?(kt.ui.queueMapClasses({mouse:j.DRAG}),un.drag(ne)):ne.originalEvent.stopPropagation()},Le.mousedrag=function(ne){Le.drag(ne,function($e){return!he(de,$e)})},Le.touchdrag=function(ne){Le.drag(ne,function($e){return!Fe(Me,$e)})},Le.mousemove=function(ne){if((ne.originalEvent.buttons!==void 0?ne.originalEvent.buttons:ne.originalEvent.which)===1)return Le.mousedrag(ne);var $e=Ue(ne,kt);ne.featureTarget=$e,un.mousemove(ne)},Le.mousedown=function(ne){de={time:new Date().getTime(),point:ne.point};var $e=Ue(ne,kt);ne.featureTarget=$e,un.mousedown(ne)},Le.mouseup=function(ne){var $e=Ue(ne,kt);ne.featureTarget=$e,he(de,{point:ne.point,time:new Date().getTime()})?un.click(ne):un.mouseup(ne)},Le.mouseout=function(ne){un.mouseout(ne)},Le.touchstart=function(ne){if(kt.options.touchEnabled){Me={time:new Date().getTime(),point:ne.point};var $e=Gt.touch(ne,null,kt)[0];ne.featureTarget=$e,un.touchstart(ne)}},Le.touchmove=function(ne){if(kt.options.touchEnabled)return un.touchmove(ne),Le.touchdrag(ne)},Le.touchend=function(ne){if(ne.originalEvent.preventDefault(),kt.options.touchEnabled){var $e=Gt.touch(ne,null,kt)[0];ne.featureTarget=$e,Fe(Me,{time:new Date().getTime(),point:ne.point})?un.tap(ne):un.touchend(ne)}};var Cr=function(ne){return!(ne===8||ne===46||ne>=48&&ne<=57)};function dn(ne,$e,Yn){Yn===void 0&&(Yn={}),un.stop();var Tr=se[ne];if(Tr===void 0)throw new Error(ne+" is not valid");Ee=ne;var zr=Tr(kt,$e);un=n(zr,kt),Yn.silent||kt.map.fire(J.MODE_CHANGE,{mode:ne}),kt.store.setDirty(),kt.store.render()}Le.keydown=function(ne){(ne.srcElement||ne.target).classList.contains("mapboxgl-canvas")&&(ne.keyCode!==8&&ne.keyCode!==46||!kt.options.controls.trash?Cr(ne.keyCode)?un.keydown(ne):ne.keyCode===49&&kt.options.controls.point?dn(pt.DRAW_POINT):ne.keyCode===50&&kt.options.controls.line_string?dn(pt.DRAW_LINE_STRING):ne.keyCode===51&&kt.options.controls.polygon&&dn(pt.DRAW_POLYGON):(ne.preventDefault(),un.trash()))},Le.keyup=function(ne){Cr(ne.keyCode)&&un.keyup(ne)},Le.zoomend=function(){kt.store.changeZoom()},Le.data=function(ne){if(ne.dataType==="style"){var $e=kt.setup,Yn=kt.map,Tr=kt.options,zr=kt.store;Tr.styles.some(function(Do){return Yn.getLayer(Do.id)})||($e.addLayers(),zr.setDirty(),zr.render())}};var Jr={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){Ee=kt.options.defaultMode,un=n(se[Ee](kt),kt)},changeMode:dn,actionable:function(ne){var $e=!1;Object.keys(ne).forEach(function(Yn){if(Jr[Yn]===void 0)throw new Error("Invalid action type");Jr[Yn]!==ne[Yn]&&($e=!0),Jr[Yn]=ne[Yn]}),$e&&kt.map.fire(J.ACTIONABLE,{actions:Jr})},currentModeName:function(){return Ee},currentModeRender:function(ne,$e){return un.render(ne,$e)},fire:function(ne,$e){Le[ne]&&Le[ne]($e)},addEventListeners:function(){kt.map.on("mousemove",Le.mousemove),kt.map.on("mousedown",Le.mousedown),kt.map.on("mouseup",Le.mouseup),kt.map.on("data",Le.data),kt.map.on("touchmove",Le.touchmove),kt.map.on("touchstart",Le.touchstart),kt.map.on("touchend",Le.touchend),kt.container.addEventListener("mouseout",Le.mouseout),kt.options.keybindings&&(kt.container.addEventListener("keydown",Le.keydown),kt.container.addEventListener("keyup",Le.keyup))},removeEventListeners:function(){kt.map.off("mousemove",Le.mousemove),kt.map.off("mousedown",Le.mousedown),kt.map.off("mouseup",Le.mouseup),kt.map.off("data",Le.data),kt.map.off("touchmove",Le.touchmove),kt.map.off("touchstart",Le.touchstart),kt.map.off("touchend",Le.touchend),kt.container.removeEventListener("mouseout",Le.mouseout),kt.options.keybindings&&(kt.container.removeEventListener("keydown",Le.keydown),kt.container.removeEventListener("keyup",Le.keyup))},trash:function(ne){un.trash(ne)},combineFeatures:function(){un.combineFeatures()},uncombineFeatures:function(){un.uncombineFeatures()},getMode:function(){return Ee}}}(b),b.ui=function(kt){var se={},de=null,Me={mode:null,feature:null,mouse:null},Le={mode:null,feature:null,mouse:null};function Ee(ne){Le=qt(Le,ne)}function un(){var ne,$e;if(kt.container){var Yn=[],Tr=[];Ri.forEach(function(zr){Le[zr]!==Me[zr]&&(Yn.push(zr+"-"+Me[zr]),Le[zr]!==null&&Tr.push(zr+"-"+Le[zr]))}),Yn.length>0&&(ne=kt.container.classList).remove.apply(ne,Yn),Tr.length>0&&($e=kt.container.classList).add.apply($e,Tr),Me=qt(Me,Le)}}function Cr(ne,$e){$e===void 0&&($e={});var Yn=document.createElement("button");return Yn.className=N.CONTROL_BUTTON+" "+$e.className,Yn.setAttribute("title",$e.title),$e.container.appendChild(Yn),Yn.addEventListener("click",function(Tr){if(Tr.preventDefault(),Tr.stopPropagation(),Tr.target===de)return dn(),void $e.onDeactivate();Jr(ne),$e.onActivate()},!0),Yn}function dn(){de&&(de.classList.remove(N.ACTIVE_BUTTON),de=null)}function Jr(ne){dn();var $e=se[ne];$e&&$e&&ne!=="trash"&&($e.classList.add(N.ACTIVE_BUTTON),de=$e)}return{setActiveButton:Jr,queueMapClasses:Ee,updateMapClasses:un,clearMapClasses:function(){Ee({mode:null,feature:null,mouse:null}),un()},addButtons:function(){var ne=kt.options.controls,$e=document.createElement("div");return $e.className=N.CONTROL_GROUP+" "+N.CONTROL_BASE,ne&&(ne[W.LINE]&&(se[W.LINE]=Cr(W.LINE,{container:$e,className:N.CONTROL_BUTTON_LINE,title:"LineString tool "+(kt.options.keybindings?"(l)":""),onActivate:function(){return kt.events.changeMode(pt.DRAW_LINE_STRING)},onDeactivate:function(){return kt.events.trash()}})),ne[W.POLYGON]&&(se[W.POLYGON]=Cr(W.POLYGON,{container:$e,className:N.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(kt.options.keybindings?"(p)":""),onActivate:function(){return kt.events.changeMode(pt.DRAW_POLYGON)},onDeactivate:function(){return kt.events.trash()}})),ne[W.POINT]&&(se[W.POINT]=Cr(W.POINT,{container:$e,className:N.CONTROL_BUTTON_POINT,title:"Marker tool "+(kt.options.keybindings?"(m)":""),onActivate:function(){return kt.events.changeMode(pt.DRAW_POINT)},onDeactivate:function(){return kt.events.trash()}})),ne.trash&&(se.trash=Cr("trash",{container:$e,className:N.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){kt.events.trash()}})),ne.combine_features&&(se.combine_features=Cr("combineFeatures",{container:$e,className:N.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){kt.events.combineFeatures()}})),ne.uncombine_features&&(se.uncombine_features=Cr("uncombineFeatures",{container:$e,className:N.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){kt.events.uncombineFeatures()}}))),$e},removeButtons:function(){Object.keys(se).forEach(function(ne){var $e=se[ne];$e.parentNode&&$e.parentNode.removeChild($e),delete se[ne]})}}}(b),b.container=wt.getContainer(),b.store=new vn(b),L=b.ui.addButtons(),b.options.boxSelect&&(b.boxZoomInitial=wt.boxZoom.isEnabled(),wt.boxZoom.disable(),wt.dragPan.disable(),wt.dragPan.enable()),wt.loaded()?ct.connect():(wt.on("load",ct.connect),X=setInterval(function(){wt.loaded()&&ct.connect()},16)),b.events.start(),L},addLayers:function(){b.map.addSource(O.COLD,{data:{type:nt.FEATURE_COLLECTION,features:[]},type:"geojson"}),b.map.addSource(O.HOT,{data:{type:nt.FEATURE_COLLECTION,features:[]},type:"geojson"}),b.options.styles.forEach(function(wt){b.map.addLayer(wt)}),b.store.setDirty(!0),b.store.render()},removeLayers:function(){b.options.styles.forEach(function(wt){b.map.getLayer(wt.id)&&b.map.removeLayer(wt.id)}),b.map.getSource(O.COLD)&&b.map.removeSource(O.COLD),b.map.getSource(O.HOT)&&b.map.removeSource(O.HOT)}};return b.setup=ct,ct}var Vn=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function En(b){return function(L){var X=L.featureTarget;return!!X&&!!X.properties&&X.properties.meta===b}}function $i(b){return!!b.originalEvent&&!!b.originalEvent.shiftKey&&b.originalEvent.button===0}function ao(b){return!!b.featureTarget&&!!b.featureTarget.properties&&b.featureTarget.properties.active===_t.ACTIVE&&b.featureTarget.properties.meta===Q.FEATURE}function vo(b){return!!b.featureTarget&&!!b.featureTarget.properties&&b.featureTarget.properties.active===_t.INACTIVE&&b.featureTarget.properties.meta===Q.FEATURE}function Rs(b){return b.featureTarget===void 0}function No(b){return!!b.featureTarget&&!!b.featureTarget.properties&&b.featureTarget.properties.meta===Q.FEATURE}function Kr(b){var L=b.featureTarget;return!!L&&!!L.properties&&L.properties.meta===Q.VERTEX}function wi(b){return!!b.originalEvent&&b.originalEvent.shiftKey===!0}function ce(b){return b.keyCode===27}function Gi(b){return b.keyCode===13}var pr=Object.freeze({__proto__:null,isOfMetaType:En,isShiftMousedown:$i,isActiveFeature:ao,isInactiveFeature:vo,noTarget:Rs,isFeature:No,isVertex:Kr,isShiftDown:wi,isEscapeKey:ce,isEnterKey:Gi,isTrue:function(){return!0}}),Os=Oi;function Oi(b,L){this.x=b,this.y=L}Oi.prototype={clone:function(){return new Oi(this.x,this.y)},add:function(b){return this.clone()._add(b)},sub:function(b){return this.clone()._sub(b)},multByPoint:function(b){return this.clone()._multByPoint(b)},divByPoint:function(b){return this.clone()._divByPoint(b)},mult:function(b){return this.clone()._mult(b)},div:function(b){return this.clone()._div(b)},rotate:function(b){return this.clone()._rotate(b)},rotateAround:function(b,L){return this.clone()._rotateAround(b,L)},matMult:function(b){return this.clone()._matMult(b)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(b){return this.x===b.x&&this.y===b.y},dist:function(b){return Math.sqrt(this.distSqr(b))},distSqr:function(b){var L=b.x-this.x,X=b.y-this.y;return L*L+X*X},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(b){return Math.atan2(this.y-b.y,this.x-b.x)},angleWith:function(b){return this.angleWithSep(b.x,b.y)},angleWithSep:function(b,L){return Math.atan2(this.x*L-this.y*b,this.x*b+this.y*L)},_matMult:function(b){var L=b[0]*this.x+b[1]*this.y,X=b[2]*this.x+b[3]*this.y;return this.x=L,this.y=X,this},_add:function(b){return this.x+=b.x,this.y+=b.y,this},_sub:function(b){return this.x-=b.x,this.y-=b.y,this},_mult:function(b){return this.x*=b,this.y*=b,this},_div:function(b){return this.x/=b,this.y/=b,this},_multByPoint:function(b){return this.x*=b.x,this.y*=b.y,this},_divByPoint:function(b){return this.x/=b.x,this.y/=b.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var b=this.y;return this.y=this.x,this.x=-b,this},_rotate:function(b){var L=Math.cos(b),X=Math.sin(b),ct=L*this.x-X*this.y,wt=X*this.x+L*this.y;return this.x=ct,this.y=wt,this},_rotateAround:function(b,L){var X=Math.cos(b),ct=Math.sin(b),wt=L.x+X*(this.x-L.x)-ct*(this.y-L.y),Et=L.y+ct*(this.x-L.x)+X*(this.y-L.y);return this.x=wt,this.y=Et,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Oi.convert=function(b){return b instanceof Oi?b:Array.isArray(b)?new Oi(b[0],b[1]):b};var pe=r(Os);function ln(b,L){var X=L.getBoundingClientRect();return new pe(b.clientX-X.left-(L.clientLeft||0),b.clientY-X.top-(L.clientTop||0))}function tn(b,L,X,ct){return{type:nt.FEATURE,properties:{meta:Q.VERTEX,parent:b,coord_path:X,active:ct?_t.ACTIVE:_t.INACTIVE},geometry:{type:nt.POINT,coordinates:L}}}function li(b,L,X){var ct=L.geometry.coordinates,wt=X.geometry.coordinates;if(ct[1]>85||ct[1]<zt||wt[1]>85||wt[1]<zt)return null;var Et={lng:(ct[0]+wt[0])/2,lat:(ct[1]+wt[1])/2};return{type:nt.FEATURE,properties:{meta:Q.MIDPOINT,parent:b,lng:Et.lng,lat:Et.lat,coord_path:X.properties.coord_path},geometry:{type:nt.POINT,coordinates:[Et.lng,Et.lat]}}}function ji(b,L,X){L===void 0&&(L={}),X===void 0&&(X=null);var ct,wt=b.geometry,Et=wt.type,kt=wt.coordinates,se=b.properties&&b.properties.id,de=[];function Me(Ee,un){var Cr="",dn=null;Ee.forEach(function(Jr,ne){var $e=un!=null?un+"."+ne:String(ne),Yn=tn(se,Jr,$e,Le($e));if(L.midpoints&&dn){var Tr=li(se,dn,Yn);Tr&&de.push(Tr)}dn=Yn;var zr=JSON.stringify(Jr);Cr!==zr&&de.push(Yn),ne===0&&(Cr=zr)})}function Le(Ee){return!!L.selectedPaths&&L.selectedPaths.indexOf(Ee)!==-1}return Et===nt.POINT?de.push(tn(se,kt,X,Le(X))):Et===nt.POLYGON?kt.forEach(function(Ee,un){Me(Ee,X!==null?X+"."+un:String(un))}):Et===nt.LINE_STRING?Me(kt,X):Et.indexOf(nt.MULTI_PREFIX)===0&&(ct=Et.replace(nt.MULTI_PREFIX,""),kt.forEach(function(Ee,un){var Cr={type:nt.FEATURE,properties:b.properties,geometry:{type:ct,coordinates:Ee}};de=de.concat(ji(Cr,L,un))})),de}var Xe={enable:function(b){setTimeout(function(){b.map&&b.map.doubleClickZoom&&b._ctx&&b._ctx.store&&b._ctx.store.getInitialConfigValue&&b._ctx.store.getInitialConfigValue("doubleClickZoom")&&b.map.doubleClickZoom.enable()},0)},disable:function(b){setTimeout(function(){b.map&&b.map.doubleClickZoom&&b.map.doubleClickZoom.disable()},0)}},qi={exports:{}},q=function(b){if(!b||!b.type)return null;var L=V[b.type];if(!L)return null;if(L==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:b}]};if(L==="feature")return{type:"FeatureCollection",features:[b]};if(L==="featurecollection")return b},V={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},G=r(q),et=Object.freeze({__proto__:null,default:function b(L){switch(L&&L.type||null){case"FeatureCollection":return L.features=L.features.reduce(function(X,ct){return X.concat(b(ct))},[]),L;case"Feature":return L.geometry?b(L.geometry).map(function(X){var ct={type:"Feature",properties:JSON.parse(JSON.stringify(L.properties)),geometry:X};return L.id!==void 0&&(ct.id=L.id),ct}):[L];case"MultiPoint":return L.coordinates.map(function(X){return{type:"Point",coordinates:X}});case"MultiPolygon":return L.coordinates.map(function(X){return{type:"Polygon",coordinates:X}});case"MultiLineString":return L.coordinates.map(function(X){return{type:"LineString",coordinates:X}});case"GeometryCollection":return L.geometries.map(b).reduce(function(X,ct){return X.concat(ct)},[]);case"Point":case"Polygon":case"LineString":return[L]}}}),at=q,lt=s(et),It=function(b){return function L(X){return Array.isArray(X)&&X.length&&typeof X[0]=="number"?[X]:X.reduce(function(ct,wt){return Array.isArray(wt)&&Array.isArray(wt[0])?ct.concat(L(wt)):(ct.push(wt),ct)},[])}(b)};lt instanceof Function||(lt=lt.default);var vt={exports:{}},dt=vt.exports=function(b){return new bt(b)};function bt(b){this.value=b}function Yt(b,L,X){var ct=[],wt=[],Et=!0;return function kt(se){var de=X?Kt(se):se,Me={},Le=!0,Ee={node:de,node_:se,path:[].concat(ct),parent:wt[wt.length-1],parents:wt,key:ct.slice(-1)[0],isRoot:ct.length===0,level:ct.length,circular:null,update:function(dn,Jr){Ee.isRoot||(Ee.parent.node[Ee.key]=dn),Ee.node=dn,Jr&&(Le=!1)},delete:function(dn){delete Ee.parent.node[Ee.key],dn&&(Le=!1)},remove:function(dn){$(Ee.parent.node)?Ee.parent.node.splice(Ee.key,1):delete Ee.parent.node[Ee.key],dn&&(Le=!1)},keys:null,before:function(dn){Me.before=dn},after:function(dn){Me.after=dn},pre:function(dn){Me.pre=dn},post:function(dn){Me.post=dn},stop:function(){Et=!1},block:function(){Le=!1}};if(!Et)return Ee;function un(){if(typeof Ee.node=="object"&&Ee.node!==null){Ee.keys&&Ee.node_===Ee.node||(Ee.keys=Jt(Ee.node)),Ee.isLeaf=Ee.keys.length==0;for(var dn=0;dn<wt.length;dn++)if(wt[dn].node_===se){Ee.circular=wt[dn];break}}else Ee.isLeaf=!0,Ee.keys=null;Ee.notLeaf=!Ee.isLeaf,Ee.notRoot=!Ee.isRoot}un();var Cr=L.call(Ee,Ee.node);return Cr!==void 0&&Ee.update&&Ee.update(Cr),Me.before&&Me.before.call(Ee,Ee.node),Le&&(typeof Ee.node!="object"||Ee.node===null||Ee.circular||(wt.push(Ee),un(),Y(Ee.keys,function(dn,Jr){ct.push(dn),Me.pre&&Me.pre.call(Ee,Ee.node[dn],dn);var ne=kt(Ee.node[dn]);X&&yt.call(Ee.node,dn)&&(Ee.node[dn]=ne.node),ne.isLast=Jr==Ee.keys.length-1,ne.isFirst=Jr==0,Me.post&&Me.post.call(Ee,ne),ct.pop()}),wt.pop()),Me.after&&Me.after.call(Ee,Ee.node)),Ee}(b).node}function Kt(b){if(typeof b=="object"&&b!==null){var L;if($(b))L=[];else if(z(b)==="[object Date]")L=new Date(b.getTime?b.getTime():b);else if(function(wt){return z(wt)==="[object RegExp]"}(b))L=new RegExp(b);else if(function(wt){return z(wt)==="[object Error]"}(b))L={message:b.message};else if(function(wt){return z(wt)==="[object Boolean]"}(b))L=new Boolean(b);else if(function(wt){return z(wt)==="[object Number]"}(b))L=new Number(b);else if(function(wt){return z(wt)==="[object String]"}(b))L=new String(b);else if(Object.create&&Object.getPrototypeOf)L=Object.create(Object.getPrototypeOf(b));else if(b.constructor===Object)L={};else{var X=b.constructor&&b.constructor.prototype||b.__proto__||{},ct=function(){};ct.prototype=X,L=new ct}return Y(Jt(b),function(wt){L[wt]=b[wt]}),L}return b}bt.prototype.get=function(b){for(var L=this.value,X=0;X<b.length;X++){var ct=b[X];if(!L||!yt.call(L,ct)){L=void 0;break}L=L[ct]}return L},bt.prototype.has=function(b){for(var L=this.value,X=0;X<b.length;X++){var ct=b[X];if(!L||!yt.call(L,ct))return!1;L=L[ct]}return!0},bt.prototype.set=function(b,L){for(var X=this.value,ct=0;ct<b.length-1;ct++){var wt=b[ct];yt.call(X,wt)||(X[wt]={}),X=X[wt]}return X[b[ct]]=L,L},bt.prototype.map=function(b){return Yt(this.value,b,!0)},bt.prototype.forEach=function(b){return this.value=Yt(this.value,b,!1),this.value},bt.prototype.reduce=function(b,L){var X=arguments.length===1,ct=X?this.value:L;return this.forEach(function(wt){this.isRoot&&X||(ct=b.call(this,ct,wt))}),ct},bt.prototype.paths=function(){var b=[];return this.forEach(function(L){b.push(this.path)}),b},bt.prototype.nodes=function(){var b=[];return this.forEach(function(L){b.push(this.node)}),b},bt.prototype.clone=function(){var b=[],L=[];return function X(ct){for(var wt=0;wt<b.length;wt++)if(b[wt]===ct)return L[wt];if(typeof ct=="object"&&ct!==null){var Et=Kt(ct);return b.push(ct),L.push(Et),Y(Jt(ct),function(kt){Et[kt]=X(ct[kt])}),b.pop(),L.pop(),Et}return ct}(this.value)};var Jt=Object.keys||function(b){var L=[];for(var X in b)L.push(X);return L};function z(b){return Object.prototype.toString.call(b)}var $=Array.isArray||function(b){return Object.prototype.toString.call(b)==="[object Array]"},Y=function(b,L){if(b.forEach)return b.forEach(L);for(var X=0;X<b.length;X++)L(b[X],X,b)};Y(Jt(bt.prototype),function(b){dt[b]=function(L){var X=[].slice.call(arguments,1),ct=new bt(L);return ct[b].apply(ct,X)}});var yt=Object.hasOwnProperty||function(b,L){return L in b},gt=vt.exports,Mt=Nt;function Nt(b){if(!(this instanceof Nt))return new Nt(b);this._bbox=b||[1/0,1/0,-1/0,-1/0],this._valid=!!b}Nt.prototype.include=function(b){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],b[0]),this._bbox[1]=Math.min(this._bbox[1],b[1]),this._bbox[2]=Math.max(this._bbox[2],b[0]),this._bbox[3]=Math.max(this._bbox[3],b[1]),this},Nt.prototype.equals=function(b){var L;return L=b instanceof Nt?b.bbox():b,this._bbox[0]==L[0]&&this._bbox[1]==L[1]&&this._bbox[2]==L[2]&&this._bbox[3]==L[3]},Nt.prototype.center=function(b){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Nt.prototype.union=function(b){var L;return this._valid=!0,L=b instanceof Nt?b.bbox():b,this._bbox[0]=Math.min(this._bbox[0],L[0]),this._bbox[1]=Math.min(this._bbox[1],L[1]),this._bbox[2]=Math.max(this._bbox[2],L[2]),this._bbox[3]=Math.max(this._bbox[3],L[3]),this},Nt.prototype.bbox=function(){return this._valid?this._bbox:null},Nt.prototype.contains=function(b){if(!b)return this._fastContains();if(!this._valid)return null;var L=b[0],X=b[1];return this._bbox[0]<=L&&this._bbox[1]<=X&&this._bbox[2]>=L&&this._bbox[3]>=X},Nt.prototype.intersect=function(b){return this._valid?(L=b instanceof Nt?b.bbox():b,!(this._bbox[0]>L[2]||this._bbox[2]<L[0]||this._bbox[3]<L[1]||this._bbox[1]>L[3])):null;var L},Nt.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var b="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",b)},Nt.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Qt=function(b){if(!b)return[];var L=lt(at(b)),X=[];return L.features.forEach(function(ct){ct.geometry&&(X=X.concat(It(ct.geometry.coordinates)))}),X},Ut=gt,ie=Mt,oe={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},ze=Object.keys(oe);function qe(b){for(var L=ie(),X=Qt(b),ct=0;ct<X.length;ct++)L.include(X[ct]);return L}qi.exports=function(b){return qe(b).bbox()},qi.exports.polygon=function(b){return qe(b).polygon()},qi.exports.bboxify=function(b){return Ut(b).map(function(L){L&&ze.some(function(X){return!!L[X]&&oe[X].indexOf(L.type)!==-1})&&(L.bbox=qe(L).bbox(),this.update(L))})};var fn=r(qi.exports),vr=-90;function Hn(b,L){var X=vr,ct=90,wt=vr,Et=90,kt=270,se=-270;b.forEach(function(Me){var Le=fn(Me),Ee=Le[1],un=Le[3],Cr=Le[0],dn=Le[2];Ee>X&&(X=Ee),un<ct&&(ct=un),un>wt&&(wt=un),Ee<Et&&(Et=Ee),Cr<kt&&(kt=Cr),dn>se&&(se=dn)});var de=L;return X+de.lat>85&&(de.lat=85-X),wt+de.lat>90&&(de.lat=90-wt),ct+de.lat<-85&&(de.lat=-85-ct),Et+de.lat<vr&&(de.lat=vr-Et),kt+de.lng<=-270&&(de.lng+=360*Math.ceil(Math.abs(de.lng)/360)),se+de.lng>=270&&(de.lng-=360*Math.ceil(Math.abs(de.lng)/360)),de}function fr(b,L){var X=Hn(b.map(function(ct){return ct.toGeoJSON()}),L);b.forEach(function(ct){var wt,Et=ct.getCoordinates(),kt=function(de){var Me={lng:de[0]+X.lng,lat:de[1]+X.lat};return[Me.lng,Me.lat]},se=function(de){return de.map(function(Me){return kt(Me)})};ct.type===nt.POINT?wt=kt(Et):ct.type===nt.LINE_STRING||ct.type===nt.MULTI_POINT?wt=Et.map(kt):ct.type===nt.POLYGON||ct.type===nt.MULTI_LINE_STRING?wt=Et.map(se):ct.type===nt.MULTI_POLYGON&&(wt=Et.map(function(de){return de.map(function(Me){return se(Me)})})),ct.incomingCoords(wt)})}var In={onSetup:function(b){var L=this,X={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:b.featureIds||[]};return this.setSelected(X.initiallySelectedFeatureIds.filter(function(ct){return L.getFeature(ct)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),X},fireUpdate:function(){this.map.fire(J.UPDATE,{action:tt.MOVE,features:this.getSelected().map(function(b){return b.toGeoJSON()})})},fireActionable:function(){var b=this,L=this.getSelected(),X=L.filter(function(se){return b.isInstanceOf("MultiFeature",se)}),ct=!1;if(L.length>1){ct=!0;var wt=L[0].type.replace("Multi","");L.forEach(function(se){se.type.replace("Multi","")!==wt&&(ct=!1)})}var Et=X.length>0,kt=L.length>0;this.setActionableState({combineFeatures:ct,uncombineFeatures:Et,trash:kt})},getUniqueIds:function(b){return b.length?b.map(function(L){return L.properties.id}).filter(function(L){return L!==void 0}).reduce(function(L,X){return L.add(X),L},new ue).values():[]},stopExtendedInteractions:function(b){b.boxSelectElement&&(b.boxSelectElement.parentNode&&b.boxSelectElement.parentNode.removeChild(b.boxSelectElement),b.boxSelectElement=null),this.map.dragPan.enable(),b.boxSelecting=!1,b.canBoxSelect=!1,b.dragMoving=!1,b.canDragMove=!1},onStop:function(){Xe.enable(this)},onMouseMove:function(b,L){return No(L)&&b.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(b),!0},onMouseOut:function(b){return!b.dragMoving||this.fireUpdate()}};In.onTap=In.onClick=function(b,L){return Rs(L)?this.clickAnywhere(b,L):En(Q.VERTEX)(L)?this.clickOnVertex(b,L):No(L)?this.clickOnFeature(b,L):void 0},In.clickAnywhere=function(b){var L=this,X=this.getSelectedIds();X.length&&(this.clearSelectedFeatures(),X.forEach(function(ct){return L.doRender(ct)})),Xe.enable(this),this.stopExtendedInteractions(b)},In.clickOnVertex=function(b,L){this.changeMode(pt.DIRECT_SELECT,{featureId:L.featureTarget.properties.parent,coordPath:L.featureTarget.properties.coord_path,startPos:L.lngLat}),this.updateUIClasses({mouse:j.MOVE})},In.startOnActiveFeature=function(b,L){this.stopExtendedInteractions(b),this.map.dragPan.disable(),this.doRender(L.featureTarget.properties.id),b.canDragMove=!0,b.dragMoveLocation=L.lngLat},In.clickOnFeature=function(b,L){var X=this;Xe.disable(this),this.stopExtendedInteractions(b);var ct=wi(L),wt=this.getSelectedIds(),Et=L.featureTarget.properties.id,kt=this.isSelected(Et);if(!ct&&kt&&this.getFeature(Et).type!==nt.POINT)return this.changeMode(pt.DIRECT_SELECT,{featureId:Et});kt&&ct?(this.deselect(Et),this.updateUIClasses({mouse:j.POINTER}),wt.length===1&&Xe.enable(this)):!kt&&ct?(this.select(Et),this.updateUIClasses({mouse:j.MOVE})):kt||ct||(wt.forEach(function(se){return X.doRender(se)}),this.setSelected(Et),this.updateUIClasses({mouse:j.MOVE})),this.doRender(Et)},In.onMouseDown=function(b,L){return ao(L)?this.startOnActiveFeature(b,L):this.drawConfig.boxSelect&&$i(L)?this.startBoxSelect(b,L):void 0},In.startBoxSelect=function(b,L){this.stopExtendedInteractions(b),this.map.dragPan.disable(),b.boxSelectStartLocation=ln(L.originalEvent,this.map.getContainer()),b.canBoxSelect=!0},In.onTouchStart=function(b,L){if(ao(L))return this.startOnActiveFeature(b,L)},In.onDrag=function(b,L){return b.canDragMove?this.dragMove(b,L):this.drawConfig.boxSelect&&b.canBoxSelect?this.whileBoxSelect(b,L):void 0},In.whileBoxSelect=function(b,L){b.boxSelecting=!0,this.updateUIClasses({mouse:j.ADD}),b.boxSelectElement||(b.boxSelectElement=document.createElement("div"),b.boxSelectElement.classList.add(N.BOX_SELECT),this.map.getContainer().appendChild(b.boxSelectElement));var X=ln(L.originalEvent,this.map.getContainer()),ct=Math.min(b.boxSelectStartLocation.x,X.x),wt=Math.max(b.boxSelectStartLocation.x,X.x),Et=Math.min(b.boxSelectStartLocation.y,X.y),kt=Math.max(b.boxSelectStartLocation.y,X.y),se="translate("+ct+"px, "+Et+"px)";b.boxSelectElement.style.transform=se,b.boxSelectElement.style.WebkitTransform=se,b.boxSelectElement.style.width=wt-ct+"px",b.boxSelectElement.style.height=kt-Et+"px"},In.dragMove=function(b,L){b.dragMoving=!0,L.originalEvent.stopPropagation();var X={lng:L.lngLat.lng-b.dragMoveLocation.lng,lat:L.lngLat.lat-b.dragMoveLocation.lat};fr(this.getSelected(),X),b.dragMoveLocation=L.lngLat},In.onTouchEnd=In.onMouseUp=function(b,L){var X=this;if(b.dragMoving)this.fireUpdate();else if(b.boxSelecting){var ct=[b.boxSelectStartLocation,ln(L.originalEvent,this.map.getContainer())],wt=this.featuresAt(null,ct,"click"),Et=this.getUniqueIds(wt).filter(function(kt){return!X.isSelected(kt)});Et.length&&(this.select(Et),Et.forEach(function(kt){return X.doRender(kt)}),this.updateUIClasses({mouse:j.MOVE}))}this.stopExtendedInteractions(b)},In.toDisplayFeatures=function(b,L,X){L.properties.active=this.isSelected(L.properties.id)?_t.ACTIVE:_t.INACTIVE,X(L),this.fireActionable(),L.properties.active===_t.ACTIVE&&L.geometry.type!==nt.POINT&&ji(L).forEach(X)},In.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},In.onCombineFeatures=function(){var b=this.getSelected();if(!(b.length===0||b.length<2)){for(var L=[],X=[],ct=b[0].type.replace("Multi",""),wt=0;wt<b.length;wt++){var Et=b[wt];if(Et.type.replace("Multi","")!==ct)return;Et.type.includes("Multi")?Et.getCoordinates().forEach(function(se){L.push(se)}):L.push(Et.getCoordinates()),X.push(Et.toGeoJSON())}if(X.length>1){var kt=this.newFeature({type:nt.FEATURE,properties:X[0].properties,geometry:{type:"Multi"+ct,coordinates:L}});this.addFeature(kt),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([kt.id]),this.map.fire(J.COMBINE_FEATURES,{createdFeatures:[kt.toGeoJSON()],deletedFeatures:X})}this.fireActionable()}},In.onUncombineFeatures=function(){var b=this,L=this.getSelected();if(L.length!==0){for(var X=[],ct=[],wt=function(kt){var se=L[kt];b.isInstanceOf("MultiFeature",se)&&(se.getFeatures().forEach(function(de){b.addFeature(de),de.properties=se.properties,X.push(de.toGeoJSON()),b.select([de.id])}),b.deleteFeature(se.id,{silent:!0}),ct.push(se.toGeoJSON()))},Et=0;Et<L.length;Et++)wt(Et);X.length>1&&this.map.fire(J.UNCOMBINE_FEATURES,{createdFeatures:X,deletedFeatures:ct}),this.fireActionable()}};var Sn=En(Q.VERTEX),Or=En(Q.MIDPOINT),nr={fireUpdate:function(){this.map.fire(J.UPDATE,{action:tt.CHANGE_COORDINATES,features:this.getSelected().map(function(b){return b.toGeoJSON()})})},fireActionable:function(b){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:b.selectedCoordPaths.length>0})},startDragging:function(b,L){this.map.dragPan.disable(),b.canDragMove=!0,b.dragMoveLocation=L.lngLat},stopDragging:function(b){this.map.dragPan.enable(),b.dragMoving=!1,b.canDragMove=!1,b.dragMoveLocation=null},onVertex:function(b,L){this.startDragging(b,L);var X=L.featureTarget.properties,ct=b.selectedCoordPaths.indexOf(X.coord_path);wi(L)||ct!==-1?wi(L)&&ct===-1&&b.selectedCoordPaths.push(X.coord_path):b.selectedCoordPaths=[X.coord_path];var wt=this.pathsToCoordinates(b.featureId,b.selectedCoordPaths);this.setSelectedCoordinates(wt)},onMidpoint:function(b,L){this.startDragging(b,L);var X=L.featureTarget.properties;b.feature.addCoordinate(X.coord_path,X.lng,X.lat),this.fireUpdate(),b.selectedCoordPaths=[X.coord_path]},pathsToCoordinates:function(b,L){return L.map(function(X){return{feature_id:b,coord_path:X}})},onFeature:function(b,L){b.selectedCoordPaths.length===0?this.startDragging(b,L):this.stopDragging(b)},dragFeature:function(b,L,X){fr(this.getSelected(),X),b.dragMoveLocation=L.lngLat},dragVertex:function(b,L,X){for(var ct=b.selectedCoordPaths.map(function(se){return b.feature.getCoordinate(se)}),wt=Hn(ct.map(function(se){return{type:nt.FEATURE,properties:{},geometry:{type:nt.POINT,coordinates:se}}}),X),Et=0;Et<ct.length;Et++){var kt=ct[Et];b.feature.updateCoordinate(b.selectedCoordPaths[Et],kt[0]+wt.lng,kt[1]+wt.lat)}},clickNoTarget:function(){this.changeMode(pt.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(pt.SIMPLE_SELECT)},clickActiveFeature:function(b){b.selectedCoordPaths=[],this.clearSelectedCoordinates(),b.feature.changed()},onSetup:function(b){var L=b.featureId,X=this.getFeature(L);if(!X)throw new Error("You must provide a featureId to enter direct_select mode");if(X.type===nt.POINT)throw new TypeError("direct_select mode doesn't handle point features");var ct={featureId:L,feature:X,dragMoveLocation:b.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:b.coordPath?[b.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(L,ct.selectedCoordPaths)),this.setSelected(L),Xe.disable(this),this.setActionableState({trash:!0}),ct},onStop:function(){Xe.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(b,L,X){b.featureId===L.properties.id?(L.properties.active=_t.ACTIVE,X(L),ji(L,{map:this.map,midpoints:!0,selectedPaths:b.selectedCoordPaths}).forEach(X)):(L.properties.active=_t.INACTIVE,X(L)),this.fireActionable(b)},onTrash:function(b){b.selectedCoordPaths.sort(function(L,X){return X.localeCompare(L,"en",{numeric:!0})}).forEach(function(L){return b.feature.removeCoordinate(L)}),this.fireUpdate(),b.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(b),b.feature.isValid()===!1&&(this.deleteFeature([b.featureId]),this.changeMode(pt.SIMPLE_SELECT,{}))},onMouseMove:function(b,L){var X=ao(L),ct=Sn(L),wt=Or(L),Et=b.selectedCoordPaths.length===0;return X&&Et||ct&&!Et?this.updateUIClasses({mouse:j.MOVE}):this.updateUIClasses({mouse:j.NONE}),(ct||X||wt)&&b.dragMoving&&this.fireUpdate(),this.stopDragging(b),!0},onMouseOut:function(b){return b.dragMoving&&this.fireUpdate(),!0}};nr.onTouchStart=nr.onMouseDown=function(b,L){return Sn(L)?this.onVertex(b,L):ao(L)?this.onFeature(b,L):Or(L)?this.onMidpoint(b,L):void 0},nr.onDrag=function(b,L){if(b.canDragMove===!0){b.dragMoving=!0,L.originalEvent.stopPropagation();var X={lng:L.lngLat.lng-b.dragMoveLocation.lng,lat:L.lngLat.lat-b.dragMoveLocation.lat};b.selectedCoordPaths.length>0?this.dragVertex(b,L,X):this.dragFeature(b,L,X),b.dragMoveLocation=L.lngLat}},nr.onClick=function(b,L){return Rs(L)?this.clickNoTarget(b,L):ao(L)?this.clickActiveFeature(b,L):vo(L)?this.clickInactive(b,L):void this.stopDragging(b)},nr.onTap=function(b,L){return Rs(L)?this.clickNoTarget(b,L):ao(L)?this.clickActiveFeature(b,L):vo(L)?this.clickInactive(b,L):void 0},nr.onTouchEnd=nr.onMouseUp=function(b){b.dragMoving&&this.fireUpdate(),this.stopDragging(b)};var Fn={};function ui(b,L){return!!b.lngLat&&b.lngLat.lng===L[0]&&b.lngLat.lat===L[1]}Fn.onSetup=function(){var b=this.newFeature({type:nt.FEATURE,properties:{},geometry:{type:nt.POINT,coordinates:[]}});return this.addFeature(b),this.clearSelectedFeatures(),this.updateUIClasses({mouse:j.ADD}),this.activateUIButton(W.POINT),this.setActionableState({trash:!0}),{point:b}},Fn.stopDrawingAndRemove=function(b){this.deleteFeature([b.point.id],{silent:!0}),this.changeMode(pt.SIMPLE_SELECT)},Fn.onTap=Fn.onClick=function(b,L){this.updateUIClasses({mouse:j.MOVE}),b.point.updateCoordinate("",L.lngLat.lng,L.lngLat.lat),this.map.fire(J.CREATE,{features:[b.point.toGeoJSON()]}),this.changeMode(pt.SIMPLE_SELECT,{featureIds:[b.point.id]})},Fn.onStop=function(b){this.activateUIButton(),b.point.getCoordinate().length||this.deleteFeature([b.point.id],{silent:!0})},Fn.toDisplayFeatures=function(b,L,X){var ct=L.properties.id===b.point.id;if(L.properties.active=ct?_t.ACTIVE:_t.INACTIVE,!ct)return X(L)},Fn.onTrash=Fn.stopDrawingAndRemove,Fn.onKeyUp=function(b,L){if(ce(L)||Gi(L))return this.stopDrawingAndRemove(b,L)};var dr={onSetup:function(){var b=this.newFeature({type:nt.FEATURE,properties:{},geometry:{type:nt.POLYGON,coordinates:[[]]}});return this.addFeature(b),this.clearSelectedFeatures(),Xe.disable(this),this.updateUIClasses({mouse:j.ADD}),this.activateUIButton(W.POLYGON),this.setActionableState({trash:!0}),{polygon:b,currentVertexPosition:0}},clickAnywhere:function(b,L){if(b.currentVertexPosition>0&&ui(L,b.polygon.coordinates[0][b.currentVertexPosition-1]))return this.changeMode(pt.SIMPLE_SELECT,{featureIds:[b.polygon.id]});this.updateUIClasses({mouse:j.ADD}),b.polygon.updateCoordinate("0."+b.currentVertexPosition,L.lngLat.lng,L.lngLat.lat),b.currentVertexPosition++,b.polygon.updateCoordinate("0."+b.currentVertexPosition,L.lngLat.lng,L.lngLat.lat)},clickOnVertex:function(b){return this.changeMode(pt.SIMPLE_SELECT,{featureIds:[b.polygon.id]})},onMouseMove:function(b,L){b.polygon.updateCoordinate("0."+b.currentVertexPosition,L.lngLat.lng,L.lngLat.lat),Kr(L)&&this.updateUIClasses({mouse:j.POINTER})}};dr.onTap=dr.onClick=function(b,L){return Kr(L)?this.clickOnVertex(b,L):this.clickAnywhere(b,L)},dr.onKeyUp=function(b,L){ce(L)?(this.deleteFeature([b.polygon.id],{silent:!0}),this.changeMode(pt.SIMPLE_SELECT)):Gi(L)&&this.changeMode(pt.SIMPLE_SELECT,{featureIds:[b.polygon.id]})},dr.onStop=function(b){this.updateUIClasses({mouse:j.NONE}),Xe.enable(this),this.activateUIButton(),this.getFeature(b.polygon.id)!==void 0&&(b.polygon.removeCoordinate("0."+b.currentVertexPosition),b.polygon.isValid()?this.map.fire(J.CREATE,{features:[b.polygon.toGeoJSON()]}):(this.deleteFeature([b.polygon.id],{silent:!0}),this.changeMode(pt.SIMPLE_SELECT,{},{silent:!0})))},dr.toDisplayFeatures=function(b,L,X){var ct=L.properties.id===b.polygon.id;if(L.properties.active=ct?_t.ACTIVE:_t.INACTIVE,!ct)return X(L);if(L.geometry.coordinates.length!==0){var wt=L.geometry.coordinates[0].length;if(!(wt<3)){if(L.properties.meta=Q.FEATURE,X(tn(b.polygon.id,L.geometry.coordinates[0][0],"0.0",!1)),wt>3){var Et=L.geometry.coordinates[0].length-3;X(tn(b.polygon.id,L.geometry.coordinates[0][Et],"0."+Et,!1))}if(wt<=4){var kt=[[L.geometry.coordinates[0][0][0],L.geometry.coordinates[0][0][1]],[L.geometry.coordinates[0][1][0],L.geometry.coordinates[0][1][1]]];if(X({type:nt.FEATURE,properties:L.properties,geometry:{coordinates:kt,type:nt.LINE_STRING}}),wt===3)return}return X(L)}}},dr.onTrash=function(b){this.deleteFeature([b.polygon.id],{silent:!0}),this.changeMode(pt.SIMPLE_SELECT)};var jr={onSetup:function(b){var L,X,ct=(b=b||{}).featureId,wt="forward";if(ct){if(!(L=this.getFeature(ct)))throw new Error("Could not find a feature with the provided featureId");var Et=b.from;if(Et&&Et.type==="Feature"&&Et.geometry&&Et.geometry.type==="Point"&&(Et=Et.geometry),Et&&Et.type==="Point"&&Et.coordinates&&Et.coordinates.length===2&&(Et=Et.coordinates),!Et||!Array.isArray(Et))throw new Error("Please use the `from` property to indicate which point to continue the line from");var kt=L.coordinates.length-1;if(L.coordinates[kt][0]===Et[0]&&L.coordinates[kt][1]===Et[1])X=kt+1,L.addCoordinate.apply(L,[X].concat(L.coordinates[kt]));else{if(L.coordinates[0][0]!==Et[0]||L.coordinates[0][1]!==Et[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");wt="backwards",X=0,L.addCoordinate.apply(L,[X].concat(L.coordinates[0]))}}else L=this.newFeature({type:nt.FEATURE,properties:{},geometry:{type:nt.LINE_STRING,coordinates:[]}}),X=0,this.addFeature(L);return this.clearSelectedFeatures(),Xe.disable(this),this.updateUIClasses({mouse:j.ADD}),this.activateUIButton(W.LINE),this.setActionableState({trash:!0}),{line:L,currentVertexPosition:X,direction:wt}},clickAnywhere:function(b,L){if(b.currentVertexPosition>0&&ui(L,b.line.coordinates[b.currentVertexPosition-1])||b.direction==="backwards"&&ui(L,b.line.coordinates[b.currentVertexPosition+1]))return this.changeMode(pt.SIMPLE_SELECT,{featureIds:[b.line.id]});this.updateUIClasses({mouse:j.ADD}),b.line.updateCoordinate(b.currentVertexPosition,L.lngLat.lng,L.lngLat.lat),b.direction==="forward"?(b.currentVertexPosition++,b.line.updateCoordinate(b.currentVertexPosition,L.lngLat.lng,L.lngLat.lat)):b.line.addCoordinate(0,L.lngLat.lng,L.lngLat.lat)},clickOnVertex:function(b){return this.changeMode(pt.SIMPLE_SELECT,{featureIds:[b.line.id]})},onMouseMove:function(b,L){b.line.updateCoordinate(b.currentVertexPosition,L.lngLat.lng,L.lngLat.lat),Kr(L)&&this.updateUIClasses({mouse:j.POINTER})}};jr.onTap=jr.onClick=function(b,L){if(Kr(L))return this.clickOnVertex(b,L);this.clickAnywhere(b,L)},jr.onKeyUp=function(b,L){Gi(L)?this.changeMode(pt.SIMPLE_SELECT,{featureIds:[b.line.id]}):ce(L)&&(this.deleteFeature([b.line.id],{silent:!0}),this.changeMode(pt.SIMPLE_SELECT))},jr.onStop=function(b){Xe.enable(this),this.activateUIButton(),this.getFeature(b.line.id)!==void 0&&(b.line.removeCoordinate(""+b.currentVertexPosition),b.line.isValid()?this.map.fire(J.CREATE,{features:[b.line.toGeoJSON()]}):(this.deleteFeature([b.line.id],{silent:!0}),this.changeMode(pt.SIMPLE_SELECT,{},{silent:!0})))},jr.onTrash=function(b){this.deleteFeature([b.line.id],{silent:!0}),this.changeMode(pt.SIMPLE_SELECT)},jr.toDisplayFeatures=function(b,L,X){var ct=L.properties.id===b.line.id;if(L.properties.active=ct?_t.ACTIVE:_t.INACTIVE,!ct)return X(L);L.geometry.coordinates.length<2||(L.properties.meta=Q.FEATURE,X(tn(b.line.id,L.geometry.coordinates[b.direction==="forward"?L.geometry.coordinates.length-2:1],""+(b.direction==="forward"?L.geometry.coordinates.length-2:1),!1)),X(L))};var qr={simple_select:In,direct_select:nr,draw_point:Fn,draw_polygon:dr,draw_line_string:jr},Da={defaultMode:pt.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Vn,modes:qr,controls:{},userProperties:!1},la={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},ir={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function xn(b,L){return b.map(function(X){return X.source?X:qt(X,{id:X.id+"."+L,source:L==="hot"?O.HOT:O.COLD})})}var Zi={exports:{}};(function(b,L){var X="__lodash_hash_undefined__",ct=9007199254740991,wt="[object Arguments]",Et="[object Array]",kt="[object Boolean]",se="[object Date]",de="[object Error]",Me="[object Function]",Le="[object Map]",Ee="[object Number]",un="[object Object]",Cr="[object Promise]",dn="[object RegExp]",Jr="[object Set]",ne="[object String]",$e="[object Symbol]",Yn="[object WeakMap]",Tr="[object ArrayBuffer]",zr="[object DataView]",Do=/^\[object .+?Constructor\]$/,eh=/^(?:0|[1-9]\d*)$/,lr={};lr["[object Float32Array]"]=lr["[object Float64Array]"]=lr["[object Int8Array]"]=lr["[object Int16Array]"]=lr["[object Int32Array]"]=lr["[object Uint8Array]"]=lr["[object Uint8ClampedArray]"]=lr["[object Uint16Array]"]=lr["[object Uint32Array]"]=!0,lr[wt]=lr[Et]=lr[Tr]=lr[kt]=lr[zr]=lr[se]=lr[de]=lr[Me]=lr[Le]=lr[Ee]=lr[un]=lr[dn]=lr[Jr]=lr[ne]=lr[Yn]=!1;var Pu=typeof Bf=="object"&&Bf&&Bf.Object===Object&&Bf,nh=typeof self=="object"&&self&&self.Object===Object&&self,Ro=Pu||nh||Function("return this")(),Ra=L&&!L.nodeType&&L,Mn=Ra&&b&&!b.nodeType&&b,lc=Mn&&Mn.exports===Ra,xo=lc&&Pu.process,Oo=function(){try{return xo&&xo.binding&&xo.binding("util")}catch{}}(),rh=Oo&&Oo.isTypedArray;function ih(Pt,Wt){for(var Se=-1,en=Pt==null?0:Pt.length;++Se<en;)if(Wt(Pt[Se],Se,Pt))return!0;return!1}function oh(Pt){var Wt=-1,Se=Array(Pt.size);return Pt.forEach(function(en,wr){Se[++Wt]=[wr,en]}),Se}function wp(Pt){var Wt=-1,Se=Array(Pt.size);return Pt.forEach(function(en){Se[++Wt]=en}),Se}var sh,uc,ah,bp=Array.prototype,lh=Function.prototype,cc=Object.prototype,uh=Ro["__core-js_shared__"],Yl=lh.toString,ha=cc.hasOwnProperty,yf=(sh=/[^.]+$/.exec(uh&&uh.keys&&uh.keys.IE_PROTO||""))?"Symbol(src)_1."+sh:"",_f=cc.toString,qd=RegExp("^"+Yl.call(ha).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vf=lc?Ro.Buffer:void 0,ch=Ro.Symbol,hh=Ro.Uint8Array,hc=cc.propertyIsEnumerable,Ep=bp.splice,Oa=ch?ch.toStringTag:void 0,Kl=Object.getOwnPropertySymbols,xf=vf?vf.isBuffer:void 0,wf=(uc=Object.keys,ah=Object,function(Pt){return uc(ah(Pt))}),pc=Jl(Ro,"DataView"),Fs=Jl(Ro,"Map"),ph=Jl(Ro,"Promise"),pa=Jl(Ro,"Set"),ll=Jl(Ro,"WeakMap"),Mu=Jl(Object,"create"),Sp=pl(pc),Un=pl(Fs),Pr=pl(ph),Zd=pl(pa),An=pl(ll),ul=ch?ch.prototype:void 0,xr=ul?ul.valueOf:void 0;function Kn(Pt){var Wt=-1,Se=Pt==null?0:Pt.length;for(this.clear();++Wt<Se;){var en=Pt[Wt];this.set(en[0],en[1])}}function ns(Pt){var Wt=-1,Se=Pt==null?0:Pt.length;for(this.clear();++Wt<Se;){var en=Pt[Wt];this.set(en[0],en[1])}}function cl(Pt){var Wt=-1,Se=Pt==null?0:Pt.length;for(this.clear();++Wt<Se;){var en=Pt[Wt];this.set(en[0],en[1])}}function Lu(Pt){var Wt=-1,Se=Pt==null?0:Pt.length;for(this.__data__=new cl;++Wt<Se;)this.add(Pt[Wt])}function Bs(Pt){var Wt=this.__data__=new ns(Pt);this.size=Wt.size}function fh(Pt,Wt){var Se=Ql(Pt),en=!Se&&_h(Pt),wr=!Se&&!en&&vh(Pt),Rn=!Se&&!en&&!wr&&Du(Pt),Fr=Se||en||wr||Rn,Qr=Fr?function(Jn,zo){for(var ga=-1,lo=Array(Jn);++ga<Jn;)lo[ga]=zo(ga);return lo}(Pt.length,String):[],ci=Qr.length;for(var Br in Pt)!Wt&&!ha.call(Pt,Br)||Fr&&(Br=="length"||wr&&(Br=="offset"||Br=="parent")||Rn&&(Br=="buffer"||Br=="byteLength"||Br=="byteOffset")||Ef(Br,ci))||Qr.push(Br);return Qr}function Au(Pt,Wt){for(var Se=Pt.length;Se--;)if(Nu(Pt[Se][0],Wt))return Se;return-1}function hl(Pt){return Pt==null?Pt===void 0?"[object Undefined]":"[object Null]":Oa&&Oa in Object(Pt)?function(Wt){var Se=ha.call(Wt,Oa),en=Wt[Oa];try{Wt[Oa]=void 0;var wr=!0}catch{}var Rn=_f.call(Wt);return wr&&(Se?Wt[Oa]=en:delete Wt[Oa]),Rn}(Pt):function(Wt){return _f.call(Wt)}(Pt)}function dh(Pt){return da(Pt)&&hl(Pt)==wt}function ku(Pt,Wt,Se,en,wr){return Pt===Wt||(Pt==null||Wt==null||!da(Pt)&&!da(Wt)?Pt!=Pt&&Wt!=Wt:function(Rn,Fr,Qr,ci,Br,Jn){var zo=Ql(Rn),ga=Ql(Fr),lo=zo?Et:fa(Rn),ma=ga?Et:fa(Fr),Fo=(lo=lo==wt?un:lo)==un,gc=(ma=ma==wt?un:ma)==un,Xi=lo==ma;if(Xi&&vh(Rn)){if(!vh(Fr))return!1;zo=!0,Fo=!1}if(Xi&&!Fo)return Jn||(Jn=new Bs),zo||Du(Rn)?bf(Rn,Fr,Qr,ci,Br,Jn):function(gr,Qn,yc,Vs,dl,hi,Pe){switch(yc){case zr:if(gr.byteLength!=Qn.byteLength||gr.byteOffset!=Qn.byteOffset)return!1;gr=gr.buffer,Qn=Qn.buffer;case Tr:return!(gr.byteLength!=Qn.byteLength||!hi(new hh(gr),new hh(Qn)));case kt:case se:case Ee:return Nu(+gr,+Qn);case de:return gr.name==Qn.name&&gr.message==Qn.message;case dn:case ne:return gr==Qn+"";case Le:var Us=oh;case Jr:var _s=1&Vs;if(Us||(Us=wp),gr.size!=Qn.size&&!_s)return!1;var Ba=Pe.get(gr);if(Ba)return Ba==Qn;Vs|=2,Pe.set(gr,Qn);var tu=bf(Us(gr),Us(Qn),Vs,dl,hi,Pe);return Pe.delete(gr),tu;case $e:if(xr)return xr.call(gr)==xr.call(Qn)}return!1}(Rn,Fr,lo,Qr,ci,Br,Jn);if(!(1&Qr)){var rs=Fo&&ha.call(Rn,"__wrapped__"),mc=gc&&ha.call(Fr,"__wrapped__");if(rs||mc){var za=rs?Rn.value():Rn,Fa=mc?Fr.value():Fr;return Jn||(Jn=new Bs),Br(za,Fa,Qr,ci,Jn)}}return Xi?(Jn||(Jn=new Bs),function(gr,Qn,yc,Vs,dl,hi){var Pe=1&yc,Us=gh(gr),_s=Us.length,Ba=gh(Qn).length;if(_s!=Ba&&!Pe)return!1;for(var tu=_s;tu--;){var xe=Us[tu];if(!(Pe?xe in Qn:ha.call(Qn,xe)))return!1}var wh=hi.get(gr);if(wh&&hi.get(Qn))return wh==Qn;var Ru=!0;hi.set(gr,Qn),hi.set(Qn,gr);for(var Ip=Pe;++tu<_s;){var Ou=gr[xe=Us[tu]],_c=Qn[xe];if(Vs)var Cp=Pe?Vs(_c,Ou,xe,Qn,gr,hi):Vs(Ou,_c,xe,gr,Qn,hi);if(!(Cp===void 0?Ou===_c||dl(Ou,_c,yc,Vs,hi):Cp)){Ru=!1;break}Ip||(Ip=xe=="constructor")}if(Ru&&!Ip){var vc=gr.constructor,bh=Qn.constructor;vc==bh||!("constructor"in gr)||!("constructor"in Qn)||typeof vc=="function"&&vc instanceof vc&&typeof bh=="function"&&bh instanceof bh||(Ru=!1)}return hi.delete(gr),hi.delete(Qn),Ru}(Rn,Fr,Qr,ci,Br,Jn)):!1}(Pt,Wt,Se,en,ku,wr))}function fc(Pt){return!(!wo(Pt)||function(Wt){return!!yf&&yf in Wt}(Pt))&&(Mr(Pt)?qd:Do).test(pl(Pt))}function dc(Pt){if(Se=(Wt=Pt)&&Wt.constructor,en=typeof Se=="function"&&Se.prototype||cc,Wt!==en)return wf(Pt);var Wt,Se,en,wr=[];for(var Rn in Object(Pt))ha.call(Pt,Rn)&&Rn!="constructor"&&wr.push(Rn);return wr}function bf(Pt,Wt,Se,en,wr,Rn){var Fr=1&Se,Qr=Pt.length,ci=Wt.length;if(Qr!=ci&&!(Fr&&ci>Qr))return!1;var Br=Rn.get(Pt);if(Br&&Rn.get(Wt))return Br==Wt;var Jn=-1,zo=!0,ga=2&Se?new Lu:void 0;for(Rn.set(Pt,Wt),Rn.set(Wt,Pt);++Jn<Qr;){var lo=Pt[Jn],ma=Wt[Jn];if(en)var Fo=Fr?en(ma,lo,Jn,Wt,Pt,Rn):en(lo,ma,Jn,Pt,Wt,Rn);if(Fo!==void 0){if(Fo)continue;zo=!1;break}if(ga){if(!ih(Wt,function(gc,Xi){if(rs=Xi,!ga.has(rs)&&(lo===gc||wr(lo,gc,Se,en,Rn)))return ga.push(Xi);var rs})){zo=!1;break}}else if(lo!==ma&&!wr(lo,ma,Se,en,Rn)){zo=!1;break}}return Rn.delete(Pt),Rn.delete(Wt),zo}function gh(Pt){return function(Wt,Se,en){var wr=Se(Wt);return Ql(Wt)?wr:function(Rn,Fr){for(var Qr=-1,ci=Fr.length,Br=Rn.length;++Qr<ci;)Rn[Br+Qr]=Fr[Qr];return Rn}(wr,en(Wt))}(Pt,xh,yh)}function mh(Pt,Wt){var Se,en,wr=Pt.__data__;return((en=typeof(Se=Wt))=="string"||en=="number"||en=="symbol"||en=="boolean"?Se!=="__proto__":Se===null)?wr[typeof Wt=="string"?"string":"hash"]:wr.map}function Jl(Pt,Wt){var Se=function(en,wr){return en==null?void 0:en[wr]}(Pt,Wt);return fc(Se)?Se:void 0}Kn.prototype.clear=function(){this.__data__=Mu?Mu(null):{},this.size=0},Kn.prototype.delete=function(Pt){var Wt=this.has(Pt)&&delete this.__data__[Pt];return this.size-=Wt?1:0,Wt},Kn.prototype.get=function(Pt){var Wt=this.__data__;if(Mu){var Se=Wt[Pt];return Se===X?void 0:Se}return ha.call(Wt,Pt)?Wt[Pt]:void 0},Kn.prototype.has=function(Pt){var Wt=this.__data__;return Mu?Wt[Pt]!==void 0:ha.call(Wt,Pt)},Kn.prototype.set=function(Pt,Wt){var Se=this.__data__;return this.size+=this.has(Pt)?0:1,Se[Pt]=Mu&&Wt===void 0?X:Wt,this},ns.prototype.clear=function(){this.__data__=[],this.size=0},ns.prototype.delete=function(Pt){var Wt=this.__data__,Se=Au(Wt,Pt);return!(Se<0)&&(Se==Wt.length-1?Wt.pop():Ep.call(Wt,Se,1),--this.size,!0)},ns.prototype.get=function(Pt){var Wt=this.__data__,Se=Au(Wt,Pt);return Se<0?void 0:Wt[Se][1]},ns.prototype.has=function(Pt){return Au(this.__data__,Pt)>-1},ns.prototype.set=function(Pt,Wt){var Se=this.__data__,en=Au(Se,Pt);return en<0?(++this.size,Se.push([Pt,Wt])):Se[en][1]=Wt,this},cl.prototype.clear=function(){this.size=0,this.__data__={hash:new Kn,map:new(Fs||ns),string:new Kn}},cl.prototype.delete=function(Pt){var Wt=mh(this,Pt).delete(Pt);return this.size-=Wt?1:0,Wt},cl.prototype.get=function(Pt){return mh(this,Pt).get(Pt)},cl.prototype.has=function(Pt){return mh(this,Pt).has(Pt)},cl.prototype.set=function(Pt,Wt){var Se=mh(this,Pt),en=Se.size;return Se.set(Pt,Wt),this.size+=Se.size==en?0:1,this},Lu.prototype.add=Lu.prototype.push=function(Pt){return this.__data__.set(Pt,X),this},Lu.prototype.has=function(Pt){return this.__data__.has(Pt)},Bs.prototype.clear=function(){this.__data__=new ns,this.size=0},Bs.prototype.delete=function(Pt){var Wt=this.__data__,Se=Wt.delete(Pt);return this.size=Wt.size,Se},Bs.prototype.get=function(Pt){return this.__data__.get(Pt)},Bs.prototype.has=function(Pt){return this.__data__.has(Pt)},Bs.prototype.set=function(Pt,Wt){var Se=this.__data__;if(Se instanceof ns){var en=Se.__data__;if(!Fs||en.length<199)return en.push([Pt,Wt]),this.size=++Se.size,this;Se=this.__data__=new cl(en)}return Se.set(Pt,Wt),this.size=Se.size,this};var yh=Kl?function(Pt){return Pt==null?[]:(Pt=Object(Pt),function(Wt,Se){for(var en=-1,wr=Wt==null?0:Wt.length,Rn=0,Fr=[];++en<wr;){var Qr=Wt[en];Se(Qr,en,Wt)&&(Fr[Rn++]=Qr)}return Fr}(Kl(Pt),function(Wt){return hc.call(Pt,Wt)}))}:function(){return[]},fa=hl;function Ef(Pt,Wt){return!!(Wt=Wt??ct)&&(typeof Pt=="number"||eh.test(Pt))&&Pt>-1&&Pt%1==0&&Pt<Wt}function pl(Pt){if(Pt!=null){try{return Yl.call(Pt)}catch{}try{return Pt+""}catch{}}return""}function Nu(Pt,Wt){return Pt===Wt||Pt!=Pt&&Wt!=Wt}(pc&&fa(new pc(new ArrayBuffer(1)))!=zr||Fs&&fa(new Fs)!=Le||ph&&fa(ph.resolve())!=Cr||pa&&fa(new pa)!=Jr||ll&&fa(new ll)!=Yn)&&(fa=function(Pt){var Wt=hl(Pt),Se=Wt==un?Pt.constructor:void 0,en=Se?pl(Se):"";if(en)switch(en){case Sp:return zr;case Un:return Le;case Pr:return Cr;case Zd:return Jr;case An:return Yn}return Wt});var _h=dh(function(){return arguments}())?dh:function(Pt){return da(Pt)&&ha.call(Pt,"callee")&&!hc.call(Pt,"callee")},Ql=Array.isArray,vh=xf||function(){return!1};function Mr(Pt){if(!wo(Pt))return!1;var Wt=hl(Pt);return Wt==Me||Wt=="[object GeneratorFunction]"||Wt=="[object AsyncFunction]"||Wt=="[object Proxy]"}function fl(Pt){return typeof Pt=="number"&&Pt>-1&&Pt%1==0&&Pt<=ct}function wo(Pt){var Wt=typeof Pt;return Pt!=null&&(Wt=="object"||Wt=="function")}function da(Pt){return Pt!=null&&typeof Pt=="object"}var Du=rh?function(Pt){return function(Wt){return Pt(Wt)}}(rh):function(Pt){return da(Pt)&&fl(Pt.length)&&!!lr[hl(Pt)]};function xh(Pt){return(Wt=Pt)!=null&&fl(Wt.length)&&!Mr(Wt)?fh(Pt):dc(Pt);var Wt}b.exports=function(Pt,Wt){return ku(Pt,Wt)}})(Zi,Zi.exports);var ar=r(Zi.exports);function ua(b,L){return b.length===L.length&&JSON.stringify(b.map(function(X){return X}).sort())===JSON.stringify(L.map(function(X){return X}).sort())}var zi={Polygon:Wn,LineString:Xn,Point:pn,MultiPolygon:Te,MultiLineString:Te,MultiPoint:Te},zs=Object.freeze({__proto__:null,CommonSelectors:pr,constrainFeatureMovement:Hn,createMidPoint:li,createSupplementaryPoints:ji,createVertex:tn,doubleClickZoom:Xe,euclideanDistance:hn,featuresAt:Gt,getFeatureAtAndSetCursors:Ue,isClick:he,isEventAtCoordinates:ui,isTap:Fe,mapEventToBoundingBox:De,ModeHandler:n,moveFeatures:fr,sortFeatures:Xt,stringSetsAreEqual:ua,StringSet:ue,theme:Vn,toDenseArray:Dn}),Ir=function(b,L){var X={options:b=function(wt){wt===void 0&&(wt={});var Et=qt(wt);return wt.controls||(Et.controls={}),wt.displayControlsDefault===!1?Et.controls=qt(ir,wt.controls):Et.controls=qt(la,wt.controls),(Et=qt(Da,Et)).styles=xn(Et.styles,"cold").concat(xn(Et.styles,"hot")),Et}(b)};L=function(wt,Et){return Et.modes=pt,Et.getFeatureIdsAt=function(kt){return Gt.click({point:kt},null,wt).map(function(se){return se.properties.id})},Et.getSelectedIds=function(){return wt.store.getSelectedIds()},Et.getSelected=function(){return{type:nt.FEATURE_COLLECTION,features:wt.store.getSelectedIds().map(function(kt){return wt.store.get(kt)}).map(function(kt){return kt.toGeoJSON()})}},Et.getSelectedPoints=function(){return{type:nt.FEATURE_COLLECTION,features:wt.store.getSelectedCoordinates().map(function(kt){return{type:nt.FEATURE,properties:{},geometry:{type:nt.POINT,coordinates:kt.coordinates}}})}},Et.set=function(kt){if(kt.type===void 0||kt.type!==nt.FEATURE_COLLECTION||!Array.isArray(kt.features))throw new Error("Invalid FeatureCollection");var se=wt.store.createRenderBatch(),de=wt.store.getAllIds().slice(),Me=Et.add(kt),Le=new ue(Me);return(de=de.filter(function(Ee){return!Le.has(Ee)})).length&&Et.delete(de),se(),Me},Et.add=function(kt){var se=JSON.parse(JSON.stringify(G(kt))).features.map(function(de){if(de.id=de.id||mn(),de.geometry===null)throw new Error("Invalid geometry: null");if(wt.store.get(de.id)===void 0||wt.store.get(de.id).type!==de.geometry.type){var Me=zi[de.geometry.type];if(Me===void 0)throw new Error("Invalid geometry type: "+de.geometry.type+".");var Le=new Me(wt,de);wt.store.add(Le)}else{var Ee=wt.store.get(de.id);Ee.properties=de.properties,ar(Ee.properties,de.properties)||wt.store.featureChanged(Ee.id),ar(Ee.getCoordinates(),de.geometry.coordinates)||Ee.incomingCoords(de.geometry.coordinates)}return de.id});return wt.store.render(),se},Et.get=function(kt){var se=wt.store.get(kt);if(se)return se.toGeoJSON()},Et.getAll=function(){return{type:nt.FEATURE_COLLECTION,features:wt.store.getAll().map(function(kt){return kt.toGeoJSON()})}},Et.delete=function(kt){return wt.store.delete(kt,{silent:!0}),Et.getMode()!==pt.DIRECT_SELECT||wt.store.getSelectedIds().length?wt.store.render():wt.events.changeMode(pt.SIMPLE_SELECT,void 0,{silent:!0}),Et},Et.deleteAll=function(){return wt.store.delete(wt.store.getAllIds(),{silent:!0}),Et.getMode()===pt.DIRECT_SELECT?wt.events.changeMode(pt.SIMPLE_SELECT,void 0,{silent:!0}):wt.store.render(),Et},Et.changeMode=function(kt,se){return se===void 0&&(se={}),kt===pt.SIMPLE_SELECT&&Et.getMode()===pt.SIMPLE_SELECT?(ua(se.featureIds||[],wt.store.getSelectedIds())||(wt.store.setSelected(se.featureIds,{silent:!0}),wt.store.render()),Et):(kt===pt.DIRECT_SELECT&&Et.getMode()===pt.DIRECT_SELECT&&se.featureId===wt.store.getSelectedIds()[0]||wt.events.changeMode(kt,se,{silent:!0}),Et)},Et.getMode=function(){return wt.events.getMode()},Et.trash=function(){return wt.events.trash({silent:!0}),Et},Et.combineFeatures=function(){return wt.events.combineFeatures({silent:!0}),Et},Et.uncombineFeatures=function(){return wt.events.uncombineFeatures({silent:!0}),Et},Et.setFeatureProperty=function(kt,se,de){return wt.store.setFeatureProperty(kt,se,de),Et},Et}(X,L),X.api=L;var ct=Rr(X);return L.onAdd=ct.onAdd,L.onRemove=ct.onRemove,L.types=W,L.options=b,L};function ca(b){Ir(b,this)}return ca.modes=qr,ca.constants=Rt,ca.lib=zs,ca})})(jT);var $k=jT.exports;const Gk=c1($k);function aw(t){const e=Ml.useRef(!1);Ml.useEffect(()=>{e.current||(e.current=!0,t())},[])}const SS=t=>{const e=t.draw.getAll();if(e.features.length){const n=ym(e);t.fitBounds(n,{animate:!1})}};function jk({map:t,svg:e,onCreate:n}){return aw(()=>{const r=new Gk({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}});t.addControl(r),t.draw=r,t.on("draw.create",()=>{SS(t),n(t)})}),Ml.useEffect(()=>{var s;let r=[];if(e){const u=new DOMParser().parseFromString(e,"image/svg+xml").querySelector("#base");try{r=JSON.parse(((s=u==null?void 0:u.getAttribute("data-shapes"))==null?void 0:s.replaceAll("'",'"'))??"")}catch{console.log("error")}if(r!=null&&r.length){for(const w of r)t.draw.add(w);SS(t)}}},[e,t]),null}var qT={},qk=Object.defineProperty,Zk=(t,e,n)=>e in t?qk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,IS=(t,e,n)=>(Zk(t,typeof e!="symbol"?e+"":e,n),n),ZT=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},au=(t,e,n)=>(ZT(t,e,"read from private field"),n?n.call(t):e.get(t)),CS=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},j0=(t,e,n,r)=>(ZT(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);function oi(){}function Xk(t,e){for(const n in e)t[n]=e[n];return t}function XT(t){return t()}function TS(){return Object.create(null)}function th(t){t.forEach(XT)}function WT(t){return typeof t=="function"}function mp(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let By;function Pa(t,e){return t===e?!0:(By||(By=document.createElement("a")),By.href=e,t===By.href)}function Wk(t){return Object.keys(t).length===0}function Hk(t,e,n,r){if(t){const s=HT(t,e,n,r);return t[0](s)}}function HT(t,e,n,r){return t[1]&&r?Xk(n.ctx.slice(),t[1](r(e))):n.ctx}function Yk(t,e,n,r){if(t[2]&&r){const s=t[2](r(n));if(e.dirty===void 0)return s;if(typeof s=="object"){const c=[],f=Math.max(e.dirty.length,s.length);for(let u=0;u<f;u+=1)c[u]=e.dirty[u]|s[u];return c}return e.dirty|s}return e.dirty}function Kk(t,e,n,r,s,c){if(s){const f=HT(e,n,r,c);t.p(f,s)}}function Jk(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function PS(t){return t??""}function rr(t,e){t.appendChild(e)}function ki(t,e,n){t.insertBefore(e,n||null)}function _i(t){t.parentNode&&t.parentNode.removeChild(t)}function Ur(t){return document.createElement(t)}function Qu(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ep(t){return document.createTextNode(t)}function qa(){return ep(" ")}function Qk(){return ep("")}function Ys(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function tN(t){return function(e){return e.preventDefault(),t.call(this,e)}}function me(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function eN(t){return Array.from(t.childNodes)}function _m(t,e){e=""+e,t.data!==e&&(t.data=e)}function MS(t,e){t.value=e??""}function Al(t,e,n){t.classList.toggle(e,!!n)}function nN(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}let vm;function Jg(t){vm=t}function YT(){if(!vm)throw new Error("Function called outside component initialization");return vm}function rN(t){YT().$$.on_destroy.push(t)}function iN(){const t=YT();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const c=nN(e,n,{cancelable:r});return s.slice().forEach(f=>{f.call(t,c)}),!c.defaultPrevented}return!0}}function LS(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const Vf=[],Zx=[];let ld=[];const AS=[],oN=Promise.resolve();let Xx=!1;function sN(){Xx||(Xx=!0,oN.then(KT))}function Wx(t){ld.push(t)}const q0=new Set;let Ff=0;function KT(){if(Ff!==0)return;const t=vm;do{try{for(;Ff<Vf.length;){const e=Vf[Ff];Ff++,Jg(e),aN(e.$$)}}catch(e){throw Vf.length=0,Ff=0,e}for(Jg(null),Vf.length=0,Ff=0;Zx.length;)Zx.pop()();for(let e=0;e<ld.length;e+=1){const n=ld[e];q0.has(n)||(q0.add(n),n())}ld.length=0}while(Vf.length);for(;AS.length;)AS.pop()();Xx=!1,q0.clear(),Jg(t)}function aN(t){if(t.fragment!==null){t.update(),th(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Wx)}}function lN(t){const e=[],n=[];ld.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),ld=e}const s_=new Set;let $p;function a_(){$p={r:0,c:[],p:$p}}function l_(){$p.r||th($p.c),$p=$p.p}function no(t,e){t&&t.i&&(s_.delete(t),t.i(e))}function Go(t,e,n,r){if(t&&t.o){if(s_.has(t))return;s_.add(t),$p.c.push(()=>{s_.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function kS(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function uN(t,e){Go(t,1,1,()=>{e.delete(t.key)})}function cN(t,e,n,r,s,c,f,u,w,S,A,N){let O=t.length,j=c.length,W=O;const nt={};for(;W--;)nt[t[W].key]=W;const pt=[],J=new Map,tt=new Map,Q=[];for(W=j;W--;){const Rt=N(s,c,W),At=n(Rt);let Ht=f.get(At);Ht?r&&Q.push(()=>Ht.p(Rt,e)):(Ht=S(At,Rt),Ht.c()),J.set(At,pt[W]=Ht),At in nt&&tt.set(At,Math.abs(W-nt[At]))}const _t=new Set,Ot=new Set;function zt(Rt){no(Rt,1),Rt.m(u,A),f.set(Rt.key,Rt),A=Rt.first,j--}for(;O&&j;){const Rt=pt[j-1],At=t[O-1],Ht=Rt.key,Xt=At.key;Rt===At?(A=Rt.first,O--,j--):J.has(Xt)?!f.has(Ht)||_t.has(Ht)?zt(Rt):Ot.has(Xt)?O--:tt.get(Ht)>tt.get(Xt)?(Ot.add(Ht),zt(Rt)):(_t.add(Xt),O--):(w(At,f),O--)}for(;O--;){const Rt=t[O];J.has(Rt.key)||w(Rt,f)}for(;j;)zt(pt[j-1]);return th(Q),pt}function np(t){t&&t.c()}function $c(t,e,n){const{fragment:r,after_update:s}=t.$$;r&&r.m(e,n),Wx(()=>{const c=t.$$.on_mount.map(XT).filter(WT);t.$$.on_destroy?t.$$.on_destroy.push(...c):th(c),t.$$.on_mount=[]}),s.forEach(Wx)}function Gc(t,e){const n=t.$$;n.fragment!==null&&(lN(n.after_update),th(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function hN(t,e){t.$$.dirty[0]===-1&&(Vf.push(t),sN(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function yp(t,e,n,r,s,c,f=null,u=[-1]){const w=vm;Jg(t);const S=t.$$={fragment:null,ctx:[],props:c,update:oi,not_equal:s,bound:TS(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(w?w.$$.context:[])),callbacks:TS(),dirty:u,skip_bound:!1,root:e.target||w.$$.root};f&&f(S.root);let A=!1;if(S.ctx=n?n(t,e.props||{},(N,O,...j)=>{const W=j.length?j[0]:O;return S.ctx&&s(S.ctx[N],S.ctx[N]=W)&&(!S.skip_bound&&S.bound[N]&&S.bound[N](W),A&&hN(t,N)),O}):[],S.update(),A=!0,th(S.before_update),S.fragment=r?r(S.ctx):!1,e.target){if(e.hydrate){const N=eN(e.target);S.fragment&&S.fragment.l(N),N.forEach(_i)}else S.fragment&&S.fragment.c();e.intro&&no(t.$$.fragment),$c(t,e.target,e.anchor),KT()}Jg(w)}class _p{constructor(){IS(this,"$$"),IS(this,"$$set")}$destroy(){Gc(this,1),this.$destroy=oi}$on(e,n){if(!WT(n))return oi;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Wk(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const pN="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(pN);function fN(t){let e,n;return{c(){e=Qu("svg"),n=Qu("path"),me(n,"d","M13.12.706a.982.982 0 0 0-1.391 0L6.907 5.517 2.087.696a.982.982 0 1 0-1.391 1.39l4.821 4.821L.696 11.73a.982.982 0 1 0 1.39 1.39l4.821-4.821 4.822 4.821a.982.982 0 1 0 1.39-1.39L8.298 6.908l4.821-4.822a.988.988 0 0 0 0-1.38Z"),me(e,"viewBox","0 0 14 14"),me(e,"width","13"),me(e,"height","13"),me(e,"class","svelte-en2qvf")},m(r,s){ki(r,e,s),rr(e,n)},p:oi,i:oi,o:oi,d(r){r&&_i(e)}}}class JT extends _p{constructor(e){super(),yp(this,e,null,fN,mp,{})}}function dN(t){let e,n;return{c(){e=Qu("svg"),n=Qu("path"),me(n,"d","M15 0C6.705 0 0 6.705 0 15C0 23.295 6.705 30 15 30C23.295 30 30 23.295 30 15C30 6.705 23.295 0 15 0ZM22.5 20.385L20.385 22.5L15 17.115L9.615 22.5L7.5 20.385L12.885 15L7.5 9.615L9.615 7.5L15 12.885L20.385 7.5L22.5 9.615L17.115 15L22.5 20.385Z"),me(e,"viewBox","0 0 30 30"),me(e,"fill","none"),me(e,"xmlns","http://www.w3.org/2000/svg"),me(e,"class","svelte-d2loi5")},m(r,s){ki(r,e,s),rr(e,n)},p:oi,i:oi,o:oi,d(r){r&&_i(e)}}}class QT extends _p{constructor(e){super(),yp(this,e,null,dN,mp,{})}}function gN(t){let e,n;return{c(){e=Ur("img"),Pa(e.src,n=t[3]+"area.svg")||me(e,"src",n),me(e,"alt",t[6]),me(e,"class","svelte-ltkwvy")},m(r,s){ki(r,e,s)},p(r,s){s&8&&!Pa(e.src,n=r[3]+"area.svg")&&me(e,"src",n),s&64&&me(e,"alt",r[6])},d(r){r&&_i(e)}}}function mN(t){let e,n;return{c(){e=Ur("img"),Pa(e.src,n=t[3]+"poi.svg")||me(e,"src",n),me(e,"alt",t[6]),me(e,"class","svelte-ltkwvy")},m(r,s){ki(r,e,s)},p(r,s){s&8&&!Pa(e.src,n=r[3]+"poi.svg")&&me(e,"src",n),s&64&&me(e,"alt",r[6])},d(r){r&&_i(e)}}}function yN(t){let e,n;return{c(){e=Ur("img"),Pa(e.src,n=t[3]+"postal_code.svg")||me(e,"src",n),me(e,"alt",t[6]),me(e,"class","svelte-ltkwvy")},m(r,s){ki(r,e,s)},p(r,s){s&8&&!Pa(e.src,n=r[3]+"postal_code.svg")&&me(e,"src",n),s&64&&me(e,"alt",r[6])},d(r){r&&_i(e)}}}function _N(t){let e,n;return{c(){e=Ur("img"),Pa(e.src,n=t[3]+"street.svg")||me(e,"src",n),me(e,"alt",t[6]),me(e,"class","svelte-ltkwvy")},m(r,s){ki(r,e,s)},p(r,s){s&8&&!Pa(e.src,n=r[3]+"street.svg")&&me(e,"src",n),s&64&&me(e,"alt",r[6])},d(r){r&&_i(e)}}}function vN(t){let e,n;return{c(){e=Ur("img"),Pa(e.src,n=t[3]+"road.svg")||me(e,"src",n),me(e,"alt",t[6]),me(e,"class","svelte-ltkwvy")},m(r,s){ki(r,e,s)},p(r,s){s&8&&!Pa(e.src,n=r[3]+"road.svg")&&me(e,"src",n),s&64&&me(e,"alt",r[6])},d(r){r&&_i(e)}}}function xN(t){let e,n;return{c(){e=Ur("img"),Pa(e.src,n=t[3]+"housenumber.svg")||me(e,"src",n),me(e,"alt",t[6]),me(e,"class","svelte-ltkwvy")},m(r,s){ki(r,e,s)},p(r,s){s&8&&!Pa(e.src,n=r[3]+"housenumber.svg")&&me(e,"src",n),s&64&&me(e,"alt",r[6])},d(r){r&&_i(e)}}}function wN(t){let e,n,r,s;return{c(){e=Ur("img"),Pa(e.src,n=t[5])||me(e,"src",n),me(e,"alt",t[4]),me(e,"class","svelte-ltkwvy")},m(c,f){ki(c,e,f),r||(s=Ys(e,"error",t[13]),r=!0)},p(c,f){f&32&&!Pa(e.src,n=c[5])&&me(e,"src",n),f&16&&me(e,"alt",c[4])},d(c){c&&_i(e),r=!1,s()}}}function NS(t){let e,n;return{c(){e=Ur("span"),n=ep(t[6]),me(e,"class","secondary svelte-ltkwvy")},m(r,s){ki(r,e,s),rr(e,n)},p(r,s){s&64&&_m(n,r[6])},d(r){r&&_i(e)}}}function bN(t){var e,n;let r,s,c,f,u,w,S,A,N=t[0].place_name.replace(/,.*/,"")+"",O,j,W=t[2]==="always"||t[2]&&!t[0].address&&((e=t[0].properties)==null?void 0:e.kind)!=="road"&&((n=t[0].properties)==null?void 0:n.kind)!=="road_relation"&&!t[0].id.startsWith("address.")&&!t[0].id.startsWith("postal_code.")&&(!t[0].id.startsWith("poi.")||!t[5]),nt,pt,J=t[0].place_name.replace(/[^,]*,?\s*/,"")+"",tt,Q,_t;function Ot(Ht,Xt){var De,ue;return Xt&1&&(s=null),Xt&1&&(c=null),Xt&1&&(f=null),Ht[5]?wN:Ht[0].address?xN:((De=Ht[0].properties)==null?void 0:De.kind)==="road"||((ue=Ht[0].properties)==null?void 0:ue.kind)==="road_relation"?vN:(s==null&&(s=!!Ht[0].id.startsWith("address.")),s?_N:(c==null&&(c=!!Ht[0].id.startsWith("postal_code.")),c?yN:(f==null&&(f=!!Ht[0].id.startsWith("poi.")),f?mN:gN)))}let zt=Ot(t,-1),Rt=zt(t),At=W&&NS(t);return{c(){r=Ur("li"),Rt.c(),u=qa(),w=Ur("span"),S=Ur("span"),A=Ur("span"),O=ep(N),j=qa(),At&&At.c(),nt=qa(),pt=Ur("span"),tt=ep(J),me(A,"class","primary svelte-ltkwvy"),me(S,"class","svelte-ltkwvy"),me(pt,"class","line2 svelte-ltkwvy"),me(w,"class","texts svelte-ltkwvy"),me(r,"tabindex","0"),me(r,"data-selected",t[1]),me(r,"class","svelte-ltkwvy"),Al(r,"selected",t[1])},m(Ht,Xt){ki(Ht,r,Xt),Rt.m(r,null),rr(r,u),rr(r,w),rr(w,S),rr(S,A),rr(A,O),rr(S,j),At&&At.m(S,null),rr(w,nt),rr(w,pt),rr(pt,tt),Q||(_t=[Ys(r,"mouseenter",t[11]),Ys(r,"focus",t[12])],Q=!0)},p(Ht,[Xt]){var De,ue;zt===(zt=Ot(Ht,Xt))&&Rt?Rt.p(Ht,Xt):(Rt.d(1),Rt=zt(Ht),Rt&&(Rt.c(),Rt.m(r,u))),Xt&1&&N!==(N=Ht[0].place_name.replace(/,.*/,"")+"")&&_m(O,N),Xt&37&&(W=Ht[2]==="always"||Ht[2]&&!Ht[0].address&&((De=Ht[0].properties)==null?void 0:De.kind)!=="road"&&((ue=Ht[0].properties)==null?void 0:ue.kind)!=="road_relation"&&!Ht[0].id.startsWith("address.")&&!Ht[0].id.startsWith("postal_code.")&&(!Ht[0].id.startsWith("poi.")||!Ht[5])),W?At?At.p(Ht,Xt):(At=NS(Ht),At.c(),At.m(S,null)):At&&(At.d(1),At=null),Xt&1&&J!==(J=Ht[0].place_name.replace(/[^,]*,?\s*/,"")+"")&&_m(tt,J),Xt&2&&me(r,"data-selected",Ht[1]),Xt&2&&Al(r,"selected",Ht[1])},i:oi,o:oi,d(Ht){Ht&&_i(r),Rt.d(),At&&At.d(),Q=!1,th(_t)}}}function EN(t,e,n){var r;let s,c,{feature:f}=e,{selected:u=!1}=e,{showPlaceType:w}=e,{missingIconsCache:S}=e,{iconsBaseUrl:A}=e;const N=(r=f.properties)==null?void 0:r.categories;let O,j,W=0;function nt(Q){j&&S.add(j),n(9,W++,W)}function pt(Q){LS.call(this,t,Q)}function J(Q){LS.call(this,t,Q)}const tt=Q=>nt(Q.currentTarget);return t.$$set=Q=>{"feature"in Q&&n(0,f=Q.feature),"selected"in Q&&n(1,u=Q.selected),"showPlaceType"in Q&&n(2,w=Q.showPlaceType),"missingIconsCache"in Q&&n(8,S=Q.missingIconsCache),"iconsBaseUrl"in Q&&n(3,A=Q.iconsBaseUrl)},t.$$.update=()=>{var Q,_t,Ot,zt;if(t.$$.dirty&1848)do n(10,s--,s),n(4,O=N==null?void 0:N[s]),n(5,j=O?A+O.replace(/ /g,"_")+".svg":void 0);while(s>-1&&(!j||S.has(j)));t.$$.dirty&1&&n(6,c=f.id.startsWith("poi.")?(_t=(Q=f.properties)==null?void 0:Q.categories)==null?void 0:_t.join(", "):((zt=(Ot=f.properties)==null?void 0:Ot.place_type_name)==null?void 0:zt[0])??f.place_type[0])},n(10,s=(N==null?void 0:N.length)??0),[f,u,w,A,O,j,c,nt,S,W,s,pt,J,tt]}class SN extends _p{constructor(e){super(),yp(this,e,EN,bN,mp,{feature:0,selected:1,showPlaceType:2,missingIconsCache:8,iconsBaseUrl:3})}}function IN(t){let e;return{c(){e=Ur("div"),e.innerHTML='<svg viewBox="0 0 18 18" width="24" height="24" class="svelte-7cmwmc"><path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"></path><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"></path></svg>',me(e,"class","svelte-7cmwmc")},m(n,r){ki(n,e,r)},p:oi,i:oi,o:oi,d(n){n&&_i(e)}}}class CN extends _p{constructor(e){super(),yp(this,e,null,IN,mp,{})}}function TN(t){let e,n,r;return{c(){e=Qu("svg"),n=Qu("path"),me(n,"stroke-width","4"),me(n,"d","M 5,33.103579 C 5,17.607779 18.457,5 35,5 C 51.543,5 65,17.607779 65,33.103579 C 65,56.388679 40.4668,76.048179 36.6112,79.137779 C 36.3714,79.329879 36.2116,79.457979 36.1427,79.518879 C 35.8203,79.800879 35.4102,79.942779 35,79.942779 C 34.5899,79.942779 34.1797,79.800879 33.8575,79.518879 C 33.7886,79.457979 33.6289,79.330079 33.3893,79.138079 C 29.5346,76.049279 5,56.389379 5,33.103579 Z M 35.0001,49.386379 C 43.1917,49.386379 49.8323,42.646079 49.8323,34.331379 C 49.8323,26.016779 43.1917,19.276479 35.0001,19.276479 C 26.8085,19.276479 20.1679,26.016779 20.1679,34.331379 C 20.1679,42.646079 26.8085,49.386379 35.0001,49.386379 Z"),me(n,"class","svelte-gzo3ar"),me(e,"width",r=t[0]==="list"?20:void 0),me(e,"viewBox","0 0 70 85"),me(e,"fill","none"),me(e,"class","svelte-gzo3ar"),Al(e,"in-map",t[0]!=="list"),Al(e,"list-icon",t[0]==="list")},m(s,c){ki(s,e,c),rr(e,n)},p(s,[c]){c&1&&r!==(r=s[0]==="list"?20:void 0)&&me(e,"width",r),c&1&&Al(e,"in-map",s[0]!=="list"),c&1&&Al(e,"list-icon",s[0]==="list")},i:oi,o:oi,d(s){s&&_i(e)}}}function PN(t,e,n){let{displayIn:r}=e;return t.$$set=s=>{"displayIn"in s&&n(0,r=s.displayIn)},[r]}class MN extends _p{constructor(e){super(),yp(this,e,PN,TN,mp,{displayIn:0})}}function LN(t){let e,n;return{c(){e=Qu("svg"),n=Qu("path"),me(n,"d","M30.003-26.765C13.46-26.765 0-14.158 0 1.337c0 23.286 24.535 42.952 28.39 46.04.24.192.402.316.471.376.323.282.732.424 1.142.424.41 0 .82-.142 1.142-.424.068-.06.231-.183.471-.376 3.856-3.09 28.39-22.754 28.39-46.04 0-15.495-13.46-28.102-30.003-28.102Zm1.757 12.469c4.38 0 7.858 1.052 10.431 3.158 2.595 2.105 3.89 4.913 3.89 8.422 0 2.34-.53 4.362-1.593 6.063-1.063 1.702-3.086 3.616-6.063 5.742-2.042 1.51-3.337 2.659-3.89 3.446-.532.787-.8 1.82-.8 3.096v1.914h-8.449V15.18c0-2.041.434-3.815 1.306-5.325.872-1.51 2.467-3.118 4.785-4.82 2.233-1.594 3.7-2.89 4.402-3.889a5.582 5.582 0 0 0 1.087-3.35c0-1.382-.51-2.435-1.531-3.158-1.02-.723-2.45-1.087-4.28-1.087-3.19 0-6.826 1.047-10.91 3.131l-3.472-6.986c4.742-2.659 9.77-3.992 15.087-3.992Zm-1.88 37.324c1.765 0 3.124.472 4.08 1.408.98.936 1.47 2.276 1.47 4.02 0 1.68-.49 3.007-1.47 3.985-.977.957-2.336 1.435-4.08 1.435-1.787 0-3.171-.465-4.15-1.4-.978-.958-1.47-2.298-1.47-4.02 0-1.787.48-3.14 1.436-4.054.957-.915 2.355-1.374 4.184-1.374Z"),me(e,"viewBox","0 0 60.006 21.412"),me(e,"width","14"),me(e,"height","20"),me(e,"class","svelte-en2qvf")},m(r,s){ki(r,e,s),rr(e,n)},p:oi,i:oi,o:oi,d(r){r&&_i(e)}}}class AN extends _p{constructor(e){super(),yp(this,e,null,LN,mp,{})}}function kN(t){let e,n;return{c(){e=Qu("svg"),n=Qu("path"),me(n,"d","M13.101 14.261 8.74 9.899a4.797 4.797 0 0 1-1.425.748 5.165 5.165 0 0 1-1.603.248c-1.446 0-2.677-.5-3.693-1.503S.495 7.164.495 5.717c0-1.446.508-2.678 1.524-3.693C3.035 1.008 4.266.5 5.712.5c1.448 0 2.672.508 3.675 1.524 1.002 1.015 1.503 2.247 1.503 3.693 0 .558-.08 1.092-.239 1.603-.159.512-.411.98-.757 1.405l4.382 4.4a.74.74 0 0 1 .229.568.81.81 0 0 1-.249.568.787.787 0 0 1-.577.239.787.787 0 0 1-.578-.239ZM5.712 9.223c.97 0 1.796-.342 2.48-1.026a3.378 3.378 0 0 0 1.026-2.48c0-.982-.34-1.818-1.016-2.509-.677-.69-1.507-1.035-2.49-1.035a3.42 3.42 0 0 0-2.509 1.035 3.42 3.42 0 0 0-1.035 2.51c0 .982.345 1.812 1.035 2.488.691.678 1.527 1.017 2.51 1.017Z"),me(e,"width","14"),me(e,"height","14"),me(e,"viewBox","0 0 15 15"),me(e,"class","svelte-en2qvf")},m(r,s){ki(r,e,s),rr(e,n)},p:oi,i:oi,o:oi,d(r){r&&_i(e)}}}class NN extends _p{constructor(e){super(),yp(this,e,null,kN,mp,{})}}function DN(t,e,n){const r=e[1],s=e[0],c=r-s;return t===r&&n?t:((t-s)%c+c)%c+s}function DS(t){const e=[...t];return e[2]<e[0]&&(e[2]+=360),e}let Dg;async function RN(t,e,n){const r=t==null?void 0:t.getCenterAndZoom();for(const s of e??[])if(!(r&&(s.minZoom!=null&&s.minZoom>r[0]||s.maxZoom!=null&&s.maxZoom<r[0]))){if(s.type==="fixed")return s.coordinates.join(",");t:if(s.type==="client-geolocation"){if(Dg&&s.cachedLocationExpiry&&Dg.time+s.cachedLocationExpiry>Date.now()){if(!Dg.coords)break t;return Dg.coords}let c;try{return c=await new Promise((f,u)=>{n.signal.addEventListener("abort",()=>{u(Error("aborted"))}),navigator.geolocation.getCurrentPosition(w=>{f([w.coords.longitude,w.coords.latitude].map(S=>S.toFixed(6)).join(","))},w=>{u(w)},s)}),c}catch{}finally{s.cachedLocationExpiry&&(Dg={time:Date.now(),coords:c})}if(n.signal.aborted)return}if(s.type==="server-geolocation")return"ip";if(r&&s.type==="map-center")return r[1].toFixed(6)+","+r[2].toFixed(6)}}function RS(t,e,n){const r=t.slice();return r[77]=e[n],r[79]=n,r}function OS(t){let e,n;return e=new CN({}),{c(){np(e.$$.fragment)},m(r,s){$c(e,r,s),n=!0},i(r){n||(no(e.$$.fragment,r),n=!0)},o(r){Go(e.$$.fragment,r),n=!1},d(r){Gc(e,r)}}}function zS(t){let e,n,r,s,c;return n=new AN({}),{c(){e=Ur("button"),np(n.$$.fragment),me(e,"type","button"),me(e,"title",t[9]),me(e,"class","svelte-1r7dvt7"),Al(e,"active",t[0])},m(f,u){ki(f,e,u),$c(n,e,null),r=!0,s||(c=Ys(e,"click",t[63]),s=!0)},p(f,u){(!r||u[0]&512)&&me(e,"title",f[9]),(!r||u[0]&1)&&Al(e,"active",f[0])},i(f){r||(no(n.$$.fragment,f),r=!0)},o(f){Go(n.$$.fragment,f),r=!1},d(f){f&&_i(e),Gc(n),s=!1,c()}}}function ON(t){let e,n=[],r=new Map,s,c,f,u=kS(t[13]);const w=S=>S[77].id+(S[77].address?","+S[77].address:"");for(let S=0;S<u.length;S+=1){let A=RS(t,u,S),N=w(A);r.set(N,n[S]=FS(N,A))}return{c(){e=Ur("ul");for(let S=0;S<n.length;S+=1)n[S].c();me(e,"class","svelte-1r7dvt7")},m(S,A){ki(S,e,A);for(let N=0;N<n.length;N+=1)n[N]&&n[N].m(e,null);s=!0,c||(f=[Ys(e,"mouseleave",t[67]),Ys(e,"blur",t[68])],c=!0)},p(S,A){A[0]&8940544&&(u=kS(S[13]),a_(),n=cN(n,A,w,1,S,u,r,e,uN,FS,null,RS),l_())},i(S){if(!s){for(let A=0;A<u.length;A+=1)no(n[A]);s=!0}},o(S){for(let A=0;A<n.length;A+=1)Go(n[A]);s=!1},d(S){S&&_i(e);for(let A=0;A<n.length;A+=1)n[A].d();c=!1,th(f)}}}function zN(t){let e,n,r,s,c,f;return n=new QT({}),{c(){e=Ur("div"),np(n.$$.fragment),r=qa(),s=Ur("div"),c=ep(t[7]),me(s,"class","svelte-1r7dvt7"),me(e,"class","no-results svelte-1r7dvt7")},m(u,w){ki(u,e,w),$c(n,e,null),rr(e,r),rr(e,s),rr(s,c),f=!0},p(u,w){(!f||w[0]&128)&&_m(c,u[7])},i(u){f||(no(n.$$.fragment,u),f=!0)},o(u){Go(n.$$.fragment,u),f=!1},d(u){u&&_i(e),Gc(n)}}}function FN(t){let e="",n;return{c(){n=ep(e)},m(r,s){ki(r,n,s)},p:oi,i:oi,o:oi,d(r){r&&_i(n)}}}function BN(t){let e,n,r,s,c,f,u,w,S,A,N;return n=new QT({}),w=new JT({}),{c(){e=Ur("div"),np(n.$$.fragment),r=qa(),s=Ur("div"),c=ep(t[6]),f=qa(),u=Ur("button"),np(w.$$.fragment),me(s,"class","svelte-1r7dvt7"),me(u,"class","svelte-1r7dvt7"),me(e,"class","error svelte-1r7dvt7")},m(O,j){ki(O,e,j),$c(n,e,null),rr(e,r),rr(e,s),rr(s,c),rr(e,f),rr(e,u),$c(w,u,null),S=!0,A||(N=Ys(u,"click",t[64]),A=!0)},p(O,j){(!S||j[0]&64)&&_m(c,O[6])},i(O){S||(no(n.$$.fragment,O),no(w.$$.fragment,O),S=!0)},o(O){Go(n.$$.fragment,O),Go(w.$$.fragment,O),S=!1},d(O){O&&_i(e),Gc(n),Gc(w),A=!1,N()}}}function FS(t,e){let n,r,s;function c(){return e[65](e[79])}function f(){return e[66](e[77])}return r=new SN({props:{feature:e[77],showPlaceType:e[10],selected:e[14]===e[79],missingIconsCache:e[19],iconsBaseUrl:e[11]}}),r.$on("mouseenter",c),r.$on("focus",f),{key:t,first:null,c(){n=Qk(),np(r.$$.fragment),this.first=n},m(u,w){ki(u,n,w),$c(r,u,w),s=!0},p(u,w){e=u;const S={};w[0]&8192&&(S.feature=e[77]),w[0]&1024&&(S.showPlaceType=e[10]),w[0]&24576&&(S.selected=e[14]===e[79]),w[0]&2048&&(S.iconsBaseUrl=e[11]),r.$set(S)},i(u){s||(no(r.$$.fragment,u),s=!0)},o(u){Go(r.$$.fragment,u),s=!1},d(u){u&&_i(n),Gc(r,u)}}}function VN(t){let e,n,r,s,c,f,u,w,S,A,N,O,j,W,nt,pt,J,tt,Q,_t,Ot,zt=!1;c=new NN({}),N=new JT({});let Rt=t[18]&&OS(),At=t[5]===!0&&zS(t);const Ht=t[55].default,Xt=Hk(Ht,t,t[54],null),De=[BN,FN,zN,ON],ue=[];function on(Gt,ye){var Ue,hn;return Gt[17]?0:Gt[15]?((Ue=Gt[13])==null?void 0:Ue.length)===0?2:Gt[15]&&(hn=Gt[13])!=null&&hn.length?3:-1:1}return~(pt=on(t))&&(J=ue[pt]=De[pt](t)),{c(){e=qa(),n=Ur("form"),r=Ur("div"),s=Ur("button"),np(c.$$.fragment),f=qa(),u=Ur("input"),w=qa(),S=Ur("div"),A=Ur("button"),np(N.$$.fragment),O=qa(),Rt&&Rt.c(),j=qa(),At&&At.c(),W=qa(),Xt&&Xt.c(),nt=qa(),J&&J.c(),me(s,"class","search-button svelte-1r7dvt7"),me(s,"type","button"),me(u,"placeholder",t[8]),me(u,"aria-label",t[8]),me(u,"class","svelte-1r7dvt7"),me(A,"type","button"),me(A,"title",t[3]),me(A,"class","svelte-1r7dvt7"),me(S,"class","clear-button-container svelte-1r7dvt7"),Al(S,"displayable",t[1]!==""),me(r,"class","input-group svelte-1r7dvt7"),me(n,"tabindex","0"),me(n,"class",tt=PS(t[2])+" svelte-1r7dvt7"),Al(n,"can-collapse",t[4]&&t[1]==="")},m(Gt,ye){ki(Gt,e,ye),ki(Gt,n,ye),rr(n,r),rr(r,s),$c(c,s,null),rr(r,f),rr(r,u),t[57](u),MS(u,t[1]),rr(r,w),rr(r,S),rr(S,A),$c(N,A,null),rr(S,O),Rt&&Rt.m(S,null),rr(r,j),At&&At.m(r,null),rr(r,W),Xt&&Xt.m(r,null),rr(n,nt),~pt&&ue[pt].m(n,null),Q=!0,_t||(Ot=[Ys(s,"click",t[56]),Ys(u,"input",t[58]),Ys(u,"focus",t[59]),Ys(u,"blur",t[60]),Ys(u,"keydown",t[21]),Ys(u,"input",t[61]),Ys(A,"click",t[62]),Ys(n,"submit",tN(t[20]))],_t=!0)},p(Gt,ye){(!Q||ye[0]&256)&&me(u,"placeholder",Gt[8]),(!Q||ye[0]&256)&&me(u,"aria-label",Gt[8]),ye[0]&2&&u.value!==Gt[1]&&MS(u,Gt[1]),(!Q||ye[0]&8)&&me(A,"title",Gt[3]),Gt[18]?Rt?ye[0]&262144&&no(Rt,1):(Rt=OS(),Rt.c(),no(Rt,1),Rt.m(S,null)):Rt&&(a_(),Go(Rt,1,1,()=>{Rt=null}),l_()),(!Q||ye[0]&2)&&Al(S,"displayable",Gt[1]!==""),Gt[5]===!0?At?(At.p(Gt,ye),ye[0]&32&&no(At,1)):(At=zS(Gt),At.c(),no(At,1),At.m(r,W)):At&&(a_(),Go(At,1,1,()=>{At=null}),l_()),Xt&&Xt.p&&(!Q||ye[1]&8388608)&&Kk(Xt,Ht,Gt,Gt[54],Q?Yk(Ht,Gt[54],ye,null):Jk(Gt[54]),null);let Ue=pt;pt=on(Gt),pt===Ue?~pt&&ue[pt].p(Gt,ye):(J&&(a_(),Go(ue[Ue],1,1,()=>{ue[Ue]=null}),l_()),~pt?(J=ue[pt],J?J.p(Gt,ye):(J=ue[pt]=De[pt](Gt),J.c()),no(J,1),J.m(n,null)):J=null),(!Q||ye[0]&4&&tt!==(tt=PS(Gt[2])+" svelte-1r7dvt7"))&&me(n,"class",tt),(!Q||ye[0]&22)&&Al(n,"can-collapse",Gt[4]&&Gt[1]==="")},i(Gt){Q||(no(zt),no(c.$$.fragment,Gt),no(N.$$.fragment,Gt),no(Rt),no(At),no(Xt,Gt),no(J),Q=!0)},o(Gt){Go(zt),Go(c.$$.fragment,Gt),Go(N.$$.fragment,Gt),Go(Rt),Go(At),Go(Xt,Gt),Go(J),Q=!1},d(Gt){Gt&&(_i(e),_i(n)),Gc(c),t[57](null),Gc(N),Rt&&Rt.d(),At&&At.d(),Xt&&Xt.d(Gt),~pt&&ue[pt].d(),_t=!1,th(Ot)}}}function UN(t,e,n){let r,{$$slots:s={},$$scope:c}=e,{class:f=void 0}=e,{apiKey:u}=e,{bbox:w=void 0}=e,{clearButtonTitle:S="clear"}=e,{clearOnBlur:A=!1}=e,{collapsed:N=!1}=e,{country:O=void 0}=e,{debounceSearch:j=200}=e,{enableReverse:W=!1}=e,{errorMessage:nt="Something went wrong"}=e,{filter:pt=()=>!0}=e,{flyTo:J=!0}=e,{fuzzyMatch:tt=!0}=e,{language:Q=void 0}=e,{limit:_t=void 0}=e,{mapController:Ot=void 0}=e,{minLength:zt=2}=e,{noResultsMessage:Rt="Oops! Looks like you're trying to predict something that's not quite right. We can't seem to find what you're looking for. Maybe try double-checking your spelling or try a different search term. Keep on typing - we'll do our best to get you where you need to go!"}=e,{placeholder:At="Search"}=e,{proximity:Ht=[{type:"server-geolocation"}]}=e,{reverseActive:Xt=W==="always"}=e,{reverseButtonTitle:De="toggle reverse geocoding"}=e,{searchValue:ue=""}=e,{showFullGeometry:on=!0}=e,{showPlaceType:Gt="ifNeeded"}=e,{showResultsWhileTyping:ye=!0}=e,{types:Ue=void 0}=e,{zoom:hn=16}=e,{maxZoom:he=18}=e,{apiUrl:Fe="https://api.maptiler.com/geocoding"}=e,{fetchParameters:Qe={}}=e,{iconsBaseUrl:_n="https://cdn.maptiler.com/maptiler-geocoding-control/v1.0.1/icons/"}=e,{adjustUrlQuery:mn=q=>{}}=e;function Ke(){xi.focus()}function pn(){xi.blur()}function Xn(q,V=!0){n(1,ue=q),V?(n(14,Dn=-1),Vn()):(No(),setTimeout(()=>{xi.focus(),xi.select()}))}function Wn(){n(13,Te=void 0),n(51,bn=void 0),n(14,Dn=-1)}function _o(){n(50,Oe=[]),n(51,bn=void 0)}let Dr=!1,Te,Oe,bn,es="",xi,Dn=-1,hr,vn=[],Di,Ui,ko,qt;const Ri=new Set,Rr=iN();rN(()=>{Ot&&(Ot.setEventHandler(void 0),Ot.indicateReverse(!1),Ot.setSelectedMarker(-1),Ot.setMarkers(void 0,void 0))});function Vn(q){if(Ui&&(clearTimeout(Ui),Ui=void 0),Dn>-1&&Te)n(51,bn=Te[Dn]),n(1,ue=bn.place_name.replace(/,.*/,"")),n(17,hr=void 0),n(50,Oe=void 0),n(14,Dn=-1);else if(ue){const V=q||!En();$i(ue,{exact:!0}).then(()=>{n(50,Oe=Te),n(51,bn=void 0),V&&ao()}).catch(G=>n(17,hr=G))}}function En(){return/^-?\d+(\.\d+)?,-?\d+(\.\d+)?$/.test(ue)}async function $i(q,{byId:V=!1,exact:G=!1}={}){n(17,hr=void 0),Di==null||Di.abort();const et=new AbortController;n(18,Di=et);try{const at=En(),lt=new URLSearchParams;if(Q!==void 0&&lt.set("language",Array.isArray(Q)?Q.join(","):Q??""),Ue&&lt.set("types",Ue.join(",")),w&&lt.set("bbox",w.map(bt=>bt.toFixed(6)).join(",")),O&&lt.set("country",Array.isArray(O)?O.join(","):O),!V&&!at){const bt=await RN(Ot,Ht,et);bt&&lt.set("proximity",bt),(G||!ye)&&lt.set("autocomplete","false"),lt.set("fuzzyMatch",String(tt))}_t!==void 0&&(!at||(Ue==null?void 0:Ue.length)===1)&&lt.set("limit",String(_t)),lt.set("key",u),mn(lt);const It=Fe+"/"+encodeURIComponent(q)+".json?"+lt.toString();if(It===es){V?(n(13,Te=void 0),n(51,bn=vn[0])):n(13,Te=vn);return}es=It;const vt=await fetch(It,{signal:et.signal,...Qe});if(!vt.ok)throw new Error;const dt=await vt.json();Rr("response",{url:It,featureCollection:dt}),V?(n(13,Te=void 0),n(51,bn=dt.features[0]),vn=[bn]):(n(13,Te=dt.features.filter(pt)),vn=Te,at&&xi.focus())}catch(at){if(at&&typeof at=="object"&&"name"in at&&at.name==="AbortError")return;throw at}finally{et===Di&&n(18,Di=void 0)}}function ao(){var q;if(!(Oe!=null&&Oe.length)||!J)return;const V=[180,90,-180,-90],G=!Oe.some(et=>!et.matching_text);for(const et of Oe)if(G||!et.matching_text)for(const at of[0,1,2,3])V[at]=Math[at<2?"min":"max"](V[at],((q=et.bbox)==null?void 0:q[at])??et.center[at%2]);Ot&&Oe.length>0&&(bn&&V[0]===V[2]&&V[1]===V[3]?Ot.flyTo(bn.center,hn):Ot.fitBounds(DS(V),50,he))}function vo(q){n(0,Xt=W==="always"),Xn(DN(q[0],[-180,180],!0).toFixed(6)+","+q[1].toFixed(6))}function Rs(q){if(!Te)return;let V=q.key==="ArrowDown"?1:q.key==="ArrowUp"?-1:0;V?(Dn===-1&&V===-1&&n(14,Dn=Te.length),n(14,Dn+=V),Dn>=Te.length&&n(14,Dn=-1),q.preventDefault()):["ArrowLeft","ArrowRight","Home","End"].includes(q.key)&&n(14,Dn=-1)}function No(q=!0){if(n(17,hr=void 0),ye){if(Ui&&clearTimeout(Ui),ue.length<zt)return;const V=ue;Ui=window.setTimeout(()=>{$i(V).catch(G=>n(17,hr=G))},q?j:0)}else n(13,Te=void 0),n(17,hr=void 0)}function Kr(q){n(51,bn=q),n(1,ue=q.place_name),n(14,Dn=-1)}const wi=()=>xi.focus();function ce(q){Zx[q?"unshift":"push"](()=>{xi=q,n(16,xi)})}function Gi(){ue=this.value,n(1,ue),n(12,Dr),n(26,A)}const pr=()=>n(12,Dr=!0),Os=()=>n(12,Dr=!1),Oi=()=>No(),pe=()=>{n(1,ue=""),xi.focus()},ln=()=>n(0,Xt=!Xt),tn=()=>n(17,hr=void 0),li=q=>n(14,Dn=q),ji=q=>Kr(q),Xe=()=>n(14,Dn=-1),qi=()=>{};return t.$$set=q=>{"class"in q&&n(2,f=q.class),"apiKey"in q&&n(24,u=q.apiKey),"bbox"in q&&n(25,w=q.bbox),"clearButtonTitle"in q&&n(3,S=q.clearButtonTitle),"clearOnBlur"in q&&n(26,A=q.clearOnBlur),"collapsed"in q&&n(4,N=q.collapsed),"country"in q&&n(27,O=q.country),"debounceSearch"in q&&n(28,j=q.debounceSearch),"enableReverse"in q&&n(5,W=q.enableReverse),"errorMessage"in q&&n(6,nt=q.errorMessage),"filter"in q&&n(29,pt=q.filter),"flyTo"in q&&n(30,J=q.flyTo),"fuzzyMatch"in q&&n(31,tt=q.fuzzyMatch),"language"in q&&n(32,Q=q.language),"limit"in q&&n(33,_t=q.limit),"mapController"in q&&n(34,Ot=q.mapController),"minLength"in q&&n(35,zt=q.minLength),"noResultsMessage"in q&&n(7,Rt=q.noResultsMessage),"placeholder"in q&&n(8,At=q.placeholder),"proximity"in q&&n(36,Ht=q.proximity),"reverseActive"in q&&n(0,Xt=q.reverseActive),"reverseButtonTitle"in q&&n(9,De=q.reverseButtonTitle),"searchValue"in q&&n(1,ue=q.searchValue),"showFullGeometry"in q&&n(37,on=q.showFullGeometry),"showPlaceType"in q&&n(10,Gt=q.showPlaceType),"showResultsWhileTyping"in q&&n(38,ye=q.showResultsWhileTyping),"types"in q&&n(39,Ue=q.types),"zoom"in q&&n(40,hn=q.zoom),"maxZoom"in q&&n(41,he=q.maxZoom),"apiUrl"in q&&n(42,Fe=q.apiUrl),"fetchParameters"in q&&n(43,Qe=q.fetchParameters),"iconsBaseUrl"in q&&n(11,_n=q.iconsBaseUrl),"adjustUrlQuery"in q&&n(44,mn=q.adjustUrlQuery),"$$scope"in q&&n(54,c=q.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&67112960&&setTimeout(()=>{n(15,ko=Dr),A&&!Dr&&n(1,ue="")}),t.$$.dirty[0]&8194|t.$$.dirty[1]&16&&ue.length<zt&&(n(51,bn=void 0),n(13,Te=void 0),n(17,hr=void 0),n(50,Oe=Te)),t.$$.dirty[1]&1048640&&on&&bn&&!bn.address&&bn.geometry.type==="Point"&&$i(bn.id,{byId:!0}).catch(q=>n(17,hr=q)),t.$$.dirty[0]&1073741824|t.$$.dirty[1]&3147272&&(Ot&&bn&&bn.id!==qt&&J&&(!bn.bbox||bn.bbox[0]===bn.bbox[2]&&bn.bbox[1]===bn.bbox[3]?Ot.flyTo(bn.center,bn.id.startsWith("poi.")||bn.id.startsWith("address.")?he:hn):Ot.fitBounds(DS(bn.bbox),50,he),n(13,Te=void 0),n(50,Oe=void 0),n(14,Dn=-1)),n(52,qt=bn==null?void 0:bn.id)),t.$$.dirty[0]&8192|t.$$.dirty[1]&524288&&Oe!==Te&&n(50,Oe=void 0),t.$$.dirty[1]&1572872&&Ot&&Ot.setMarkers(Oe,bn),t.$$.dirty[0]&2&&n(14,Dn=-1),t.$$.dirty[0]&40961|t.$$.dirty[1]&8&&Ot&&Ot.setEventHandler(q=>{switch(q.type){case"mapClick":Xt&&vo(q.coordinates);break;case"markerClick":{const V=Te==null?void 0:Te.find(G=>G.id===q.id);V&&Kr(V)}break;case"markerMouseEnter":n(14,Dn=ko?(Te==null?void 0:Te.findIndex(V=>V.id===q.id))??-1:-1);break;case"markerMouseLeave":n(14,Dn=-1);break}}),t.$$.dirty[0]&16384|t.$$.dirty[1]&8&&(Ot==null||Ot.setSelectedMarker(Dn)),t.$$.dirty[0]&24576&&n(53,r=Te==null?void 0:Te[Dn]),t.$$.dirty[0]&2|t.$$.dirty[1]&8){const q=/^(-?\d+(?:\.\d*)?),(-?\d+(?:\.\d*)?)$/.exec(ue);Ot==null||Ot.setReverseMarker(q?[Number(q[1]),Number(q[2])]:void 0)}t.$$.dirty[1]&4194304&&Rr("select",r),t.$$.dirty[1]&1048576&&Rr("pick",bn),t.$$.dirty[0]&40960&&Rr("optionsVisibilityChange",ko&&!!Te),t.$$.dirty[0]&8192&&Rr("featuresListed",Te),t.$$.dirty[1]&524288&&Rr("featuresMarked",Oe),t.$$.dirty[0]&1&&Rr("reverseToggle",Xt),t.$$.dirty[0]&2&&Rr("queryChange",ue),t.$$.dirty[0]&1|t.$$.dirty[1]&8&&Ot&&Ot.indicateReverse(Xt)},[Xt,ue,f,S,N,W,nt,Rt,At,De,Gt,_n,Dr,Te,Dn,ko,xi,hr,Di,Ri,Vn,Rs,No,Kr,u,w,A,O,j,pt,J,tt,Q,_t,Ot,zt,Ht,on,ye,Ue,hn,he,Fe,Qe,mn,Ke,pn,Xn,Wn,_o,Oe,bn,qt,r,c,s,wi,ce,Gi,pr,Os,Oi,pe,ln,tn,li,ji,Xe,qi]}let $N=class extends _p{constructor(t){super(),yp(this,t,UN,VN,mp,{class:2,apiKey:24,bbox:25,clearButtonTitle:3,clearOnBlur:26,collapsed:4,country:27,debounceSearch:28,enableReverse:5,errorMessage:6,filter:29,flyTo:30,fuzzyMatch:31,language:32,limit:33,mapController:34,minLength:35,noResultsMessage:7,placeholder:8,proximity:36,reverseActive:0,reverseButtonTitle:9,searchValue:1,showFullGeometry:37,showPlaceType:10,showResultsWhileTyping:38,types:39,zoom:40,maxZoom:41,apiUrl:42,fetchParameters:43,iconsBaseUrl:11,adjustUrlQuery:44,focus:45,blur:46,setQuery:47,clearList:48,clearMap:49},null,[-1,-1,-1])}get focus(){return this.$$.ctx[45]}get blur(){return this.$$.ctx[46]}get setQuery(){return this.$$.ctx[47]}get clearList(){return this.$$.ctx[48]}get clearMap(){return this.$$.ctx[49]}};/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function GN(t,e){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},r,s,c,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(S){return function(A){return w([S,A])}}function w(S){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(c=S[0]&2?s.return:S[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,S[1])).done)return c;switch(s=0,c&&(S=[S[0]&2,c.value]),S[0]){case 0:case 1:c=S;break;case 4:return n.label++,{value:S[1],done:!1};case 5:n.label++,s=S[1],S=[0];continue;case 7:S=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(S[0]===6||S[0]===2)){n=0;continue}if(S[0]===3&&(!c||S[1]>c[0]&&S[1]<c[3])){n.label=S[1];break}if(S[0]===6&&n.label<c[1]){n.label=c[1],c=S;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(S);break}c[2]&&n.ops.pop(),n.trys.pop();continue}S=e.call(t,n)}catch(A){S=[6,A],s=0}finally{r=c=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}}var rp=function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t}();function jN(t,e){return t>e?1:t<e?-1:0}function Bh(t,e,n){for(var r=new rp(null,null),s=r,c=r;;){var f=n(t,e.key);if(f<0){if(e.left===null)break;if(n(t,e.left.key)<0){var u=e.left;if(e.left=u.right,u.right=e,e=u,e.left===null)break}c.left=e,c=e,e=e.left}else if(f>0){if(e.right===null)break;if(n(t,e.right.key)>0){var u=e.right;if(e.right=u.left,u.left=e,e=u,e.right===null)break}s.right=e,s=e,e=e.right}else break}return s.right=e.left,c.left=e.right,e.left=r.right,e.right=r.left,e}function Z0(t,e,n,r){var s=new rp(t,e);if(n===null)return s.left=s.right=null,s;n=Bh(t,n,r);var c=r(t,n.key);return c<0?(s.left=n.left,s.right=n,n.left=null):c>=0&&(s.right=n.right,s.left=n,n.right=null),s}function BS(t,e,n){var r=null,s=null;if(e){e=Bh(t,e,n);var c=n(e.key,t);c===0?(r=e.left,s=e.right):c<0?(s=e.right,e.right=null,r=e):(r=e.left,e.left=null,s=e)}return{left:r,right:s}}function qN(t,e,n){return e===null?t:(t===null||(e=Bh(t.key,e,n),e.left=t),e)}function Hx(t,e,n,r,s){if(t){r(""+e+(n?" ":" ")+s(t)+`
`);var c=e+(n?"    ":"   ");t.left&&Hx(t.left,c,!1,r,s),t.right&&Hx(t.right,c,!0,r,s)}}var lw=function(){function t(e){e===void 0&&(e=jN),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=Z0(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var r=new rp(e,n);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var s=this._comparator,c=Bh(e,this._root,s),f=s(e,c.key);return f===0?this._root=c:(f<0?(r.left=c.left,r.right=c,c.left=null):f>0&&(r.right=c.right,r.left=c,c.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,r){var s;if(n===null)return null;n=Bh(e,n,r);var c=r(e,n.key);return c===0?(n.left===null?s=n.right:(s=Bh(e,n.left,r),s.right=n.right),this._size--,s):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Bh(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,r=this._comparator;n;){var s=r(e,n.key);if(s===0)return n;s<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=Bh(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,r=this._comparator;n;){var s=r(e,n.key);if(s===0)return!0;s<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var r=this._root,s=[],c=!1;!c;)r!==null?(s.push(r),r=r.left):s.length!==0?(r=s.pop(),e.call(n,r),r=r.right):c=!0;return this},t.prototype.range=function(e,n,r,s){for(var c=[],f=this._comparator,u=this._root,w;c.length!==0||u;)if(u)c.push(u),u=u.left;else{if(u=c.pop(),w=f(u.key,n),w>0)break;if(f(u.key,e)>=0&&r.call(s,u))return this;u=u.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var r=n.key;return e.push(r)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var r=n.data;return e.push(r)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,r=!1,s=0,c=[];!r;)if(n)c.push(n),n=n.left;else if(c.length>0){if(n=c.pop(),s===e)return n;s++,n=n.right}else r=!0;return null},t.prototype.next=function(e){var n=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var s=this._comparator;n;){var c=s(e.key,n.key);if(c===0)break;c<0?(r=n,n=n.left):n=n.right}return r},t.prototype.prev=function(e){var n=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var s=this._comparator;n;){var c=s(e.key,n.key);if(c===0)break;c<0?n=n.left:(r=n,n=n.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return XN(this._root)},t.prototype.load=function(e,n,r){n===void 0&&(n=[]),r===void 0&&(r=!1);var s=e.length,c=this._comparator;if(r&&Jx(e,n,0,s-1,c),this._root===null)this._root=Yx(e,n,0,s),this._size=s;else{var f=WN(this.toList(),ZN(e,n),c);s=this._size+s,this._root=Kx({head:f},0,s)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var n=[];return Hx(this._root,"",!0,function(r){return n.push(r)},e),n.join("")},t.prototype.update=function(e,n,r){var s=this._comparator,c=BS(e,this._root,s),f=c.left,u=c.right;s(e,n)<0?u=Z0(n,r,u,s):f=Z0(n,r,f,s),this._root=qN(f,u,s)},t.prototype.split=function(e){return BS(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e;return GN(this,function(n){switch(n.label){case 0:e=this.minNode(),n.label=1;case 1:return e?[4,e]:[3,3];case 2:return n.sent(),e=this.next(e),[3,1];case 3:return[2]}})},t}();function Yx(t,e,n,r){var s=r-n;if(s>0){var c=n+Math.floor(s/2),f=t[c],u=e[c],w=new rp(f,u);return w.left=Yx(t,e,n,c),w.right=Yx(t,e,c+1,r),w}return null}function ZN(t,e){for(var n=new rp(null,null),r=n,s=0;s<t.length;s++)r=r.next=new rp(t[s],e[s]);return r.next=null,n.next}function XN(t){for(var e=t,n=[],r=!1,s=new rp(null,null),c=s;!r;)e?(n.push(e),e=e.left):n.length>0?(e=c=c.next=n.pop(),e=e.right):r=!0;return c.next=null,s.next}function Kx(t,e,n){var r=n-e;if(r>0){var s=e+Math.floor(r/2),c=Kx(t,e,s),f=t.head;return f.left=c,t.head=t.head.next,f.right=Kx(t,s+1,n),f}return null}function WN(t,e,n){for(var r=new rp(null,null),s=r,c=t,f=e;c!==null&&f!==null;)n(c.key,f.key)<0?(s.next=c,c=c.next):(s.next=f,f=f.next),s=s.next;return c!==null?s.next=c:f!==null&&(s.next=f),r.next}function Jx(t,e,n,r,s){if(!(n>=r)){for(var c=t[n+r>>1],f=n-1,u=r+1;;){do f++;while(s(t[f],c)<0);do u--;while(s(t[u],c)>0);if(f>=u)break;var w=t[f];t[f]=t[u],t[u]=w,w=e[f],e[f]=e[u],e[u]=w}Jx(t,e,n,u,s),Jx(t,e,u+1,r,s)}}function Xl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ta(t,e,n){return e&&VS(t.prototype,e),n&&VS(t,n),t}var Rg=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},Qx=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x,s=t.ll.y<e.ll.y?e.ll.y:t.ll.y,c=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:n,y:s},ur:{x:r,y:c}}},$h=Number.EPSILON;$h===void 0&&($h=Math.pow(2,-52));var HN=$h*$h,t1=function(t,e){if(-$h<t&&t<$h&&-$h<e&&e<$h)return 0;var n=t-e;return n*n<HN*t*e?0:t<e?-1:1},YN=function(){function t(){Xl(this,t),this.reset()}return ta(t,[{key:"reset",value:function(){this.xRounder=new US,this.yRounder=new US}},{key:"round",value:function(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}]),t}(),US=function(){function t(){Xl(this,t),this.tree=new lw,this.round(0)}return ta(t,[{key:"round",value:function(e){var n=this.tree.add(e),r=this.tree.prev(n);if(r!==null&&t1(n.key,r.key)===0)return this.tree.remove(e),r.key;var s=this.tree.next(n);return s!==null&&t1(n.key,s.key)===0?(this.tree.remove(e),s.key):e}}]),t}(),xm=new YN,Qg=function(t,e){return t.x*e.y-t.y*e.x},t2=function(t,e){return t.x*e.x+t.y*e.y},$S=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},s={x:n.x-t.x,y:n.y-t.y},c=Qg(r,s);return t1(c,0)},z_=function(t){return Math.sqrt(t2(t,t))},KN=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},s={x:n.x-t.x,y:n.y-t.y};return Qg(s,r)/z_(s)/z_(r)},JN=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},s={x:n.x-t.x,y:n.y-t.y};return t2(s,r)/z_(s)/z_(r)},GS=function(t,e,n){return e.y===0?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},jS=function(t,e,n){return e.x===0?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},QN=function(t,e,n,r){if(e.x===0)return jS(n,r,t.x);if(r.x===0)return jS(t,e,n.x);if(e.y===0)return GS(n,r,t.y);if(r.y===0)return GS(t,e,n.y);var s=Qg(e,r);if(s==0)return null;var c={x:n.x-t.x,y:n.y-t.y},f=Qg(c,e)/s,u=Qg(c,r)/s,w=t.x+u*e.x,S=n.x+f*r.x,A=t.y+u*e.y,N=n.y+f*r.y,O=(w+S)/2,j=(A+N)/2;return{x:O,y:j}},Zu=function(){ta(t,null,[{key:"compare",value:function(e,n){var r=t.comparePoints(e.point,n.point);return r!==0?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:F_.compare(e.segment,n.segment))}},{key:"comparePoints",value:function(e,n){return e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0}}]);function t(e,n){Xl(this,t),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}return ta(t,[{key:"link",value:function(e){if(e.point===this.point)throw new Error("Tried to link already linked events");for(var n=e.point.events,r=0,s=n.length;r<s;r++){var c=n[r];this.point.events.push(c),c.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var e=this.point.events.length,n=0;n<e;n++){var r=this.point.events[n];if(r.segment.consumedBy===void 0)for(var s=n+1;s<e;s++){var c=this.point.events[s];c.consumedBy===void 0&&r.otherSE.point.events===c.otherSE.point.events&&r.segment.consume(c.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var e=[],n=0,r=this.point.events.length;n<r;n++){var s=this.point.events[n];s!==this&&!s.segment.ringOut&&s.segment.isInResult()&&e.push(s)}return e}},{key:"getLeftmostComparator",value:function(e){var n=this,r=new Map,s=function(c){var f=c.otherSE;r.set(c,{sine:KN(n.point,e.point,f.point),cosine:JN(n.point,e.point,f.point)})};return function(c,f){r.has(c)||s(c),r.has(f)||s(f);var u=r.get(c),w=u.sine,S=u.cosine,A=r.get(f),N=A.sine,O=A.cosine;return w>=0&&N>=0?S<O?1:S>O?-1:0:w<0&&N<0?S<O?-1:S>O?1:0:N<w?-1:N>w?1:0}}}]),t}(),tD=0,F_=function(){ta(t,null,[{key:"compare",value:function(e,n){var r=e.leftSE.point.x,s=n.leftSE.point.x,c=e.rightSE.point.x,f=n.rightSE.point.x;if(f<r)return 1;if(c<s)return-1;var u=e.leftSE.point.y,w=n.leftSE.point.y,S=e.rightSE.point.y,A=n.rightSE.point.y;if(r<s){if(w<u&&w<S)return 1;if(w>u&&w>S)return-1;var N=e.comparePoint(n.leftSE.point);if(N<0)return 1;if(N>0)return-1;var O=n.comparePoint(e.rightSE.point);return O!==0?O:-1}if(r>s){if(u<w&&u<A)return-1;if(u>w&&u>A)return 1;var j=n.comparePoint(e.leftSE.point);if(j!==0)return j;var W=e.comparePoint(n.rightSE.point);return W<0?1:W>0?-1:1}if(u<w)return-1;if(u>w)return 1;if(c<f){var nt=n.comparePoint(e.rightSE.point);if(nt!==0)return nt}if(c>f){var pt=e.comparePoint(n.rightSE.point);if(pt<0)return 1;if(pt>0)return-1}if(c!==f){var J=S-u,tt=c-r,Q=A-w,_t=f-s;if(J>tt&&Q<_t)return 1;if(J<tt&&Q>_t)return-1}return c>f?1:c<f||S<A?-1:S>A?1:e.id<n.id?-1:e.id>n.id?1:0}}]);function t(e,n,r,s){Xl(this,t),this.id=++tD,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=s}return ta(t,[{key:"replaceRightSE",value:function(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<n?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}},{key:"comparePoint",value:function(e){if(this.isAnEndpoint(e))return 0;var n=this.leftSE.point,r=this.rightSE.point,s=this.vector();if(n.x===r.x)return e.x===n.x?0:e.x<n.x?1:-1;var c=(e.y-n.y)/s.y,f=n.x+c*s.x;if(e.x===f)return 0;var u=(e.x-n.x)/s.x,w=n.y+u*s.y;return e.y===w?0:e.y<w?-1:1}},{key:"getIntersection",value:function(e){var n=this.bbox(),r=e.bbox(),s=Qx(n,r);if(s===null)return null;var c=this.leftSE.point,f=this.rightSE.point,u=e.leftSE.point,w=e.rightSE.point,S=Rg(n,u)&&this.comparePoint(u)===0,A=Rg(r,c)&&e.comparePoint(c)===0,N=Rg(n,w)&&this.comparePoint(w)===0,O=Rg(r,f)&&e.comparePoint(f)===0;if(A&&S)return O&&!N?f:!O&&N?w:null;if(A)return N&&c.x===w.x&&c.y===w.y?null:c;if(S)return O&&f.x===u.x&&f.y===u.y?null:u;if(O&&N)return null;if(O)return f;if(N)return w;var j=QN(c,this.vector(),u,e.vector());return j===null||!Rg(s,j)?null:xm.round(j.x,j.y)}},{key:"split",value:function(e){var n=[],r=e.events!==void 0,s=new Zu(e,!0),c=new Zu(e,!1),f=this.rightSE;this.replaceRightSE(c),n.push(c),n.push(s);var u=new t(s,f,this.rings.slice(),this.windings.slice());return Zu.comparePoints(u.leftSE.point,u.rightSE.point)>0&&u.swapEvents(),Zu.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(s.checkForConsuming(),c.checkForConsuming()),n}},{key:"swapEvents",value:function(){var e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var n=0,r=this.windings.length;n<r;n++)this.windings[n]*=-1}},{key:"consume",value:function(e){for(var n=this,r=e;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var s=t.compare(n,r);if(s!==0){if(s>0){var c=n;n=r,r=c}if(n.prev===r){var f=n;n=r,r=f}for(var u=0,w=r.rings.length;u<w;u++){var S=r.rings[u],A=r.windings[u],N=n.rings.indexOf(S);N===-1?(n.rings.push(S),n.windings.push(A)):n.windings[N]+=A}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};for(var n=this._afterState.rings,r=this._afterState.windings,s=this._afterState.multiPolys,c=0,f=this.rings.length;c<f;c++){var u=this.rings[c],w=this.windings[c],S=n.indexOf(u);S===-1?(n.push(u),r.push(w)):r[S]+=w}for(var A=[],N=[],O=0,j=n.length;O<j;O++)if(r[O]!==0){var W=n[O],nt=W.poly;if(N.indexOf(nt)===-1)if(W.isExterior)A.push(nt);else{N.indexOf(nt)===-1&&N.push(nt);var pt=A.indexOf(W.poly);pt!==-1&&A.splice(pt,1)}}for(var J=0,tt=A.length;J<tt;J++){var Q=A[J].multiPoly;s.indexOf(Q)===-1&&s.push(Q)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(pu.type){case"union":{var r=e.length===0,s=n.length===0;this._isInResult=r!==s;break}case"intersection":{var c,f;e.length<n.length?(c=e.length,f=n.length):(c=n.length,f=e.length),this._isInResult=f===pu.numMultiPolys&&c<f;break}case"xor":{var u=Math.abs(e.length-n.length);this._isInResult=u%2===1;break}case"difference":{var w=function(S){return S.length===1&&S[0].isSubject};this._isInResult=w(e)!==w(n);break}default:throw new Error("Unrecognized operation type found ".concat(pu.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,n,r){var s,c,f,u=Zu.comparePoints(e,n);if(u<0)s=e,c=n,f=1;else if(u>0)s=n,c=e,f=-1;else throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));var w=new Zu(s,!0),S=new Zu(c,!1);return new t(w,S,[r],[f])}}]),t}(),qS=function(){function t(e,n,r){if(Xl(this,t),!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var s=xm.round(e[0][0],e[0][1]);this.bbox={ll:{x:s.x,y:s.y},ur:{x:s.x,y:s.y}};for(var c=s,f=1,u=e.length;f<u;f++){if(typeof e[f][0]!="number"||typeof e[f][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var w=xm.round(e[f][0],e[f][1]);w.x===c.x&&w.y===c.y||(this.segments.push(F_.fromRing(c,w,this)),w.x<this.bbox.ll.x&&(this.bbox.ll.x=w.x),w.y<this.bbox.ll.y&&(this.bbox.ll.y=w.y),w.x>this.bbox.ur.x&&(this.bbox.ur.x=w.x),w.y>this.bbox.ur.y&&(this.bbox.ur.y=w.y),c=w)}(s.x!==c.x||s.y!==c.y)&&this.segments.push(F_.fromRing(c,s,this))}return ta(t,[{key:"getSweepEvents",value:function(){for(var e=[],n=0,r=this.segments.length;n<r;n++){var s=this.segments[n];e.push(s.leftSE),e.push(s.rightSE)}return e}}]),t}(),eD=function(){function t(e,n){if(Xl(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new qS(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,s=e.length;r<s;r++){var c=new qS(e[r],this,!1);c.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=c.bbox.ll.x),c.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=c.bbox.ll.y),c.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=c.bbox.ur.x),c.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=c.bbox.ur.y),this.interiorRings.push(c)}this.multiPoly=n}return ta(t,[{key:"getSweepEvents",value:function(){for(var e=this.exteriorRing.getSweepEvents(),n=0,r=this.interiorRings.length;n<r;n++)for(var s=this.interiorRings[n].getSweepEvents(),c=0,f=s.length;c<f;c++)e.push(s[c]);return e}}]),t}(),ZS=function(){function t(e,n){if(Xl(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,s=e.length;r<s;r++){var c=new eD(e[r],this);c.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=c.bbox.ll.x),c.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=c.bbox.ll.y),c.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=c.bbox.ur.x),c.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=c.bbox.ur.y),this.polys.push(c)}this.isSubject=n}return ta(t,[{key:"getSweepEvents",value:function(){for(var e=[],n=0,r=this.polys.length;n<r;n++)for(var s=this.polys[n].getSweepEvents(),c=0,f=s.length;c<f;c++)e.push(s[c]);return e}}]),t}(),nD=function(){ta(t,null,[{key:"factory",value:function(e){for(var n=[],r=0,s=e.length;r<s;r++){var c=e[r];if(!(!c.isInResult()||c.ringOut)){for(var f=null,u=c.leftSE,w=c.rightSE,S=[u],A=u.point,N=[];f=u,u=w,S.push(u),u.point!==A;)for(;;){var O=u.getAvailableLinkedEvents();if(O.length===0){var j=S[0].point,W=S[S.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(j.x,",")+" ".concat(j.y,"]. Last matching segment found ends at")+" [".concat(W.x,", ").concat(W.y,"]."))}if(O.length===1){w=O[0].otherSE;break}for(var nt=null,pt=0,J=N.length;pt<J;pt++)if(N[pt].point===u.point){nt=pt;break}if(nt!==null){var tt=N.splice(nt)[0],Q=S.splice(tt.index);Q.unshift(Q[0].otherSE),n.push(new t(Q.reverse()));continue}N.push({index:S.length,point:u.point});var _t=u.getLeftmostComparator(f);w=O.sort(_t)[0].otherSE;break}n.push(new t(S))}}return n}}]);function t(e){Xl(this,t),this.events=e;for(var n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}return ta(t,[{key:"getGeom",value:function(){for(var e=this.events[0].point,n=[e],r=1,s=this.events.length-1;r<s;r++){var c=this.events[r].point,f=this.events[r+1].point;$S(c,e,f)!==0&&(n.push(c),e=c)}if(n.length===1)return null;var u=n[0],w=n[1];$S(u,e,w)===0&&n.shift(),n.push(n[0]);for(var S=this.isExteriorRing()?1:-1,A=this.isExteriorRing()?0:n.length-1,N=this.isExteriorRing()?n.length:-1,O=[],j=A;j!=N;j+=S)O.push([n[j].x,n[j].y]);return O}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var e=this.events[0],n=1,r=this.events.length;n<r;n++){var s=this.events[n];Zu.compare(e,s)>0&&(e=s)}for(var c=e.segment.prevInResult(),f=c?c.prevInResult():null;;){if(!c)return null;if(!f)return c.ringOut;if(f.ringOut!==c.ringOut)return f.ringOut.enclosingRing()!==c.ringOut?c.ringOut:c.ringOut.enclosingRing();c=f.prevInResult(),f=c?c.prevInResult():null}}}]),t}(),XS=function(){function t(e){Xl(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return ta(t,[{key:"addInterior",value:function(e){this.interiorRings.push(e),e.poly=this}},{key:"getGeom",value:function(){var e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(var n=0,r=this.interiorRings.length;n<r;n++){var s=this.interiorRings[n].getGeom();s!==null&&e.push(s)}return e}}]),t}(),rD=function(){function t(e){Xl(this,t),this.rings=e,this.polys=this._composePolys(e)}return ta(t,[{key:"getGeom",value:function(){for(var e=[],n=0,r=this.polys.length;n<r;n++){var s=this.polys[n].getGeom();s!==null&&e.push(s)}return e}},{key:"_composePolys",value:function(e){for(var n=[],r=0,s=e.length;r<s;r++){var c=e[r];if(!c.poly)if(c.isExteriorRing())n.push(new XS(c));else{var f=c.enclosingRing();f.poly||n.push(new XS(f)),f.poly.addInterior(c)}}return n}}]),t}(),iD=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:F_.compare;Xl(this,t),this.queue=e,this.tree=new lw(n),this.segments=[]}return ta(t,[{key:"process",value:function(e){var n=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),r;var s=e.isLeft?this.tree.insert(n):this.tree.find(n);if(!s)throw new Error("Unable to find segment #".concat(n.id," ")+"[".concat(n.leftSE.point.x,", ").concat(n.leftSE.point.y,"] -> ")+"[".concat(n.rightSE.point.x,", ").concat(n.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var c=s,f=s,u=void 0,w=void 0;u===void 0;)c=this.tree.prev(c),c===null?u=null:c.key.consumedBy===void 0&&(u=c.key);for(;w===void 0;)f=this.tree.next(f),f===null?w=null:f.key.consumedBy===void 0&&(w=f.key);if(e.isLeft){var S=null;if(u){var A=u.getIntersection(n);if(A!==null&&(n.isAnEndpoint(A)||(S=A),!u.isAnEndpoint(A)))for(var N=this._splitSafely(u,A),O=0,j=N.length;O<j;O++)r.push(N[O])}var W=null;if(w){var nt=w.getIntersection(n);if(nt!==null&&(n.isAnEndpoint(nt)||(W=nt),!w.isAnEndpoint(nt)))for(var pt=this._splitSafely(w,nt),J=0,tt=pt.length;J<tt;J++)r.push(pt[J])}if(S!==null||W!==null){var Q=null;if(S===null)Q=W;else if(W===null)Q=S;else{var _t=Zu.comparePoints(S,W);Q=_t<=0?S:W}this.queue.remove(n.rightSE),r.push(n.rightSE);for(var Ot=n.split(Q),zt=0,Rt=Ot.length;zt<Rt;zt++)r.push(Ot[zt])}r.length>0?(this.tree.remove(n),r.push(e)):(this.segments.push(n),n.prev=u)}else{if(u&&w){var At=u.getIntersection(w);if(At!==null){if(!u.isAnEndpoint(At))for(var Ht=this._splitSafely(u,At),Xt=0,De=Ht.length;Xt<De;Xt++)r.push(Ht[Xt]);if(!w.isAnEndpoint(At))for(var ue=this._splitSafely(w,At),on=0,Gt=ue.length;on<Gt;on++)r.push(ue[on])}}this.tree.remove(n)}return r}},{key:"_splitSafely",value:function(e,n){this.tree.remove(e);var r=e.rightSE;this.queue.remove(r);var s=e.split(n);return s.push(r),e.consumedBy===void 0&&this.tree.insert(e),s}}]),t}(),WS=typeof process<"u"&&qT.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,oD=typeof process<"u"&&qT.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,sD=function(){function t(){Xl(this,t)}return ta(t,[{key:"run",value:function(e,n,r){pu.type=e,xm.reset();for(var s=[new ZS(n,!0)],c=0,f=r.length;c<f;c++)s.push(new ZS(r[c],!1));if(pu.numMultiPolys=s.length,pu.type==="difference")for(var u=s[0],w=1;w<s.length;)Qx(s[w].bbox,u.bbox)!==null?w++:s.splice(w,1);if(pu.type==="intersection"){for(var S=0,A=s.length;S<A;S++)for(var N=s[S],O=S+1,j=s.length;O<j;O++)if(Qx(N.bbox,s[O].bbox)===null)return[]}for(var W=new lw(Zu.compare),nt=0,pt=s.length;nt<pt;nt++)for(var J=s[nt].getSweepEvents(),tt=0,Q=J.length;tt<Q;tt++)if(W.insert(J[tt]),W.size>WS)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var _t=new iD(W),Ot=W.size,zt=W.pop();zt;){var Rt=zt.key;if(W.size===Ot){var At=Rt.segment;throw new Error("Unable to pop() ".concat(Rt.isLeft?"left":"right"," SweepEvent ")+"[".concat(Rt.point.x,", ").concat(Rt.point.y,"] from segment #").concat(At.id," ")+"[".concat(At.leftSE.point.x,", ").concat(At.leftSE.point.y,"] -> ")+"[".concat(At.rightSE.point.x,", ").concat(At.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(W.size>WS)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(_t.segments.length>oD)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var Ht=_t.process(Rt),Xt=0,De=Ht.length;Xt<De;Xt++){var ue=Ht[Xt];ue.consumedBy===void 0&&W.insert(ue)}Ot=W.size,zt=W.pop()}xm.reset();var on=nD.factory(_t.segments),Gt=new rD(on);return Gt.getGeom()}}]),t}(),pu=new sD,aD=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pu.run("union",t,n)},lD=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pu.run("intersection",t,n)},uD=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pu.run("xor",t,n)},cD=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pu.run("difference",t,n)},e2={union:aD,intersection:lD,xor:uD,difference:cD},Ws=63710088e-1,n2={centimeters:Ws*100,centimetres:Ws*100,degrees:Ws/111325,feet:Ws*3.28084,inches:Ws*39.37,kilometers:Ws/1e3,kilometres:Ws/1e3,meters:Ws,metres:Ws,miles:Ws/1609.344,millimeters:Ws*1e3,millimetres:Ws*1e3,nauticalmiles:Ws/1852,radians:1,yards:Ws*1.0936};function dv(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function hD(t,e,n){if(n===void 0&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!HS(t[0])||!HS(t[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:t};return dv(r,e,n)}function r2(t,e,n){n===void 0&&(n={});for(var r=0,s=t;r<s.length;r++){var c=s[r];if(c.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var f=0;f<c[c.length-1].length;f++)if(c[c.length-1][f]!==c[0][f])throw new Error("First and last Position are not equivalent.")}var u={type:"Polygon",coordinates:t};return dv(u,e,n)}function e1(t,e){e===void 0&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function i2(t,e,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:t};return dv(r,e,n)}function pD(t,e){e===void 0&&(e="kilometers");var n=n2[e];if(!n)throw new Error(e+" units is invalid");return t*n}function fD(t,e){e===void 0&&(e="kilometers");var n=n2[e];if(!n)throw new Error(e+" units is invalid");return t/n}function HS(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function B_(t){return t.type==="Feature"?t.geometry:t}function dD(t,e,n){n===void 0&&(n={});var r=B_(t),s=B_(e),c=e2.union(r.coordinates,s.coordinates);return c.length===0?null:c.length===1?r2(c[0],n.properties):i2(c,n.properties)}function o2(t,e,n){if(t!==null)for(var r,s,c,f,u,w,S,A=0,N=0,O,j=t.type,W=j==="FeatureCollection",nt=j==="Feature",pt=W?t.features.length:1,J=0;J<pt;J++){S=W?t.features[J].geometry:nt?t.geometry:t,O=S?S.type==="GeometryCollection":!1,u=O?S.geometries.length:1;for(var tt=0;tt<u;tt++){var Q=0,_t=0;if(f=O?S.geometries[tt]:S,f!==null){w=f.coordinates;var Ot=f.type;switch(A=n&&(Ot==="Polygon"||Ot==="MultiPolygon")?1:0,Ot){case null:break;case"Point":if(e(w,N,J,Q,_t)===!1)return!1;N++,Q++;break;case"LineString":case"MultiPoint":for(r=0;r<w.length;r++){if(e(w[r],N,J,Q,_t)===!1)return!1;N++,Ot==="MultiPoint"&&Q++}Ot==="LineString"&&Q++;break;case"Polygon":case"MultiLineString":for(r=0;r<w.length;r++){for(s=0;s<w[r].length-A;s++){if(e(w[r][s],N,J,Q,_t)===!1)return!1;N++}Ot==="MultiLineString"&&Q++,Ot==="Polygon"&&_t++}Ot==="Polygon"&&Q++;break;case"MultiPolygon":for(r=0;r<w.length;r++){for(_t=0,s=0;s<w[r].length;s++){for(c=0;c<w[r][s].length-A;c++){if(e(w[r][s][c],N,J,Q,_t)===!1)return!1;N++}_t++}Q++}break;case"GeometryCollection":for(r=0;r<f.geometries.length;r++)if(o2(f.geometries[r],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function YS(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var n=0;n<t.features.length&&e(t.features[n],n)!==!1;n++);}function s2(t,e){var n,r,s,c,f,u,w,S,A,N,O=0,j=t.type==="FeatureCollection",W=t.type==="Feature",nt=j?t.features.length:1;for(n=0;n<nt;n++){for(u=j?t.features[n].geometry:W?t.geometry:t,S=j?t.features[n].properties:W?t.properties:{},A=j?t.features[n].bbox:W?t.bbox:void 0,N=j?t.features[n].id:W?t.id:void 0,w=u?u.type==="GeometryCollection":!1,f=w?u.geometries.length:1,s=0;s<f;s++){if(c=w?u.geometries[s]:u,c===null){if(e(null,O,S,A,N)===!1)return!1;continue}switch(c.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(c,O,S,A,N)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<c.geometries.length;r++)if(e(c.geometries[r],O,S,A,N)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}O++}}function n1(t){var e=[1/0,1/0,-1/0,-1/0];return o2(t,function(n){e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])}),e}n1.default=n1;function gD(t,e){e===void 0&&(e={});var n=n1(t),r=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return hD([r,s],e.properties,e)}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(n+r,0):Math.min(r,n);var s=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:n;for(s=s<0?Math.max(n+arguments[2],0):Math.min(s,n);r<s;)e[r]=t,++r;return e},writable:!0});Number.isFinite=Number.isFinite||function(t){return typeof t=="number"&&isFinite(t)};Number.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(t){return t!==t};Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var Yp=function(){};Yp.prototype.interfaces_=function(){return[]};Yp.prototype.getClass=function(){return Yp};Yp.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var Nr=function(t){function e(n){t.call(this,n),this.name="IllegalArgumentException",this.message=n,this.stack=new t().stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),cn=function(){},a2={MAX_VALUE:{configurable:!0}};cn.isNaN=function(t){return Number.isNaN(t)};cn.doubleToLongBits=function(t){return t};cn.longBitsToDouble=function(t){return t};cn.isInfinite=function(t){return!Number.isFinite(t)};a2.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(cn,a2);var ka=function(){},gv=function(){},md=function(){};function Na(){}var Dt=function t(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},pf={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Dt.prototype.setOrdinate=function(t,e){switch(t){case Dt.X:this.x=e;break;case Dt.Y:this.y=e;break;case Dt.Z:this.z=e;break;default:throw new Nr("Invalid ordinate index: "+t)}};Dt.prototype.equals2D=function(){if(arguments.length===1){var t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];return!(!Yp.equalsWithTolerance(this.x,e.x,n)||!Yp.equalsWithTolerance(this.y,e.y,n))}};Dt.prototype.getOrdinate=function(t){switch(t){case Dt.X:return this.x;case Dt.Y:return this.y;case Dt.Z:return this.z}throw new Nr("Invalid ordinate index: "+t)};Dt.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||cn.isNaN(this.z))&&cn.isNaN(t.z)};Dt.prototype.equals=function(t){return t instanceof Dt?this.equals2D(t):!1};Dt.prototype.equalInZ=function(t,e){return Yp.equalsWithTolerance(this.z,t.z,e)};Dt.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0};Dt.prototype.clone=function(){};Dt.prototype.copy=function(){return new Dt(this)};Dt.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};Dt.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return Math.sqrt(e*e+n*n+r*r)};Dt.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)};Dt.prototype.hashCode=function(){var t=17;return t=37*t+Dt.hashCode(this.x),t=37*t+Dt.hashCode(this.y),t};Dt.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z};Dt.prototype.interfaces_=function(){return[ka,gv,Na]};Dt.prototype.getClass=function(){return Dt};Dt.hashCode=function(){if(arguments.length===1){var t=arguments[0],e=cn.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}};pf.DimensionalComparator.get=function(){return Dc};pf.serialVersionUID.get=function(){return 6683108902428367e3};pf.NULL_ORDINATE.get=function(){return cn.NaN};pf.X.get=function(){return 0};pf.Y.get=function(){return 1};pf.Z.get=function(){return 2};Object.defineProperties(Dt,pf);var Dc=function(t){if(this._dimensionsToTest=2,arguments.length!==0&&arguments.length===1){var e=arguments[0];if(e!==2&&e!==3)throw new Nr("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};Dc.prototype.compare=function(t,e){var n=t,r=e,s=Dc.compare(n.x,r.x);if(s!==0)return s;var c=Dc.compare(n.y,r.y);if(c!==0)return c;if(this._dimensionsToTest<=2)return 0;var f=Dc.compare(n.z,r.z);return f};Dc.prototype.interfaces_=function(){return[md]};Dc.prototype.getClass=function(){return Dc};Dc.compare=function(t,e){return t<e?-1:t>e?1:cn.isNaN(t)?cn.isNaN(e)?0:-1:cn.isNaN(e)?1:0};var yd=function(){};yd.prototype.create=function(){};yd.prototype.interfaces_=function(){return[]};yd.prototype.getClass=function(){return yd};var Bt=function(){},Um={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};Bt.prototype.interfaces_=function(){return[]};Bt.prototype.getClass=function(){return Bt};Bt.toLocationSymbol=function(t){switch(t){case Bt.EXTERIOR:return"e";case Bt.BOUNDARY:return"b";case Bt.INTERIOR:return"i";case Bt.NONE:return"-"}throw new Nr("Unknown location value: "+t)};Um.INTERIOR.get=function(){return 0};Um.BOUNDARY.get=function(){return 1};Um.EXTERIOR.get=function(){return 2};Um.NONE.get=function(){return-1};Object.defineProperties(Bt,Um);var an=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},ea=function(){},l2={LOG_10:{configurable:!0}};ea.prototype.interfaces_=function(){return[]};ea.prototype.getClass=function(){return ea};ea.log10=function(t){var e=Math.log(t);return cn.isInfinite(e)||cn.isNaN(e)?e:e/ea.LOG_10};ea.min=function(t,e,n,r){var s=t;return e<s&&(s=e),n<s&&(s=n),r<s&&(s=r),s};ea.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],s=arguments[1],c=arguments[2];return r<s?s:r>c?c:r}};ea.wrap=function(t,e){return t<0?e- -t%e:t%e};ea.max=function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],n=arguments[2],r=t;return e>r&&(r=e),n>r&&(r=n),r}else if(arguments.length===4){var s=arguments[0],c=arguments[1],f=arguments[2],u=arguments[3],w=s;return c>w&&(w=c),f>w&&(w=f),u>w&&(w=u),w}};ea.average=function(t,e){return(t+e)/2};l2.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(ea,l2);var Wl=function(t){this.str=t};Wl.prototype.append=function(t){this.str+=t};Wl.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)};Wl.prototype.toString=function(t){return this.str};var zl=function(t){this.value=t};zl.prototype.intValue=function(){return this.value};zl.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0};zl.isNaN=function(t){return Number.isNaN(t)};var wm=function(){};wm.isWhitespace=function(t){return t<=32&&t>=0||t===127};wm.toUpperCase=function(t){return t.toUpperCase()};var Zt=function t(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if(typeof arguments[0]=="string"){var r=arguments[0];t.call(this,t.parse(r))}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.init(s,c)}},sl={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Zt.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo};Zt.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),r=Zt.magnitude(n._hi),s=Zt.TEN.pow(r);n=n.divide(s),n.gt(Zt.TEN)?(n=n.divide(Zt.TEN),r+=1):n.lt(Zt.ONE)&&(n=n.multiply(Zt.TEN),r-=1);for(var c=r+1,f=new Wl,u=Zt.MAX_PRINT_DIGITS-1,w=0;w<=u;w++){t&&w===c&&f.append(".");var S=Math.trunc(n._hi);if(S<0)break;var A=!1,N=0;S>9?(A=!0,N="9"):N="0"+S,f.append(N),n=n.subtract(Zt.valueOf(S)).multiply(Zt.TEN),A&&n.selfAdd(Zt.TEN);var O=!0,j=Zt.magnitude(n._hi);if(j<0&&Math.abs(j)>=u-w&&(O=!1),!O)break}return e[0]=r,f.toString()};Zt.prototype.sqr=function(){return this.multiply(this)};Zt.prototype.doubleValue=function(){return this._hi+this._lo};Zt.prototype.subtract=function(){if(arguments[0]instanceof Zt){var t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.add(-e)}};Zt.prototype.equals=function(){if(arguments.length===1){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}};Zt.prototype.isZero=function(){return this._hi===0&&this._lo===0};Zt.prototype.selfSubtract=function(){if(arguments[0]instanceof Zt){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}};Zt.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};Zt.prototype.min=function(t){return this.le(t)?this:t};Zt.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof Zt){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfDivide(e,0)}}else if(arguments.length===2){var n=arguments[0],r=arguments[1],s=null,c=null,f=null,u=null,w=null,S=null,A=null,N=null;return w=this._hi/n,S=Zt.SPLIT*w,s=S-w,N=Zt.SPLIT*n,s=S-s,c=w-s,f=N-n,A=w*n,f=N-f,u=n-f,N=s*f-A+s*u+c*f+c*u,S=(this._hi-A-N+this._lo-w*r)/n,N=w+S,this._hi=N,this._lo=w-N+S,this}};Zt.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};Zt.prototype.divide=function(){if(arguments[0]instanceof Zt){var t=arguments[0],e=null,n=null,r=null,s=null,c=null,f=null,u=null,w=null;c=this._hi/t._hi,f=Zt.SPLIT*c,e=f-c,w=Zt.SPLIT*t._hi,e=f-e,n=c-e,r=w-t._hi,u=c*t._hi,r=w-r,s=t._hi-r,w=e*r-u+e*s+n*r+n*s,f=(this._hi-u-w+this._lo-c*t._lo)/t._hi,w=c+f;var S=w,A=c-w+f;return new Zt(S,A)}else if(typeof arguments[0]=="number"){var N=arguments[0];return cn.isNaN(N)?Zt.createNaN():Zt.copy(this).selfDivide(N,0)}};Zt.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo};Zt.prototype.pow=function(t){if(t===0)return Zt.valueOf(1);var e=new Zt(this),n=Zt.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2===1&&n.selfMultiply(e),r/=2,r>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n};Zt.prototype.ceil=function(){if(this.isNaN())return Zt.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new Zt(t,e)};Zt.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0};Zt.prototype.rint=function(){if(this.isNaN())return this;var t=this.add(.5);return t.floor()};Zt.prototype.setValue=function(){if(arguments[0]instanceof Zt){var t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.init(e),this}};Zt.prototype.max=function(t){return this.ge(t)?this:t};Zt.prototype.sqrt=function(){if(this.isZero())return Zt.valueOf(0);if(this.isNegative())return Zt.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=Zt.valueOf(e),r=this.subtract(n.sqr()),s=r._hi*(t*.5);return n.add(s)};Zt.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof Zt){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0],n=null,r=null,s=null,c=null,f=null,u=null;return s=this._hi+e,f=s-this._hi,c=s-f,c=e-f+(this._hi-c),u=c+this._lo,n=s+u,r=u+(s-n),this._hi=n+r,this._lo=r+(n-this._hi),this}}else if(arguments.length===2){var w=arguments[0],S=arguments[1],A=null,N=null,O=null,j=null,W=null,nt=null,pt=null,J=null;W=this._hi+w,O=this._lo+S,pt=W-this._hi,J=O-this._lo,nt=W-pt,j=O-J,nt=w-pt+(this._hi-nt),j=S-J+(this._lo-j),pt=nt+O,A=W+pt,N=pt+(W-A),pt=j+N;var tt=A+pt,Q=pt+(A-tt);return this._hi=tt,this._lo=Q,this}};Zt.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof Zt){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfMultiply(e,0)}}else if(arguments.length===2){var n=arguments[0],r=arguments[1],s=null,c=null,f=null,u=null,w=null,S=null;w=Zt.SPLIT*this._hi,s=w-this._hi,S=Zt.SPLIT*n,s=w-s,c=this._hi-s,f=S-n,w=this._hi*n,f=S-f,u=n-f,S=s*f-w+s*u+c*f+c*u+(this._hi*r+this._lo*n);var A=w+S;s=w-A;var N=S+s;return this._hi=A,this._lo=N,this}};Zt.prototype.selfSqr=function(){return this.selfMultiply(this)};Zt.prototype.floor=function(){if(this.isNaN())return Zt.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new Zt(t,e)};Zt.prototype.negate=function(){return this.isNaN()?this:new Zt(-this._hi,-this._lo)};Zt.prototype.clone=function(){};Zt.prototype.multiply=function(){if(arguments[0]instanceof Zt){var t=arguments[0];return t.isNaN()?Zt.createNaN():Zt.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){var e=arguments[0];return cn.isNaN(e)?Zt.createNaN():Zt.copy(this).selfMultiply(e,0)}};Zt.prototype.isNaN=function(){return cn.isNaN(this._hi)};Zt.prototype.intValue=function(){return Math.trunc(this._hi)};Zt.prototype.toString=function(){var t=Zt.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()};Zt.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),r=e[0]+1,s=n;if(n.charAt(0)===".")s="0"+n;else if(r<0)s="0."+Zt.stringOfChar("0",-r)+n;else if(n.indexOf(".")===-1){var c=r-n.length,f=Zt.stringOfChar("0",c);s=n+f+".0"}return this.isNegative()?"-"+s:s};Zt.prototype.reciprocal=function(){var t=null,e=null,n=null,r=null,s=null,c=null,f=null,u=null;s=1/this._hi,c=Zt.SPLIT*s,t=c-s,u=Zt.SPLIT*this._hi,t=c-t,e=s-t,n=u-this._hi,f=s*this._hi,n=u-n,r=this._hi-n,u=t*n-f+t*r+e*n+e*r,c=(1-f-u-s*this._lo)/this._hi;var w=s+c,S=s-w+c;return new Zt(w,S)};Zt.prototype.toSciNotation=function(){if(this.isZero())return Zt.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),r=Zt.SCI_NOT_EXPONENT_CHAR+e[0];if(n.charAt(0)==="0")throw new Error("Found leading zero: "+n);var s="";n.length>1&&(s=n.substring(1));var c=n.charAt(0)+"."+s;return this.isNegative()?"-"+c+r:c+r};Zt.prototype.abs=function(){return this.isNaN()?Zt.NaN:this.isNegative()?this.negate():new Zt(this)};Zt.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};Zt.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo};Zt.prototype.add=function(){if(arguments[0]instanceof Zt){var t=arguments[0];return Zt.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){var e=arguments[0];return Zt.copy(this).selfAdd(e)}};Zt.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof Zt){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._hi=n,this._lo=r}};Zt.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo};Zt.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};Zt.prototype.trunc=function(){return this.isNaN()?Zt.NaN:this.isPositive()?this.floor():this.ceil()};Zt.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};Zt.prototype.interfaces_=function(){return[Na,ka,gv]};Zt.prototype.getClass=function(){return Zt};Zt.sqr=function(t){return Zt.valueOf(t).selfMultiply(t)};Zt.valueOf=function(){if(typeof arguments[0]=="string"){var t=arguments[0];return Zt.parse(t)}else if(typeof arguments[0]=="number"){var e=arguments[0];return new Zt(e)}};Zt.sqrt=function(t){return Zt.valueOf(t).sqrt()};Zt.parse=function(t){for(var e=0,n=t.length;wm.isWhitespace(t.charAt(e));)e++;var r=!1;if(e<n){var s=t.charAt(e);(s==="-"||s==="+")&&(e++,s==="-"&&(r=!0))}for(var c=new Zt,f=0,u=0,w=0;!(e>=n);){var S=t.charAt(e);if(e++,wm.isDigit(S)){var A=S-"0";c.selfMultiply(Zt.TEN),c.selfAdd(A),f++;continue}if(S==="."){u=f;continue}if(S==="e"||S==="E"){var N=t.substring(e);try{w=zl.parseInt(N)}catch(pt){throw pt instanceof Error?new Error("Invalid exponent "+N+" in string "+t):pt}finally{}break}throw new Error("Unexpected character '"+S+"' at position "+e+" in string "+t)}var O=c,j=f-u-w;if(j===0)O=c;else if(j>0){var W=Zt.TEN.pow(j);O=c.divide(W)}else if(j<0){var nt=Zt.TEN.pow(-j);O=c.multiply(nt)}return r?O.negate():O};Zt.createNaN=function(){return new Zt(cn.NaN,cn.NaN)};Zt.copy=function(t){return new Zt(t)};Zt.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),r=Math.trunc(Math.floor(n)),s=Math.pow(10,r);return s*10<=e&&(r+=1),r};Zt.stringOfChar=function(t,e){for(var n=new Wl,r=0;r<e;r++)n.append(t);return n.toString()};sl.PI.get=function(){return new Zt(3.141592653589793,12246467991473532e-32)};sl.TWO_PI.get=function(){return new Zt(6.283185307179586,24492935982947064e-32)};sl.PI_2.get=function(){return new Zt(1.5707963267948966,6123233995736766e-32)};sl.E.get=function(){return new Zt(2.718281828459045,14456468917292502e-32)};sl.NaN.get=function(){return new Zt(cn.NaN,cn.NaN)};sl.EPS.get=function(){return 123259516440783e-46};sl.SPLIT.get=function(){return 134217729};sl.MAX_PRINT_DIGITS.get=function(){return 32};sl.TEN.get=function(){return Zt.valueOf(10)};sl.ONE.get=function(){return Zt.valueOf(1)};sl.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};sl.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(Zt,sl);var ps=function(){},u2={DP_SAFE_EPSILON:{configurable:!0}};ps.prototype.interfaces_=function(){return[]};ps.prototype.getClass=function(){return ps};ps.orientationIndex=function(t,e,n){var r=ps.orientationIndexFilter(t,e,n);if(r<=1)return r;var s=Zt.valueOf(e.x).selfAdd(-t.x),c=Zt.valueOf(e.y).selfAdd(-t.y),f=Zt.valueOf(n.x).selfAdd(-e.x),u=Zt.valueOf(n.y).selfAdd(-e.y);return s.selfMultiply(u).selfSubtract(c.selfMultiply(f)).signum()};ps.signOfDet2x2=function(t,e,n,r){var s=t.multiply(r).selfSubtract(e.multiply(n));return s.signum()};ps.intersection=function(t,e,n,r){var s=Zt.valueOf(r.y).selfSubtract(n.y).selfMultiply(Zt.valueOf(e.x).selfSubtract(t.x)),c=Zt.valueOf(r.x).selfSubtract(n.x).selfMultiply(Zt.valueOf(e.y).selfSubtract(t.y)),f=s.subtract(c),u=Zt.valueOf(r.x).selfSubtract(n.x).selfMultiply(Zt.valueOf(t.y).selfSubtract(n.y)),w=Zt.valueOf(r.y).selfSubtract(n.y).selfMultiply(Zt.valueOf(t.x).selfSubtract(n.x)),S=u.subtract(w),A=S.selfDivide(f).doubleValue(),N=Zt.valueOf(t.x).selfAdd(Zt.valueOf(e.x).selfSubtract(t.x).selfMultiply(A)).doubleValue(),O=Zt.valueOf(e.x).selfSubtract(t.x).selfMultiply(Zt.valueOf(t.y).selfSubtract(n.y)),j=Zt.valueOf(e.y).selfSubtract(t.y).selfMultiply(Zt.valueOf(t.x).selfSubtract(n.x)),W=O.subtract(j),nt=W.selfDivide(f).doubleValue(),pt=Zt.valueOf(n.y).selfAdd(Zt.valueOf(r.y).selfSubtract(n.y).selfMultiply(nt)).doubleValue();return new Dt(N,pt)};ps.orientationIndexFilter=function(t,e,n){var r=null,s=(t.x-n.x)*(e.y-n.y),c=(t.y-n.y)*(e.x-n.x),f=s-c;if(s>0){if(c<=0)return ps.signum(f);r=s+c}else if(s<0){if(c>=0)return ps.signum(f);r=-s-c}else return ps.signum(f);var u=ps.DP_SAFE_EPSILON*r;return f>=u||-f>=u?ps.signum(f):2};ps.signum=function(t){return t>0?1:t<0?-1:0};u2.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(ps,u2);var Bn=function(){},$m={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};$m.X.get=function(){return 0};$m.Y.get=function(){return 1};$m.Z.get=function(){return 2};$m.M.get=function(){return 3};Bn.prototype.setOrdinate=function(t,e,n){};Bn.prototype.size=function(){};Bn.prototype.getOrdinate=function(t,e){};Bn.prototype.getCoordinate=function(){};Bn.prototype.getCoordinateCopy=function(t){};Bn.prototype.getDimension=function(){};Bn.prototype.getX=function(t){};Bn.prototype.clone=function(){};Bn.prototype.expandEnvelope=function(t){};Bn.prototype.copy=function(){};Bn.prototype.getY=function(t){};Bn.prototype.toCoordinateArray=function(){};Bn.prototype.interfaces_=function(){return[gv]};Bn.prototype.getClass=function(){return Bn};Object.defineProperties(Bn,$m);var c2=function(){},Vd=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(c2),fo=function(){};fo.arraycopy=function(t,e,n,r,s){for(var c=0,f=e;f<e+s;f++)n[r+c]=t[f],c++};fo.getProperty=function(t){return{"line.separator":`
`}[t]};var Wa=function t(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var s=arguments[0],c=arguments[1];this.x=s.y*c.w-c.y*s.w,this.y=c.x*s.w-s.x*c.w,this.w=s.x*c.y-c.x*s.y}else if(arguments[0]instanceof Dt&&arguments[1]instanceof Dt){var f=arguments[0],u=arguments[1];this.x=f.y-u.y,this.y=u.x-f.x,this.w=f.x*u.y-u.x*f.y}}else if(arguments.length===3){var w=arguments[0],S=arguments[1],A=arguments[2];this.x=w,this.y=S,this.w=A}else if(arguments.length===4){var N=arguments[0],O=arguments[1],j=arguments[2],W=arguments[3],nt=N.y-O.y,pt=O.x-N.x,J=N.x*O.y-O.x*N.y,tt=j.y-W.y,Q=W.x-j.x,_t=j.x*W.y-W.x*j.y;this.x=pt*_t-Q*J,this.y=tt*J-nt*_t,this.w=nt*Q-tt*pt}};Wa.prototype.getY=function(){var t=this.y/this.w;if(cn.isNaN(t)||cn.isInfinite(t))throw new Vd;return t};Wa.prototype.getX=function(){var t=this.x/this.w;if(cn.isNaN(t)||cn.isInfinite(t))throw new Vd;return t};Wa.prototype.getCoordinate=function(){var t=new Dt;return t.x=this.getX(),t.y=this.getY(),t};Wa.prototype.interfaces_=function(){return[]};Wa.prototype.getClass=function(){return Wa};Wa.intersection=function(t,e,n,r){var s=t.y-e.y,c=e.x-t.x,f=t.x*e.y-e.x*t.y,u=n.y-r.y,w=r.x-n.x,S=n.x*r.y-r.x*n.y,A=c*S-w*f,N=u*f-s*S,O=s*w-u*c,j=A/O,W=N/O;if(cn.isNaN(j)||cn.isInfinite(j)||cn.isNaN(W)||cn.isInfinite(W))throw new Vd;return new Dt(j,W)};var He=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Dt){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.init(r.x,s.x,r.y,s.y)}else if(arguments.length===4){var c=arguments[0],f=arguments[1],u=arguments[2],w=arguments[3];this.init(c,f,u,w)}},h2={serialVersionUID:{configurable:!0}};He.prototype.getArea=function(){return this.getWidth()*this.getHeight()};He.prototype.equals=function(t){if(!(t instanceof He))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()};He.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new He;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,r=this._maxx<t._maxx?this._maxx:t._maxx,s=this._maxy<t._maxy?this._maxy:t._maxy;return new He(e,r,n,s)};He.prototype.isNull=function(){return this._maxx<this._minx};He.prototype.getMaxX=function(){return this._maxx};He.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof Dt){var t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof He){var e=arguments[0];return this.isNull()||e.isNull()?!1:e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.isNull()?!1:n>=this._minx&&n<=this._maxx&&r>=this._miny&&r<=this._maxy}};He.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof He){var t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof Dt){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.isNull()?!1:!(n>this._maxx||n<this._minx||r>this._maxy||r<this._miny)}};He.prototype.getMinY=function(){return this._miny};He.prototype.getMinX=function(){return this._minx};He.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof Dt){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof He){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=r,this._maxy=r):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}};He.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e};He.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};He.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0};He.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)};He.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};He.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};He.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};He.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e};He.prototype.expandBy=function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};He.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof He){var t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof Dt){var e=arguments[0];return this.covers(e)}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.covers(n,r)}};He.prototype.centre=function(){return this.isNull()?null:new Dt((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};He.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Dt){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof He){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(arguments.length===4){var s=arguments[0],c=arguments[1],f=arguments[2],u=arguments[3];s<c?(this._minx=s,this._maxx=c):(this._minx=c,this._maxx=s),f<u?(this._miny=f,this._maxy=u):(this._miny=u,this._maxy=f)}};He.prototype.getMaxY=function(){return this._maxy};He.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),e===0?n:n===0?e:Math.sqrt(e*e+n*n)};He.prototype.hashCode=function(){var t=17;return t=37*t+Dt.hashCode(this._minx),t=37*t+Dt.hashCode(this._maxx),t=37*t+Dt.hashCode(this._miny),t=37*t+Dt.hashCode(this._maxy),t};He.prototype.interfaces_=function(){return[ka,Na]};He.prototype.getClass=function(){return He};He.intersects=function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}else if(arguments.length===4){var r=arguments[0],s=arguments[1],c=arguments[2],f=arguments[3],u=Math.min(c.x,f.x),w=Math.max(c.x,f.x),S=Math.min(r.x,s.x),A=Math.max(r.x,s.x);return!(S>w||A<u||(u=Math.min(c.y,f.y),w=Math.max(c.y,f.y),S=Math.min(r.y,s.y),A=Math.max(r.y,s.y),S>w)||A<u)}};h2.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(He,h2);var El={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},mv=function(t){this.geometryFactory=t||new Tn};mv.prototype.read=function(t){var e,n,r;t=t.replace(/[\n\r]/g," ");var s=El.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(s=El.emptyTypeStr.exec(t),s[2]=void 0),s&&(n=s[1].toLowerCase(),r=s[2],ed[n]&&(e=ed[n].apply(this,[r]))),e===void 0)throw new Error("Could not parse WKT "+t);return e};mv.prototype.write=function(t){return this.extractGeometry(t)};mv.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!ju[e])return null;var n=e.toUpperCase(),r;return t.isEmpty()?r=n+" EMPTY":r=n+"("+ju[e].apply(this,[t])+")",r};var ju={coordinate:function(t){return t.x+" "+t.y},point:function(t){return ju.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=this,n=[],r=0,s=t._geometries.length;r<s;++r)n.push("("+ju.point.apply(e,[t._geometries[r]])+")");return n.join(",")},linestring:function(t){for(var e=this,n=[],r=0,s=t._points._coordinates.length;r<s;++r)n.push(ju.coordinate.apply(e,[t._points._coordinates[r]]));return n.join(",")},linearring:function(t){for(var e=this,n=[],r=0,s=t._points._coordinates.length;r<s;++r)n.push(ju.coordinate.apply(e,[t._points._coordinates[r]]));return n.join(",")},multilinestring:function(t){for(var e=this,n=[],r=0,s=t._geometries.length;r<s;++r)n.push("("+ju.linestring.apply(e,[t._geometries[r]])+")");return n.join(",")},polygon:function(t){var e=this,n=[];n.push("("+ju.linestring.apply(this,[t._shell])+")");for(var r=0,s=t._holes.length;r<s;++r)n.push("("+ju.linestring.apply(e,[t._holes[r]])+")");return n.join(",")},multipolygon:function(t){for(var e=this,n=[],r=0,s=t._geometries.length;r<s;++r)n.push("("+ju.polygon.apply(e,[t._geometries[r]])+")");return n.join(",")},geometrycollection:function(t){for(var e=this,n=[],r=0,s=t._geometries.length;r<s;++r)n.push(e.extractGeometry(t._geometries[r]));return n.join(",")}},ed={point:function(t){if(t===void 0)return this.geometryFactory.createPoint();var e=t.trim().split(El.spaces);return this.geometryFactory.createPoint(new Dt(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){var e=this;if(t===void 0)return this.geometryFactory.createMultiPoint();for(var n,r=t.trim().split(","),s=[],c=0,f=r.length;c<f;++c)n=r[c].replace(El.trimParens,"$1"),s.push(ed.point.apply(e,[n]));return this.geometryFactory.createMultiPoint(s)},linestring:function(t){if(t===void 0)return this.geometryFactory.createLineString();for(var e=t.trim().split(","),n=[],r,s=0,c=e.length;s<c;++s)r=e[s].trim().split(El.spaces),n.push(new Dt(Number.parseFloat(r[0]),Number.parseFloat(r[1])));return this.geometryFactory.createLineString(n)},linearring:function(t){if(t===void 0)return this.geometryFactory.createLinearRing();for(var e=t.trim().split(","),n=[],r,s=0,c=e.length;s<c;++s)r=e[s].trim().split(El.spaces),n.push(new Dt(Number.parseFloat(r[0]),Number.parseFloat(r[1])));return this.geometryFactory.createLinearRing(n)},multilinestring:function(t){var e=this;if(t===void 0)return this.geometryFactory.createMultiLineString();for(var n,r=t.trim().split(El.parenComma),s=[],c=0,f=r.length;c<f;++c)n=r[c].replace(El.trimParens,"$1"),s.push(ed.linestring.apply(e,[n]));return this.geometryFactory.createMultiLineString(s)},polygon:function(t){var e=this;if(t===void 0)return this.geometryFactory.createPolygon();for(var n,r,s,c=t.trim().split(El.parenComma),f,u=[],w=0,S=c.length;w<S;++w)n=c[w].replace(El.trimParens,"$1"),r=ed.linestring.apply(e,[n]),s=e.geometryFactory.createLinearRing(r._points),w===0?f=s:u.push(s);return this.geometryFactory.createPolygon(f,u)},multipolygon:function(t){var e=this;if(t===void 0)return this.geometryFactory.createMultiPolygon();for(var n,r=t.trim().split(El.doubleParenComma),s=[],c=0,f=r.length;c<f;++c)n=r[c].replace(El.trimParens,"$1"),s.push(ed.polygon.apply(e,[n]));return this.geometryFactory.createMultiPolygon(s)},geometrycollection:function(t){var e=this;if(t===void 0)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var n=t.trim().split("|"),r=[],s=0,c=n.length;s<c;++s)r.push(e.read(n[s]));return this.geometryFactory.createGeometryCollection(r)}},Ka=function(t){this.parser=new mv(t)};Ka.prototype.write=function(t){return this.parser.write(t)};Ka.toLineString=function(t,e){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var tc=function(t){function e(n){t.call(this,n),this.name="RuntimeException",this.message=n,this.stack=new t().stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),V_=function(t){function e(){if(t.call(this),arguments.length===0)t.call(this);else if(arguments.length===1){var n=arguments[0];t.call(this,n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(tc),yn=function(){};yn.prototype.interfaces_=function(){return[]};yn.prototype.getClass=function(){return yn};yn.shouldNeverReachHere=function(){if(arguments.length===0)yn.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new V_("Should never reach here"+(t!==null?": "+t:""))}};yn.isTrue=function(){var t,e;if(arguments.length===1)t=arguments[0],yn.isTrue(t,null);else if(arguments.length===2&&(t=arguments[0],e=arguments[1],!t))throw e===null?new V_:new V_(e)};yn.equals=function(){var t,e,n;if(arguments.length===2)t=arguments[0],e=arguments[1],yn.equals(t,e,null);else if(arguments.length===3&&(t=arguments[0],e=arguments[1],n=arguments[2],!e.equals(t)))throw new V_("Expected "+t+" but encountered "+e+(n!==null?": "+n:""))};var $r=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Dt,this._intPt[1]=new Dt,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},ff={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};$r.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]};$r.prototype.getTopologySummary=function(){var t=new Wl;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()};$r.prototype.computeIntersection=function(t,e,n,r){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(t,e,n,r)};$r.prototype.getIntersectionNum=function(){return this._result};$r.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],e=this.getEdgeDistance(t,0),n=this.getEdgeDistance(t,1);e>n?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}};$r.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};$r.prototype.setPrecisionModel=function(t){this._precisionModel=t};$r.prototype.isInteriorIntersection=function(){var t=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var e=arguments[0],n=0;n<this._result;n++)if(!(t._intPt[n].equals2D(t._inputLines[e][0])||t._intPt[n].equals2D(t._inputLines[e][1])))return!0;return!1}};$r.prototype.getIntersection=function(t){return this._intPt[t]};$r.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};$r.prototype.hasIntersection=function(){return this._result!==$r.NO_INTERSECTION};$r.prototype.getEdgeDistance=function(t,e){var n=$r.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1]);return n};$r.prototype.isCollinear=function(){return this._result===$r.COLLINEAR_INTERSECTION};$r.prototype.toString=function(){return Ka.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Ka.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};$r.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]};$r.prototype.isIntersection=function(t){for(var e=this,n=0;n<this._result;n++)if(e._intPt[n].equals2D(t))return!0;return!1};$r.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]};$r.prototype.interfaces_=function(){return[]};$r.prototype.getClass=function(){return $r};$r.computeEdgeDistance=function(t,e,n){var r=Math.abs(n.x-e.x),s=Math.abs(n.y-e.y),c=-1;if(t.equals(e))c=0;else if(t.equals(n))r>s?c=r:c=s;else{var f=Math.abs(t.x-e.x),u=Math.abs(t.y-e.y);r>s?c=f:c=u,c===0&&!t.equals(e)&&(c=Math.max(f,u))}return yn.isTrue(!(c===0&&!t.equals(e)),"Bad distance calculation"),c};$r.nonRobustComputeEdgeDistance=function(t,e,n){var r=t.x-e.x,s=t.y-e.y,c=Math.sqrt(r*r+s*s);return yn.isTrue(!(c===0&&!t.equals(e)),"Invalid distance calculation"),c};ff.DONT_INTERSECT.get=function(){return 0};ff.DO_INTERSECT.get=function(){return 1};ff.COLLINEAR.get=function(){return 2};ff.NO_INTERSECTION.get=function(){return 0};ff.POINT_INTERSECTION.get=function(){return 1};ff.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties($r,ff);var vp=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(n){var r=new He(this._inputLines[0][0],this._inputLines[0][1]),s=new He(this._inputLines[1][0],this._inputLines[1][1]);return r.contains(n)&&s.contains(n)},e.prototype.computeIntersection=function(){if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];if(this._isProper=!1,He.intersects(r,s,n)&&Ne.orientationIndex(r,s,n)===0&&Ne.orientationIndex(s,r,n)===0)return this._isProper=!0,(n.equals(r)||n.equals(s))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION}else return t.prototype.computeIntersection.apply(this,arguments)},e.prototype.normalizeToMinimum=function(n,r,s,c,f){f.x=this.smallestInAbsValue(n.x,r.x,s.x,c.x),f.y=this.smallestInAbsValue(n.y,r.y,s.y,c.y),n.x-=f.x,n.y-=f.y,r.x-=f.x,r.y-=f.y,s.x-=f.x,s.y-=f.y,c.x-=f.x,c.y-=f.y},e.prototype.safeHCoordinateIntersection=function(n,r,s,c){var f=null;try{f=Wa.intersection(n,r,s,c)}catch(u){if(u instanceof Vd)f=e.nearestEndpoint(n,r,s,c);else throw u}finally{}return f},e.prototype.intersection=function(n,r,s,c){var f=this.intersectionWithNormalization(n,r,s,c);return this.isInSegmentEnvelopes(f)||(f=new Dt(e.nearestEndpoint(n,r,s,c))),this._precisionModel!==null&&this._precisionModel.makePrecise(f),f},e.prototype.smallestInAbsValue=function(n,r,s,c){var f=n,u=Math.abs(f);return Math.abs(r)<u&&(f=r,u=Math.abs(r)),Math.abs(s)<u&&(f=s,u=Math.abs(s)),Math.abs(c)<u&&(f=c),f},e.prototype.checkDD=function(n,r,s,c,f){var u=ps.intersection(n,r,s,c),w=this.isInSegmentEnvelopes(u);fo.out.println("DD in env = "+w+"  --------------------- "+u),f.distance(u)>1e-4&&fo.out.println("Distance = "+f.distance(u))},e.prototype.intersectionWithNormalization=function(n,r,s,c){var f=new Dt(n),u=new Dt(r),w=new Dt(s),S=new Dt(c),A=new Dt;this.normalizeToEnvCentre(f,u,w,S,A);var N=this.safeHCoordinateIntersection(f,u,w,S);return N.x+=A.x,N.y+=A.y,N},e.prototype.computeCollinearIntersection=function(n,r,s,c){var f=He.intersects(n,r,s),u=He.intersects(n,r,c),w=He.intersects(s,c,n),S=He.intersects(s,c,r);return f&&u?(this._intPt[0]=s,this._intPt[1]=c,t.COLLINEAR_INTERSECTION):w&&S?(this._intPt[0]=n,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):f&&w?(this._intPt[0]=s,this._intPt[1]=n,s.equals(n)&&!u&&!S?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):f&&S?(this._intPt[0]=s,this._intPt[1]=r,s.equals(r)&&!u&&!w?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):u&&w?(this._intPt[0]=c,this._intPt[1]=n,c.equals(n)&&!f&&!S?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):u&&S?(this._intPt[0]=c,this._intPt[1]=r,c.equals(r)&&!f&&!w?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(n,r,s,c,f){var u=n.x<r.x?n.x:r.x,w=n.y<r.y?n.y:r.y,S=n.x>r.x?n.x:r.x,A=n.y>r.y?n.y:r.y,N=s.x<c.x?s.x:c.x,O=s.y<c.y?s.y:c.y,j=s.x>c.x?s.x:c.x,W=s.y>c.y?s.y:c.y,nt=u>N?u:N,pt=S<j?S:j,J=w>O?w:O,tt=A<W?A:W,Q=(nt+pt)/2,_t=(J+tt)/2;f.x=Q,f.y=_t,n.x-=f.x,n.y-=f.y,r.x-=f.x,r.y-=f.y,s.x-=f.x,s.y-=f.y,c.x-=f.x,c.y-=f.y},e.prototype.computeIntersect=function(n,r,s,c){if(this._isProper=!1,!He.intersects(n,r,s,c))return t.NO_INTERSECTION;var f=Ne.orientationIndex(n,r,s),u=Ne.orientationIndex(n,r,c);if(f>0&&u>0||f<0&&u<0)return t.NO_INTERSECTION;var w=Ne.orientationIndex(s,c,n),S=Ne.orientationIndex(s,c,r);if(w>0&&S>0||w<0&&S<0)return t.NO_INTERSECTION;var A=f===0&&u===0&&w===0&&S===0;return A?this.computeCollinearIntersection(n,r,s,c):(f===0||u===0||w===0||S===0?(this._isProper=!1,n.equals2D(s)||n.equals2D(c)?this._intPt[0]=n:r.equals2D(s)||r.equals2D(c)?this._intPt[0]=r:f===0?this._intPt[0]=new Dt(s):u===0?this._intPt[0]=new Dt(c):w===0?this._intPt[0]=new Dt(n):S===0&&(this._intPt[0]=new Dt(r))):(this._isProper=!0,this._intPt[0]=this.intersection(n,r,s,c)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(n,r,s,c){var f=n,u=Ne.distancePointLine(n,s,c),w=Ne.distancePointLine(r,s,c);return w<u&&(u=w,f=r),w=Ne.distancePointLine(s,n,r),w<u&&(u=w,f=s),w=Ne.distancePointLine(c,n,r),w<u&&(u=w,f=c),f},e}($r),Kp=function(){};Kp.prototype.interfaces_=function(){return[]};Kp.prototype.getClass=function(){return Kp};Kp.orientationIndex=function(t,e,n){var r=e.x-t.x,s=e.y-t.y,c=n.x-e.x,f=n.y-e.y;return Kp.signOfDet2x2(r,s,c,f)};Kp.signOfDet2x2=function(t,e,n,r){var s=null,c=null,f=null;if(s=1,t===0||r===0)return e===0||n===0?0:e>0?n>0?-s:s:n>0?s:-s;if(e===0||n===0)return r>0?t>0?s:-s:t>0?-s:s;if(e>0?r>0?e<=r||(s=-s,c=t,t=n,n=c,c=e,e=r,r=c):e<=-r?(s=-s,n=-n,r=-r):(c=t,t=-n,n=c,c=e,e=-r,r=c):r>0?-e<=r?(s=-s,t=-t,e=-e):(c=-t,t=n,n=c,c=-e,e=r,r=c):e>=r?(t=-t,e=-e,n=-n,r=-r):(s=-s,c=-t,t=-n,n=c,c=-e,e=-r,r=c),t>0)if(n>0){if(!(t<=n))return s}else return s;else{if(n>0)return-s;if(t>=n)s=-s,t=-t,n=-n;else return-s}for(;;){if(f=Math.floor(n/t),n=n-f*t,r=r-f*e,r<0)return-s;if(r>e)return s;if(t>n+n){if(e<r+r)return s}else{if(e>r+r)return-s;n=t-n,r=e-r,s=-s}if(r===0)return n===0?0:-s;if(n===0||(f=Math.floor(t/n),t=t-f*n,e=e-f*r,e<0))return s;if(e>r)return-s;if(n>t+t){if(r<e+e)return-s}else{if(r>e+e)return s;t=n-t,e=r-e,s=-s}if(e===0)return t===0?0:s;if(t===0)return-s}};var Nl=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};Nl.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,r=e.x;return n>r&&(n=e.x,r=t.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var s=t.x-this._p.x,c=t.y-this._p.y,f=e.x-this._p.x,u=e.y-this._p.y,w=Kp.signOfDet2x2(s,c,f,u);if(w===0)return this._isPointOnSegment=!0,null;u<c&&(w=-w),w>0&&this._crossingCount++}};Nl.prototype.isPointInPolygon=function(){return this.getLocation()!==Bt.EXTERIOR};Nl.prototype.getLocation=function(){return this._isPointOnSegment?Bt.BOUNDARY:this._crossingCount%2===1?Bt.INTERIOR:Bt.EXTERIOR};Nl.prototype.isOnSegment=function(){return this._isPointOnSegment};Nl.prototype.interfaces_=function(){return[]};Nl.prototype.getClass=function(){return Nl};Nl.locatePointInRing=function(){if(arguments[0]instanceof Dt&&an(arguments[1],Bn)){for(var t=arguments[0],e=arguments[1],n=new Nl(t),r=new Dt,s=new Dt,c=1;c<e.size();c++)if(e.getCoordinate(c,r),e.getCoordinate(c-1,s),n.countSegment(r,s),n.isOnSegment())return n.getLocation();return n.getLocation()}else if(arguments[0]instanceof Dt&&arguments[1]instanceof Array){for(var f=arguments[0],u=arguments[1],w=new Nl(f),S=1;S<u.length;S++){var A=u[S],N=u[S-1];if(w.countSegment(A,N),w.isOnSegment())return w.getLocation()}return w.getLocation()}};var Ne=function(){},df={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Ne.prototype.interfaces_=function(){return[]};Ne.prototype.getClass=function(){return Ne};Ne.orientationIndex=function(t,e,n){return ps.orientationIndex(t,e,n)};Ne.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,r=1;r<t.length-1;r++){var s=t[r].x-n,c=t[r+1].y,f=t[r-1].y;e+=s*(f-c)}return e/2}else if(an(arguments[0],Bn)){var u=arguments[0],w=u.size();if(w<3)return 0;var S=new Dt,A=new Dt,N=new Dt;u.getCoordinate(0,A),u.getCoordinate(1,N);var O=A.x;N.x-=O;for(var j=0,W=1;W<w-1;W++)S.y=A.y,A.x=N.x,A.y=N.y,u.getCoordinate(W+1,N),N.x-=O,j+=A.x*(S.y-N.y);return j/2}};Ne.distanceLineLine=function(t,e,n,r){if(t.equals(e))return Ne.distancePointLine(t,n,r);if(n.equals(r))return Ne.distancePointLine(r,t,e);var s=!1;if(!He.intersects(t,e,n,r))s=!0;else{var c=(e.x-t.x)*(r.y-n.y)-(e.y-t.y)*(r.x-n.x);if(c===0)s=!0;else{var f=(t.y-n.y)*(r.x-n.x)-(t.x-n.x)*(r.y-n.y),u=(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y),w=u/c,S=f/c;(S<0||S>1||w<0||w>1)&&(s=!0)}}return s?ea.min(Ne.distancePointLine(t,n,r),Ne.distancePointLine(e,n,r),Ne.distancePointLine(n,t,e),Ne.distancePointLine(r,t,e)):0};Ne.isPointInRing=function(t,e){return Ne.locatePointInRing(t,e)!==Bt.EXTERIOR};Ne.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,r=new Dt;t.getCoordinate(0,r);for(var s=r.x,c=r.y,f=1;f<e;f++){t.getCoordinate(f,r);var u=r.x,w=r.y,S=u-s,A=w-c;n+=Math.sqrt(S*S+A*A),s=u,c=w}return n};Ne.isCCW=function(t){var e=t.length-1;if(e<3)throw new Nr("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,s=1;s<=e;s++){var c=t[s];c.y>n.y&&(n=c,r=s)}var f=r;do f=f-1,f<0&&(f=e);while(t[f].equals2D(n)&&f!==r);var u=r;do u=(u+1)%e;while(t[u].equals2D(n)&&u!==r);var w=t[f],S=t[u];if(w.equals2D(n)||S.equals2D(n)||w.equals2D(S))return!1;var A=Ne.computeOrientation(w,n,S),N=!1;return A===0?N=w.x>S.x:N=A>0,N};Ne.locatePointInRing=function(t,e){return Nl.locatePointInRing(t,e)};Ne.distancePointLinePerpendicular=function(t,e,n){var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),s=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(s)*Math.sqrt(r)};Ne.computeOrientation=function(t,e,n){return Ne.orientationIndex(t,e,n)};Ne.distancePointLine=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(e.length===0)throw new Nr("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var s=Ne.distancePointLine(t,e[r],e[r+1]);s<n&&(n=s)}return n}else if(arguments.length===3){var c=arguments[0],f=arguments[1],u=arguments[2];if(f.x===u.x&&f.y===u.y)return c.distance(f);var w=(u.x-f.x)*(u.x-f.x)+(u.y-f.y)*(u.y-f.y),S=((c.x-f.x)*(u.x-f.x)+(c.y-f.y)*(u.y-f.y))/w;if(S<=0)return c.distance(f);if(S>=1)return c.distance(u);var A=((f.y-c.y)*(u.x-f.x)-(f.x-c.x)*(u.y-f.y))/w;return Math.abs(A)*Math.sqrt(w)}};Ne.isOnLine=function(t,e){for(var n=new vp,r=1;r<e.length;r++){var s=e[r-1],c=e[r];if(n.computeIntersection(t,s,c),n.hasIntersection())return!0}return!1};df.CLOCKWISE.get=function(){return-1};df.RIGHT.get=function(){return Ne.CLOCKWISE};df.COUNTERCLOCKWISE.get=function(){return 1};df.LEFT.get=function(){return Ne.COUNTERCLOCKWISE};df.COLLINEAR.get=function(){return 0};df.STRAIGHT.get=function(){return Ne.COLLINEAR};Object.defineProperties(Ne,df);var ec=function(){};ec.prototype.filter=function(t){};ec.prototype.interfaces_=function(){return[]};ec.prototype.getClass=function(){return ec};var sn=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},Tu={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};sn.prototype.isGeometryCollection=function(){return this.getSortIndex()===sn.SORTINDEX_GEOMETRYCOLLECTION};sn.prototype.getFactory=function(){return this._factory};sn.prototype.getGeometryN=function(t){return this};sn.prototype.getArea=function(){return 0};sn.prototype.isRectangle=function(){return!1};sn.prototype.equals=function(){if(arguments[0]instanceof sn){var t=arguments[0];return t===null?!1:this.equalsTopo(t)}else if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof sn))return!1;var n=e;return this.equalsExact(n)}};sn.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)};sn.prototype.geometryChanged=function(){this.apply(sn.geometryChangedFilter)};sn.prototype.geometryChangedAction=function(){this._envelope=null};sn.prototype.equalsNorm=function(t){return t===null?!1:this.norm().equalsExact(t.norm())};sn.prototype.getLength=function(){return 0};sn.prototype.getNumGeometries=function(){return 1};sn.prototype.compareTo=function(){if(arguments.length===1){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,r)}};sn.prototype.getUserData=function(){return this._userData};sn.prototype.getSRID=function(){return this._SRID};sn.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};sn.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===sn.SORTINDEX_GEOMETRYCOLLECTION)throw new Nr("This method does not support GeometryCollection arguments")};sn.prototype.equal=function(t,e,n){return n===0?t.equals(e):t.distance(e)<=n};sn.prototype.norm=function(){var t=this.copy();return t.normalize(),t};sn.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};sn.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new He(this._envelope)};sn.prototype.setSRID=function(t){this._SRID=t};sn.prototype.setUserData=function(t){this._userData=t};sn.prototype.compare=function(t,e){for(var n=t.iterator(),r=e.iterator();n.hasNext()&&r.hasNext();){var s=n.next(),c=r.next(),f=s.compareTo(c);if(f!==0)return f}return n.hasNext()?1:r.hasNext()?-1:0};sn.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};sn.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===sn.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===sn.SORTINDEX_MULTIPOINT||this.getSortIndex()===sn.SORTINDEX_MULTILINESTRING||this.getSortIndex()===sn.SORTINDEX_MULTIPOLYGON};sn.prototype.interfaces_=function(){return[gv,ka,Na]};sn.prototype.getClass=function(){return sn};sn.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1};sn.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(t[e]===null)return!0;return!1};Tu.serialVersionUID.get=function(){return 8763622679187377e3};Tu.SORTINDEX_POINT.get=function(){return 0};Tu.SORTINDEX_MULTIPOINT.get=function(){return 1};Tu.SORTINDEX_LINESTRING.get=function(){return 2};Tu.SORTINDEX_LINEARRING.get=function(){return 3};Tu.SORTINDEX_MULTILINESTRING.get=function(){return 4};Tu.SORTINDEX_POLYGON.get=function(){return 5};Tu.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Tu.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Tu.geometryChangedFilter.get=function(){return uw};Object.defineProperties(sn,Tu);var uw=function(){};uw.interfaces_=function(){return[ec]};uw.filter=function(t){t.geometryChangedAction()};var _u=function(){};_u.prototype.filter=function(t){};_u.prototype.interfaces_=function(){return[]};_u.prototype.getClass=function(){return _u};var Ma=function(){},sc={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Ma.prototype.isInBoundary=function(t){};Ma.prototype.interfaces_=function(){return[]};Ma.prototype.getClass=function(){return Ma};sc.Mod2BoundaryNodeRule.get=function(){return _d};sc.EndPointBoundaryNodeRule.get=function(){return vd};sc.MultiValentEndPointBoundaryNodeRule.get=function(){return xd};sc.MonoValentEndPointBoundaryNodeRule.get=function(){return wd};sc.MOD2_BOUNDARY_RULE.get=function(){return new _d};sc.ENDPOINT_BOUNDARY_RULE.get=function(){return new vd};sc.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new xd};sc.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new wd};sc.OGC_SFS_BOUNDARY_RULE.get=function(){return Ma.MOD2_BOUNDARY_RULE};Object.defineProperties(Ma,sc);var _d=function(){};_d.prototype.isInBoundary=function(t){return t%2===1};_d.prototype.interfaces_=function(){return[Ma]};_d.prototype.getClass=function(){return _d};var vd=function(){};vd.prototype.isInBoundary=function(t){return t>0};vd.prototype.interfaces_=function(){return[Ma]};vd.prototype.getClass=function(){return vd};var xd=function(){};xd.prototype.isInBoundary=function(t){return t>1};xd.prototype.interfaces_=function(){return[Ma]};xd.prototype.getClass=function(){return xd};var wd=function(){};wd.prototype.isInBoundary=function(t){return t===1};wd.prototype.interfaces_=function(){return[Ma]};wd.prototype.getClass=function(){return wd};var Ci=function(){};Ci.prototype.add=function(){};Ci.prototype.addAll=function(){};Ci.prototype.isEmpty=function(){};Ci.prototype.iterator=function(){};Ci.prototype.size=function(){};Ci.prototype.toArray=function(){};Ci.prototype.remove=function(){};function cw(t){this.message=t||""}cw.prototype=new Error;cw.prototype.name="IndexOutOfBoundsException";var Ud=function(){};Ud.prototype.hasNext=function(){};Ud.prototype.next=function(){};Ud.prototype.remove=function(){};var Ha=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Ci);function $d(t){this.message=t||""}$d.prototype=new Error;$d.prototype.name="NoSuchElementException";var be=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ci&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,Ci]},e.prototype.add=function(n){return arguments.length===1?this.array_.push(n):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(n){for(var r=this,s=n.iterator();s.hasNext();)r.add(s.next());return!0},e.prototype.set=function(n,r){var s=this.array_[n];return this.array_[n]=r,s},e.prototype.iterator=function(){return new mD(this)},e.prototype.get=function(n){if(n<0||n>=this.size())throw new cw;return this.array_[n]},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var n=this,r=[],s=0,c=this.array_.length;s<c;s++)r.push(n.array_[s]);return r},e.prototype.remove=function(n){for(var r=this,s=!1,c=0,f=this.array_.length;c<f;c++)if(r.array_[c]===n){r.array_.splice(c,1),s=!0;break}return s},e}(Ha),mD=function(t){function e(n){t.call(this),this.arrayList_=n,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new $d;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(n){return this.arrayList_.set(this.position_-1,n)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(Ud),Gm=function(t){function e(){if(t.call(this),arguments.length!==0){if(arguments.length===1){var r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.ensureCapacity(s.length),this.add(s,c)}}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(r){return this.get(r)},e.prototype.addAll=function(){var r=this;if(arguments.length===2){for(var s=arguments[0],c=arguments[1],f=!1,u=s.iterator();u.hasNext();)r.add(u.next(),c),f=!0;return f}else return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var r=this,s=t.prototype.clone.call(this),c=0;c<this.size();c++)s.add(c,r.get(c).copy());return s},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){var r=this;if(arguments.length===1){var s=arguments[0];t.prototype.add.call(this,s)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var c=arguments[0],f=arguments[1];return this.add(c,f,!0),!0}else if(arguments[0]instanceof Dt&&typeof arguments[1]=="boolean"){var u=arguments[0],w=arguments[1];if(!w&&this.size()>=1){var S=this.get(this.size()-1);if(S.equals2D(u))return null}t.prototype.add.call(this,u)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var A=arguments[0],N=arguments[1];return this.add(A,N),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var O=arguments[0],j=arguments[1],W=arguments[2];if(W)for(var nt=0;nt<O.length;nt++)r.add(O[nt],j);else for(var pt=O.length-1;pt>=0;pt--)r.add(O[pt],j);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Dt){var J=arguments[0],tt=arguments[1],Q=arguments[2];if(!Q){var _t=this.size();if(_t>0){if(J>0){var Ot=this.get(J-1);if(Ot.equals2D(tt))return null}if(J<_t){var zt=this.get(J);if(zt.equals2D(tt))return null}}}t.prototype.add.call(this,J,tt)}}else if(arguments.length===4){var Rt=arguments[0],At=arguments[1],Ht=arguments[2],Xt=arguments[3],De=1;Ht>Xt&&(De=-1);for(var ue=Ht;ue!==Xt;ue+=De)r.add(Rt[ue],At);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new Dt(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(be),Pn=function(){},yv={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};yv.ForwardComparator.get=function(){return bm};yv.BidirectionalComparator.get=function(){return bd};yv.coordArrayType.get=function(){return new Array(0).fill(null)};Pn.prototype.interfaces_=function(){return[]};Pn.prototype.getClass=function(){return Pn};Pn.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))};Pn.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(Pn.indexOf(r,e)<0)return r}return null};Pn.scroll=function(t,e){var n=Pn.indexOf(e,t);if(n<0)return null;var r=new Array(t.length).fill(null);fo.arraycopy(t,n,r,0,t.length-n),fo.arraycopy(t,0,r,t.length-n,n),fo.arraycopy(r,0,t,0,t.length)};Pn.equals=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(t===null||e===null||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];if(r===s)return!0;if(r===null||s===null||r.length!==s.length)return!1;for(var f=0;f<r.length;f++)if(c.compare(r[f],s[f])!==0)return!1;return!0}};Pn.intersection=function(t,e){for(var n=new Gm,r=0;r<t.length;r++)e.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()};Pn.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1};Pn.removeRepeatedPoints=function(t){if(!Pn.hasRepeatedPoints(t))return t;var e=new Gm(t,!1);return e.toCoordinateArray()};Pn.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),r=0;r<=n;r++){var s=t[r];t[r]=t[e-r],t[e-r]=s}};Pn.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)t[n]!==null&&e++;var r=new Array(e).fill(null);if(e===0)return r;for(var s=0,c=0;c<t.length;c++)t[c]!==null&&(r[s++]=t[c]);return r};Pn.copyDeep=function(){if(arguments.length===1){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new Dt(t[n]);return e}else if(arguments.length===5)for(var r=arguments[0],s=arguments[1],c=arguments[2],f=arguments[3],u=arguments[4],w=0;w<u;w++)c[f+w]=new Dt(r[s+w])};Pn.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var r=t[n],s=e[t.length-n-1];if(r.compareTo(s)!==0)return!1}return!0};Pn.envelope=function(t){for(var e=new He,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e};Pn.toCoordinateArray=function(t){return t.toArray(Pn.coordArrayType)};Pn.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]};Pn.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1};Pn.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,r=t[e].compareTo(t[n]);if(r!==0)return r}return 1};Pn.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var r=t[n].compareTo(e[n]);if(r!==0)return r;n++}return n<e.length?-1:n<t.length?1:0};Pn.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(e===null||e.compareTo(t[n])>0)&&(e=t[n]);return e};Pn.extract=function(t,e,n){e=ea.clamp(e,0,t.length),n=ea.clamp(n,-1,t.length);var r=n-e+1;n<0&&(r=0),e>=t.length&&(r=0),n<e&&(r=0);var s=new Array(r).fill(null);if(r===0)return s;for(var c=0,f=e;f<=n;f++)s[c++]=t[f];return s};Object.defineProperties(Pn,yv);var bm=function(){};bm.prototype.compare=function(t,e){var n=t,r=e;return Pn.compare(n,r)};bm.prototype.interfaces_=function(){return[md]};bm.prototype.getClass=function(){return bm};var bd=function(){};bd.prototype.compare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(n.length===0)return 0;var s=Pn.compare(n,r),c=Pn.isEqualReversed(n,r);return c?0:s};bd.prototype.OLDcompare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(n.length===0)return 0;for(var s=Pn.increasingDirection(n),c=Pn.increasingDirection(r),f=s>0?0:n.length-1,u=c>0?0:n.length-1,w=0;w<n.length;w++){var S=n[f].compareTo(r[u]);if(S!==0)return S;f+=s,u+=c}return 0};bd.prototype.interfaces_=function(){return[md]};bd.prototype.getClass=function(){return bd};var gf=function(){};gf.prototype.get=function(){};gf.prototype.put=function(){};gf.prototype.size=function(){};gf.prototype.values=function(){};gf.prototype.entrySet=function(){};var yD=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(gf);function jm(t){this.message=t||""}jm.prototype=new Error;jm.prototype.name="OperationNotSupported";function _v(){}_v.prototype=new Ci;_v.prototype.contains=function(){};var hw=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ci&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(n){for(var r=this,s=0,c=this.array_.length;s<c;s++){var f=r.array_[s];if(f===n)return!0}return!1},e.prototype.add=function(n){return this.contains(n)?!1:(this.array_.push(n),!0)},e.prototype.addAll=function(n){for(var r=this,s=n.iterator();s.hasNext();)r.add(s.next());return!0},e.prototype.remove=function(n){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.toArray=function(){for(var n=this,r=[],s=0,c=this.array_.length;s<c;s++)r.push(n.array_[s]);return r},e.prototype.iterator=function(){return new _D(this)},e}(_v),_D=function(t){function e(n){t.call(this),this.hashSet_=n,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new $d;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new jm},e}(Ud),Xu=0,Nh=1;function KS(t){return t===null?Xu:t.color}function yr(t){return t===null?null:t.parent}function $u(t,e){t!==null&&(t.color=e)}function X0(t){return t===null?null:t.left}function JS(t){return t===null?null:t.right}function Mo(){this.root_=null,this.size_=0}Mo.prototype=new yD;Mo.prototype.get=function(t){for(var e=this.root_;e!==null;){var n=t.compareTo(e.key);if(n<0)e=e.left;else if(n>0)e=e.right;else return e.value}return null};Mo.prototype.put=function(t,e){if(this.root_===null)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Xu,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n=this.root_,r,s;do if(r=n,s=t.compareTo(n.key),s<0)n=n.left;else if(s>0)n=n.right;else{var c=n.value;return n.value=e,c}while(n!==null);var f={key:t,left:null,right:null,value:e,parent:r,color:Xu,getValue:function(){return this.value},getKey:function(){return this.key}};return s<0?r.left=f:r.right=f,this.fixAfterInsertion(f),this.size_++,null};Mo.prototype.fixAfterInsertion=function(t){var e=this;for(t.color=Nh;t!=null&&t!==this.root_&&t.parent.color===Nh;)if(yr(t)===X0(yr(yr(t)))){var n=JS(yr(yr(t)));KS(n)===Nh?($u(yr(t),Xu),$u(n,Xu),$u(yr(yr(t)),Nh),t=yr(yr(t))):(t===JS(yr(t))&&(t=yr(t),e.rotateLeft(t)),$u(yr(t),Xu),$u(yr(yr(t)),Nh),e.rotateRight(yr(yr(t))))}else{var r=X0(yr(yr(t)));KS(r)===Nh?($u(yr(t),Xu),$u(r,Xu),$u(yr(yr(t)),Nh),t=yr(yr(t))):(t===X0(yr(t))&&(t=yr(t),e.rotateRight(t)),$u(yr(t),Xu),$u(yr(yr(t)),Nh),e.rotateLeft(yr(yr(t))))}this.root_.color=Xu};Mo.prototype.values=function(){var t=new be,e=this.getFirstEntry();if(e!==null)for(t.add(e.value);(e=Mo.successor(e))!==null;)t.add(e.value);return t};Mo.prototype.entrySet=function(){var t=new hw,e=this.getFirstEntry();if(e!==null)for(t.add(e);(e=Mo.successor(e))!==null;)t.add(e);return t};Mo.prototype.rotateLeft=function(t){if(t!=null){var e=t.right;t.right=e.left,e.left!=null&&(e.left.parent=t),e.parent=t.parent,t.parent===null?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}};Mo.prototype.rotateRight=function(t){if(t!=null){var e=t.left;t.left=e.right,e.right!=null&&(e.right.parent=t),e.parent=t.parent,t.parent===null?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}};Mo.prototype.getFirstEntry=function(){var t=this.root_;if(t!=null)for(;t.left!=null;)t=t.left;return t};Mo.successor=function(t){if(t===null)return null;if(t.right!==null){for(var e=t.right;e.left!==null;)e=e.left;return e}else{for(var n=t.parent,r=t;n!==null&&r===n.right;)r=n,n=n.parent;return n}};Mo.prototype.size=function(){return this.size_};var Em=function(){};Em.prototype.interfaces_=function(){return[]};Em.prototype.getClass=function(){return Em};function p2(){}p2.prototype=new _v;function Fl(){this.array_=[],arguments[0]instanceof Ci&&this.addAll(arguments[0])}Fl.prototype=new p2;Fl.prototype.contains=function(t){for(var e=this,n=0,r=this.array_.length;n<r;n++){var s=e.array_[n];if(s.compareTo(t)===0)return!0}return!1};Fl.prototype.add=function(t){var e=this;if(this.contains(t))return!1;for(var n=0,r=this.array_.length;n<r;n++){var s=e.array_[n];if(s.compareTo(t)===1)return e.array_.splice(n,0,t),!0}return this.array_.push(t),!0};Fl.prototype.addAll=function(t){for(var e=this,n=t.iterator();n.hasNext();)e.add(n.next());return!0};Fl.prototype.remove=function(t){throw new jm};Fl.prototype.size=function(){return this.array_.length};Fl.prototype.isEmpty=function(){return this.array_.length===0};Fl.prototype.toArray=function(){for(var t=this,e=[],n=0,r=this.array_.length;n<r;n++)e.push(t.array_[n]);return e};Fl.prototype.iterator=function(){return new vv(this)};var vv=function(t){this.treeSet_=t,this.position_=0};vv.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new $d;return this.treeSet_.array_[this.position_++]};vv.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};vv.prototype.remove=function(){throw new jm};var Kh=function(){};Kh.sort=function(){var t=arguments[0],e,n,r,s;if(arguments.length===1)s=function(f,u){return f.compareTo(u)},t.sort(s);else if(arguments.length===2)r=arguments[1],s=function(f,u){return r.compare(f,u)},t.sort(s);else if(arguments.length===3){n=t.slice(arguments[1],arguments[2]),n.sort();var c=t.slice(0,arguments[1]).concat(n,t.slice(arguments[2],t.length));for(t.splice(0,t.length),e=0;e<c.length;e++)t.push(c[e])}else if(arguments.length===4)for(n=t.slice(arguments[1],arguments[2]),r=arguments[3],s=function(f,u){return r.compare(f,u)},n.sort(s),c=t.slice(0,arguments[1]).concat(n,t.slice(arguments[2],t.length)),t.splice(0,t.length),e=0;e<c.length;e++)t.push(c[e])};Kh.asList=function(t){for(var e=new be,n=0,r=t.length;n<r;n++)e.add(t[n]);return e};var $n=function(){},al={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};al.P.get=function(){return 0};al.L.get=function(){return 1};al.A.get=function(){return 2};al.FALSE.get=function(){return-1};al.TRUE.get=function(){return-2};al.DONTCARE.get=function(){return-3};al.SYM_FALSE.get=function(){return"F"};al.SYM_TRUE.get=function(){return"T"};al.SYM_DONTCARE.get=function(){return"*"};al.SYM_P.get=function(){return"0"};al.SYM_L.get=function(){return"1"};al.SYM_A.get=function(){return"2"};$n.prototype.interfaces_=function(){return[]};$n.prototype.getClass=function(){return $n};$n.toDimensionSymbol=function(t){switch(t){case $n.FALSE:return $n.SYM_FALSE;case $n.TRUE:return $n.SYM_TRUE;case $n.DONTCARE:return $n.SYM_DONTCARE;case $n.P:return $n.SYM_P;case $n.L:return $n.SYM_L;case $n.A:return $n.SYM_A}throw new Nr("Unknown dimension value: "+t)};$n.toDimensionValue=function(t){switch(wm.toUpperCase(t)){case $n.SYM_FALSE:return $n.FALSE;case $n.SYM_TRUE:return $n.TRUE;case $n.SYM_DONTCARE:return $n.DONTCARE;case $n.SYM_P:return $n.P;case $n.SYM_L:return $n.L;case $n.SYM_A:return $n.A}throw new Nr("Unknown dimension symbol: "+t)};Object.defineProperties($n,al);var Bl=function(){};Bl.prototype.filter=function(t){};Bl.prototype.interfaces_=function(){return[]};Bl.prototype.getClass=function(){return Bl};var Ja=function(){};Ja.prototype.filter=function(t,e){};Ja.prototype.isDone=function(){};Ja.prototype.isGeometryChanged=function(){};Ja.prototype.interfaces_=function(){return[]};Ja.prototype.getClass=function(){return Ja};var Ko=function(t){function e(r,s){if(t.call(this,s),this._geometries=r||[],t.hasNullElements(this._geometries))throw new Nr("geometries must not contain null elements")}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var r=this,s=new He,c=0;c<this._geometries.length;c++)s.expandToInclude(r._geometries[c].getEnvelopeInternal());return s},e.prototype.getGeometryN=function(r){return this._geometries[r]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var r=this,s=new Array(this.getNumPoints()).fill(null),c=-1,f=0;f<this._geometries.length;f++)for(var u=r._geometries[f].getCoordinates(),w=0;w<u.length;w++)c++,s[c]=u[w];return s},e.prototype.getArea=function(){for(var r=this,s=0,c=0;c<this._geometries.length;c++)s+=r._geometries[c].getArea();return s},e.prototype.equalsExact=function(){var r=this;if(arguments.length===2){var s=arguments[0],c=arguments[1];if(!this.isEquivalentClass(s))return!1;var f=s;if(this._geometries.length!==f._geometries.length)return!1;for(var u=0;u<this._geometries.length;u++)if(!r._geometries[u].equalsExact(f._geometries[u],c))return!1;return!0}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var r=this,s=0;s<this._geometries.length;s++)r._geometries[s].normalize();Kh.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var r=this,s=$n.FALSE,c=0;c<this._geometries.length;c++)s=Math.max(s,r._geometries[c].getBoundaryDimension());return s},e.prototype.getDimension=function(){for(var r=this,s=$n.FALSE,c=0;c<this._geometries.length;c++)s=Math.max(s,r._geometries[c].getDimension());return s},e.prototype.getLength=function(){for(var r=this,s=0,c=0;c<this._geometries.length;c++)s+=r._geometries[c].getLength();return s},e.prototype.getNumPoints=function(){for(var r=this,s=0,c=0;c<this._geometries.length;c++)s+=r._geometries[c].getNumPoints();return s},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var r=this,s=this._geometries.length,c=new Array(s).fill(null),f=0;f<this._geometries.length;f++)c[f]=r._geometries[f].reverse();return this.getFactory().createGeometryCollection(c)},e.prototype.compareToSameClass=function(){var r=this;if(arguments.length===1){var s=arguments[0],c=new Fl(Kh.asList(this._geometries)),f=new Fl(Kh.asList(s._geometries));return this.compare(c,f)}else if(arguments.length===2){for(var u=arguments[0],w=arguments[1],S=u,A=this.getNumGeometries(),N=S.getNumGeometries(),O=0;O<A&&O<N;){var j=r.getGeometryN(O),W=S.getGeometryN(O),nt=j.compareToSameClass(W,w);if(nt!==0)return nt;O++}return O<A?1:O<N?-1:0}},e.prototype.apply=function(){var r=this;if(an(arguments[0],_u))for(var s=arguments[0],c=0;c<this._geometries.length;c++)r._geometries[c].apply(s);else if(an(arguments[0],Ja)){var f=arguments[0];if(this._geometries.length===0)return null;for(var u=0;u<this._geometries.length&&(r._geometries[u].apply(f),!f.isDone());u++);f.isGeometryChanged()&&this.geometryChanged()}else if(an(arguments[0],Bl)){var w=arguments[0];w.filter(this);for(var S=0;S<this._geometries.length;S++)r._geometries[S].apply(w)}else if(an(arguments[0],ec)){var A=arguments[0];A.filter(this);for(var N=0;N<this._geometries.length;N++)r._geometries[N].apply(A)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),yn.shouldNeverReachHere(),null},e.prototype.clone=function(){var r=this,s=t.prototype.clone.call(this);s._geometries=new Array(this._geometries.length).fill(null);for(var c=0;c<this._geometries.length;c++)s._geometries[c]=r._geometries[c].clone();return s},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var r=this,s=new Array(this._geometries.length).fill(null),c=0;c<s.length;c++)s[c]=r._geometries[c].copy();return new e(s,this._factory)},e.prototype.isEmpty=function(){for(var r=this,s=0;s<this._geometries.length;s++)if(!r._geometries[s].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(e,n),e}(sn),ip=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return sn.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.isEquivalentClass(r)?t.prototype.equalsExact.call(this,r,s):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?$n.FALSE:0},e.prototype.isClosed=function(){var r=this;if(this.isEmpty())return!1;for(var s=0;s<this._geometries.length;s++)if(!r._geometries[s].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var r=this,s=this._geometries.length,c=new Array(s).fill(null),f=0;f<this._geometries.length;f++)c[s-1-f]=r._geometries[f].reverse();return this.getFactory().createMultiLineString(c)},e.prototype.getBoundary=function(){return new Ia(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var r=this,s=new Array(this._geometries.length).fill(null),c=0;c<s.length;c++)s[c]=r._geometries[c].copy();return new e(s,this._factory)},e.prototype.interfaces_=function(){return[Em]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(e,n),e}(Ko),Ia=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var t=arguments[0],e=Ma.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=r}};Ia.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return e.length===1?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)};Ia.prototype.getBoundary=function(){return this._geom instanceof Hr?this.boundaryLineString(this._geom):this._geom instanceof ip?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};Ia.prototype.boundaryLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var e=this._bnRule.isInBoundary(2);return e?t.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])};Ia.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};Ia.prototype.computeBoundaryCoordinates=function(t){var e=this,n=new be;this._endpointMap=new Mo;for(var r=0;r<t.getNumGeometries();r++){var s=t.getGeometryN(r);s.getNumPoints()!==0&&(e.addEndpoint(s.getCoordinateN(0)),e.addEndpoint(s.getCoordinateN(s.getNumPoints()-1)))}for(var c=this._endpointMap.entrySet().iterator();c.hasNext();){var f=c.next(),u=f.getValue(),w=u.count;e._bnRule.isInBoundary(w)&&n.add(f.getKey())}return Pn.toCoordinateArray(n)};Ia.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);e===null&&(e=new U_,this._endpointMap.put(t,e)),e.count++};Ia.prototype.interfaces_=function(){return[]};Ia.prototype.getClass=function(){return Ia};Ia.getBoundary=function(){if(arguments.length===1){var t=arguments[0],e=new Ia(t);return e.getBoundary()}else if(arguments.length===2){var n=arguments[0],r=arguments[1],s=new Ia(n,r);return s.getBoundary()}};var U_=function(){this.count=null};U_.prototype.interfaces_=function(){return[]};U_.prototype.getClass=function(){return U_};function vD(){}function xD(){}var wD=function(){};function bD(){}function ED(){}function SD(){}var Ca=function(){},pw={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Ca.prototype.interfaces_=function(){return[]};Ca.prototype.getClass=function(){return Ca};Ca.chars=function(t,e){for(var n=new Array(e).fill(null),r=0;r<e;r++)n[r]=t;return String(n)};Ca.getStackTrace=function(){if(arguments.length===1){var t=arguments[0],e=new bD,n=new vD;return t.printStackTrace(n),e.toString()}else if(arguments.length===2){var r=arguments[0],s=arguments[1],c="";new xD(Ca.getStackTrace(r));for(var f=new SD,u=0;u<s;u++)try{c+=f.readLine()+Ca.NEWLINE}catch(w){if(w instanceof ED)yn.shouldNeverReachHere();else throw w}finally{}return c}};Ca.split=function(t,e){for(var n=e.length,r=new be,s=""+t,c=s.indexOf(e);c>=0;){var f=s.substring(0,c);r.add(f),s=s.substring(c+n),c=s.indexOf(e)}s.length>0&&r.add(s);for(var u=new Array(r.size()).fill(null),w=0;w<u.length;w++)u[w]=r.get(w);return u};Ca.toString=function(){if(arguments.length===1){var t=arguments[0];return Ca.SIMPLE_ORDINATE_FORMAT.format(t)}};Ca.spaces=function(t){return Ca.chars(" ",t)};pw.NEWLINE.get=function(){return fo.getProperty("line.separator")};pw.SIMPLE_ORDINATE_FORMAT.get=function(){return new wD};Object.defineProperties(Ca,pw);var si=function(){};si.prototype.interfaces_=function(){return[]};si.prototype.getClass=function(){return si};si.copyCoord=function(t,e,n,r){for(var s=Math.min(t.getDimension(),n.getDimension()),c=0;c<s;c++)n.setOrdinate(r,c,t.getOrdinate(e,c))};si.isRing=function(t){var e=t.size();return e===0?!0:e<=3?!1:t.getOrdinate(0,Bn.X)===t.getOrdinate(e-1,Bn.X)&&t.getOrdinate(0,Bn.Y)===t.getOrdinate(e-1,Bn.Y)};si.isEqual=function(t,e){var n=t.size(),r=e.size();if(n!==r)return!1;for(var s=Math.min(t.getDimension(),e.getDimension()),c=0;c<n;c++)for(var f=0;f<s;f++){var u=t.getOrdinate(c,f),w=e.getOrdinate(c,f);if(t.getOrdinate(c,f)!==e.getOrdinate(c,f)&&!(cn.isNaN(u)&&cn.isNaN(w)))return!1}return!0};si.extend=function(t,e,n){var r=t.create(n,e.getDimension()),s=e.size();if(si.copy(e,0,r,0,s),s>0)for(var c=s;c<n;c++)si.copy(e,s-1,r,c,1);return r};si.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),r=0;r<=n;r++)si.swap(t,r,e-r)};si.swap=function(t,e,n){if(e===n)return null;for(var r=0;r<t.getDimension();r++){var s=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,s)}};si.copy=function(t,e,n,r,s){for(var c=0;c<s;c++)si.copyCoord(t,e+c,n,r+c)};si.toString=function(){if(arguments.length===1){var t=arguments[0],e=t.size();if(e===0)return"()";var n=t.getDimension(),r=new Wl;r.append("(");for(var s=0;s<e;s++){s>0&&r.append(" ");for(var c=0;c<n;c++)c>0&&r.append(","),r.append(Ca.toString(t.getOrdinate(s,c)))}return r.append(")"),r.toString()}};si.ensureValidRing=function(t,e){var n=e.size();if(n===0)return e;if(n<=3)return si.createClosedRing(t,e,4);var r=e.getOrdinate(0,Bn.X)===e.getOrdinate(n-1,Bn.X)&&e.getOrdinate(0,Bn.Y)===e.getOrdinate(n-1,Bn.Y);return r?e:si.createClosedRing(t,e,n+1)};si.createClosedRing=function(t,e,n){var r=t.create(n,e.getDimension()),s=e.size();si.copy(e,0,r,0,s);for(var c=s;c<n;c++)si.copy(e,0,r,c,1);return r};var Hr=function(t){function e(r,s){t.call(this,s),this._points=null,this.init(r)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new He:this._points.expandEnvelope(new He)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){var r=this;if(arguments.length===2){var s=arguments[0],c=arguments[1];if(!this.isEquivalentClass(s))return!1;var f=s;if(this._points.size()!==f._points.size())return!1;for(var u=0;u<this._points.size();u++)if(!r.equal(r._points.getCoordinate(u),f._points.getCoordinate(u),c))return!1;return!0}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var r=this,s=0;s<Math.trunc(this._points.size()/2);s++){var c=r._points.size()-1-s;if(!r._points.getCoordinate(s).equals(r._points.getCoordinate(c)))return r._points.getCoordinate(s).compareTo(r._points.getCoordinate(c))>0&&si.reverse(r._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?$n.FALSE:0},e.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return Ne.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var r=this._points.copy();si.reverse(r);var s=this.getFactory().createLineString(r);return s},e.prototype.compareToSameClass=function(){var r=this;if(arguments.length===1){for(var s=arguments[0],c=s,f=0,u=0;f<this._points.size()&&u<c._points.size();){var w=r._points.getCoordinate(f).compareTo(c._points.getCoordinate(u));if(w!==0)return w;f++,u++}return f<this._points.size()?1:u<c._points.size()?-1:0}else if(arguments.length===2){var S=arguments[0],A=arguments[1],N=S;return A.compare(this._points,N._points)}},e.prototype.apply=function(){var r=this;if(an(arguments[0],_u))for(var s=arguments[0],c=0;c<this._points.size();c++)s.filter(r._points.getCoordinate(c));else if(an(arguments[0],Ja)){var f=arguments[0];if(this._points.size()===0)return null;for(var u=0;u<this._points.size()&&(f.filter(r._points,u),!f.isDone());u++);f.isGeometryChanged()&&this.geometryChanged()}else if(an(arguments[0],Bl)){var w=arguments[0];w.filter(this)}else if(an(arguments[0],ec)){var S=arguments[0];S.filter(this)}},e.prototype.getBoundary=function(){return new Ia(this).getBoundary()},e.prototype.isEquivalentClass=function(r){return r instanceof e},e.prototype.clone=function(){var r=t.prototype.clone.call(this);return r._points=this._points.clone(),r},e.prototype.getCoordinateN=function(r){return this._points.getCoordinate(r)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return this._points.size()===0},e.prototype.init=function(r){if(r===null&&(r=this.getFactory().getCoordinateSequenceFactory().create([])),r.size()===1)throw new Nr("Invalid number of points in LineString (found "+r.size()+" - must be 0 or >= 2)");this._points=r},e.prototype.isCoordinate=function(r){for(var s=this,c=0;c<this._points.size();c++)if(s._points.getCoordinate(c).equals(r))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(r){return this.getFactory().createPoint(this._points.getCoordinate(r))},e.prototype.interfaces_=function(){return[Em]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(sn),Sm=function(){};Sm.prototype.interfaces_=function(){return[]};Sm.prototype.getClass=function(){return Sm};var As=function(t){function e(r,s){t.call(this,s),this._coordinates=r||null,this.init(this._coordinates)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new He;var r=new He;return r.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),r},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.isEquivalentClass(r)?this.isEmpty()&&r.isEmpty()?!0:this.isEmpty()!==r.isEmpty()?!1:this.equal(r.getCoordinate(),this.getCoordinate(),s):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return $n.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(arguments.length===1){var r=arguments[0],s=r;return this.getCoordinate().compareTo(s.getCoordinate())}else if(arguments.length===2){var c=arguments[0],f=arguments[1],u=c;return f.compare(this._coordinates,u._coordinates)}},e.prototype.apply=function(){if(an(arguments[0],_u)){var r=arguments[0];if(this.isEmpty())return null;r.filter(this.getCoordinate())}else if(an(arguments[0],Ja)){var s=arguments[0];if(this.isEmpty())return null;s.filter(this._coordinates,0),s.isGeometryChanged()&&this.geometryChanged()}else if(an(arguments[0],Bl)){var c=arguments[0];c.filter(this)}else if(an(arguments[0],ec)){var f=arguments[0];f.filter(this)}},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var r=t.prototype.clone.call(this);return r._coordinates=this._coordinates.clone(),r},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return this._coordinates.size()===0},e.prototype.init=function(r){r===null&&(r=this.getFactory().getCoordinateSequenceFactory().create([])),yn.isTrue(r.size()<=1),this._coordinates=r},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Sm]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(e,n),e}(sn),jc=function(){};jc.prototype.interfaces_=function(){return[]};jc.prototype.getClass=function(){return jc};var Ni=function(t){function e(r,s,c){if(t.call(this,c),this._shell=null,this._holes=null,r===null&&(r=this.getFactory().createLinearRing()),s===null&&(s=[]),t.hasNullElements(s))throw new Nr("holes must not contain null elements");if(r.isEmpty()&&t.hasNonEmptyElements(s))throw new Nr("shell is empty but holes are not");this._shell=r,this._holes=s}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){var r=this;if(this.isEmpty())return[];for(var s=new Array(this.getNumPoints()).fill(null),c=-1,f=this._shell.getCoordinates(),u=0;u<f.length;u++)c++,s[c]=f[u];for(var w=0;w<this._holes.length;w++)for(var S=r._holes[w].getCoordinates(),A=0;A<S.length;A++)c++,s[c]=S[A];return s},e.prototype.getArea=function(){var r=this,s=0;s+=Math.abs(Ne.signedArea(this._shell.getCoordinateSequence()));for(var c=0;c<this._holes.length;c++)s-=Math.abs(Ne.signedArea(r._holes[c].getCoordinateSequence()));return s},e.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var r=this._shell.getCoordinateSequence(),s=this.getEnvelopeInternal(),c=0;c<5;c++){var f=r.getX(c);if(!(f===s.getMinX()||f===s.getMaxX()))return!1;var u=r.getY(c);if(!(u===s.getMinY()||u===s.getMaxY()))return!1}for(var w=r.getX(0),S=r.getY(0),A=1;A<=4;A++){var N=r.getX(A),O=r.getY(A),j=N!==w,W=O!==S;if(j===W)return!1;w=N,S=O}return!0},e.prototype.equalsExact=function(){var r=this;if(arguments.length===2){var s=arguments[0],c=arguments[1];if(!this.isEquivalentClass(s))return!1;var f=s,u=this._shell,w=f._shell;if(!u.equalsExact(w,c)||this._holes.length!==f._holes.length)return!1;for(var S=0;S<this._holes.length;S++)if(!r._holes[S].equalsExact(f._holes[S],c))return!1;return!0}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){var r=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var s=0;s<this._holes.length;s++)r.normalize(r._holes[s],!1);Kh.sort(this._holes)}else if(arguments.length===2){var c=arguments[0],f=arguments[1];if(c.isEmpty())return null;var u=new Array(c.getCoordinates().length-1).fill(null);fo.arraycopy(c.getCoordinates(),0,u,0,u.length);var w=Pn.minCoordinate(c.getCoordinates());Pn.scroll(u,w),fo.arraycopy(u,0,c.getCoordinates(),0,u.length),c.getCoordinates()[u.length]=u[0],Ne.isCCW(c.getCoordinates())===f&&Pn.reverse(c.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var r=this,s=0;s+=this._shell.getLength();for(var c=0;c<this._holes.length;c++)s+=r._holes[c].getLength();return s},e.prototype.getNumPoints=function(){for(var r=this,s=this._shell.getNumPoints(),c=0;c<this._holes.length;c++)s+=r._holes[c].getNumPoints();return s},e.prototype.reverse=function(){var r=this,s=this.copy();s._shell=this._shell.copy().reverse(),s._holes=new Array(this._holes.length).fill(null);for(var c=0;c<this._holes.length;c++)s._holes[c]=r._holes[c].copy().reverse();return s},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){var r=this;if(arguments.length===1){var s=arguments[0],c=this._shell,f=s._shell;return c.compareToSameClass(f)}else if(arguments.length===2){var u=arguments[0],w=arguments[1],S=u,A=this._shell,N=S._shell,O=A.compareToSameClass(N,w);if(O!==0)return O;for(var j=this.getNumInteriorRing(),W=S.getNumInteriorRing(),nt=0;nt<j&&nt<W;){var pt=r.getInteriorRingN(nt),J=S.getInteriorRingN(nt),tt=pt.compareToSameClass(J,w);if(tt!==0)return tt;nt++}return nt<j?1:nt<W?-1:0}},e.prototype.apply=function(r){var s=this;if(an(r,_u)){this._shell.apply(r);for(var c=0;c<this._holes.length;c++)s._holes[c].apply(r)}else if(an(r,Ja)){if(this._shell.apply(r),!r.isDone())for(var f=0;f<this._holes.length&&(s._holes[f].apply(r),!r.isDone());f++);r.isGeometryChanged()&&this.geometryChanged()}else if(an(r,Bl))r.filter(this);else if(an(r,ec)){r.filter(this),this._shell.apply(r);for(var u=0;u<this._holes.length;u++)s._holes[u].apply(r)}},e.prototype.getBoundary=function(){var r=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var s=new Array(this._holes.length+1).fill(null);s[0]=this._shell;for(var c=0;c<this._holes.length;c++)s[c+1]=r._holes[c];return s.length<=1?this.getFactory().createLinearRing(s[0].getCoordinateSequence()):this.getFactory().createMultiLineString(s)},e.prototype.clone=function(){var r=this,s=t.prototype.clone.call(this);s._shell=this._shell.clone(),s._holes=new Array(this._holes.length).fill(null);for(var c=0;c<this._holes.length;c++)s._holes[c]=r._holes[c].clone();return s},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var r=this,s=this._shell.copy(),c=new Array(this._holes.length).fill(null),f=0;f<c.length;f++)c[f]=r._holes[f].copy();return new e(s,c,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(r){return this._holes[r]},e.prototype.interfaces_=function(){return[jc]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(sn),Ed=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return sn.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.isEquivalentClass(r)?t.prototype.equalsExact.call(this,r,s):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(arguments.length===1){var r=arguments[0];return this._geometries[r].getCoordinate()}else return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return $n.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var r=this,s=new Array(this._geometries.length).fill(null),c=0;c<s.length;c++)s[c]=r._geometries[c].copy();return new e(s,this._factory)},e.prototype.interfaces_=function(){return[Sm]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(e,n),e}(Ko),vu=function(t){function e(r,s){r instanceof Dt&&s instanceof Tn&&(r=s.getCoordinateSequenceFactory().create(r)),t.call(this,r,s),this.validateConstruction()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return sn.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return $n.FALSE},e.prototype.isClosed=function(){return this.isEmpty()?!0:t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var r=this._points.copy();si.reverse(r);var s=this.getFactory().createLinearRing(r);return s},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new Nr("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new Nr("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Hr),gu=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return sn.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.isEquivalentClass(r)?t.prototype.equalsExact.call(this,r,s):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var r=this,s=this._geometries.length,c=new Array(s).fill(null),f=0;f<this._geometries.length;f++)c[f]=r._geometries[f].reverse();return this.getFactory().createMultiPolygon(c)},e.prototype.getBoundary=function(){var r=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var s=new be,c=0;c<this._geometries.length;c++)for(var f=r._geometries[c],u=f.getBoundary(),w=0;w<u.getNumGeometries();w++)s.add(u.getGeometryN(w));var S=new Array(s.size()).fill(null);return this.getFactory().createMultiLineString(s.toArray(S))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var r=this,s=new Array(this._geometries.length).fill(null),c=0;c<s.length;c++)s[c]=r._geometries[c].copy();return new e(s,this._factory)},e.prototype.interfaces_=function(){return[jc]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Ko),La=function(t){this._factory=t||null,this._isUserDataCopied=!1},xv={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};La.prototype.setCopyUserData=function(t){this._isUserDataCopied=t};La.prototype.edit=function(t,e){if(t===null)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n};La.prototype.editInternal=function(t,e){return this._factory===null&&(this._factory=t.getFactory()),t instanceof Ko?this.editGeometryCollection(t,e):t instanceof Ni?this.editPolygon(t,e):t instanceof As?e.edit(t,this._factory):t instanceof Hr?e.edit(t,this._factory):(yn.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)};La.prototype.editGeometryCollection=function(t,e){for(var n=this,r=e.edit(t,this._factory),s=new be,c=0;c<r.getNumGeometries();c++){var f=n.edit(r.getGeometryN(c),e);f===null||f.isEmpty()||s.add(f)}return r.getClass()===Ed?this._factory.createMultiPoint(s.toArray([])):r.getClass()===ip?this._factory.createMultiLineString(s.toArray([])):r.getClass()===gu?this._factory.createMultiPolygon(s.toArray([])):this._factory.createGeometryCollection(s.toArray([]))};La.prototype.editPolygon=function(t,e){var n=this,r=e.edit(t,this._factory);if(r===null&&(r=this._factory.createPolygon(null)),r.isEmpty())return r;var s=this.edit(r.getExteriorRing(),e);if(s===null||s.isEmpty())return this._factory.createPolygon();for(var c=new be,f=0;f<r.getNumInteriorRing();f++){var u=n.edit(r.getInteriorRingN(f),e);u===null||u.isEmpty()||c.add(u)}return this._factory.createPolygon(s,c.toArray([]))};La.prototype.interfaces_=function(){return[]};La.prototype.getClass=function(){return La};La.GeometryEditorOperation=function(){};xv.NoOpGeometryOperation.get=function(){return Im};xv.CoordinateOperation.get=function(){return Cm};xv.CoordinateSequenceOperation.get=function(){return Tm};Object.defineProperties(La,xv);var Im=function(){};Im.prototype.edit=function(t,e){return t};Im.prototype.interfaces_=function(){return[La.GeometryEditorOperation]};Im.prototype.getClass=function(){return Im};var Cm=function(){};Cm.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return n===null?t:t instanceof vu?e.createLinearRing(n):t instanceof Hr?e.createLineString(n):t instanceof As?n.length>0?e.createPoint(n[0]):e.createPoint():t};Cm.prototype.interfaces_=function(){return[La.GeometryEditorOperation]};Cm.prototype.getClass=function(){return Cm};var Tm=function(){};Tm.prototype.edit=function(t,e){return t instanceof vu?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Hr?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof As?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t};Tm.prototype.interfaces_=function(){return[La.GeometryEditorOperation]};Tm.prototype.getClass=function(){return Tm};var ri=function(){var t=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var n=0;n<e;n++)t._coordinates[n]=new Dt}else if(an(arguments[0],Bn)){var r=arguments[0];if(r===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=r.getDimension(),this._coordinates=new Array(r.size()).fill(null);for(var s=0;s<this._coordinates.length;s++)t._coordinates[s]=r.getCoordinateCopy(s)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var c=arguments[0],f=arguments[1];this._coordinates=c,this._dimension=f,c===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var u=arguments[0],w=arguments[1];this._coordinates=new Array(u).fill(null),this._dimension=w;for(var S=0;S<u;S++)t._coordinates[S]=new Dt}}},f2={serialVersionUID:{configurable:!0}};ri.prototype.setOrdinate=function(t,e,n){switch(e){case Bn.X:this._coordinates[t].x=n;break;case Bn.Y:this._coordinates[t].y=n;break;case Bn.Z:this._coordinates[t].z=n;break;default:throw new Nr("invalid ordinateIndex")}};ri.prototype.size=function(){return this._coordinates.length};ri.prototype.getOrdinate=function(t,e){switch(e){case Bn.X:return this._coordinates[t].x;case Bn.Y:return this._coordinates[t].y;case Bn.Z:return this._coordinates[t].z}return cn.NaN};ri.prototype.getCoordinate=function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}};ri.prototype.getCoordinateCopy=function(t){return new Dt(this._coordinates[t])};ri.prototype.getDimension=function(){return this._dimension};ri.prototype.getX=function(t){return this._coordinates[t].x};ri.prototype.clone=function(){for(var t=this,e=new Array(this.size()).fill(null),n=0;n<this._coordinates.length;n++)e[n]=t._coordinates[n].clone();return new ri(e,this._dimension)};ri.prototype.expandEnvelope=function(t){for(var e=this,n=0;n<this._coordinates.length;n++)t.expandToInclude(e._coordinates[n]);return t};ri.prototype.copy=function(){for(var t=this,e=new Array(this.size()).fill(null),n=0;n<this._coordinates.length;n++)e[n]=t._coordinates[n].copy();return new ri(e,this._dimension)};ri.prototype.toString=function(){var t=this;if(this._coordinates.length>0){var e=new Wl(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var n=1;n<this._coordinates.length;n++)e.append(", "),e.append(t._coordinates[n]);return e.append(")"),e.toString()}else return"()"};ri.prototype.getY=function(t){return this._coordinates[t].y};ri.prototype.toCoordinateArray=function(){return this._coordinates};ri.prototype.interfaces_=function(){return[Bn,Na]};ri.prototype.getClass=function(){return ri};f2.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(ri,f2);var xu=function(){},fw={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};xu.prototype.readResolve=function(){return xu.instance()};xu.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new ri(t)}else if(an(arguments[0],Bn)){var e=arguments[0];return new ri(e)}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return r>3&&(r=3),r<2?new ri(n):new ri(n,r)}};xu.prototype.interfaces_=function(){return[yd,Na]};xu.prototype.getClass=function(){return xu};xu.instance=function(){return xu.instanceObject};fw.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};fw.instanceObject.get=function(){return new xu};Object.defineProperties(xu,fw);var d2=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(n){return this.map_.get(n)||null},e.prototype.put=function(n,r){return this.map_.set(n,r),r},e.prototype.values=function(){for(var n=new be,r=this.map_.values(),s=r.next();!s.done;)n.add(s.value),s=r.next();return n},e.prototype.entrySet=function(){var n=new hw;return this.map_.entries().forEach(function(r){return n.add(r)}),n},e.prototype.size=function(){return this.map_.size()},e}(gf),jn=function t(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=t.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Vl){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},dw={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};jn.prototype.equals=function(t){if(!(t instanceof jn))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale};jn.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),r=e.getMaximumSignificantDigits();return new zl(n).compareTo(new zl(r))};jn.prototype.getScale=function(){return this._scale};jn.prototype.isFloating=function(){return this._modelType===jn.FLOATING||this._modelType===jn.FLOATING_SINGLE};jn.prototype.getType=function(){return this._modelType};jn.prototype.toString=function(){var t="UNKNOWN";return this._modelType===jn.FLOATING?t="Floating":this._modelType===jn.FLOATING_SINGLE?t="Floating-Single":this._modelType===jn.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t};jn.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var t=arguments[0];if(cn.isNaN(t))return t;if(this._modelType===jn.FLOATING_SINGLE){var e=t;return e}return this._modelType===jn.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof Dt){var n=arguments[0];if(this._modelType===jn.FLOATING)return null;n.x=this.makePrecise(n.x),n.y=this.makePrecise(n.y)}};jn.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===jn.FLOATING?t=16:this._modelType===jn.FLOATING_SINGLE?t=6:this._modelType===jn.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t};jn.prototype.setScale=function(t){this._scale=Math.abs(t)};jn.prototype.interfaces_=function(){return[Na,ka]};jn.prototype.getClass=function(){return jn};jn.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e};dw.serialVersionUID.get=function(){return 7777263578777804e3};dw.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(jn,dw);var Vl=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},gw={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Vl.prototype.readResolve=function(){return Vl.nameToTypeMap.get(this._name)};Vl.prototype.toString=function(){return this._name};Vl.prototype.interfaces_=function(){return[Na]};Vl.prototype.getClass=function(){return Vl};gw.serialVersionUID.get=function(){return-552860263173159e4};gw.nameToTypeMap.get=function(){return new d2};Object.defineProperties(Vl,gw);jn.Type=Vl;jn.FIXED=new Vl("FIXED");jn.FLOATING=new Vl("FLOATING");jn.FLOATING_SINGLE=new Vl("FLOATING SINGLE");var Tn=function t(){this._precisionModel=new jn,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?an(arguments[0],yd)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof jn&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},g2={serialVersionUID:{configurable:!0}};Tn.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new Dt(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new Dt(t.getMinX(),t.getMinY()),new Dt(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new Dt(t.getMinX(),t.getMinY()),new Dt(t.getMinX(),t.getMaxY()),new Dt(t.getMaxX(),t.getMaxY()),new Dt(t.getMaxX(),t.getMinY()),new Dt(t.getMinX(),t.getMinY())]),null)};Tn.prototype.createLineString=function(t){if(t){if(t instanceof Array)return new Hr(this.getCoordinateSequenceFactory().create(t),this);if(an(t,Bn))return new Hr(t,this)}else return new Hr(this.getCoordinateSequenceFactory().create([]),this)};Tn.prototype.createMultiLineString=function(){if(arguments.length===0)return new ip(null,this);if(arguments.length===1){var t=arguments[0];return new ip(t,this)}};Tn.prototype.buildGeometry=function(t){for(var e=null,n=!1,r=!1,s=t.iterator();s.hasNext();){var c=s.next(),f=c.getClass();e===null&&(e=f),f!==e&&(n=!0),c.isGeometryCollectionOrDerived()&&(r=!0)}if(e===null)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(Tn.toGeometryArray(t));var u=t.iterator().next(),w=t.size()>1;if(w){if(u instanceof Ni)return this.createMultiPolygon(Tn.toPolygonArray(t));if(u instanceof Hr)return this.createMultiLineString(Tn.toLineStringArray(t));if(u instanceof As)return this.createMultiPoint(Tn.toPointArray(t));yn.shouldNeverReachHere("Unhandled class: "+u.getClass().getName())}return u};Tn.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)};Tn.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Dt){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(an(arguments[0],Bn)){var e=arguments[0];return new As(e,this)}}};Tn.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};Tn.prototype.createPolygon=function(){if(arguments.length===0)return new Ni(null,null,this);if(arguments.length===1){if(an(arguments[0],Bn)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}else if(arguments[0]instanceof vu){var n=arguments[0];return this.createPolygon(n,null)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return new Ni(r,s,this)}};Tn.prototype.getSRID=function(){return this._SRID};Tn.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Ko(null,this);if(arguments.length===1){var t=arguments[0];return new Ko(t,this)}};Tn.prototype.createGeometry=function(t){var e=new La(this);return e.edit(t,{edit:function(){if(arguments.length===2){var n=arguments[0];return this._coordinateSequenceFactory.create(n)}}})};Tn.prototype.getPrecisionModel=function(){return this._precisionModel};Tn.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(an(arguments[0],Bn)){var e=arguments[0];return new vu(e,this)}}};Tn.prototype.createMultiPolygon=function(){if(arguments.length===0)return new gu(null,this);if(arguments.length===1){var t=arguments[0];return new gu(t,this)}};Tn.prototype.createMultiPoint=function(){var t=this;if(arguments.length===0)return new Ed(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new Ed(e,this)}else if(arguments[0]instanceof Array){var n=arguments[0];return this.createMultiPoint(n!==null?this.getCoordinateSequenceFactory().create(n):null)}else if(an(arguments[0],Bn)){var r=arguments[0];if(r===null)return this.createMultiPoint(new Array(0).fill(null));for(var s=new Array(r.size()).fill(null),c=0;c<r.size();c++){var f=t.getCoordinateSequenceFactory().create(1,r.getDimension());si.copy(r,c,f,0,1),s[c]=t.createPoint(f)}return this.createMultiPoint(s)}}};Tn.prototype.interfaces_=function(){return[Na]};Tn.prototype.getClass=function(){return Tn};Tn.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Tn.toGeometryArray=function(t){if(t===null)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)};Tn.getDefaultCoordinateSequenceFactory=function(){return xu.instance()};Tn.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Tn.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Tn.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Tn.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Tn.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Tn.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Tn.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)};g2.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(Tn,g2);var ID=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],wv=function(t){this.geometryFactory=t||new Tn};wv.prototype.read=function(t){var e;typeof t=="string"?e=JSON.parse(t):e=t;var n=e.type;if(!Il[n])throw new Error("Unknown GeoJSON type: "+e.type);return ID.indexOf(n)!==-1?Il[n].apply(this,[e.coordinates]):n==="GeometryCollection"?Il[n].apply(this,[e.geometries]):Il[n].apply(this,[e])};wv.prototype.write=function(t){var e=t.getGeometryType();if(!qu[e])throw new Error("Geometry is not supported");return qu[e].apply(this,[t])};var Il={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!Il[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=Il.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e=this,n={};if(t.features){n.features=[];for(var r=0;r<t.features.length;++r)n.features.push(e.read(t.features[r]))}return t.bbox&&(n.bbox=this.parse.bbox.apply(this,[t.bbox])),n},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new Dt(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new Dt(t[0],t[1]),new Dt(t[2],t[1]),new Dt(t[2],t[3]),new Dt(t[0],t[3]),new Dt(t[0],t[1])])},Point:function(t){var e=new Dt(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=this,n=[],r=0;r<t.length;++r)n.push(Il.Point.apply(e,[t[r]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(t){var e=Il.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=this,n=[],r=0;r<t.length;++r)n.push(Il.LineString.apply(e,[t[r]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(t){for(var e=this,n=Il.coordinates.apply(this,[t[0]]),r=this.geometryFactory.createLinearRing(n),s=[],c=1;c<t.length;++c){var f=t[c],u=Il.coordinates.apply(e,[f]),w=e.geometryFactory.createLinearRing(u);s.push(w)}return this.geometryFactory.createPolygon(r,s)},MultiPolygon:function(t){for(var e=this,n=[],r=0;r<t.length;++r){var s=t[r];n.push(Il.Polygon.apply(e,[s]))}return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(t){for(var e=this,n=[],r=0;r<t.length;++r){var s=t[r];n.push(e.read(s))}return this.geometryFactory.createGeometryCollection(n)}},qu={coordinate:function(t){return[t.x,t.y]},Point:function(t){var e=qu.coordinate.apply(this,[t.getCoordinate()]);return{type:"Point",coordinates:e}},MultiPoint:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var s=t._geometries[r],c=qu.Point.apply(e,[s]);n.push(c.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(t){for(var e=this,n=[],r=t.getCoordinates(),s=0;s<r.length;++s){var c=r[s];n.push(qu.coordinate.apply(e,[c]))}return{type:"LineString",coordinates:n}},MultiLineString:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var s=t._geometries[r],c=qu.LineString.apply(e,[s]);n.push(c.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(t){var e=this,n=[],r=qu.LineString.apply(this,[t._shell]);n.push(r.coordinates);for(var s=0;s<t._holes.length;++s){var c=t._holes[s],f=qu.LineString.apply(e,[c]);n.push(f.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var s=t._geometries[r],c=qu.Polygon.apply(e,[s]);n.push(c.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var s=t._geometries[r],c=s.getGeometryType();n.push(qu[c].apply(e,[s]))}return{type:"GeometryCollection",geometries:n}}},mw=function(t){this.geometryFactory=t||new Tn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new wv(this.geometryFactory)};mw.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===jn.FIXED&&this.reducePrecision(e),e};mw.prototype.reducePrecision=function(t){var e=this,n,r;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(n=0,r=t.points.length;n<r;n++)e.precisionModel.makePrecise(t.points[n]);else if(t.geometries)for(n=0,r=t.geometries.length;n<r;n++)e.reducePrecision(t.geometries[n])};var m2=function(){this.parser=new wv(this.geometryFactory)};m2.prototype.write=function(t){return this.parser.write(t)};var fe=function(){},bv={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};fe.prototype.interfaces_=function(){return[]};fe.prototype.getClass=function(){return fe};fe.opposite=function(t){return t===fe.LEFT?fe.RIGHT:t===fe.RIGHT?fe.LEFT:t};bv.ON.get=function(){return 0};bv.LEFT.get=function(){return 1};bv.RIGHT.get=function(){return 2};Object.defineProperties(fe,bv);function Ev(t){this.message=t||""}Ev.prototype=new Error;Ev.prototype.name="EmptyStackException";function Hl(){this.array_=[]}Hl.prototype=new Ha;Hl.prototype.add=function(t){return this.array_.push(t),!0};Hl.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]};Hl.prototype.push=function(t){return this.array_.push(t),t};Hl.prototype.pop=function(t){if(this.array_.length===0)throw new Ev;return this.array_.pop()};Hl.prototype.peek=function(){if(this.array_.length===0)throw new Ev;return this.array_[this.array_.length-1]};Hl.prototype.empty=function(){return this.array_.length===0};Hl.prototype.isEmpty=function(){return this.empty()};Hl.prototype.search=function(t){return this.array_.indexOf(t)};Hl.prototype.size=function(){return this.array_.length};Hl.prototype.toArray=function(){for(var t=this,e=[],n=0,r=this.array_.length;n<r;n++)e.push(t.array_[n]);return e};var Ul=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Ul.prototype.getCoordinate=function(){return this._minCoord};Ul.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n};Ul.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();yn.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],r=Ne.computeOrientation(this._minCoord,n,e),s=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&r===Ne.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&r===Ne.CLOCKWISE)&&(s=!0),s&&(this._minIndex=this._minIndex-1)};Ul.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge(),r=n.getCoordinates();if(e<0||e+1>=r.length||r[e].y===r[e+1].y)return-1;var s=fe.LEFT;return r[e].y<r[e+1].y&&(s=fe.RIGHT),s};Ul.prototype.getEdge=function(){return this._orientedDe};Ul.prototype.checkForRightmostCoordinate=function(t){for(var e=this,n=t.getEdge().getCoordinates(),r=0;r<n.length-1;r++)(e._minCoord===null||n[r].x>e._minCoord.x)&&(e._minDe=t,e._minIndex=r,e._minCoord=n[r])};Ul.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode(),e=t.getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Ul.prototype.findEdge=function(t){for(var e=this,n=t.iterator();n.hasNext();){var r=n.next();r.isForward()&&e.checkForRightmostCoordinate(r)}yn.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var s=this.getRightmostSide(this._minDe,this._minIndex);s===fe.LEFT&&(this._orientedDe=this._minDe.getSym())};Ul.prototype.interfaces_=function(){return[]};Ul.prototype.getClass=function(){return Ul};var nc=function(t){function e(n,r){t.call(this,e.msgWithCoord(n,r)),this.pt=r?new Dt(r):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(n,r){return r?n:n+" [ "+r+" ]"},e}(tc),Sv=function(){this.array_=[]};Sv.prototype.addLast=function(t){this.array_.push(t)};Sv.prototype.removeFirst=function(){return this.array_.shift()};Sv.prototype.isEmpty=function(){return this.array_.length===0};var Jo=function(){this._finder=null,this._dirEdgeList=new be,this._nodes=new be,this._rightMostCoord=null,this._env=null,this._finder=new Ul};Jo.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.setVisited(!1)}};Jo.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};Jo.prototype.computeNodeDepth=function(t){for(var e=this,n=null,r=t.getEdges().iterator();r.hasNext();){var s=r.next();if(s.isVisited()||s.getSym().isVisited()){n=s;break}}if(n===null)throw new nc("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(n);for(var c=t.getEdges().iterator();c.hasNext();){var f=c.next();f.setVisited(!0),e.copySymDepths(f)}};Jo.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(fe.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)};Jo.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};Jo.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(fe.RIGHT)>=1&&e.getDepth(fe.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}};Jo.prototype.computeDepths=function(t){var e=this,n=new hw,r=new Sv,s=t.getNode();for(r.addLast(s),n.add(s),t.setVisited(!0);!r.isEmpty();){var c=r.removeFirst();n.add(c),e.computeNodeDepth(c);for(var f=c.getEdges().iterator();f.hasNext();){var u=f.next(),w=u.getSym();if(!w.isVisited()){var S=w.getNode();n.contains(S)||(r.addLast(S),n.add(S))}}}};Jo.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0};Jo.prototype.getEnvelope=function(){if(this._env===null){for(var t=new He,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next(),r=n.getEdge().getCoordinates(),s=0;s<r.length-1;s++)t.expandToInclude(r[s]);this._env=t}return this._env};Jo.prototype.addReachable=function(t){var e=this,n=new Hl;for(n.add(t);!n.empty();){var r=n.pop();e.add(r,n)}};Jo.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(fe.LEFT,t.getDepth(fe.RIGHT)),e.setDepth(fe.RIGHT,t.getDepth(fe.LEFT))};Jo.prototype.add=function(t,e){var n=this;t.setVisited(!0),this._nodes.add(t);for(var r=t.getEdges().iterator();r.hasNext();){var s=r.next();n._dirEdgeList.add(s);var c=s.getSym(),f=c.getNode();f.isVisited()||e.push(f)}};Jo.prototype.getNodes=function(){return this._nodes};Jo.prototype.getDirectedEdges=function(){return this._dirEdgeList};Jo.prototype.interfaces_=function(){return[ka]};Jo.prototype.getClass=function(){return Jo};var _r=function t(){var e=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];this.init(n.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[fe.ON]=r}else if(arguments[0]instanceof t){var s=arguments[0];if(this.init(s.location.length),s!==null)for(var c=0;c<this.location.length;c++)e.location[c]=s.location[c]}}else if(arguments.length===3){var f=arguments[0],u=arguments[1],w=arguments[2];this.init(3),this.location[fe.ON]=f,this.location[fe.LEFT]=u,this.location[fe.RIGHT]=w}};_r.prototype.setAllLocations=function(t){for(var e=this,n=0;n<this.location.length;n++)e.location[n]=t};_r.prototype.isNull=function(){for(var t=this,e=0;e<this.location.length;e++)if(t.location[e]!==Bt.NONE)return!1;return!0};_r.prototype.setAllLocationsIfNull=function(t){for(var e=this,n=0;n<this.location.length;n++)e.location[n]===Bt.NONE&&(e.location[n]=t)};_r.prototype.isLine=function(){return this.location.length===1};_r.prototype.merge=function(t){var e=this;if(t.location.length>this.location.length){var n=new Array(3).fill(null);n[fe.ON]=this.location[fe.ON],n[fe.LEFT]=Bt.NONE,n[fe.RIGHT]=Bt.NONE,this.location=n}for(var r=0;r<this.location.length;r++)e.location[r]===Bt.NONE&&r<t.location.length&&(e.location[r]=t.location[r])};_r.prototype.getLocations=function(){return this.location};_r.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[fe.LEFT];this.location[fe.LEFT]=this.location[fe.RIGHT],this.location[fe.RIGHT]=t};_r.prototype.toString=function(){var t=new Wl;return this.location.length>1&&t.append(Bt.toLocationSymbol(this.location[fe.LEFT])),t.append(Bt.toLocationSymbol(this.location[fe.ON])),this.location.length>1&&t.append(Bt.toLocationSymbol(this.location[fe.RIGHT])),t.toString()};_r.prototype.setLocations=function(t,e,n){this.location[fe.ON]=t,this.location[fe.LEFT]=e,this.location[fe.RIGHT]=n};_r.prototype.get=function(t){return t<this.location.length?this.location[t]:Bt.NONE};_r.prototype.isArea=function(){return this.location.length>1};_r.prototype.isAnyNull=function(){for(var t=this,e=0;e<this.location.length;e++)if(t.location[e]===Bt.NONE)return!0;return!1};_r.prototype.setLocation=function(){if(arguments.length===1){var t=arguments[0];this.setLocation(fe.ON,t)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this.location[e]=n}};_r.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(Bt.NONE)};_r.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]};_r.prototype.allPositionsEqual=function(t){for(var e=this,n=0;n<this.location.length;n++)if(e.location[n]!==t)return!1;return!0};_r.prototype.interfaces_=function(){return[]};_r.prototype.getClass=function(){return _r};var er=function t(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new _r(e),this.elt[1]=new _r(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new _r(n.elt[0]),this.elt[1]=new _r(n.elt[1])}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.elt[0]=new _r(Bt.NONE),this.elt[1]=new _r(Bt.NONE),this.elt[r].setLocation(s)}else if(arguments.length===3){var c=arguments[0],f=arguments[1],u=arguments[2];this.elt[0]=new _r(c,f,u),this.elt[1]=new _r(c,f,u)}else if(arguments.length===4){var w=arguments[0],S=arguments[1],A=arguments[2],N=arguments[3];this.elt[0]=new _r(Bt.NONE,Bt.NONE,Bt.NONE),this.elt[1]=new _r(Bt.NONE,Bt.NONE,Bt.NONE),this.elt[w].setLocations(S,A,N)}};er.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t};er.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)};er.prototype.isNull=function(t){return this.elt[t].isNull()};er.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}};er.prototype.isLine=function(t){return this.elt[t].isLine()};er.prototype.merge=function(t){for(var e=this,n=0;n<2;n++)e.elt[n]===null&&t.elt[n]!==null?e.elt[n]=new _r(t.elt[n]):e.elt[n].merge(t.elt[n])};er.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};er.prototype.getLocation=function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(fe.ON)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}};er.prototype.toString=function(){var t=new Wl;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()};er.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}};er.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()};er.prototype.setLocation=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(fe.ON,e)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];this.elt[n].setLocation(r,s)}};er.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)};er.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)};er.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new _r(this.elt[t].location[0]))};er.prototype.interfaces_=function(){return[]};er.prototype.getClass=function(){return er};er.toLineLabel=function(t){for(var e=new er(Bt.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var vi=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new be,this._pts=new be,this._label=new er(Bt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new be,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};vi.prototype.computeRing=function(){var t=this;if(this._ring!==null)return null;for(var e=new Array(this._pts.size()).fill(null),n=0;n<this._pts.size();n++)e[n]=t._pts.get(n);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=Ne.isCCW(this._ring.getCoordinates())};vi.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};vi.prototype.computePoints=function(t){var e=this;this._startDe=t;var n=t,r=!0;do{if(n===null)throw new nc("Found null DirectedEdge");if(n.getEdgeRing()===e)throw new nc("Directed Edge visited twice during ring-building at "+n.getCoordinate());e._edges.add(n);var s=n.getLabel();yn.isTrue(s.isArea()),e.mergeLabel(s),e.addPoints(n.getEdge(),n.isForward(),r),r=!1,e.setEdgeRing(n,e),n=e.getNext(n)}while(n!==this._startDe)};vi.prototype.getLinearRing=function(){return this._ring};vi.prototype.getCoordinate=function(t){return this._pts.get(t)};vi.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var e=this._startDe;do{var n=e.getNode(),r=n.getEdges().getOutgoingDegree(t);r>t._maxNodeDegree&&(t._maxNodeDegree=r),e=t.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2};vi.prototype.addPoints=function(t,e,n){var r=this,s=t.getCoordinates();if(e){var c=1;n&&(c=0);for(var f=c;f<s.length;f++)r._pts.add(s[f])}else{var u=s.length-2;n&&(u=s.length-1);for(var w=u;w>=0;w--)r._pts.add(s[w])}};vi.prototype.isHole=function(){return this._isHole};vi.prototype.setInResult=function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)};vi.prototype.containsPoint=function(t){var e=this.getLinearRing(),n=e.getEnvelopeInternal();if(!n.contains(t)||!Ne.isPointInRing(t,e.getCoordinates()))return!1;for(var r=this._holes.iterator();r.hasNext();){var s=r.next();if(s.containsPoint(t))return!1}return!0};vi.prototype.addHole=function(t){this._holes.add(t)};vi.prototype.isShell=function(){return this._shell===null};vi.prototype.getLabel=function(){return this._label};vi.prototype.getEdges=function(){return this._edges};vi.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};vi.prototype.getShell=function(){return this._shell};vi.prototype.mergeLabel=function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var e=arguments[0],n=arguments[1],r=e.getLocation(n,fe.RIGHT);if(r===Bt.NONE)return null;if(this._label.getLocation(n)===Bt.NONE)return this._label.setLocation(n,r),null}};vi.prototype.setShell=function(t){this._shell=t,t!==null&&t.addHole(this)};vi.prototype.toPolygon=function(t){for(var e=this,n=new Array(this._holes.size()).fill(null),r=0;r<this._holes.size();r++)n[r]=e._holes.get(r).getLinearRing();var s=t.createPolygon(this.getLinearRing(),n);return s};vi.prototype.interfaces_=function(){return[]};vi.prototype.getClass=function(){return vi};var CD=function(t){function e(){var n=arguments[0],r=arguments[1];t.call(this,n,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(n,r){n.setMinEdgeRing(r)},e.prototype.getNext=function(n){return n.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(vi),TD=function(t){function e(){var n=arguments[0],r=arguments[1];t.call(this,n,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var n=this,r=new be,s=this._startDe;do{if(s.getMinEdgeRing()===null){var c=new CD(s,n._geometryFactory);r.add(c)}s=s.getNext()}while(s!==this._startDe);return r},e.prototype.setEdgeRing=function(n,r){n.setEdgeRing(r)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var n=this,r=this._startDe;do{var s=r.getNode();s.getEdges().linkMinimalDirectedEdges(n),r=r.getNext()}while(r!==this._startDe)},e.prototype.getNext=function(n){return n.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(vi),na=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0&&arguments.length===1){var t=arguments[0];this._label=t}};na.prototype.setVisited=function(t){this._isVisited=t};na.prototype.setInResult=function(t){this._isInResult=t};na.prototype.isCovered=function(){return this._isCovered};na.prototype.isCoveredSet=function(){return this._isCoveredSet};na.prototype.setLabel=function(t){this._label=t};na.prototype.getLabel=function(){return this._label};na.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0};na.prototype.updateIM=function(t){yn.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)};na.prototype.isInResult=function(){return this._isInResult};na.prototype.isVisited=function(){return this._isVisited};na.prototype.interfaces_=function(){return[]};na.prototype.getClass=function(){return na};var Iv=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var n=arguments[0],r=arguments[1];this._coord=n,this._edges=r,this._label=new er(0,Bt.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var n=this.getEdges().getEdges().iterator();n.hasNext();){var r=n.next();if(r.getEdge().isInResult())return!0}return!1},e.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(n){n.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(n){},e.prototype.computeMergedLocation=function(n,r){var s=Bt.NONE;if(s=this._label.getLocation(r),!n.isNull(r)){var c=n.getLocation(r);s!==Bt.BOUNDARY&&(s=c)}return s},e.prototype.setLabel=function(){if(arguments.length===2){var n=arguments[0],r=arguments[1];this._label===null?this._label=new er(n,r):this._label.setLocation(n,r)}else return t.prototype.setLabel.apply(this,arguments)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){var n=this;if(arguments[0]instanceof e){var r=arguments[0];this.mergeLabel(r._label)}else if(arguments[0]instanceof er)for(var s=arguments[0],c=0;c<2;c++){var f=n.computeMergedLocation(s,c),u=n._label.getLocation(c);u===Bt.NONE&&n._label.setLocation(c,f)}},e.prototype.add=function(n){this._edges.insert(n),n.setNode(this)},e.prototype.setLabelBoundary=function(n){if(this._label===null)return null;var r=Bt.NONE;this._label!==null&&(r=this._label.getLocation(n));var s=null;switch(r){case Bt.BOUNDARY:s=Bt.INTERIOR;break;case Bt.INTERIOR:s=Bt.BOUNDARY;break;default:s=Bt.BOUNDARY;break}this._label.setLocation(n,s)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(na),$l=function(){this.nodeMap=new Mo,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};$l.prototype.find=function(t){return this.nodeMap.get(t)};$l.prototype.addNode=function(){if(arguments[0]instanceof Dt){var t=arguments[0],e=this.nodeMap.get(t);return e===null&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}else if(arguments[0]instanceof Iv){var n=arguments[0],r=this.nodeMap.get(n.getCoordinate());return r===null?(this.nodeMap.put(n.getCoordinate(),n),n):(r.mergeLabel(n),r)}};$l.prototype.print=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next();n.print(t)}};$l.prototype.iterator=function(){return this.nodeMap.values().iterator()};$l.prototype.values=function(){return this.nodeMap.values()};$l.prototype.getBoundaryNodes=function(t){for(var e=new be,n=this.iterator();n.hasNext();){var r=n.next();r.getLabel().getLocation(t)===Bt.BOUNDARY&&e.add(r)}return e};$l.prototype.add=function(t){var e=t.getCoordinate(),n=this.addNode(e);n.add(t)};$l.prototype.interfaces_=function(){return[]};$l.prototype.getClass=function(){return $l};var or=function(){},qm={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};or.prototype.interfaces_=function(){return[]};or.prototype.getClass=function(){return or};or.isNorthern=function(t){return t===or.NE||t===or.NW};or.isOpposite=function(t,e){if(t===e)return!1;var n=(t-e+4)%4;return n===2};or.commonHalfPlane=function(t,e){if(t===e)return t;var n=(t-e+4)%4;if(n===2)return-1;var r=t<e?t:e,s=t>e?t:e;return r===0&&s===3?3:r};or.isInHalfPlane=function(t,e){return e===or.SE?t===or.SE||t===or.SW:t===e||t===e+1};or.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new Nr("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?or.NE:or.SE:e>=0?or.NW:or.SW}else if(arguments[0]instanceof Dt&&arguments[1]instanceof Dt){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new Nr("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?or.NE:or.SE:r.y>=n.y?or.NW:or.SW}};qm.NE.get=function(){return 0};qm.NW.get=function(){return 1};qm.SW.get=function(){return 2};qm.SE.get=function(){return 3};Object.defineProperties(or,qm);var Lo=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var e=arguments[0],n=arguments[1],r=arguments[2],s=null;this._edge=e,this.init(n,r),this._label=s}else if(arguments.length===4){var c=arguments[0],f=arguments[1],u=arguments[2],w=arguments[3];this._edge=c,this.init(f,u),this._label=w}};Lo.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Ne.computeOrientation(t._p0,t._p1,this._p1)};Lo.prototype.getDy=function(){return this._dy};Lo.prototype.getCoordinate=function(){return this._p0};Lo.prototype.setNode=function(t){this._node=t};Lo.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),s=n.substring(r+1);t.print("  "+s+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)};Lo.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)};Lo.prototype.getDirectedCoordinate=function(){return this._p1};Lo.prototype.getDx=function(){return this._dx};Lo.prototype.getLabel=function(){return this._label};Lo.prototype.getEdge=function(){return this._edge};Lo.prototype.getQuadrant=function(){return this._quadrant};Lo.prototype.getNode=function(){return this._node};Lo.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf("."),r=e.substring(n+1);return"  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label};Lo.prototype.computeLabel=function(t){};Lo.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=or.quadrant(this._dx,this._dy),yn.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};Lo.prototype.interfaces_=function(){return[ka]};Lo.prototype.getClass=function(){return Lo};var r1=function(t){function e(){var n=arguments[0],r=arguments[1];if(t.call(this,n),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var s=n.getNumPoints()-1;this.init(n.getCoordinate(s),n.getCoordinate(s-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(n){return this._depth[n]},e.prototype.setVisited=function(n){this._isVisited=n},e.prototype.computeDirectedLabel=function(){this._label=new er(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(n,r){if(this._depth[n]!==-999&&this._depth[n]!==r)throw new nc("assigned depths do not match",this.getCoordinate());this._depth[n]=r},e.prototype.isInteriorAreaEdge=function(){for(var n=this,r=!0,s=0;s<2;s++)n._label.isArea(s)&&n._label.getLocation(s,fe.LEFT)===Bt.INTERIOR&&n._label.getLocation(s,fe.RIGHT)===Bt.INTERIOR||(r=!1);return r},e.prototype.setNextMin=function(n){this._nextMin=n},e.prototype.print=function(n){t.prototype.print.call(this,n),n.print(" "+this._depth[fe.LEFT]+"/"+this._depth[fe.RIGHT]),n.print(" ("+this.getDepthDelta()+")"),this._isInResult&&n.print(" inResult")},e.prototype.setMinEdgeRing=function(n){this._minEdgeRing=n},e.prototype.isLineEdge=function(){var n=this._label.isLine(0)||this._label.isLine(1),r=!this._label.isArea(0)||this._label.allPositionsEqual(0,Bt.EXTERIOR),s=!this._label.isArea(1)||this._label.allPositionsEqual(1,Bt.EXTERIOR);return n&&r&&s},e.prototype.setEdgeRing=function(n){this._edgeRing=n},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var n=this._edge.getDepthDelta();return this._isForward||(n=-n),n},e.prototype.setInResult=function(n){this._isInResult=n},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(n){this.print(n),n.print(" "),this._isForward?this._edge.print(n):this._edge.printReverse(n)},e.prototype.setSym=function(n){this._sym=n},e.prototype.setVisitedEdge=function(n){this.setVisited(n),this._sym.setVisited(n)},e.prototype.setEdgeDepths=function(n,r){var s=this.getEdge().getDepthDelta();this._isForward||(s=-s);var c=1;n===fe.LEFT&&(c=-1);var f=fe.opposite(n),u=s*c,w=r+u;this.setDepth(n,r),this.setDepth(f,w)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(n){this._next=n},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(n,r){return n===Bt.EXTERIOR&&r===Bt.INTERIOR?1:n===Bt.INTERIOR&&r===Bt.EXTERIOR?-1:0},e}(Lo),Sd=function(){};Sd.prototype.createNode=function(t){return new Iv(t,null)};Sd.prototype.interfaces_=function(){return[]};Sd.prototype.getClass=function(){return Sd};var Gr=function(){if(this._edges=new be,this._nodes=null,this._edgeEndList=new be,arguments.length===0)this._nodes=new $l(new Sd);else if(arguments.length===1){var t=arguments[0];this._nodes=new $l(t)}};Gr.prototype.printEdges=function(t){var e=this;t.println("Edges:");for(var n=0;n<this._edges.size();n++){t.println("edge "+n+":");var r=e._edges.get(n);r.print(t),r.eiList.print(t)}};Gr.prototype.find=function(t){return this._nodes.find(t)};Gr.prototype.addNode=function(){if(arguments[0]instanceof Iv){var t=arguments[0];return this._nodes.addNode(t)}else if(arguments[0]instanceof Dt){var e=arguments[0];return this._nodes.addNode(e)}};Gr.prototype.getNodeIterator=function(){return this._nodes.iterator()};Gr.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next();e.getEdges().linkResultDirectedEdges()}};Gr.prototype.debugPrintln=function(t){fo.out.println(t)};Gr.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(n===null)return!1;var r=n.getLabel();return r!==null&&r.getLocation(t)===Bt.BOUNDARY};Gr.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next();e.getEdges().linkAllDirectedEdges()}};Gr.prototype.matchInSameDirection=function(t,e,n,r){return t.equals(n)?Ne.computeOrientation(t,e,r)===Ne.COLLINEAR&&or.quadrant(t,e)===or.quadrant(n,r):!1};Gr.prototype.getEdgeEnds=function(){return this._edgeEndList};Gr.prototype.debugPrint=function(t){fo.out.print(t)};Gr.prototype.getEdgeIterator=function(){return this._edges.iterator()};Gr.prototype.findEdgeInSameDirection=function(t,e){for(var n=this,r=0;r<this._edges.size();r++){var s=n._edges.get(r),c=s.getCoordinates();if(n.matchInSameDirection(t,e,c[0],c[1])||n.matchInSameDirection(t,e,c[c.length-1],c[c.length-2]))return s}return null};Gr.prototype.insertEdge=function(t){this._edges.add(t)};Gr.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null};Gr.prototype.addEdges=function(t){for(var e=this,n=t.iterator();n.hasNext();){var r=n.next();e._edges.add(r);var s=new r1(r,!0),c=new r1(r,!1);s.setSym(c),c.setSym(s),e.add(s),e.add(c)}};Gr.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)};Gr.prototype.getNodes=function(){return this._nodes.values()};Gr.prototype.findEdge=function(t,e){for(var n=this,r=0;r<this._edges.size();r++){var s=n._edges.get(r),c=s.getCoordinates();if(t.equals(c[0])&&e.equals(c[1]))return s}return null};Gr.prototype.interfaces_=function(){return[]};Gr.prototype.getClass=function(){return Gr};Gr.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.getEdges().linkResultDirectedEdges()}};var ks=function(){this._geometryFactory=null,this._shellList=new be;var t=arguments[0];this._geometryFactory=t};ks.prototype.sortShellsAndHoles=function(t,e,n){for(var r=t.iterator();r.hasNext();){var s=r.next();s.isHole()?n.add(s):e.add(s)}};ks.prototype.computePolygons=function(t){for(var e=this,n=new be,r=t.iterator();r.hasNext();){var s=r.next(),c=s.toPolygon(e._geometryFactory);n.add(c)}return n};ks.prototype.placeFreeHoles=function(t,e){for(var n=this,r=e.iterator();r.hasNext();){var s=r.next();if(s.getShell()===null){var c=n.findEdgeRingContaining(s,t);if(c===null)throw new nc("unable to assign hole to a shell",s.getCoordinate(0));s.setShell(c)}}};ks.prototype.buildMinimalEdgeRings=function(t,e,n){for(var r=this,s=new be,c=t.iterator();c.hasNext();){var f=c.next();if(f.getMaxNodeDegree()>2){f.linkDirectedEdgesForMinimalEdgeRings();var u=f.buildMinimalRings(),w=r.findShell(u);w!==null?(r.placePolygonHoles(w,u),e.add(w)):n.addAll(u)}else s.add(f)}return s};ks.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();){var n=e.next();if(n.containsPoint(t))return!0}return!1};ks.prototype.buildMaximalEdgeRings=function(t){for(var e=this,n=new be,r=t.iterator();r.hasNext();){var s=r.next();if(s.isInResult()&&s.getLabel().isArea()&&s.getEdgeRing()===null){var c=new TD(s,e._geometryFactory);n.add(c),c.setInResult()}}return n};ks.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(t)}};ks.prototype.getPolygons=function(){var t=this.computePolygons(this._shellList);return t};ks.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),r=n.getEnvelopeInternal(),s=n.getCoordinateN(0),c=null,f=null,u=e.iterator();u.hasNext();){var w=u.next(),S=w.getLinearRing(),A=S.getEnvelopeInternal();c!==null&&(f=c.getLinearRing().getEnvelopeInternal());var N=!1;A.contains(r)&&Ne.isPointInRing(s,S.getCoordinates())&&(N=!0),N&&(c===null||f.contains(A))&&(c=w)}return c};ks.prototype.findShell=function(t){for(var e=0,n=null,r=t.iterator();r.hasNext();){var s=r.next();s.isHole()||(n=s,e++)}return yn.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n};ks.prototype.add=function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var e=arguments[0],n=arguments[1];Gr.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(e),s=new be,c=this.buildMinimalEdgeRings(r,this._shellList,s);this.sortShellsAndHoles(c,this._shellList,s),this.placeFreeHoles(this._shellList,s)}};ks.prototype.interfaces_=function(){return[]};ks.prototype.getClass=function(){return ks};var Id=function(){};Id.prototype.getBounds=function(){};Id.prototype.interfaces_=function(){return[]};Id.prototype.getClass=function(){return Id};var Qa=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Qa.prototype.getItem=function(){return this._item};Qa.prototype.getBounds=function(){return this._bounds};Qa.prototype.interfaces_=function(){return[Id,Na]};Qa.prototype.getClass=function(){return Qa};var rc=function(){this._size=null,this._items=null,this._size=0,this._items=new be,this._items.add(null)};rc.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t};rc.prototype.size=function(){return this._size};rc.prototype.reorder=function(t){for(var e=this,n=null,r=this._items.get(t);t*2<=this._size&&(n=t*2,n!==e._size&&e._items.get(n+1).compareTo(e._items.get(n))<0&&n++,e._items.get(n).compareTo(r)<0);t=n)e._items.set(t,e._items.get(n));this._items.set(t,r)};rc.prototype.clear=function(){this._size=0,this._items.clear()};rc.prototype.isEmpty=function(){return this._size===0};rc.prototype.add=function(t){var e=this;this._items.add(null),this._size+=1;var n=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(n/2)))<0;n/=2)e._items.set(n,e._items.get(Math.trunc(n/2)));this._items.set(n,t)};rc.prototype.interfaces_=function(){return[]};rc.prototype.getClass=function(){return rc};var qc=function(){};qc.prototype.visitItem=function(t){};qc.prototype.interfaces_=function(){return[]};qc.prototype.getClass=function(){return qc};var Jp=function(){};Jp.prototype.insert=function(t,e){};Jp.prototype.remove=function(t,e){};Jp.prototype.query=function(){};Jp.prototype.interfaces_=function(){return[]};Jp.prototype.getClass=function(){return Jp};var Mi=function(){if(this._childBoundables=new be,this._bounds=null,this._level=null,arguments.length!==0&&arguments.length===1){var t=arguments[0];this._level=t}},y2={serialVersionUID:{configurable:!0}};Mi.prototype.getLevel=function(){return this._level};Mi.prototype.size=function(){return this._childBoundables.size()};Mi.prototype.getChildBoundables=function(){return this._childBoundables};Mi.prototype.addChildBoundable=function(t){yn.isTrue(this._bounds===null),this._childBoundables.add(t)};Mi.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};Mi.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};Mi.prototype.interfaces_=function(){return[Id,Na]};Mi.prototype.getClass=function(){return Mi};y2.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(Mi,y2);var tl=function(){};tl.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}};tl.min=function(t){return tl.sort(t),t.get(0)};tl.sort=function(t,e){var n=t.toArray();e?Kh.sort(n,e):Kh.sort(n);for(var r=t.iterator(),s=0,c=n.length;s<c;s++)r.next(),r.set(n[s])};tl.singletonList=function(t){var e=new be;return e.add(t),e};var mi=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};mi.prototype.expandToQueue=function(t,e){var n=mi.isComposite(this._boundable1),r=mi.isComposite(this._boundable2);if(n&&r)return mi.area(this._boundable1)>mi.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(r)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new Nr("neither boundable is composite")};mi.prototype.isLeaves=function(){return!(mi.isComposite(this._boundable1)||mi.isComposite(this._boundable2))};mi.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0};mi.prototype.expand=function(t,e,n,r){for(var s=this,c=t.getChildBoundables(),f=c.iterator();f.hasNext();){var u=f.next(),w=new mi(u,e,s._itemDistance);w.getDistance()<r&&n.add(w)}};mi.prototype.getBoundable=function(t){return t===0?this._boundable1:this._boundable2};mi.prototype.getDistance=function(){return this._distance};mi.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};mi.prototype.interfaces_=function(){return[ka]};mi.prototype.getClass=function(){return mi};mi.area=function(t){return t.getBounds().getArea()};mi.isComposite=function(t){return t instanceof Mi};var io=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new be,this._nodeCapacity=null,arguments.length===0){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(arguments.length===1){var n=arguments[0];yn.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},Cv={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};io.prototype.getNodeCapacity=function(){return this._nodeCapacity};io.prototype.lastNode=function(t){return t.get(t.size()-1)};io.prototype.size=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var e=arguments[0],n=0,r=e.getChildBoundables().iterator();r.hasNext();){var s=r.next();s instanceof Mi?n+=t.size(s):s instanceof Qa&&(n+=1)}return n}};io.prototype.removeItem=function(t,e){for(var n=null,r=t.getChildBoundables().iterator();r.hasNext();){var s=r.next();s instanceof Qa&&s.getItem()===e&&(n=s)}return n!==null?(t.getChildBoundables().remove(n),!0):!1};io.prototype.itemsTree=function(){var t=this;if(arguments.length===0){this.build();var e=this.itemsTree(this._root);return e===null?new be:e}else if(arguments.length===1){for(var n=arguments[0],r=new be,s=n.getChildBoundables().iterator();s.hasNext();){var c=s.next();if(c instanceof Mi){var f=t.itemsTree(c);f!==null&&r.add(f)}else c instanceof Qa?r.add(c.getItem()):yn.shouldNeverReachHere()}return r.size()<=0?null:r}};io.prototype.insert=function(t,e){yn.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Qa(t,e))};io.prototype.boundablesAtLevel=function(){var t=this;if(arguments.length===1){var e=arguments[0],n=new be;return this.boundablesAtLevel(e,this._root,n),n}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];if(yn.isTrue(r>-2),s.getLevel()===r)return c.add(s),null;for(var f=s.getChildBoundables().iterator();f.hasNext();){var u=f.next();u instanceof Mi?t.boundablesAtLevel(r,u,c):(yn.isTrue(u instanceof Qa),r===-1&&c.add(u))}return null}};io.prototype.query=function(){var t=this;if(arguments.length===1){var e=arguments[0];this.build();var n=new be;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,n),n}else if(arguments.length===2){var r=arguments[0],s=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),r)&&this.query(r,this._root,s)}else if(arguments.length===3){if(an(arguments[2],qc)&&arguments[0]instanceof Object&&arguments[1]instanceof Mi)for(var c=arguments[0],f=arguments[1],u=arguments[2],w=f.getChildBoundables(),S=0;S<w.size();S++){var A=w.get(S);t.getIntersectsOp().intersects(A.getBounds(),c)&&(A instanceof Mi?t.query(c,A,u):A instanceof Qa?u.visitItem(A.getItem()):yn.shouldNeverReachHere())}else if(an(arguments[2],Ha)&&arguments[0]instanceof Object&&arguments[1]instanceof Mi)for(var N=arguments[0],O=arguments[1],j=arguments[2],W=O.getChildBoundables(),nt=0;nt<W.size();nt++){var pt=W.get(nt);t.getIntersectsOp().intersects(pt.getBounds(),N)&&(pt instanceof Mi?t.query(N,pt,j):pt instanceof Qa?j.add(pt.getItem()):yn.shouldNeverReachHere())}}};io.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};io.prototype.getRoot=function(){return this.build(),this._root};io.prototype.remove=function(){var t=this;if(arguments.length===2){var e=arguments[0],n=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),e)?this.remove(e,this._root,n):!1}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2],f=this.removeItem(s,c);if(f)return!0;for(var u=null,w=s.getChildBoundables().iterator();w.hasNext();){var S=w.next();if(t.getIntersectsOp().intersects(S.getBounds(),r)&&S instanceof Mi&&(f=t.remove(r,S,c),f)){u=S;break}}return u!==null&&u.getChildBoundables().isEmpty()&&s.getChildBoundables().remove(u),f}};io.prototype.createHigherLevels=function(t,e){yn.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return n.size()===1?n.get(0):this.createHigherLevels(n,e+1)};io.prototype.depth=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var e=arguments[0],n=0,r=e.getChildBoundables().iterator();r.hasNext();){var s=r.next();if(s instanceof Mi){var c=t.depth(s);c>n&&(n=c)}}return n+1}};io.prototype.createParentBoundables=function(t,e){var n=this;yn.isTrue(!t.isEmpty());var r=new be;r.add(this.createNode(e));var s=new be(t);tl.sort(s,this.getComparator());for(var c=s.iterator();c.hasNext();){var f=c.next();n.lastNode(r).getChildBoundables().size()===n.getNodeCapacity()&&r.add(n.createNode(e)),n.lastNode(r).addChildBoundable(f)}return r};io.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};io.prototype.interfaces_=function(){return[Na]};io.prototype.getClass=function(){return io};io.compareDoubles=function(t,e){return t>e?1:t<e?-1:0};Cv.IntersectsOp.get=function(){return PD};Cv.serialVersionUID.get=function(){return-3886435814360241e3};Cv.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(io,Cv);var PD=function(){},Cd=function(){};Cd.prototype.distance=function(t,e){};Cd.prototype.interfaces_=function(){return[]};Cd.prototype.getClass=function(){return Cd};var _2=function(t){function e(r){r=r||e.DEFAULT_NODE_CAPACITY,t.call(this,r)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(r,s){var c=this;yn.isTrue(r.length>0);for(var f=new be,u=0;u<r.length;u++)f.addAll(c.createParentBoundablesFromVerticalSlice(r[u],s));return f},e.prototype.createNode=function(r){return new QS(r)},e.prototype.size=function(){return arguments.length===0?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];if(r.isNull())return null;t.prototype.insert.call(this,r,s)}else return t.prototype.insert.apply(this,arguments)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(r,s){for(var c=Math.trunc(Math.ceil(r.size()/s)),f=new Array(s).fill(null),u=r.iterator(),w=0;w<s;w++){f[w]=new be;for(var S=0;u.hasNext()&&S<c;){var A=u.next();f[w].add(A),S++}}return f},e.prototype.query=function(){if(arguments.length===1){var r=arguments[0];return t.prototype.query.call(this,r)}else if(arguments.length===2){var s=arguments[0],c=arguments[1];t.prototype.query.call(this,s,c)}else if(arguments.length===3){if(an(arguments[2],qc)&&arguments[0]instanceof Object&&arguments[1]instanceof Mi){var f=arguments[0],u=arguments[1],w=arguments[2];t.prototype.query.call(this,f,u,w)}else if(an(arguments[2],Ha)&&arguments[0]instanceof Object&&arguments[1]instanceof Mi){var S=arguments[0],A=arguments[1],N=arguments[2];t.prototype.query.call(this,S,A,N)}}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(r,s){return t.prototype.createParentBoundables.call(this,r,s)},e.prototype.remove=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];return t.prototype.remove.call(this,r,s)}else return t.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return arguments.length===0?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(r,s){yn.isTrue(!r.isEmpty());var c=Math.trunc(Math.ceil(r.size()/this.getNodeCapacity())),f=new be(r);tl.sort(f,e.xComparator);var u=this.verticalSlices(f,Math.trunc(Math.ceil(Math.sqrt(c))));return this.createParentBoundablesFromVerticalSlices(u,s)},e.prototype.nearestNeighbour=function(){if(arguments.length===1){if(an(arguments[0],Cd)){var r=arguments[0],s=new mi(this.getRoot(),this.getRoot(),r);return this.nearestNeighbour(s)}else if(arguments[0]instanceof mi){var c=arguments[0];return this.nearestNeighbour(c,cn.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof e&&an(arguments[1],Cd)){var f=arguments[0],u=arguments[1],w=new mi(this.getRoot(),f.getRoot(),u);return this.nearestNeighbour(w)}else if(arguments[0]instanceof mi&&typeof arguments[1]=="number"){var S=arguments[0],A=arguments[1],N=A,O=null,j=new rc;for(j.add(S);!j.isEmpty()&&N>0;){var W=j.poll(),nt=W.getDistance();if(nt>=N)break;W.isLeaves()?(N=nt,O=W):W.expandToQueue(j,N)}return[O.getBoundable(0).getItem(),O.getBoundable(1).getItem()]}}else if(arguments.length===3){var pt=arguments[0],J=arguments[1],tt=arguments[2],Q=new Qa(pt,J),_t=new mi(this.getRoot(),Q,tt);return this.nearestNeighbour(_t)[0]}},e.prototype.interfaces_=function(){return[Jp,Na]},e.prototype.getClass=function(){return e},e.centreX=function(r){return e.avg(r.getMinX(),r.getMaxX())},e.avg=function(r,s){return(r+s)/2},e.centreY=function(r){return e.avg(r.getMinY(),r.getMaxY())},n.STRtreeNode.get=function(){return QS},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[md]},compare:function(r,s){return t.compareDoubles(e.centreX(r.getBounds()),e.centreX(s.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[md]},compare:function(r,s){return t.compareDoubles(e.centreY(r.getBounds()),e.centreY(s.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(r,s){return r.intersects(s)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,n),e}(io),QS=function(t){function e(){var n=arguments[0];t.call(this,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var n=null,r=this.getChildBoundables().iterator();r.hasNext();){var s=r.next();n===null?n=new He(s.getBounds()):n.expandToInclude(s.getBounds())}return n},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Mi),hs=function(){};hs.prototype.interfaces_=function(){return[]};hs.prototype.getClass=function(){return hs};hs.relativeSign=function(t,e){return t<e?-1:t>e?1:0};hs.compare=function(t,e,n){if(e.equals2D(n))return 0;var r=hs.relativeSign(e.x,n.x),s=hs.relativeSign(e.y,n.y);switch(t){case 0:return hs.compareValue(r,s);case 1:return hs.compareValue(s,r);case 2:return hs.compareValue(s,-r);case 3:return hs.compareValue(-r,s);case 4:return hs.compareValue(-r,-s);case 5:return hs.compareValue(-s,-r);case 6:return hs.compareValue(-s,r);case 7:return hs.compareValue(r,-s)}return yn.shouldNeverReachHere("invalid octant value"),0};hs.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var Zc=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._segString=t,this.coord=new Dt(e),this.segmentIndex=n,this._segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(n))};Zc.prototype.getCoordinate=function(){return this.coord};Zc.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)};Zc.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:hs.compare(this._segmentOctant,this.coord,e.coord)};Zc.prototype.isEndPoint=function(t){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===t};Zc.prototype.isInterior=function(){return this._isInterior};Zc.prototype.interfaces_=function(){return[ka]};Zc.prototype.getClass=function(){return Zc};var Qo=function(){this._nodeMap=new Mo,this._edge=null;var t=arguments[0];this._edge=t};Qo.prototype.getSplitCoordinates=function(){var t=this,e=new Gm;this.addEndpoints();for(var n=this.iterator(),r=n.next();n.hasNext();){var s=n.next();t.addEdgeCoordinates(r,s,e),r=s}return e.toCoordinateArray()};Qo.prototype.addCollapsedNodes=function(){var t=this,e=new be;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var n=e.iterator();n.hasNext();){var r=n.next().intValue();t.add(t._edge.getCoordinate(r),r)}};Qo.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){var n=e.next();n.print(t)}};Qo.prototype.findCollapsesFromExistingVertices=function(t){for(var e=this,n=0;n<this._edge.size()-2;n++){var r=e._edge.getCoordinate(n),s=e._edge.getCoordinate(n+2);r.equals2D(s)&&t.add(new zl(n+1))}};Qo.prototype.addEdgeCoordinates=function(t,e,n){var r=this,s=this._edge.getCoordinate(e.segmentIndex),c=e.isInterior()||!e.coord.equals2D(s);n.add(new Dt(t.coord),!1);for(var f=t.segmentIndex+1;f<=e.segmentIndex;f++)n.add(r._edge.getCoordinate(f));c&&n.add(new Dt(e.coord))};Qo.prototype.iterator=function(){return this._nodeMap.values().iterator()};Qo.prototype.addSplitEdges=function(t){var e=this;this.addEndpoints(),this.addCollapsedNodes();for(var n=this.iterator(),r=n.next();n.hasNext();){var s=n.next(),c=e.createSplitEdge(r,s);t.add(c),r=s}};Qo.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var r=e.segmentIndex-t.segmentIndex;return e.isInterior()||r--,r===1?(n[0]=t.segmentIndex+1,!0):!1};Qo.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=this,n=new Array(1).fill(null),r=this.iterator(),s=r.next();r.hasNext();){var c=r.next(),f=e.findCollapseIndex(s,c,n);f&&t.add(new zl(n[0])),s=c}};Qo.prototype.getEdge=function(){return this._edge};Qo.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)};Qo.prototype.createSplitEdge=function(t,e){var n=this,r=e.segmentIndex-t.segmentIndex+2,s=this._edge.getCoordinate(e.segmentIndex),c=e.isInterior()||!e.coord.equals2D(s);c||r--;var f=new Array(r).fill(null),u=0;f[u++]=new Dt(t.coord);for(var w=t.segmentIndex+1;w<=e.segmentIndex;w++)f[u++]=n._edge.getCoordinate(w);return c&&(f[u]=new Dt(e.coord)),new ai(f,this._edge.getData())};Qo.prototype.add=function(t,e){var n=new Zc(this._edge,t,e,this._edge.getSegmentOctant(e)),r=this._nodeMap.get(n);return r!==null?(yn.isTrue(r.coord.equals2D(t),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(n,n),n)};Qo.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0),r=n.getCoordinate(0);if(!r.equals2D(e[0]))throw new tc("bad split edge start point at "+r);var s=t.get(t.size()-1),c=s.getCoordinates(),f=c[c.length-1];if(!f.equals2D(e[e.length-1]))throw new tc("bad split edge end point at "+f)};Qo.prototype.interfaces_=function(){return[]};Qo.prototype.getClass=function(){return Qo};var Qp=function(){};Qp.prototype.interfaces_=function(){return[]};Qp.prototype.getClass=function(){return Qp};Qp.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new Nr("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}else if(arguments[0]instanceof Dt&&arguments[1]instanceof Dt){var s=arguments[0],c=arguments[1],f=c.x-s.x,u=c.y-s.y;if(f===0&&u===0)throw new Nr("Cannot compute the octant for two identical points "+s);return Qp.octant(f,u)}};var wu=function(){};wu.prototype.getCoordinates=function(){};wu.prototype.size=function(){};wu.prototype.getCoordinate=function(t){};wu.prototype.isClosed=function(){};wu.prototype.setData=function(t){};wu.prototype.getData=function(){};wu.prototype.interfaces_=function(){return[]};wu.prototype.getClass=function(){return wu};var Pm=function(){};Pm.prototype.addIntersection=function(t,e){};Pm.prototype.interfaces_=function(){return[wu]};Pm.prototype.getClass=function(){return Pm};var ai=function(){this._nodeList=new Qo(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};ai.prototype.getCoordinates=function(){return this._pts};ai.prototype.size=function(){return this._pts.length};ai.prototype.getCoordinate=function(t){return this._pts[t]};ai.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};ai.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))};ai.prototype.setData=function(t){this._data=t};ai.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:Qp.octant(t,e)};ai.prototype.getData=function(){return this._data};ai.prototype.addIntersection=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(arguments.length===4){var n=arguments[0],r=arguments[1],s=arguments[3],c=new Dt(n.getIntersection(s));this.addIntersection(c,r)}};ai.prototype.toString=function(){return Ka.toLineString(new ri(this._pts))};ai.prototype.getNodeList=function(){return this._nodeList};ai.prototype.addIntersectionNode=function(t,e){var n=e,r=n+1;if(r<this._pts.length){var s=this._pts[r];t.equals2D(s)&&(n=r)}var c=this._nodeList.add(t,n);return c};ai.prototype.addIntersections=function(t,e,n){for(var r=this,s=0;s<t.getIntersectionNum();s++)r.addIntersection(t,e,n,s)};ai.prototype.interfaces_=function(){return[Pm]};ai.prototype.getClass=function(){return ai};ai.getNodedSubstrings=function(){if(arguments.length===1){var t=arguments[0],e=new be;return ai.getNodedSubstrings(t,e),e}else if(arguments.length===2)for(var n=arguments[0],r=arguments[1],s=n.iterator();s.hasNext();){var c=s.next();c.getNodeList().addSplitEdges(r)}};var Ye=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new Dt,this.p1=new Dt;else if(arguments.length===1){var t=arguments[0];this.p0=new Dt(t.p0),this.p1=new Dt(t.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];this.p0=new Dt(e,n),this.p1=new Dt(r,s)}},v2={serialVersionUID:{configurable:!0}};Ye.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};Ye.prototype.orientationIndex=function(){if(arguments[0]instanceof Ye){var t=arguments[0],e=Ne.orientationIndex(this.p0,this.p1,t.p0),n=Ne.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}else if(arguments[0]instanceof Dt){var r=arguments[0];return Ne.orientationIndex(this.p0,this.p1,r)}};Ye.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])};Ye.prototype.isVertical=function(){return this.p0.x===this.p1.x};Ye.prototype.equals=function(t){if(!(t instanceof Ye))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)};Ye.prototype.intersection=function(t){var e=new vp;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null};Ye.prototype.project=function(){if(arguments[0]instanceof Dt){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new Dt(t);var e=this.projectionFactor(t),n=new Dt;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}else if(arguments[0]instanceof Ye){var r=arguments[0],s=this.projectionFactor(r.p0),c=this.projectionFactor(r.p1);if(s>=1&&c>=1||s<=0&&c<=0)return null;var f=this.project(r.p0);s<0&&(f=this.p0),s>1&&(f=this.p1);var u=this.project(r.p1);return c<0&&(u=this.p0),c>1&&(u=this.p1),new Ye(f,u)}};Ye.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};Ye.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};Ye.prototype.getCoordinate=function(t){return t===0?this.p0:this.p1};Ye.prototype.distancePerpendicular=function(t){return Ne.distancePointLinePerpendicular(t,this.p0,this.p1)};Ye.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};Ye.prototype.midPoint=function(){return Ye.midPoint(this.p0,this.p1)};Ye.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=e*e+n*n;if(r<=0)return cn.NaN;var s=((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r;return s};Ye.prototype.closestPoints=function(t){var e=this.intersection(t);if(e!==null)return[e,e];var n=new Array(2).fill(null),r=cn.MAX_VALUE,s=null,c=this.closestPoint(t.p0);r=c.distance(t.p0),n[0]=c,n[1]=t.p0;var f=this.closestPoint(t.p1);s=f.distance(t.p1),s<r&&(r=s,n[0]=f,n[1]=t.p1);var u=t.closestPoint(this.p0);s=u.distance(this.p0),s<r&&(r=s,n[0]=this.p0,n[1]=u);var w=t.closestPoint(this.p1);return s=w.distance(this.p1),s<r&&(r=s,n[0]=this.p1,n[1]=w),n};Ye.prototype.closestPoint=function(t){var e=this.projectionFactor(t);if(e>0&&e<1)return this.project(t);var n=this.p0.distance(t),r=this.p1.distance(t);return n<r?this.p0:this.p1};Ye.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};Ye.prototype.getLength=function(){return this.p0.distance(this.p1)};Ye.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return n!==0?n:this.p1.compareTo(e.p1)};Ye.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t};Ye.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)};Ye.prototype.lineIntersection=function(t){try{var e=Wa.intersection(this.p0,this.p1,t.p0,t.p1);return e}catch(n){if(!(n instanceof Vd))throw n}finally{}return null};Ye.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};Ye.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),r=this.p0.y+t*(this.p1.y-this.p0.y),s=this.p1.x-this.p0.x,c=this.p1.y-this.p0.y,f=Math.sqrt(s*s+c*c),u=0,w=0;if(e!==0){if(f<=0)throw new Error("Cannot compute offset from zero-length line segment");u=e*s/f,w=e*c/f}var S=n-w,A=r+u,N=new Dt(S,A);return N};Ye.prototype.setCoordinates=function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}};Ye.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||cn.isNaN(e))&&(e=1),e};Ye.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};Ye.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};Ye.prototype.distance=function(){if(arguments[0]instanceof Ye){var t=arguments[0];return Ne.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}else if(arguments[0]instanceof Dt){var e=arguments[0];return Ne.distancePointLine(e,this.p0,this.p1)}};Ye.prototype.pointAlong=function(t){var e=new Dt;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e};Ye.prototype.hashCode=function(){var t=cn.doubleToLongBits(this.p0.x);t^=cn.doubleToLongBits(this.p0.y)*31;var e=Math.trunc(t)^Math.trunc(t>>32),n=cn.doubleToLongBits(this.p1.x);n^=cn.doubleToLongBits(this.p1.y)*31;var r=Math.trunc(n)^Math.trunc(n>>32);return e^r};Ye.prototype.interfaces_=function(){return[ka,Na]};Ye.prototype.getClass=function(){return Ye};Ye.midPoint=function(t,e){return new Dt((t.x+e.x)/2,(t.y+e.y)/2)};v2.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(Ye,v2);var Mm=function(){this.tempEnv1=new He,this.tempEnv2=new He,this._overlapSeg1=new Ye,this._overlapSeg2=new Ye};Mm.prototype.overlap=function(){if(arguments.length!==2&&arguments.length===4){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(r,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}};Mm.prototype.interfaces_=function(){return[]};Mm.prototype.getClass=function(){return Mm};var Ns=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=r};Ns.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]};Ns.prototype.computeSelect=function(t,e,n,r){var s=this._pts[e],c=this._pts[n];if(r.tempEnv1.init(s,c),n-e===1)return r.select(this,e),null;if(!t.intersects(r.tempEnv1))return null;var f=Math.trunc((e+n)/2);e<f&&this.computeSelect(t,e,f,r),f<n&&this.computeSelect(t,f,n,r)};Ns.prototype.getCoordinates=function(){for(var t=this,e=new Array(this._end-this._start+1).fill(null),n=0,r=this._start;r<=this._end;r++)e[n++]=t._pts[r];return e};Ns.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)};Ns.prototype.setId=function(t){this._id=t};Ns.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)};Ns.prototype.getEnvelope=function(){if(this._env===null){var t=this._pts[this._start],e=this._pts[this._end];this._env=new He(t,e)}return this._env};Ns.prototype.getEndIndex=function(){return this._end};Ns.prototype.getStartIndex=function(){return this._start};Ns.prototype.getContext=function(){return this._context};Ns.prototype.getId=function(){return this._id};Ns.prototype.computeOverlapsInternal=function(t,e,n,r,s,c){var f=this._pts[t],u=this._pts[e],w=n._pts[r],S=n._pts[s];if(e-t===1&&s-r===1)return c.overlap(this,t,n,r),null;if(c.tempEnv1.init(f,u),c.tempEnv2.init(w,S),!c.tempEnv1.intersects(c.tempEnv2))return null;var A=Math.trunc((t+e)/2),N=Math.trunc((r+s)/2);t<A&&(r<N&&this.computeOverlapsInternal(t,A,n,r,N,c),N<s&&this.computeOverlapsInternal(t,A,n,N,s,c)),A<e&&(r<N&&this.computeOverlapsInternal(A,e,n,r,N,c),N<s&&this.computeOverlapsInternal(A,e,n,N,s,c))};Ns.prototype.interfaces_=function(){return[]};Ns.prototype.getClass=function(){return Ns};var Dl=function(){};Dl.prototype.interfaces_=function(){return[]};Dl.prototype.getClass=function(){return Dl};Dl.getChainStartIndices=function(t){var e=0,n=new be;n.add(new zl(e));do{var r=Dl.findChainEnd(t,e);n.add(new zl(r)),e=r}while(e<t.length-1);var s=Dl.toIntArray(n);return s};Dl.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var r=or.quadrant(t[n],t[n+1]),s=e+1;s<t.length;){if(!t[s-1].equals2D(t[s])){var c=or.quadrant(t[s-1],t[s]);if(c!==r)break}s++}return s-1};Dl.getChains=function(){if(arguments.length===1){var t=arguments[0];return Dl.getChains(t,null)}else if(arguments.length===2){for(var e=arguments[0],n=arguments[1],r=new be,s=Dl.getChainStartIndices(e),c=0;c<s.length-1;c++){var f=new Ns(e,s[c],s[c+1],n);r.add(f)}return r}};Dl.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var op=function(){};op.prototype.computeNodes=function(t){};op.prototype.getNodedSubstrings=function(){};op.prototype.interfaces_=function(){return[]};op.prototype.getClass=function(){return op};var Lm=function(){if(this._segInt=null,arguments.length!==0&&arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}};Lm.prototype.setSegmentIntersector=function(t){this._segInt=t};Lm.prototype.interfaces_=function(){return[op]};Lm.prototype.getClass=function(){return Lm};var yw=function(t){function e(r){r?t.call(this,r):t.call(this),this._monoChains=new be,this._index=new _2,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return ai.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(r){for(var s=this,c=Dl.getChains(r.getCoordinates(),r),f=c.iterator();f.hasNext();){var u=f.next();u.setId(s._idCounter++),s._index.insert(u.getEnvelope(),u),s._monoChains.add(u)}},e.prototype.computeNodes=function(r){var s=this;this._nodedSegStrings=r;for(var c=r.iterator();c.hasNext();)s.add(c.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var r=this,s=new tI(this._segInt),c=this._monoChains.iterator();c.hasNext();)for(var f=c.next(),u=r._index.query(f.getEnvelope()),w=u.iterator();w.hasNext();){var S=w.next();if(S.getId()>f.getId()&&(f.computeOverlaps(S,s),r._nOverlaps++),r._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return tI},Object.defineProperties(e,n),e}(Lm),tI=function(t){function e(){t.call(this),this._si=null;var n=arguments[0];this._si=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(arguments.length===4){var n=arguments[0],r=arguments[1],s=arguments[2],c=arguments[3],f=n.getContext(),u=s.getContext();this._si.processIntersections(f,r,u,c)}else return t.prototype.overlap.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Mm),Gn=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setQuadrantSegments(e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(arguments.length===4){var s=arguments[0],c=arguments[1],f=arguments[2],u=arguments[3];this.setQuadrantSegments(s),this.setEndCapStyle(c),this.setJoinStyle(f),this.setMitreLimit(u)}}},ac={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Gn.prototype.getEndCapStyle=function(){return this._endCapStyle};Gn.prototype.isSingleSided=function(){return this._isSingleSided};Gn.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=Gn.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Gn.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Gn.JOIN_ROUND&&(this._quadrantSegments=Gn.DEFAULT_QUADRANT_SEGMENTS)};Gn.prototype.getJoinStyle=function(){return this._joinStyle};Gn.prototype.setJoinStyle=function(t){this._joinStyle=t};Gn.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t};Gn.prototype.getSimplifyFactor=function(){return this._simplifyFactor};Gn.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Gn.prototype.setEndCapStyle=function(t){this._endCapStyle=t};Gn.prototype.getMitreLimit=function(){return this._mitreLimit};Gn.prototype.setMitreLimit=function(t){this._mitreLimit=t};Gn.prototype.setSingleSided=function(t){this._isSingleSided=t};Gn.prototype.interfaces_=function(){return[]};Gn.prototype.getClass=function(){return Gn};Gn.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)};ac.CAP_ROUND.get=function(){return 1};ac.CAP_FLAT.get=function(){return 2};ac.CAP_SQUARE.get=function(){return 3};ac.JOIN_ROUND.get=function(){return 1};ac.JOIN_MITRE.get=function(){return 2};ac.JOIN_BEVEL.get=function(){return 3};ac.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};ac.DEFAULT_MITRE_LIMIT.get=function(){return 5};ac.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(Gn,ac);var Yr=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Ne.COUNTERCLOCKWISE,this._inputLine=t||null},Zm={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Yr.prototype.isDeletable=function(t,e,n,r){var s=this._inputLine[t],c=this._inputLine[e],f=this._inputLine[n];return!this.isConcave(s,c,f)||!this.isShallow(s,c,f,r)?!1:this.isShallowSampled(s,c,t,n,r)};Yr.prototype.deleteShallowConcavities=function(){for(var t=this,e=1,n=this.findNextNonDeletedIndex(e),r=this.findNextNonDeletedIndex(n),s=!1;r<this._inputLine.length;){var c=!1;t.isDeletable(e,n,r,t._distanceTol)&&(t._isDeleted[n]=Yr.DELETE,c=!0,s=!0),c?e=r:e=n,n=t.findNextNonDeletedIndex(e),r=t.findNextNonDeletedIndex(n)}return s};Yr.prototype.isShallowConcavity=function(t,e,n,r){var s=Ne.computeOrientation(t,e,n),c=s===this._angleOrientation;if(!c)return!1;var f=Ne.distancePointLine(e,t,n);return f<r};Yr.prototype.isShallowSampled=function(t,e,n,r,s){var c=this,f=Math.trunc((r-n)/Yr.NUM_PTS_TO_CHECK);f<=0&&(f=1);for(var u=n;u<r;u+=f)if(!c.isShallow(t,e,c._inputLine[u],s))return!1;return!0};Yr.prototype.isConcave=function(t,e,n){var r=Ne.computeOrientation(t,e,n),s=r===this._angleOrientation;return s};Yr.prototype.simplify=function(t){var e=this;this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Ne.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var n=!1;do n=e.deleteShallowConcavities();while(n);return this.collapseLine()};Yr.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Yr.DELETE;)e++;return e};Yr.prototype.isShallow=function(t,e,n,r){var s=Ne.distancePointLine(e,t,n);return s<r};Yr.prototype.collapseLine=function(){for(var t=this,e=new Gm,n=0;n<this._inputLine.length;n++)t._isDeleted[n]!==Yr.DELETE&&e.add(t._inputLine[n]);return e.toCoordinateArray()};Yr.prototype.interfaces_=function(){return[]};Yr.prototype.getClass=function(){return Yr};Yr.simplify=function(t,e){var n=new Yr(t);return n.simplify(e)};Zm.INIT.get=function(){return 0};Zm.DELETE.get=function(){return 1};Zm.KEEP.get=function(){return 1};Zm.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(Yr,Zm);var ra=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new be},x2={COORDINATE_ARRAY_TYPE:{configurable:!0}};ra.prototype.getCoordinates=function(){var t=this._ptList.toArray(ra.COORDINATE_ARRAY_TYPE);return t};ra.prototype.setPrecisionModel=function(t){this._precisionModel=t};ra.prototype.addPt=function(t){var e=new Dt(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)};ra.prototype.revere=function(){};ra.prototype.addPts=function(t,e){var n=this;if(e)for(var r=0;r<t.length;r++)n.addPt(t[r]);else for(var s=t.length-1;s>=0;s--)n.addPt(t[s])};ra.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1),n=t.distance(e);return n<this._minimimVertexDistance};ra.prototype.toString=function(){var t=new Tn,e=t.createLineString(this.getCoordinates());return e.toString()};ra.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new Dt(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)};ra.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t};ra.prototype.interfaces_=function(){return[]};ra.prototype.getClass=function(){return ra};x2.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(ra,x2);var zn=function(){},mf={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};zn.prototype.interfaces_=function(){return[]};zn.prototype.getClass=function(){return zn};zn.toDegrees=function(t){return t*180/Math.PI};zn.normalize=function(t){for(;t>Math.PI;)t-=zn.PI_TIMES_2;for(;t<=-Math.PI;)t+=zn.PI_TIMES_2;return t};zn.angle=function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}else if(arguments.length===2){var e=arguments[0],n=arguments[1],r=n.x-e.x,s=n.y-e.y;return Math.atan2(s,r)}};zn.isAcute=function(t,e,n){var r=t.x-e.x,s=t.y-e.y,c=n.x-e.x,f=n.y-e.y,u=r*c+s*f;return u>0};zn.isObtuse=function(t,e,n){var r=t.x-e.x,s=t.y-e.y,c=n.x-e.x,f=n.y-e.y,u=r*c+s*f;return u<0};zn.interiorAngle=function(t,e,n){var r=zn.angle(e,t),s=zn.angle(e,n);return Math.abs(s-r)};zn.normalizePositive=function(t){if(t<0){for(;t<0;)t+=zn.PI_TIMES_2;t>=zn.PI_TIMES_2&&(t=0)}else{for(;t>=zn.PI_TIMES_2;)t-=zn.PI_TIMES_2;t<0&&(t=0)}return t};zn.angleBetween=function(t,e,n){var r=zn.angle(e,t),s=zn.angle(e,n);return zn.diff(r,s)};zn.diff=function(t,e){var n=null;return t<e?n=e-t:n=t-e,n>Math.PI&&(n=2*Math.PI-n),n};zn.toRadians=function(t){return t*Math.PI/180};zn.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?zn.COUNTERCLOCKWISE:n<0?zn.CLOCKWISE:zn.NONE};zn.angleBetweenOriented=function(t,e,n){var r=zn.angle(e,t),s=zn.angle(e,n),c=s-r;return c<=-Math.PI?c+zn.PI_TIMES_2:c>Math.PI?c-zn.PI_TIMES_2:c};mf.PI_TIMES_2.get=function(){return 2*Math.PI};mf.PI_OVER_2.get=function(){return Math.PI/2};mf.PI_OVER_4.get=function(){return Math.PI/4};mf.COUNTERCLOCKWISE.get=function(){return Ne.COUNTERCLOCKWISE};mf.CLOCKWISE.get=function(){return Ne.CLOCKWISE};mf.NONE.get=function(){return Ne.COLLINEAR};Object.defineProperties(zn,mf);var Sr=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Ye,this._seg1=new Ye,this._offset0=new Ye,this._offset1=new Ye,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new vp,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===Gn.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},Xm={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Sr.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=Ne.computeOrientation(this._s0,this._s1,this._s2),r=n===Ne.CLOCKWISE&&this._side===fe.LEFT||n===Ne.COUNTERCLOCKWISE&&this._side===fe.RIGHT;n===0?this.addCollinear(e):r?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)};Sr.prototype.addLineEndCap=function(t,e){var n=new Ye(t,e),r=new Ye;this.computeOffsetSegment(n,fe.LEFT,this._distance,r);var s=new Ye;this.computeOffsetSegment(n,fe.RIGHT,this._distance,s);var c=e.x-t.x,f=e.y-t.y,u=Math.atan2(f,c);switch(this._bufParams.getEndCapStyle()){case Gn.CAP_ROUND:this._segList.addPt(r.p1),this.addFilletArc(e,u+Math.PI/2,u-Math.PI/2,Ne.CLOCKWISE,this._distance),this._segList.addPt(s.p1);break;case Gn.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(s.p1);break;case Gn.CAP_SQUARE:var w=new Dt;w.x=Math.abs(this._distance)*Math.cos(u),w.y=Math.abs(this._distance)*Math.sin(u);var S=new Dt(r.p1.x+w.x,r.p1.y+w.y),A=new Dt(s.p1.x+w.x,s.p1.y+w.y);this._segList.addPt(S),this._segList.addPt(A);break}};Sr.prototype.getCoordinates=function(){var t=this._segList.getCoordinates();return t};Sr.prototype.addMitreJoin=function(t,e,n,r){var s=!0,c=null;try{c=Wa.intersection(e.p0,e.p1,n.p0,n.p1);var f=r<=0?1:c.distance(t)/Math.abs(r);f>this._bufParams.getMitreLimit()&&(s=!1)}catch(u){if(u instanceof Vd)c=new Dt(0,0),s=!1;else throw u}finally{}s?this._segList.addPt(c):this.addLimitedMitreJoin(e,n,r,this._bufParams.getMitreLimit())};Sr.prototype.addFilletCorner=function(t,e,n,r,s){var c=e.x-t.x,f=e.y-t.y,u=Math.atan2(f,c),w=n.x-t.x,S=n.y-t.y,A=Math.atan2(S,w);r===Ne.CLOCKWISE?u<=A&&(u+=2*Math.PI):u>=A&&(u-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,u,A,r,s),this._segList.addPt(n)};Sr.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Sr.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Gn.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Gn.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))};Sr.prototype.createSquare=function(t){this._segList.addPt(new Dt(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new Dt(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new Dt(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new Dt(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()};Sr.prototype.addSegments=function(t,e){this._segList.addPts(t,e)};Sr.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Sr.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Sr.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)};Sr.prototype.addLimitedMitreJoin=function(t,e,n,r){var s=this._seg0.p1,c=zn.angle(s,this._seg0.p0),f=zn.angleBetweenOriented(this._seg0.p0,s,this._seg1.p1),u=f/2,w=zn.normalize(c+u),S=zn.normalize(w+Math.PI),A=r*n,N=A*Math.abs(Math.sin(u)),O=n-N,j=s.x+A*Math.cos(S),W=s.y+A*Math.sin(S),nt=new Dt(j,W),pt=new Ye(s,nt),J=pt.pointAlongOffset(1,O),tt=pt.pointAlongOffset(1,-O);this._side===fe.LEFT?(this._segList.addPt(J),this._segList.addPt(tt)):(this._segList.addPt(tt),this._segList.addPt(J))};Sr.prototype.computeOffsetSegment=function(t,e,n,r){var s=e===fe.LEFT?1:-1,c=t.p1.x-t.p0.x,f=t.p1.y-t.p0.y,u=Math.sqrt(c*c+f*f),w=s*n*c/u,S=s*n*f/u;r.p0.x=t.p0.x-S,r.p0.y=t.p0.y+w,r.p1.x=t.p1.x-S,r.p1.y=t.p1.y+w};Sr.prototype.addFilletArc=function(t,e,n,r,s){var c=this,f=r===Ne.CLOCKWISE?-1:1,u=Math.abs(e-n),w=Math.trunc(u/this._filletAngleQuantum+.5);if(w<1)return null;for(var S=0,A=u/w,N=S,O=new Dt;N<u;){var j=e+f*N;O.x=t.x+s*Math.cos(j),O.y=t.y+s*Math.sin(j),c._segList.addPt(O),N+=A}};Sr.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Sr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new Dt((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var r=new Dt((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};Sr.prototype.createCircle=function(t){var e=new Dt(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};Sr.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)};Sr.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new ra,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Sr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Sr.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var e=this._li.getIntersectionNum();e>=2&&(this._bufParams.getJoinStyle()===Gn.JOIN_BEVEL||this._bufParams.getJoinStyle()===Gn.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Ne.CLOCKWISE,this._distance))};Sr.prototype.closeRing=function(){this._segList.closeRing()};Sr.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};Sr.prototype.interfaces_=function(){return[]};Sr.prototype.getClass=function(){return Sr};Xm.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};Xm.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};Xm.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};Xm.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Sr,Xm);var gs=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};gs.prototype.getOffsetCurve=function(t,e){if(this._distance=e,e===0)return null;var n=e<0,r=Math.abs(e),s=this.getSegGen(r);t.length<=1?this.computePointCurve(t[0],s):this.computeOffsetCurve(t,n,s);var c=s.getCoordinates();return n&&Pn.reverse(c),c};gs.prototype.computeSingleSidedBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var s=Yr.simplify(t,-r),c=s.length-1;n.initSideSegments(s[c],s[c-1],fe.LEFT),n.addFirstSegment();for(var f=c-2;f>=0;f--)n.addNextSegment(s[f],!0)}else{n.addSegments(t,!1);var u=Yr.simplify(t,r),w=u.length-1;n.initSideSegments(u[0],u[1],fe.LEFT),n.addFirstSegment();for(var S=2;S<=w;S++)n.addNextSegment(u[S],!0)}n.addLastSegment(),n.closeRing()};gs.prototype.computeRingBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);e===fe.RIGHT&&(r=-r);var s=Yr.simplify(t,r),c=s.length-1;n.initSideSegments(s[c-1],s[0],e);for(var f=1;f<=c;f++){var u=f!==1;n.addNextSegment(s[f],u)}n.closeRing()};gs.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),r=Yr.simplify(t,n),s=r.length-1;e.initSideSegments(r[0],r[1],fe.LEFT);for(var c=2;c<=s;c++)e.addNextSegment(r[c],!0);e.addLastSegment(),e.addLineEndCap(r[s-1],r[s]);var f=Yr.simplify(t,-n),u=f.length-1;e.initSideSegments(f[u],f[u-1],fe.LEFT);for(var w=u-2;w>=0;w--)e.addNextSegment(f[w],!0);e.addLastSegment(),e.addLineEndCap(f[1],f[0]),e.closeRing()};gs.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case Gn.CAP_ROUND:e.createCircle(t);break;case Gn.CAP_SQUARE:e.createSquare(t);break}};gs.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided()||e===0)return null;var n=Math.abs(e),r=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],r);else if(this._bufParams.isSingleSided()){var s=e<0;this.computeSingleSidedBufferCurve(t,s,r)}else this.computeLineBufferCurve(t,r);var c=r.getCoordinates();return c};gs.prototype.getBufferParameters=function(){return this._bufParams};gs.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()};gs.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(n===0)return gs.copyCoordinates(t);var r=this.getSegGen(n);return this.computeRingBufferCurve(t,e,r),r.getCoordinates()};gs.prototype.computeOffsetCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){var s=Yr.simplify(t,-r),c=s.length-1;n.initSideSegments(s[c],s[c-1],fe.LEFT),n.addFirstSegment();for(var f=c-2;f>=0;f--)n.addNextSegment(s[f],!0)}else{var u=Yr.simplify(t,r),w=u.length-1;n.initSideSegments(u[0],u[1],fe.LEFT),n.addFirstSegment();for(var S=2;S<=w;S++)n.addNextSegment(u[S],!0)}n.addLastSegment()};gs.prototype.getSegGen=function(t){return new Sr(this._precisionModel,this._bufParams,t)};gs.prototype.interfaces_=function(){return[]};gs.prototype.getClass=function(){return gs};gs.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new Dt(t[n]);return e};var tf=function(){this._subgraphs=null,this._seg=new Ye,this._cga=new Ne;var t=arguments[0];this._subgraphs=t},w2={DepthSegment:{configurable:!0}};tf.prototype.findStabbedSegments=function(){var t=this;if(arguments.length===1){for(var e=arguments[0],n=new be,r=this._subgraphs.iterator();r.hasNext();){var s=r.next(),c=s.getEnvelope();e.y<c.getMinY()||e.y>c.getMaxY()||t.findStabbedSegments(e,s.getDirectedEdges(),n)}return n}else if(arguments.length===3){if(an(arguments[2],Ha)&&arguments[0]instanceof Dt&&arguments[1]instanceof r1)for(var f=arguments[0],u=arguments[1],w=arguments[2],S=u.getEdge().getCoordinates(),A=0;A<S.length-1;A++){t._seg.p0=S[A],t._seg.p1=S[A+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var N=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(N<f.x)&&!t._seg.isHorizontal()&&!(f.y<t._seg.p0.y||f.y>t._seg.p1.y)&&Ne.computeOrientation(t._seg.p0,t._seg.p1,f)!==Ne.RIGHT){var O=u.getDepth(fe.LEFT);t._seg.p0.equals(S[A])||(O=u.getDepth(fe.RIGHT));var j=new sp(t._seg,O);w.add(j)}}else if(an(arguments[2],Ha)&&arguments[0]instanceof Dt&&an(arguments[1],Ha))for(var W=arguments[0],nt=arguments[1],pt=arguments[2],J=nt.iterator();J.hasNext();){var tt=J.next();tt.isForward()&&t.findStabbedSegments(W,tt,pt)}}};tf.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);if(e.size()===0)return 0;var n=tl.min(e);return n._leftDepth};tf.prototype.interfaces_=function(){return[]};tf.prototype.getClass=function(){return tf};w2.DepthSegment.get=function(){return sp};Object.defineProperties(tf,w2);var sp=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new Ye(t),this._leftDepth=e};sp.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return n!==0||(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg),n!==0)?n:this._upwardSeg.compareTo(e._upwardSeg)};sp.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return n!==0?n:t.p1.compareTo(e.p1)};sp.prototype.toString=function(){return this._upwardSeg.toString()};sp.prototype.interfaces_=function(){return[ka]};sp.prototype.getClass=function(){return sp};var qn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};qn.prototype.area=function(){return qn.area(this.p0,this.p1,this.p2)};qn.prototype.signedArea=function(){return qn.signedArea(this.p0,this.p1,this.p2)};qn.prototype.interpolateZ=function(t){if(t===null)throw new Nr("Supplied point is null.");return qn.interpolateZ(t,this.p0,this.p1,this.p2)};qn.prototype.longestSideLength=function(){return qn.longestSideLength(this.p0,this.p1,this.p2)};qn.prototype.isAcute=function(){return qn.isAcute(this.p0,this.p1,this.p2)};qn.prototype.circumcentre=function(){return qn.circumcentre(this.p0,this.p1,this.p2)};qn.prototype.area3D=function(){return qn.area3D(this.p0,this.p1,this.p2)};qn.prototype.centroid=function(){return qn.centroid(this.p0,this.p1,this.p2)};qn.prototype.inCentre=function(){return qn.inCentre(this.p0,this.p1,this.p2)};qn.prototype.interfaces_=function(){return[]};qn.prototype.getClass=function(){return qn};qn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)};qn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2};qn.det=function(t,e,n,r){return t*r-e*n};qn.interpolateZ=function(t,e,n,r){var s=e.x,c=e.y,f=n.x-s,u=r.x-s,w=n.y-c,S=r.y-c,A=f*S-u*w,N=t.x-s,O=t.y-c,j=(S*N-u*O)/A,W=(-w*N+f*O)/A,nt=e.z+j*(n.z-e.z)+W*(r.z-e.z);return nt};qn.longestSideLength=function(t,e,n){var r=t.distance(e),s=e.distance(n),c=n.distance(t),f=r;return s>f&&(f=s),c>f&&(f=c),f};qn.isAcute=function(t,e,n){return!(!zn.isAcute(t,e,n)||!zn.isAcute(e,n,t)||!zn.isAcute(n,t,e))};qn.circumcentre=function(t,e,n){var r=n.x,s=n.y,c=t.x-r,f=t.y-s,u=e.x-r,w=e.y-s,S=2*qn.det(c,f,u,w),A=qn.det(f,c*c+f*f,w,u*u+w*w),N=qn.det(c,c*c+f*f,u,u*u+w*w),O=r-A/S,j=s+N/S;return new Dt(O,j)};qn.perpendicularBisector=function(t,e){var n=e.x-t.x,r=e.y-t.y,s=new Wa(t.x+n/2,t.y+r/2,1),c=new Wa(t.x-r+n/2,t.y+n+r/2,1);return new Wa(s,c)};qn.angleBisector=function(t,e,n){var r=e.distance(t),s=e.distance(n),c=r/(r+s),f=n.x-t.x,u=n.y-t.y,w=new Dt(t.x+c*f,t.y+c*u);return w};qn.area3D=function(t,e,n){var r=e.x-t.x,s=e.y-t.y,c=e.z-t.z,f=n.x-t.x,u=n.y-t.y,w=n.z-t.z,S=s*w-c*u,A=c*f-r*w,N=r*u-s*f,O=S*S+A*A+N*N,j=Math.sqrt(O)/2;return j};qn.centroid=function(t,e,n){var r=(t.x+e.x+n.x)/3,s=(t.y+e.y+n.y)/3;return new Dt(r,s)};qn.inCentre=function(t,e,n){var r=e.distance(n),s=t.distance(n),c=t.distance(e),f=r+s+c,u=(r*t.x+s*e.x+c*n.x)/f,w=(r*t.y+s*e.y+c*n.y)/f;return new Dt(u,w)};var Aa=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new be;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};Aa.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,Bt.EXTERIOR,Bt.INTERIOR)};Aa.prototype.addPolygon=function(t){var e=this,n=this._distance,r=fe.LEFT;this._distance<0&&(n=-this._distance,r=fe.RIGHT);var s=t.getExteriorRing(),c=Pn.removeRepeatedPoints(s.getCoordinates());if(this._distance<0&&this.isErodedCompletely(s,this._distance)||this._distance<=0&&c.length<3)return null;this.addPolygonRing(c,n,r,Bt.EXTERIOR,Bt.INTERIOR);for(var f=0;f<t.getNumInteriorRing();f++){var u=t.getInteriorRingN(f),w=Pn.removeRepeatedPoints(u.getCoordinates());e._distance>0&&e.isErodedCompletely(u,-e._distance)||e.addPolygonRing(w,n,fe.opposite(r),Bt.INTERIOR,Bt.EXTERIOR)}};Aa.prototype.isTriangleErodedCompletely=function(t,e){var n=new qn(t[0],t[1],t[2]),r=n.inCentre(),s=Ne.distancePointLine(r,n.p0,n.p1);return s<Math.abs(e)};Aa.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Pn.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,Bt.EXTERIOR,Bt.INTERIOR)};Aa.prototype.addCurve=function(t,e,n){if(t===null||t.length<2)return null;var r=new ai(t,new er(0,Bt.BOUNDARY,e,n));this._curveList.add(r)};Aa.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};Aa.prototype.addPolygonRing=function(t,e,n,r,s){if(e===0&&t.length<vu.MINIMUM_VALID_SIZE)return null;var c=r,f=s;t.length>=vu.MINIMUM_VALID_SIZE&&Ne.isCCW(t)&&(c=s,f=r,n=fe.opposite(n));var u=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(u,c,f)};Aa.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Ni?this.addPolygon(t):t instanceof Hr?this.addLineString(t):t instanceof As?this.addPoint(t):t instanceof Ed?this.addCollection(t):t instanceof ip?this.addCollection(t):t instanceof gu?this.addCollection(t):t instanceof Ko&&this.addCollection(t)};Aa.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(n.length===4)return this.isTriangleErodedCompletely(n,e);var r=t.getEnvelopeInternal(),s=Math.min(r.getHeight(),r.getWidth());return e<0&&2*Math.abs(e)>s};Aa.prototype.addCollection=function(t){for(var e=this,n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);e.add(r)}};Aa.prototype.interfaces_=function(){return[]};Aa.prototype.getClass=function(){return Aa};var Td=function(){};Td.prototype.locate=function(t){};Td.prototype.interfaces_=function(){return[]};Td.prototype.getClass=function(){return Td};var mu=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};mu.prototype.next=function(){if(this._atStart)return this._atStart=!1,mu.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new $d;var t=this._parent.getGeometryN(this._index++);return t instanceof Ko?(this._subcollectionIterator=new mu(t),this._subcollectionIterator.next()):t};mu.prototype.remove=function(){throw new Error(this.getClass().getName())};mu.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};mu.prototype.interfaces_=function(){return[Ud]};mu.prototype.getClass=function(){return mu};mu.isAtomic=function(t){return!(t instanceof Ko)};var Qs=function(){this._geom=null;var t=arguments[0];this._geom=t};Qs.prototype.locate=function(t){return Qs.locate(t,this._geom)};Qs.prototype.interfaces_=function(){return[Td]};Qs.prototype.getClass=function(){return Qs};Qs.isPointInRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?Ne.isPointInRing(t,e.getCoordinates()):!1};Qs.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Qs.isPointInRing(t,n))return!1;for(var r=0;r<e.getNumInteriorRing();r++){var s=e.getInteriorRingN(r);if(Qs.isPointInRing(t,s))return!1}return!0};Qs.containsPoint=function(t,e){if(e instanceof Ni)return Qs.containsPointInPolygon(t,e);if(e instanceof Ko)for(var n=new mu(e);n.hasNext();){var r=n.next();if(r!==e&&Qs.containsPoint(t,r))return!0}return!1};Qs.locate=function(t,e){return e.isEmpty()?Bt.EXTERIOR:Qs.containsPoint(t,e)?Bt.INTERIOR:Bt.EXTERIOR};var Ao=function(){this._edgeMap=new Mo,this._edgeList=null,this._ptInAreaLocation=[Bt.NONE,Bt.NONE]};Ao.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return e===0&&(n=this._edgeList.size()-1),this._edgeList.get(n)};Ao.prototype.propagateSideLabels=function(t){for(var e=Bt.NONE,n=this.iterator();n.hasNext();){var r=n.next(),s=r.getLabel();s.isArea(t)&&s.getLocation(t,fe.LEFT)!==Bt.NONE&&(e=s.getLocation(t,fe.LEFT))}if(e===Bt.NONE)return null;for(var c=e,f=this.iterator();f.hasNext();){var u=f.next(),w=u.getLabel();if(w.getLocation(t,fe.ON)===Bt.NONE&&w.setLocation(t,fe.ON,c),w.isArea(t)){var S=w.getLocation(t,fe.LEFT),A=w.getLocation(t,fe.RIGHT);if(A!==Bt.NONE){if(A!==c)throw new nc("side location conflict",u.getCoordinate());S===Bt.NONE&&yn.shouldNeverReachHere("found single null side (at "+u.getCoordinate()+")"),c=S}else yn.isTrue(w.getLocation(t,fe.LEFT)===Bt.NONE,"found single null side"),w.setLocation(t,fe.RIGHT,c),w.setLocation(t,fe.LEFT,c)}}};Ao.prototype.getCoordinate=function(){var t=this.iterator();if(!t.hasNext())return null;var e=t.next();return e.getCoordinate()};Ao.prototype.print=function(t){fo.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();n.print(t)}};Ao.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};Ao.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,r=e.get(n).getLabel(),s=r.getLocation(t,fe.LEFT);yn.isTrue(s!==Bt.NONE,"Found unlabelled area edge");for(var c=s,f=this.iterator();f.hasNext();){var u=f.next(),w=u.getLabel();yn.isTrue(w.isArea(t),"Found non-area edge");var S=w.getLocation(t,fe.LEFT),A=w.getLocation(t,fe.RIGHT);if(S===A||A!==c)return!1;c=S}return!0};Ao.prototype.findIndex=function(t){var e=this;this.iterator();for(var n=0;n<this._edgeList.size();n++){var r=e._edgeList.get(n);if(r===t)return n}return-1};Ao.prototype.iterator=function(){return this.getEdges().iterator()};Ao.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new be(this._edgeMap.values())),this._edgeList};Ao.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===Bt.NONE&&(this._ptInAreaLocation[t]=Qs.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]};Ao.prototype.toString=function(){var t=new Wl;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append(`
`)}return t.toString()};Ao.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next();n.computeLabel(t)}};Ao.prototype.computeLabelling=function(t){var e=this;this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var n=[!1,!1],r=this.iterator();r.hasNext();)for(var s=r.next(),c=s.getLabel(),f=0;f<2;f++)c.isLine(f)&&c.getLocation(f)===Bt.BOUNDARY&&(n[f]=!0);for(var u=this.iterator();u.hasNext();)for(var w=u.next(),S=w.getLabel(),A=0;A<2;A++)if(S.isAnyNull(A)){var N=Bt.NONE;if(n[A])N=Bt.EXTERIOR;else{var O=w.getCoordinate();N=e.getLocation(A,O,t)}S.setAllLocationsIfNull(A,N)}};Ao.prototype.getDegree=function(){return this._edgeMap.size()};Ao.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null};Ao.prototype.interfaces_=function(){return[]};Ao.prototype.getClass=function(){return Ao};var MD=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){var n=this;this.getResultAreaEdges();for(var r=null,s=null,c=this._SCANNING_FOR_INCOMING,f=0;f<this._resultAreaEdgeList.size();f++){var u=n._resultAreaEdgeList.get(f),w=u.getSym();if(u.getLabel().isArea())switch(r===null&&u.isInResult()&&(r=u),c){case n._SCANNING_FOR_INCOMING:if(!w.isInResult())continue;s=w,c=n._LINKING_TO_OUTGOING;break;case n._LINKING_TO_OUTGOING:if(!u.isInResult())continue;s.setNext(u),c=n._SCANNING_FOR_INCOMING;break}}if(c===this._LINKING_TO_OUTGOING){if(r===null)throw new nc("no outgoing dirEdge found",this.getCoordinate());yn.isTrue(r.isInResult(),"unable to link last incoming dirEdge"),s.setNext(r)}},e.prototype.insert=function(n){var r=n;this.insertEdgeEnd(r,r)},e.prototype.getRightmostEdge=function(){var n=this.getEdges(),r=n.size();if(r<1)return null;var s=n.get(0);if(r===1)return s;var c=n.get(r-1),f=s.getQuadrant(),u=c.getQuadrant();return or.isNorthern(f)&&or.isNorthern(u)?s:!or.isNorthern(f)&&!or.isNorthern(u)?c:s.getDy()!==0?s:c.getDy()!==0?c:(yn.shouldNeverReachHere("found two horizontal edges incident on node"),null)},e.prototype.print=function(n){fo.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var r=this.iterator();r.hasNext();){var s=r.next();n.print("out "),s.print(n),n.println(),n.print("in "),s.getSym().print(n),n.println()}},e.prototype.getResultAreaEdges=function(){var n=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new be;for(var r=this.iterator();r.hasNext();){var s=r.next();(s.isInResult()||s.getSym().isInResult())&&n._resultAreaEdgeList.add(s)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(n){for(var r=this.iterator();r.hasNext();){var s=r.next(),c=s.getLabel();c.setAllLocationsIfNull(0,n.getLocation(0)),c.setAllLocationsIfNull(1,n.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){var n=this;this.getEdges();for(var r=null,s=null,c=this._edgeList.size()-1;c>=0;c--){var f=n._edgeList.get(c),u=f.getSym();s===null&&(s=u),r!==null&&u.setNext(r),r=f}s.setNext(r)},e.prototype.computeDepths=function(){var n=this;if(arguments.length===1){var r=arguments[0],s=this.findIndex(r),c=r.getDepth(fe.LEFT),f=r.getDepth(fe.RIGHT),u=this.computeDepths(s+1,this._edgeList.size(),c),w=this.computeDepths(0,s,u);if(w!==f)throw new nc("depth mismatch at "+r.getCoordinate())}else if(arguments.length===3){for(var S=arguments[0],A=arguments[1],N=arguments[2],O=N,j=S;j<A;j++){var W=n._edgeList.get(j);W.setEdgeDepths(fe.RIGHT,O),O=W.getDepth(fe.LEFT)}return O}},e.prototype.mergeSymLabels=function(){for(var n=this.iterator();n.hasNext();){var r=n.next(),s=r.getLabel();s.merge(r.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(n){for(var r=this,s=null,c=null,f=this._SCANNING_FOR_INCOMING,u=this._resultAreaEdgeList.size()-1;u>=0;u--){var w=r._resultAreaEdgeList.get(u),S=w.getSym();switch(s===null&&w.getEdgeRing()===n&&(s=w),f){case r._SCANNING_FOR_INCOMING:if(S.getEdgeRing()!==n)continue;c=S,f=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(w.getEdgeRing()!==n)continue;c.setNextMin(w),f=r._SCANNING_FOR_INCOMING;break}}f===this._LINKING_TO_OUTGOING&&(yn.isTrue(s!==null,"found null for first outgoing dirEdge"),yn.isTrue(s.getEdgeRing()===n,"unable to link last incoming dirEdge"),c.setNextMin(s))},e.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var n=0,r=this.iterator();r.hasNext();){var s=r.next();s.isInResult()&&n++}return n}else if(arguments.length===1){for(var c=arguments[0],f=0,u=this.iterator();u.hasNext();){var w=u.next();w.getEdgeRing()===c&&f++}return f}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var n=Bt.NONE,r=this.iterator();r.hasNext();){var s=r.next(),c=s.getSym();if(!s.isLineEdge()){if(s.isInResult()){n=Bt.INTERIOR;break}if(c.isInResult()){n=Bt.EXTERIOR;break}}}if(n===Bt.NONE)return null;for(var f=n,u=this.iterator();u.hasNext();){var w=u.next(),S=w.getSym();w.isLineEdge()?w.getEdge().setCovered(f===Bt.INTERIOR):(w.isInResult()&&(f=Bt.EXTERIOR),S.isInResult()&&(f=Bt.INTERIOR))}},e.prototype.computeLabelling=function(n){var r=this;t.prototype.computeLabelling.call(this,n),this._label=new er(Bt.NONE);for(var s=this.iterator();s.hasNext();)for(var c=s.next(),f=c.getEdge(),u=f.getLabel(),w=0;w<2;w++){var S=u.getLocation(w);(S===Bt.INTERIOR||S===Bt.BOUNDARY)&&r._label.setLocation(w,Bt.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ao),b2=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(n){return new Iv(n,new MD)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Sd),Xc=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Xc.prototype.compareTo=function(t){var e=t,n=Xc.compareOriented(this._pts,this._orientation,e._pts,e._orientation);return n};Xc.prototype.interfaces_=function(){return[ka]};Xc.prototype.getClass=function(){return Xc};Xc.orientation=function(t){return Pn.increasingDirection(t)===1};Xc.compareOriented=function(t,e,n,r){for(var s=e?1:-1,c=r?1:-1,f=e?t.length:-1,u=r?n.length:-1,w=e?0:t.length-1,S=r?0:n.length-1;;){var A=t[w].compareTo(n[S]);if(A!==0)return A;w+=s,S+=c;var N=w===f,O=S===u;if(N&&!O)return-1;if(!N&&O)return 1;if(N&&O)return 0}};var el=function(){this._edges=new be,this._ocaMap=new Mo};el.prototype.print=function(t){var e=this;t.print("MULTILINESTRING ( ");for(var n=0;n<this._edges.size();n++){var r=e._edges.get(n);n>0&&t.print(","),t.print("(");for(var s=r.getCoordinates(),c=0;c<s.length;c++)c>0&&t.print(","),t.print(s[c].x+" "+s[c].y);t.println(")")}t.print(")  ")};el.prototype.addAll=function(t){for(var e=this,n=t.iterator();n.hasNext();)e.add(n.next())};el.prototype.findEdgeIndex=function(t){for(var e=this,n=0;n<this._edges.size();n++)if(e._edges.get(n).equals(t))return n;return-1};el.prototype.iterator=function(){return this._edges.iterator()};el.prototype.getEdges=function(){return this._edges};el.prototype.get=function(t){return this._edges.get(t)};el.prototype.findEqualEdge=function(t){var e=new Xc(t.getCoordinates()),n=this._ocaMap.get(e);return n};el.prototype.add=function(t){this._edges.add(t);var e=new Xc(t.getCoordinates());this._ocaMap.put(e,t)};el.prototype.interfaces_=function(){return[]};el.prototype.getClass=function(){return el};var ap=function(){};ap.prototype.processIntersections=function(t,e,n,r){};ap.prototype.isDone=function(){};ap.prototype.interfaces_=function(){return[]};ap.prototype.getClass=function(){return ap};var ia=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};ia.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&this._li.getIntersectionNum()===1){if(ia.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var s=t.size()-1;if(e===0&&r===s||r===0&&e===s)return!0}}return!1};ia.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};ia.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};ia.prototype.getLineIntersector=function(){return this._li};ia.prototype.hasProperIntersection=function(){return this._hasProper};ia.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var s=t.getCoordinates()[e],c=t.getCoordinates()[e+1],f=n.getCoordinates()[r],u=n.getCoordinates()[r+1];this._li.computeIntersection(s,c,f,u),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};ia.prototype.hasIntersection=function(){return this._hasIntersection};ia.prototype.isDone=function(){return!1};ia.prototype.hasInteriorIntersection=function(){return this._hasInterior};ia.prototype.interfaces_=function(){return[ap]};ia.prototype.getClass=function(){return ia};ia.isAdjacentSegments=function(t,e){return Math.abs(t-e)===1};var Gl=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new Dt(t),this.segmentIndex=e,this.dist=n};Gl.prototype.getSegmentIndex=function(){return this.segmentIndex};Gl.prototype.getCoordinate=function(){return this.coord};Gl.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)};Gl.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)};Gl.prototype.isEndPoint=function(t){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===t};Gl.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Gl.prototype.getDistance=function(){return this.dist};Gl.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0};Gl.prototype.interfaces_=function(){return[ka]};Gl.prototype.getClass=function(){return Gl};var bu=function(){this._nodeMap=new Mo,this.edge=null;var t=arguments[0];this.edge=t};bu.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){var n=e.next();n.print(t)}};bu.prototype.iterator=function(){return this._nodeMap.values().iterator()};bu.prototype.addSplitEdges=function(t){var e=this;this.addEndpoints();for(var n=this.iterator(),r=n.next();n.hasNext();){var s=n.next(),c=e.createSplitEdge(r,s);t.add(c),r=s}};bu.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)};bu.prototype.createSplitEdge=function(t,e){var n=this,r=e.segmentIndex-t.segmentIndex+2,s=this.edge.pts[e.segmentIndex],c=e.dist>0||!e.coord.equals2D(s);c||r--;var f=new Array(r).fill(null),u=0;f[u++]=new Dt(t.coord);for(var w=t.segmentIndex+1;w<=e.segmentIndex;w++)f[u++]=n.edge.pts[w];return c&&(f[u]=e.coord),new $_(f,new er(this.edge._label))};bu.prototype.add=function(t,e,n){var r=new Gl(t,e,n),s=this._nodeMap.get(r);return s!==null?s:(this._nodeMap.put(r,r),r)};bu.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next();if(n.coord.equals(t))return!0}return!1};bu.prototype.interfaces_=function(){return[]};bu.prototype.getClass=function(){return bu};var lp=function(){};lp.prototype.getChainStartIndices=function(t){var e=this,n=0,r=new be;r.add(new zl(n));do{var s=e.findChainEnd(t,n);r.add(new zl(s)),n=s}while(n<t.length-1);var c=lp.toIntArray(r);return c};lp.prototype.findChainEnd=function(t,e){for(var n=or.quadrant(t[e],t[e+1]),r=e+1;r<t.length;){var s=or.quadrant(t[r-1],t[r]);if(s!==n)break;r++}return r-1};lp.prototype.interfaces_=function(){return[]};lp.prototype.getClass=function(){return lp};lp.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var ic=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new He,this.env2=new He;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new lp;this.startIndex=e.getChainStartIndices(this.pts)};ic.prototype.getCoordinates=function(){return this.pts};ic.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n};ic.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n};ic.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],r)}else if(arguments.length===6){var s=arguments[0],c=arguments[1],f=arguments[2],u=arguments[3],w=arguments[4],S=arguments[5],A=this.pts[s],N=this.pts[c],O=f.pts[u],j=f.pts[w];if(c-s===1&&w-u===1)return S.addIntersections(this.e,s,f.e,u),null;if(this.env1.init(A,N),this.env2.init(O,j),!this.env1.intersects(this.env2))return null;var W=Math.trunc((s+c)/2),nt=Math.trunc((u+w)/2);s<W&&(u<nt&&this.computeIntersectsForChain(s,W,f,u,nt,S),nt<w&&this.computeIntersectsForChain(s,W,f,nt,w,S)),W<c&&(u<nt&&this.computeIntersectsForChain(W,c,f,u,nt,S),nt<w&&this.computeIntersectsForChain(W,c,f,nt,w,S))}};ic.prototype.getStartIndexes=function(){return this.startIndex};ic.prototype.computeIntersects=function(t,e){for(var n=this,r=0;r<this.startIndex.length-1;r++)for(var s=0;s<t.startIndex.length-1;s++)n.computeIntersectsForChain(r,t,s,e)};ic.prototype.interfaces_=function(){return[]};ic.prototype.getClass=function(){return ic};var po=function t(){var e=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var n=0;n<2;n++)for(var r=0;r<3;r++)e._depth[n][r]=t.NULL_VALUE},E2={NULL_VALUE:{configurable:!0}};po.prototype.getDepth=function(t,e){return this._depth[t][e]};po.prototype.setDepth=function(t,e,n){this._depth[t][e]=n};po.prototype.isNull=function(){var t=this;if(arguments.length===0){for(var e=0;e<2;e++)for(var n=0;n<3;n++)if(t._depth[e][n]!==po.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var r=arguments[0];return this._depth[r][1]===po.NULL_VALUE}else if(arguments.length===2){var s=arguments[0],c=arguments[1];return this._depth[s][c]===po.NULL_VALUE}};po.prototype.normalize=function(){for(var t=this,e=0;e<2;e++)if(!t.isNull(e)){var n=t._depth[e][1];t._depth[e][2]<n&&(n=t._depth[e][2]),n<0&&(n=0);for(var r=1;r<3;r++){var s=0;t._depth[e][r]>n&&(s=1),t._depth[e][r]=s}}};po.prototype.getDelta=function(t){return this._depth[t][fe.RIGHT]-this._depth[t][fe.LEFT]};po.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?Bt.EXTERIOR:Bt.INTERIOR};po.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};po.prototype.add=function(){var t=this;if(arguments.length===1)for(var e=arguments[0],n=0;n<2;n++)for(var r=1;r<3;r++){var s=e.getLocation(n,r);(s===Bt.EXTERIOR||s===Bt.INTERIOR)&&(t.isNull(n,r)?t._depth[n][r]=po.depthAtLocation(s):t._depth[n][r]+=po.depthAtLocation(s))}else if(arguments.length===3){var c=arguments[0],f=arguments[1],u=arguments[2];u===Bt.INTERIOR&&this._depth[c][f]++}};po.prototype.interfaces_=function(){return[]};po.prototype.getClass=function(){return po};po.depthAtLocation=function(t){return t===Bt.EXTERIOR?0:t===Bt.INTERIOR?1:po.NULL_VALUE};E2.NULL_VALUE.get=function(){return-1};Object.defineProperties(po,E2);var $_=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new bu(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new po,this._depthDelta=0,arguments.length===1){var n=arguments[0];e.call(this,n,null)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.pts=r,this._label=s}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var n=new Array(2).fill(null);n[0]=this.pts[0],n[1]=this.pts[1];var r=new e(n,er.toLineLabel(this._label));return r},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(n){this._isIsolated=n},e.prototype.setName=function(n){this._name=n},e.prototype.equals=function(n){var r=this;if(!(n instanceof e))return!1;var s=n;if(this.pts.length!==s.pts.length)return!1;for(var c=!0,f=!0,u=this.pts.length,w=0;w<this.pts.length;w++)if(r.pts[w].equals2D(s.pts[w])||(c=!1),r.pts[w].equals2D(s.pts[--u])||(f=!1),!c&&!f)return!1;return!0},e.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var n=arguments[0];return this.pts[n]}},e.prototype.print=function(n){var r=this;n.print("edge "+this._name+": "),n.print("LINESTRING (");for(var s=0;s<this.pts.length;s++)s>0&&n.print(","),n.print(r.pts[s].x+" "+r.pts[s].y);n.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(n){e.updateIM(this._label,n)},e.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(n){var r=this;n.print("edge "+this._name+": ");for(var s=this.pts.length-1;s>=0;s--)n.print(r.pts[s]+" ");n.println("")},e.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new ic(this)),this._mce},e.prototype.getEnvelope=function(){var n=this;if(this._env===null){this._env=new He;for(var r=0;r<this.pts.length;r++)n._env.expandToInclude(n.pts[r])}return this._env},e.prototype.addIntersection=function(n,r,s,c){var f=new Dt(n.getIntersection(c)),u=r,w=n.getEdgeDistance(s,c),S=u+1;if(S<this.pts.length){var A=this.pts[S];f.equals2D(A)&&(u=S,w=0)}this.eiList.add(f,u,w)},e.prototype.toString=function(){var n=this,r=new Wl;r.append("edge "+this._name+": "),r.append("LINESTRING (");for(var s=0;s<this.pts.length;s++)s>0&&r.append(","),r.append(n.pts[s].x+" "+n.pts[s].y);return r.append(")  "+this._label+" "+this._depthDelta),r.toString()},e.prototype.isPointwiseEqual=function(n){var r=this;if(this.pts.length!==n.pts.length)return!1;for(var s=0;s<this.pts.length;s++)if(!r.pts[s].equals2D(n.pts[s]))return!1;return!0},e.prototype.setDepthDelta=function(n){this._depthDelta=n},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(n,r,s){for(var c=this,f=0;f<n.getIntersectionNum();f++)c.addIntersection(n,r,s,f)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(arguments.length===2){var n=arguments[0],r=arguments[1];r.setAtLeastIfValid(n.getLocation(0,fe.ON),n.getLocation(1,fe.ON),1),n.isArea()&&(r.setAtLeastIfValid(n.getLocation(0,fe.LEFT),n.getLocation(1,fe.LEFT),2),r.setAtLeastIfValid(n.getLocation(0,fe.RIGHT),n.getLocation(1,fe.RIGHT),2))}else return t.prototype.updateIM.apply(this,arguments)},e}(na),Yo=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new el,this._bufParams=t||null};Yo.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t};Yo.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(e!==null){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new er(t.getLabel()),r.flip()),n.merge(r);var s=Yo.depthDelta(r),c=e.getDepthDelta(),f=c+s;e.setDepthDelta(f)}else this._edgeList.add(t),t.setDepthDelta(Yo.depthDelta(t.getLabel()))};Yo.prototype.buildSubgraphs=function(t,e){for(var n=new be,r=t.iterator();r.hasNext();){var s=r.next(),c=s.getRightmostCoordinate(),f=new tf(n),u=f.getDepth(c);s.computeDepth(u),s.findResultEdges(),n.add(s),e.add(s.getDirectedEdges(),s.getNodes())}};Yo.prototype.createSubgraphs=function(t){for(var e=new be,n=t.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var s=new Jo;s.create(r),e.add(s)}}return tl.sort(e,tl.reverseOrder()),e};Yo.prototype.createEmptyResultGeometry=function(){var t=this._geomFact.createPolygon();return t};Yo.prototype.getNoder=function(t){if(this._workingNoder!==null)return this._workingNoder;var e=new yw,n=new vp;return n.setPrecisionModel(t),e.setSegmentIntersector(new ia(n)),e};Yo.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;n===null&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var r=new gs(n,this._bufParams),s=new Aa(t,e,r),c=s.getCurves();if(c.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(c,n),this._graph=new Gr(new b2),this._graph.addEdges(this._edgeList.getEdges());var f=this.createSubgraphs(this._graph),u=new ks(this._geomFact);this.buildSubgraphs(f,u);var w=u.getPolygons();if(w.size()<=0)return this.createEmptyResultGeometry();var S=this._geomFact.buildGeometry(w);return S};Yo.prototype.computeNodedEdges=function(t,e){var n=this,r=this.getNoder(e);r.computeNodes(t);for(var s=r.getNodedSubstrings(),c=s.iterator();c.hasNext();){var f=c.next(),u=f.getCoordinates();if(!(u.length===2&&u[0].equals2D(u[1]))){var w=f.getData(),S=new $_(f.getCoordinates(),new er(w));n.insertUniqueEdge(S)}}};Yo.prototype.setNoder=function(t){this._workingNoder=t};Yo.prototype.interfaces_=function(){return[]};Yo.prototype.getClass=function(){return Yo};Yo.depthDelta=function(t){var e=t.getLocation(0,fe.LEFT),n=t.getLocation(0,fe.RIGHT);return e===Bt.INTERIOR&&n===Bt.EXTERIOR?1:e===Bt.EXTERIOR&&n===Bt.INTERIOR?-1:0};Yo.convertSegStrings=function(t){for(var e=new Tn,n=new be;t.hasNext();){var r=t.next(),s=e.createLineString(r.getCoordinates());n.add(s)}return e.buildGeometry(n)};var Wc=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var n=arguments[0],r=arguments[1],s=arguments[2],c=arguments[3];this._noder=n,this._scaleFactor=r,this._offsetX=s,this._offsetY=c,this._isScaled=!this.isIntegerPrecision()}};Wc.prototype.rescale=function(){var t=this;if(an(arguments[0],Ci))for(var e=arguments[0],n=e.iterator();n.hasNext();){var r=n.next();t.rescale(r.getCoordinates())}else if(arguments[0]instanceof Array){for(var s=arguments[0],c=0;c<s.length;c++)s[c].x=s[c].x/t._scaleFactor+t._offsetX,s[c].y=s[c].y/t._scaleFactor+t._offsetY;s.length===2&&s[0].equals2D(s[1])&&fo.out.println(s)}};Wc.prototype.scale=function(){var t=this;if(an(arguments[0],Ci)){for(var e=arguments[0],n=new be,r=e.iterator();r.hasNext();){var s=r.next();n.add(new ai(t.scale(s.getCoordinates()),s.getData()))}return n}else if(arguments[0]instanceof Array){for(var c=arguments[0],f=new Array(c.length).fill(null),u=0;u<c.length;u++)f[u]=new Dt(Math.round((c[u].x-t._offsetX)*t._scaleFactor),Math.round((c[u].y-t._offsetY)*t._scaleFactor),c[u].z);var w=Pn.removeRepeatedPoints(f);return w}};Wc.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};Wc.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t};Wc.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)};Wc.prototype.interfaces_=function(){return[op]};Wc.prototype.getClass=function(){return Wc};var jl=function(){this._li=new vp,this._segStrings=null;var t=arguments[0];this._segStrings=t},S2={fact:{configurable:!0}};jl.prototype.checkEndPtVertexIntersections=function(){var t=this;if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var n=e.next(),r=n.getCoordinates();t.checkEndPtVertexIntersections(r[0],t._segStrings),t.checkEndPtVertexIntersections(r[r.length-1],t._segStrings)}else if(arguments.length===2){for(var s=arguments[0],c=arguments[1],f=c.iterator();f.hasNext();)for(var u=f.next(),w=u.getCoordinates(),S=1;S<w.length-1;S++)if(w[S].equals(s))throw new tc("found endpt/interior pt intersection at index "+S+" :pt "+s)}};jl.prototype.checkInteriorIntersections=function(){var t=this;if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();)for(var n=e.next(),r=this._segStrings.iterator();r.hasNext();){var s=r.next();t.checkInteriorIntersections(n,s)}else if(arguments.length===2)for(var c=arguments[0],f=arguments[1],u=c.getCoordinates(),w=f.getCoordinates(),S=0;S<u.length-1;S++)for(var A=0;A<w.length-1;A++)t.checkInteriorIntersections(c,S,f,A);else if(arguments.length===4){var N=arguments[0],O=arguments[1],j=arguments[2],W=arguments[3];if(N===j&&O===W)return null;var nt=N.getCoordinates()[O],pt=N.getCoordinates()[O+1],J=j.getCoordinates()[W],tt=j.getCoordinates()[W+1];if(this._li.computeIntersection(nt,pt,J,tt),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,nt,pt)||this.hasInteriorIntersection(this._li,J,tt)))throw new tc("found non-noded intersection at "+nt+"-"+pt+" and "+J+"-"+tt)}};jl.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};jl.prototype.checkCollapses=function(){var t=this;if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var n=e.next();t.checkCollapses(n)}else if(arguments.length===1)for(var r=arguments[0],s=r.getCoordinates(),c=0;c<s.length-2;c++)t.checkCollapse(s[c],s[c+1],s[c+2])};jl.prototype.hasInteriorIntersection=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++){var s=t.getIntersection(r);if(!(s.equals(e)||s.equals(n)))return!0}return!1};jl.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new tc("found non-noded collapse at "+jl.fact.createLineString([t,e,n]))};jl.prototype.interfaces_=function(){return[]};jl.prototype.getClass=function(){return jl};S2.fact.get=function(){return new Tn};Object.defineProperties(jl,S2);var ms=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new Nr("Scale factor must be non-zero");e!==1&&(this._pt=new Dt(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new Dt,this._p1Scaled=new Dt),this.initCorners(this._pt)},I2={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ms.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.x,e.x),s=Math.min(t.y,e.y),c=Math.max(t.y,e.y),f=this._maxx<n||this._minx>r||this._maxy<s||this._miny>c;if(f)return!1;var u=this.intersectsToleranceSquare(t,e);return yn.isTrue(!(f&&u),"Found bad envelope test"),u};ms.prototype.initCorners=function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new Dt(this._maxx,this._maxy),this._corner[1]=new Dt(this._minx,this._maxy),this._corner[2]=new Dt(this._minx,this._miny),this._corner[3]=new Dt(this._maxx,this._miny)};ms.prototype.intersects=function(t,e){return this._scaleFactor===1?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};ms.prototype.scale=function(t){return Math.round(t*this._scaleFactor)};ms.prototype.getCoordinate=function(){return this._originalPt};ms.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)};ms.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var t=ms.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new He(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv};ms.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))};ms.prototype.intersectsToleranceSquare=function(t,e){var n=!1,r=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper())||n&&r||t.equals(this._pt)||e.equals(this._pt))};ms.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),r=t.getCoordinate(e+1);return this.intersects(n,r)?(t.addIntersection(this.getCoordinate(),e),!0):!1};ms.prototype.interfaces_=function(){return[]};ms.prototype.getClass=function(){return ms};I2.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(ms,I2);var Am=function(){this.tempEnv1=new He,this.selectedSegment=new Ye};Am.prototype.select=function(){if(arguments.length!==1&&arguments.length===2){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}};Am.prototype.interfaces_=function(){return[]};Am.prototype.getClass=function(){return Am};var Pd=function(){this._index=null;var t=arguments[0];this._index=t},C2={HotPixelSnapAction:{configurable:!0}};Pd.prototype.snap=function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}else if(arguments.length===3){var e=arguments[0],n=arguments[1],r=arguments[2],s=e.getSafeEnvelope(),c=new T2(e,n,r);return this._index.query(s,{interfaces_:function(){return[qc]},visitItem:function(f){var u=f;u.select(s,c)}}),c.isNodeAdded()}};Pd.prototype.interfaces_=function(){return[]};Pd.prototype.getClass=function(){return Pd};C2.HotPixelSnapAction.get=function(){return T2};Object.defineProperties(Pd,C2);var T2=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],r=arguments[1],s=arguments[2];this._hotPixel=n,this._parentEdge=r,this._hotPixelVertexIndex=s}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(arguments.length===2){var n=arguments[0],r=arguments[1],s=n.getContext();if(this._parentEdge!==null&&s===this._parentEdge&&r===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(s,r)}else return t.prototype.select.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Am),ef=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new be};ef.prototype.processIntersections=function(t,e,n,r){var s=this;if(t===n&&e===r)return null;var c=t.getCoordinates()[e],f=t.getCoordinates()[e+1],u=n.getCoordinates()[r],w=n.getCoordinates()[r+1];if(this._li.computeIntersection(c,f,u,w),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var S=0;S<this._li.getIntersectionNum();S++)s._interiorIntersections.add(s._li.getIntersection(S));t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)}};ef.prototype.isDone=function(){return!1};ef.prototype.getInteriorIntersections=function(){return this._interiorIntersections};ef.prototype.interfaces_=function(){return[ap]};ef.prototype.getClass=function(){return ef};var Eu=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new vp,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};Eu.prototype.checkCorrectness=function(t){var e=ai.getNodedSubstrings(t),n=new jl(e);try{n.checkValid()}catch(r){if(r instanceof c2)r.printStackTrace();else throw r}finally{}};Eu.prototype.getNodedSubstrings=function(){return ai.getNodedSubstrings(this._nodedSegStrings)};Eu.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)};Eu.prototype.findInteriorIntersections=function(t,e){var n=new ef(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()};Eu.prototype.computeVertexSnaps=function(){var t=this;if(an(arguments[0],Ci))for(var e=arguments[0],n=e.iterator();n.hasNext();){var r=n.next();t.computeVertexSnaps(r)}else if(arguments[0]instanceof ai)for(var s=arguments[0],c=s.getCoordinates(),f=0;f<c.length;f++){var u=new ms(c[f],t._scaleFactor,t._li),w=t._pointSnapper.snap(u,s,f);w&&s.addIntersection(c[f],f)}};Eu.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new yw,this._pointSnapper=new Pd(this._noder.getIndex()),this.snapRound(t,this._li)};Eu.prototype.computeIntersectionSnaps=function(t){for(var e=this,n=t.iterator();n.hasNext();){var r=n.next(),s=new ms(r,e._scaleFactor,e._li);e._pointSnapper.snap(s)}};Eu.prototype.interfaces_=function(){return[op]};Eu.prototype.getClass=function(){return Eu};var ho=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Gn,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},Gd={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};ho.prototype.bufferFixedPrecision=function(t){var e=new Wc(new Eu(new jn(1)),t.getScale()),n=new Yo(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)};ho.prototype.bufferReducedPrecision=function(){var t=this;if(arguments.length===0){for(var e=ho.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(c){if(c instanceof nc)t._saveException=c;else throw c}finally{}if(t._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var n=arguments[0],r=ho.precisionScaleFactor(this._argGeom,this._distance,n),s=new jn(r);this.bufferFixedPrecision(s)}};ho.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===jn.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()};ho.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)};ho.prototype.bufferOriginalPrecision=function(){try{var t=new Yo(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(e){if(e instanceof tc)this._saveException=e;else throw e}finally{}};ho.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry};ho.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)};ho.prototype.interfaces_=function(){return[]};ho.prototype.getClass=function(){return ho};ho.bufferOp=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],n=new ho(t),r=n.getResultGeometry(e);return r}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof sn&&typeof arguments[1]=="number"){var s=arguments[0],c=arguments[1],f=arguments[2],u=new ho(s);u.setQuadrantSegments(f);var w=u.getResultGeometry(c);return w}else if(arguments[2]instanceof Gn&&arguments[0]instanceof sn&&typeof arguments[1]=="number"){var S=arguments[0],A=arguments[1],N=arguments[2],O=new ho(S,N),j=O.getResultGeometry(A);return j}}else if(arguments.length===4){var W=arguments[0],nt=arguments[1],pt=arguments[2],J=arguments[3],tt=new ho(W);tt.setQuadrantSegments(pt),tt.setEndCapStyle(J);var Q=tt.getResultGeometry(nt);return Q}};ho.precisionScaleFactor=function(t,e,n){var r=t.getEnvelopeInternal(),s=ea.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY())),c=e>0?e:0,f=s+2*c,u=Math.trunc(Math.log(f)/Math.log(10)+1),w=n-u,S=Math.pow(10,w);return S};Gd.CAP_ROUND.get=function(){return Gn.CAP_ROUND};Gd.CAP_BUTT.get=function(){return Gn.CAP_FLAT};Gd.CAP_FLAT.get=function(){return Gn.CAP_FLAT};Gd.CAP_SQUARE.get=function(){return Gn.CAP_SQUARE};Gd.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(ho,Gd);var Zo=function(){this._pt=[new Dt,new Dt],this._distance=cn.NaN,this._isNull=!0};Zo.prototype.getCoordinates=function(){return this._pt};Zo.prototype.getCoordinate=function(t){return this._pt[t]};Zo.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}};Zo.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=s,this._isNull=!1}};Zo.prototype.getDistance=function(){return this._distance};Zo.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}};Zo.prototype.interfaces_=function(){return[]};Zo.prototype.getClass=function(){return Zo};var hu=function(){};hu.prototype.interfaces_=function(){return[]};hu.prototype.getClass=function(){return hu};hu.computeDistance=function(){if(arguments[2]instanceof Zo&&arguments[0]instanceof Hr&&arguments[1]instanceof Dt)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=t.getCoordinates(),s=new Ye,c=0;c<r.length-1;c++){s.setCoordinates(r[c],r[c+1]);var f=s.closestPoint(e);n.setMinimum(f,e)}else if(arguments[2]instanceof Zo&&arguments[0]instanceof Ni&&arguments[1]instanceof Dt){var u=arguments[0],w=arguments[1],S=arguments[2];hu.computeDistance(u.getExteriorRing(),w,S);for(var A=0;A<u.getNumInteriorRing();A++)hu.computeDistance(u.getInteriorRingN(A),w,S)}else if(arguments[2]instanceof Zo&&arguments[0]instanceof sn&&arguments[1]instanceof Dt){var N=arguments[0],O=arguments[1],j=arguments[2];if(N instanceof Hr)hu.computeDistance(N,O,j);else if(N instanceof Ni)hu.computeDistance(N,O,j);else if(N instanceof Ko)for(var W=N,nt=0;nt<W.getNumGeometries();nt++){var pt=W.getGeometryN(nt);hu.computeDistance(pt,O,j)}else j.setMinimum(N.getCoordinate(),O)}else if(arguments[2]instanceof Zo&&arguments[0]instanceof Ye&&arguments[1]instanceof Dt){var J=arguments[0],tt=arguments[1],Q=arguments[2],_t=J.closestPoint(tt);Q.setMinimum(_t,tt)}};var up=function(t){this._maxPtDist=new Zo,this._inputGeom=t||null},_w={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};up.prototype.computeMaxMidpointDistance=function(t){var e=new Hc(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())};up.prototype.computeMaxVertexDistance=function(t){var e=new nf(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())};up.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()};up.prototype.getDistancePoints=function(){return this._maxPtDist};up.prototype.interfaces_=function(){return[]};up.prototype.getClass=function(){return up};_w.MaxPointDistanceFilter.get=function(){return nf};_w.MaxMidpointDistanceFilter.get=function(){return Hc};Object.defineProperties(up,_w);var nf=function(t){this._maxPtDist=new Zo,this._minPtDist=new Zo,this._geom=t||null};nf.prototype.filter=function(t){this._minPtDist.initialize(),hu.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};nf.prototype.getMaxPointDistance=function(){return this._maxPtDist};nf.prototype.interfaces_=function(){return[_u]};nf.prototype.getClass=function(){return nf};var Hc=function(t){this._maxPtDist=new Zo,this._minPtDist=new Zo,this._geom=t||null};Hc.prototype.filter=function(t,e){if(e===0)return null;var n=t.getCoordinate(e-1),r=t.getCoordinate(e),s=new Dt((n.x+r.x)/2,(n.y+r.y)/2);this._minPtDist.initialize(),hu.computeDistance(this._geom,s,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Hc.prototype.isDone=function(){return!1};Hc.prototype.isGeometryChanged=function(){return!1};Hc.prototype.getMaxPointDistance=function(){return this._maxPtDist};Hc.prototype.interfaces_=function(){return[Ja]};Hc.prototype.getClass=function(){return Hc};var Ju=function(t){this._comps=t||null};Ju.prototype.filter=function(t){t instanceof Ni&&this._comps.add(t)};Ju.prototype.interfaces_=function(){return[Bl]};Ju.prototype.getClass=function(){return Ju};Ju.getPolygons=function(){if(arguments.length===1){var t=arguments[0];return Ju.getPolygons(t,new be)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];return e instanceof Ni?n.add(e):e instanceof Ko&&e.apply(new Ju(n)),n}};var uo=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var t=arguments[0];this._lines=t}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};uo.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof vu){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Hr&&this._lines.add(t)};uo.prototype.setForceToLineString=function(t){this._isForcedToLineString=t};uo.prototype.interfaces_=function(){return[ec]};uo.prototype.getClass=function(){return uo};uo.getGeometry=function(){if(arguments.length===1){var t=arguments[0];return t.getFactory().buildGeometry(uo.getLines(t))}else if(arguments.length===2){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(uo.getLines(e,n))}};uo.getLines=function(){if(arguments.length===1){var t=arguments[0];return uo.getLines(t,!1)}else if(arguments.length===2){if(an(arguments[0],Ci)&&an(arguments[1],Ci)){for(var e=arguments[0],n=arguments[1],r=e.iterator();r.hasNext();){var s=r.next();uo.getLines(s,n)}return n}else if(arguments[0]instanceof sn&&typeof arguments[1]=="boolean"){var c=arguments[0],f=arguments[1],u=new be;return c.apply(new uo(u,f)),u}else if(arguments[0]instanceof sn&&an(arguments[1],Ci)){var w=arguments[0],S=arguments[1];return w instanceof Hr?S.add(w):w.apply(new uo(S)),S}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&an(arguments[0],Ci)&&an(arguments[1],Ci)){for(var A=arguments[0],N=arguments[1],O=arguments[2],j=A.iterator();j.hasNext();){var W=j.next();uo.getLines(W,N,O)}return N}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof sn&&an(arguments[1],Ci)){var nt=arguments[0],pt=arguments[1],J=arguments[2];return nt.apply(new uo(pt,J)),pt}}};var nl=function(){if(this._boundaryRule=Ma.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0&&arguments.length===1){var t=arguments[0];if(t===null)throw new Nr("Rule must be non-null");this._boundaryRule=t}};nl.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof Dt&&arguments[1]instanceof Ni){var e=arguments[0],n=arguments[1];if(n.isEmpty())return Bt.EXTERIOR;var r=n.getExteriorRing(),s=this.locateInPolygonRing(e,r);if(s===Bt.EXTERIOR)return Bt.EXTERIOR;if(s===Bt.BOUNDARY)return Bt.BOUNDARY;for(var c=0;c<n.getNumInteriorRing();c++){var f=n.getInteriorRingN(c),u=t.locateInPolygonRing(e,f);if(u===Bt.INTERIOR)return Bt.EXTERIOR;if(u===Bt.BOUNDARY)return Bt.BOUNDARY}return Bt.INTERIOR}else if(arguments[0]instanceof Dt&&arguments[1]instanceof Hr){var w=arguments[0],S=arguments[1];if(!S.getEnvelopeInternal().intersects(w))return Bt.EXTERIOR;var A=S.getCoordinates();return!S.isClosed()&&(w.equals(A[0])||w.equals(A[A.length-1]))?Bt.BOUNDARY:Ne.isOnLine(w,A)?Bt.INTERIOR:Bt.EXTERIOR}else if(arguments[0]instanceof Dt&&arguments[1]instanceof As){var N=arguments[0],O=arguments[1],j=O.getCoordinate();return j.equals2D(N)?Bt.INTERIOR:Bt.EXTERIOR}};nl.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?Ne.locatePointInRing(t,e.getCoordinates()):Bt.EXTERIOR};nl.prototype.intersects=function(t,e){return this.locate(t,e)!==Bt.EXTERIOR};nl.prototype.updateLocationInfo=function(t){t===Bt.INTERIOR&&(this._isIn=!0),t===Bt.BOUNDARY&&this._numBoundaries++};nl.prototype.computeLocation=function(t,e){var n=this;if(e instanceof As&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Hr)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Ni)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof ip)for(var r=e,s=0;s<r.getNumGeometries();s++){var c=r.getGeometryN(s);n.updateLocationInfo(n.locateInternal(t,c))}else if(e instanceof gu)for(var f=e,u=0;u<f.getNumGeometries();u++){var w=f.getGeometryN(u);n.updateLocationInfo(n.locateInternal(t,w))}else if(e instanceof Ko)for(var S=new mu(e);S.hasNext();){var A=S.next();A!==e&&n.computeLocation(t,A)}};nl.prototype.locate=function(t,e){return e.isEmpty()?Bt.EXTERIOR:e instanceof Hr?this.locateInternal(t,e):e instanceof Ni?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?Bt.BOUNDARY:this._numBoundaries>0||this._isIn?Bt.INTERIOR:Bt.EXTERIOR)};nl.prototype.interfaces_=function(){return[]};nl.prototype.getClass=function(){return nl};var Xo=function t(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];this._component=r,this._segIndex=s,this._pt=c}},P2={INSIDE_AREA:{configurable:!0}};Xo.prototype.isInsideArea=function(){return this._segIndex===Xo.INSIDE_AREA};Xo.prototype.getCoordinate=function(){return this._pt};Xo.prototype.getGeometryComponent=function(){return this._component};Xo.prototype.getSegmentIndex=function(){return this._segIndex};Xo.prototype.interfaces_=function(){return[]};Xo.prototype.getClass=function(){return Xo};P2.INSIDE_AREA.get=function(){return-1};Object.defineProperties(Xo,P2);var Oc=function(t){this._pts=t||null};Oc.prototype.filter=function(t){t instanceof As&&this._pts.add(t)};Oc.prototype.interfaces_=function(){return[Bl]};Oc.prototype.getClass=function(){return Oc};Oc.getPoints=function(){if(arguments.length===1){var t=arguments[0];return t instanceof As?tl.singletonList(t):Oc.getPoints(t,new be)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];return e instanceof As?n.add(e):e instanceof Ko&&e.apply(new Oc(n)),n}};var rf=function(){this._locations=null;var t=arguments[0];this._locations=t};rf.prototype.filter=function(t){(t instanceof As||t instanceof Hr||t instanceof Ni)&&this._locations.add(new Xo(t,0,t.getCoordinate()))};rf.prototype.interfaces_=function(){return[Bl]};rf.prototype.getClass=function(){return rf};rf.getLocations=function(t){var e=new be;return t.apply(new rf(e)),e};var go=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new nl,this._minDistanceLocation=null,this._minDistance=cn.MAX_VALUE,arguments.length===2){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=r,this._terminateDistance=s}};go.prototype.computeContainmentDistance=function(){var t=this;if(arguments.length===0){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],s=1-n,c=Ju.getPolygons(this._geom[n]);if(c.size()>0){var f=rf.getLocations(this._geom[s]);if(this.computeContainmentDistance(f,c,r),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[s]=r[0],this._minDistanceLocation[n]=r[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&an(arguments[0],Ha)&&an(arguments[1],Ha)){for(var u=arguments[0],w=arguments[1],S=arguments[2],A=0;A<u.size();A++)for(var N=u.get(A),O=0;O<w.size();O++)if(t.computeContainmentDistance(N,w.get(O),S),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Xo&&arguments[1]instanceof Ni){var j=arguments[0],W=arguments[1],nt=arguments[2],pt=j.getCoordinate();if(Bt.EXTERIOR!==this._ptLocator.locate(pt,W))return this._minDistance=0,nt[0]=j,nt[1]=new Xo(W,pt),null}}};go.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var r=this,s=0;s<t.size();s++)for(var c=t.get(s),f=0;f<e.size();f++){var u=e.get(f);if(r.computeMinDistance(c,u,n),r._minDistance<=r._terminateDistance)return null}};go.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=uo.getLines(this._geom[0]),n=uo.getLines(this._geom[1]),r=Oc.getPoints(this._geom[0]),s=Oc.getPoints(this._geom[1]);if(this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,s,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance)||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,r,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance))return null;t[0]=null,t[1]=null,this.computeMinDistancePoints(r,s,t),this.updateMinDistance(t,!1)};go.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};go.prototype.updateMinDistance=function(t,e){if(t[0]===null)return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])};go.prototype.nearestPoints=function(){this.computeMinDistance();var t=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return t};go.prototype.computeMinDistance=function(){var t=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Hr&&arguments[1]instanceof As){var e=arguments[0],n=arguments[1],r=arguments[2];if(e.getEnvelopeInternal().distance(n.getEnvelopeInternal())>this._minDistance)return null;for(var s=e.getCoordinates(),c=n.getCoordinate(),f=0;f<s.length-1;f++){var u=Ne.distancePointLine(c,s[f],s[f+1]);if(u<t._minDistance){t._minDistance=u;var w=new Ye(s[f],s[f+1]),S=w.closestPoint(c);r[0]=new Xo(e,f,S),r[1]=new Xo(n,0,c)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Hr&&arguments[1]instanceof Hr){var A=arguments[0],N=arguments[1],O=arguments[2];if(A.getEnvelopeInternal().distance(N.getEnvelopeInternal())>this._minDistance)return null;for(var j=A.getCoordinates(),W=N.getCoordinates(),nt=0;nt<j.length-1;nt++)for(var pt=0;pt<W.length-1;pt++){var J=Ne.distanceLineLine(j[nt],j[nt+1],W[pt],W[pt+1]);if(J<t._minDistance){t._minDistance=J;var tt=new Ye(j[nt],j[nt+1]),Q=new Ye(W[pt],W[pt+1]),_t=tt.closestPoints(Q);O[0]=new Xo(A,nt,_t[0]),O[1]=new Xo(N,pt,_t[1])}if(t._minDistance<=t._terminateDistance)return null}}}};go.prototype.computeMinDistancePoints=function(t,e,n){for(var r=this,s=0;s<t.size();s++)for(var c=t.get(s),f=0;f<e.size();f++){var u=e.get(f),w=c.getCoordinate().distance(u.getCoordinate());if(w<r._minDistance&&(r._minDistance=w,n[0]=new Xo(c,0,c.getCoordinate()),n[1]=new Xo(u,0,u.getCoordinate())),r._minDistance<=r._terminateDistance)return null}};go.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new Nr("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};go.prototype.computeMinDistanceLines=function(t,e,n){for(var r=this,s=0;s<t.size();s++)for(var c=t.get(s),f=0;f<e.size();f++){var u=e.get(f);if(r.computeMinDistance(c,u,n),r._minDistance<=r._terminateDistance)return null}};go.prototype.interfaces_=function(){return[]};go.prototype.getClass=function(){return go};go.distance=function(t,e){var n=new go(t,e);return n.distance()};go.isWithinDistance=function(t,e,n){var r=new go(t,e,n);return r.distance()<=n};go.nearestPoints=function(t,e){var n=new go(t,e);return n.nearestPoints()};var Po=function(){this._pt=[new Dt,new Dt],this._distance=cn.NaN,this._isNull=!0};Po.prototype.getCoordinates=function(){return this._pt};Po.prototype.getCoordinate=function(t){return this._pt[t]};Po.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}};Po.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=s,this._isNull=!1}};Po.prototype.toString=function(){return Ka.toLineString(this._pt[0],this._pt[1])};Po.prototype.getDistance=function(){return this._distance};Po.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}};Po.prototype.interfaces_=function(){return[]};Po.prototype.getClass=function(){return Po};var Pl=function(){};Pl.prototype.interfaces_=function(){return[]};Pl.prototype.getClass=function(){return Pl};Pl.computeDistance=function(){if(arguments[2]instanceof Po&&arguments[0]instanceof Hr&&arguments[1]instanceof Dt)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=new Ye,s=t.getCoordinates(),c=0;c<s.length-1;c++){r.setCoordinates(s[c],s[c+1]);var f=r.closestPoint(e);n.setMinimum(f,e)}else if(arguments[2]instanceof Po&&arguments[0]instanceof Ni&&arguments[1]instanceof Dt){var u=arguments[0],w=arguments[1],S=arguments[2];Pl.computeDistance(u.getExteriorRing(),w,S);for(var A=0;A<u.getNumInteriorRing();A++)Pl.computeDistance(u.getInteriorRingN(A),w,S)}else if(arguments[2]instanceof Po&&arguments[0]instanceof sn&&arguments[1]instanceof Dt){var N=arguments[0],O=arguments[1],j=arguments[2];if(N instanceof Hr)Pl.computeDistance(N,O,j);else if(N instanceof Ni)Pl.computeDistance(N,O,j);else if(N instanceof Ko)for(var W=N,nt=0;nt<W.getNumGeometries();nt++){var pt=W.getGeometryN(nt);Pl.computeDistance(pt,O,j)}else j.setMinimum(N.getCoordinate(),O)}else if(arguments[2]instanceof Po&&arguments[0]instanceof Ye&&arguments[1]instanceof Dt){var J=arguments[0],tt=arguments[1],Q=arguments[2],_t=J.closestPoint(tt);Q.setMinimum(_t,tt)}};var Ta=function(){this._g0=null,this._g1=null,this._ptDist=new Po,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},vw={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Ta.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};Ta.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new Nr("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t};Ta.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)};Ta.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};Ta.prototype.computeOrientedDistance=function(t,e,n){var r=new of(e);if(t.apply(r),n.setMaximum(r.getMaxPointDistance()),this._densifyFrac>0){var s=new Yc(e,this._densifyFrac);t.apply(s),n.setMaximum(s.getMaxPointDistance())}};Ta.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};Ta.prototype.interfaces_=function(){return[]};Ta.prototype.getClass=function(){return Ta};Ta.distance=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],n=new Ta(t,e);return n.distance()}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2],f=new Ta(r,s);return f.setDensifyFraction(c),f.distance()}};vw.MaxPointDistanceFilter.get=function(){return of};vw.MaxDensifiedByFractionDistanceFilter.get=function(){return Yc};Object.defineProperties(Ta,vw);var of=function(){this._maxPtDist=new Po,this._minPtDist=new Po,this._euclideanDist=new Pl,this._geom=null;var t=arguments[0];this._geom=t};of.prototype.filter=function(t){this._minPtDist.initialize(),Pl.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};of.prototype.getMaxPointDistance=function(){return this._maxPtDist};of.prototype.interfaces_=function(){return[_u]};of.prototype.getClass=function(){return of};var Yc=function(){this._maxPtDist=new Po,this._minPtDist=new Po,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Yc.prototype.filter=function(t,e){var n=this;if(e===0)return null;for(var r=t.getCoordinate(e-1),s=t.getCoordinate(e),c=(s.x-r.x)/this._numSubSegs,f=(s.y-r.y)/this._numSubSegs,u=0;u<this._numSubSegs;u++){var w=r.x+u*c,S=r.y+u*f,A=new Dt(w,S);n._minPtDist.initialize(),Pl.computeDistance(n._geom,A,n._minPtDist),n._maxPtDist.setMaximum(n._minPtDist)}};Yc.prototype.isDone=function(){return!1};Yc.prototype.isGeometryChanged=function(){return!1};Yc.prototype.getMaxPointDistance=function(){return this._maxPtDist};Yc.prototype.interfaces_=function(){return[Ja]};Yc.prototype.getClass=function(){return Yc};var Ms=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},xw={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Ms.prototype.checkMaximumDistance=function(t,e,n){var r=new Ta(e,t);if(r.setDensifyFraction(.25),this._maxDistanceFound=r.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var s=r.getCoordinates();this._errorLocation=s[1],this._errorIndicator=t.getFactory().createLineString(s),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Ka.toLineString(s[0],s[1])+")"}};Ms.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Ms.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Ms.VERBOSE&&fo.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};Ms.prototype.checkNegativeValid=function(){if(!(this._input instanceof Ni||this._input instanceof gu||this._input instanceof Ko))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)};Ms.prototype.getErrorIndicator=function(){return this._errorIndicator};Ms.prototype.checkMinimumDistance=function(t,e,n){var r=new go(t,e,n);if(this._minDistanceFound=r.distance(),this._minDistanceFound<n){this._isValid=!1;var s=r.nearestPoints();this._errorLocation=r.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(s),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Ka.toLineString(s[0],s[1])+" )"}};Ms.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)};Ms.prototype.getErrorLocation=function(){return this._errorLocation};Ms.prototype.getPolygonLines=function(t){for(var e=new be,n=new uo(e),r=Ju.getPolygons(t),s=r.iterator();s.hasNext();){var c=s.next();c.apply(n)}return t.getFactory().buildGeometry(e)};Ms.prototype.getErrorMessage=function(){return this._errMsg};Ms.prototype.interfaces_=function(){return[]};Ms.prototype.getClass=function(){return Ms};xw.VERBOSE.get=function(){return!1};xw.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Ms,xw);var mo=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},ww={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};mo.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};mo.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*mo.MAX_ENV_DIFF_FRAC;t===0&&(t=.001);var e=new He(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new He(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")};mo.prototype.checkDistance=function(){var t=new Ms(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")};mo.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};mo.prototype.checkPolygonal=function(){this._result instanceof Ni||this._result instanceof gu||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};mo.prototype.getErrorIndicator=function(){return this._errorIndicator};mo.prototype.getErrorLocation=function(){return this._errorLocation};mo.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};mo.prototype.report=function(t){if(!mo.VERBOSE)return null;fo.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))};mo.prototype.getErrorMessage=function(){return this._errorMsg};mo.prototype.interfaces_=function(){return[]};mo.prototype.getClass=function(){return mo};mo.isValidMsg=function(t,e,n){var r=new mo(t,e,n);return r.isValid()?null:r.getErrorMessage()};mo.isValid=function(t,e,n){var r=new mo(t,e,n);return!!r.isValid()};ww.VERBOSE.get=function(){return!1};ww.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(mo,ww);var ql=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};ql.prototype.getCoordinates=function(){return this._pts};ql.prototype.size=function(){return this._pts.length};ql.prototype.getCoordinate=function(t){return this._pts[t]};ql.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};ql.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:Qp.octant(this.getCoordinate(t),this.getCoordinate(t+1))};ql.prototype.setData=function(t){this._data=t};ql.prototype.getData=function(){return this._data};ql.prototype.toString=function(){return Ka.toLineString(new ri(this._pts))};ql.prototype.interfaces_=function(){return[wu]};ql.prototype.getClass=function(){return ql};var oo=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new be,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};oo.prototype.getInteriorIntersection=function(){return this._interiorIntersection};oo.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t};oo.prototype.getIntersectionSegments=function(){return this._intSegments};oo.prototype.count=function(){return this._intersectionCount};oo.prototype.getIntersections=function(){return this._intersections};oo.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};oo.prototype.setKeepIntersections=function(t){this._keepIntersections=t};oo.prototype.processIntersections=function(t,e,n,r){if(!this._findAllIntersections&&this.hasIntersection()||t===n&&e===r)return null;if(this._isCheckEndSegmentsOnly){var s=this.isEndSegment(t,e)||this.isEndSegment(n,r);if(!s)return null}var c=t.getCoordinates()[e],f=t.getCoordinates()[e+1],u=n.getCoordinates()[r],w=n.getCoordinates()[r+1];this._li.computeIntersection(c,f,u,w),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=c,this._intSegments[1]=f,this._intSegments[2]=u,this._intSegments[3]=w,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};oo.prototype.isEndSegment=function(t,e){return e===0||e>=t.size()-2};oo.prototype.hasIntersection=function(){return this._interiorIntersection!==null};oo.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};oo.prototype.interfaces_=function(){return[ap]};oo.prototype.getClass=function(){return oo};oo.createAllIntersectionsFinder=function(t){var e=new oo(t);return e.setFindAllIntersections(!0),e};oo.createAnyIntersectionFinder=function(t){return new oo(t)};oo.createIntersectionCounter=function(t){var e=new oo(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var rl=function(){this._li=new vp,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};rl.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};rl.prototype.getIntersections=function(){return this._segInt.getIntersections()};rl.prototype.isValid=function(){return this.execute(),this._isValid};rl.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};rl.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new oo(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new yw;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};rl.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new nc(this.getErrorMessage(),this._segInt.getInteriorIntersection())};rl.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Ka.toLineString(t[0],t[1])+" and "+Ka.toLineString(t[2],t[3])};rl.prototype.interfaces_=function(){return[]};rl.prototype.getClass=function(){return rl};rl.computeIntersections=function(t){var e=new rl(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var cp=function t(){this._nv=null;var e=arguments[0];this._nv=new rl(t.toSegmentStrings(e))};cp.prototype.checkValid=function(){this._nv.checkValid()};cp.prototype.interfaces_=function(){return[]};cp.prototype.getClass=function(){return cp};cp.toSegmentStrings=function(t){for(var e=new be,n=t.iterator();n.hasNext();){var r=n.next();e.add(new ql(r.getCoordinates(),r))}return e};cp.checkValid=function(t){var e=new cp(t);e.checkValid()};var sf=function(t){this._mapOp=t};sf.prototype.map=function(t){for(var e=this,n=new be,r=0;r<t.getNumGeometries();r++){var s=e._mapOp.map(t.getGeometryN(r));s.isEmpty()||n.add(s)}return t.getFactory().createGeometryCollection(Tn.toGeometryArray(n))};sf.prototype.interfaces_=function(){return[]};sf.prototype.getClass=function(){return sf};sf.map=function(t,e){var n=new sf(e);return n.map(t)};var Zl=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new be,this._resultLineList=new be;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Zl.prototype.collectLines=function(t){for(var e=this,n=this._op.getGraph().getEdgeEnds().iterator();n.hasNext();){var r=n.next();e.collectLineEdge(r,t,e._lineEdgesList),e.collectBoundaryTouchEdge(r,t,e._lineEdgesList)}};Zl.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)};Zl.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList};Zl.prototype.collectLineEdge=function(t,e,n){var r=t.getLabel(),s=t.getEdge();t.isLineEdge()&&!t.isVisited()&&gn.isResultOfOp(r,e)&&!s.isCovered()&&(n.add(s),t.setVisitedEdge(!0))};Zl.prototype.findCoveredLineEdges=function(){for(var t=this,e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();n.getEdges().findCoveredLineEdges()}for(var r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var s=r.next(),c=s.getEdge();if(s.isLineEdge()&&!c.isCoveredSet()){var f=t._op.isCoveredByA(s.getCoordinate());c.setCovered(f)}}};Zl.prototype.labelIsolatedLines=function(t){for(var e=this,n=t.iterator();n.hasNext();){var r=n.next(),s=r.getLabel();r.isIsolated()&&(s.isNull(0)?e.labelIsolatedLine(r,0):e.labelIsolatedLine(r,1))}};Zl.prototype.buildLines=function(t){for(var e=this,n=this._lineEdgesList.iterator();n.hasNext();){var r=n.next(),s=e._geometryFactory.createLineString(r.getCoordinates());e._resultLineList.add(s),r.setInResult(!0)}};Zl.prototype.collectBoundaryTouchEdge=function(t,e,n){var r=t.getLabel();if(t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult())return null;yn.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),gn.isResultOfOp(r,e)&&e===gn.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))};Zl.prototype.interfaces_=function(){return[]};Zl.prototype.getClass=function(){return Zl};var af=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new be;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};af.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}};af.prototype.extractNonCoveredResultNodes=function(t){for(var e=this,n=this._op.getGraph().getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isInResult()&&!r.isIncidentEdgeInResult()&&(r.getEdges().getDegree()===0||t===gn.INTERSECTION)){var s=r.getLabel();gn.isResultOfOp(s,t)&&e.filterCoveredNodeToPoint(r)}}};af.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList};af.prototype.interfaces_=function(){return[]};af.prototype.getClass=function(){return af};var ys=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};ys.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))};ys.prototype.transformPolygon=function(t,e){var n=this,r=!0,s=this.transformLinearRing(t.getExteriorRing(),t);(s===null||!(s instanceof vu)||s.isEmpty())&&(r=!1);for(var c=new be,f=0;f<t.getNumInteriorRing();f++){var u=n.transformLinearRing(t.getInteriorRingN(f),t);u===null||u.isEmpty()||(u instanceof vu||(r=!1),c.add(u))}if(r)return this._factory.createPolygon(s,c.toArray([]));var w=new be;return s!==null&&w.add(s),w.addAll(c),this._factory.buildGeometry(w)};ys.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)};ys.prototype.getInputGeometry=function(){return this._inputGeom};ys.prototype.transformMultiLineString=function(t,e){for(var n=this,r=new be,s=0;s<t.getNumGeometries();s++){var c=n.transformLineString(t.getGeometryN(s),t);c!==null&&(c.isEmpty()||r.add(c))}return this._factory.buildGeometry(r)};ys.prototype.transformCoordinates=function(t,e){return this.copy(t)};ys.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))};ys.prototype.transformMultiPoint=function(t,e){for(var n=this,r=new be,s=0;s<t.getNumGeometries();s++){var c=n.transformPoint(t.getGeometryN(s),t);c!==null&&(c.isEmpty()||r.add(c))}return this._factory.buildGeometry(r)};ys.prototype.transformMultiPolygon=function(t,e){for(var n=this,r=new be,s=0;s<t.getNumGeometries();s++){var c=n.transformPolygon(t.getGeometryN(s),t);c!==null&&(c.isEmpty()||r.add(c))}return this._factory.buildGeometry(r)};ys.prototype.copy=function(t){return t.copy()};ys.prototype.transformGeometryCollection=function(t,e){for(var n=this,r=new be,s=0;s<t.getNumGeometries();s++){var c=n.transform(t.getGeometryN(s));c!==null&&(n._pruneEmptyGeometry&&c.isEmpty()||r.add(c))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Tn.toGeometryArray(r)):this._factory.buildGeometry(r)};ys.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof As)return this.transformPoint(t,null);if(t instanceof Ed)return this.transformMultiPoint(t,null);if(t instanceof vu)return this.transformLinearRing(t,null);if(t instanceof Hr)return this.transformLineString(t,null);if(t instanceof ip)return this.transformMultiLineString(t,null);if(t instanceof Ni)return this.transformPolygon(t,null);if(t instanceof gu)return this.transformMultiPolygon(t,null);if(t instanceof Ko)return this.transformGeometryCollection(t,null);throw new Nr("Unknown Geometry subtype: "+t.getClass().getName())};ys.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(n===null)return this._factory.createLinearRing(null);var r=n.size();return r>0&&r<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)};ys.prototype.interfaces_=function(){return[]};ys.prototype.getClass=function(){return ys};var Su=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Ye,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Hr&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var r=arguments[0],s=arguments[1];this._srcPts=r,this._isClosed=t.isClosed(r),this._snapTolerance=s}};Su.prototype.snapVertices=function(t,e){for(var n=this,r=this._isClosed?t.size()-1:t.size(),s=0;s<r;s++){var c=t.get(s),f=n.findSnapForVertex(c,e);f!==null&&(t.set(s,new Dt(f)),s===0&&n._isClosed&&t.set(t.size()-1,new Dt(f)))}};Su.prototype.findSnapForVertex=function(t,e){for(var n=this,r=0;r<e.length;r++){if(t.equals2D(e[r]))return null;if(t.distance(e[r])<n._snapTolerance)return e[r]}return null};Su.prototype.snapTo=function(t){var e=new Gm(this._srcPts);this.snapVertices(e,t),this.snapSegments(e,t);var n=e.toCoordinateArray();return n};Su.prototype.snapSegments=function(t,e){var n=this;if(e.length===0)return null;var r=e.length;e[0].equals2D(e[e.length-1])&&(r=e.length-1);for(var s=0;s<r;s++){var c=e[s],f=n.findSegmentIndexToSnap(c,t);f>=0&&t.add(f+1,new Dt(c),!1)}};Su.prototype.findSegmentIndexToSnap=function(t,e){for(var n=this,r=cn.MAX_VALUE,s=-1,c=0;c<e.size()-1;c++){if(n._seg.p0=e.get(c),n._seg.p1=e.get(c+1),n._seg.p0.equals2D(t)||n._seg.p1.equals2D(t)){if(n._allowSnappingToSourceVertices)continue;return-1}var f=n._seg.distance(t);f<n._snapTolerance&&f<r&&(r=f,s=c)}return s};Su.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t};Su.prototype.interfaces_=function(){return[]};Su.prototype.getClass=function(){return Su};Su.isClosed=function(t){return t.length<=1?!1:t[0].equals2D(t[t.length-1])};var ii=function(t){this._srcGeom=t||null},M2={SNAP_PRECISION_FACTOR:{configurable:!0}};ii.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t),r=new L2(e,n);return r.transform(this._srcGeom)};ii.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),r=new L2(t,n,!0),s=r.transform(this._srcGeom),c=s;return e&&an(c,jc)&&(c=s.buffer(0)),c};ii.prototype.computeSnapTolerance=function(t){var e=this.computeMinimumSegmentLength(t),n=e/10;return n};ii.prototype.extractTargetCoordinates=function(t){for(var e=new Fl,n=t.getCoordinates(),r=0;r<n.length;r++)e.add(n[r]);return e.toArray(new Array(0).fill(null))};ii.prototype.computeMinimumSegmentLength=function(t){for(var e=cn.MAX_VALUE,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);r<e&&(e=r)}return e};ii.prototype.interfaces_=function(){return[]};ii.prototype.getClass=function(){return ii};ii.snap=function(t,e,n){var r=new Array(2).fill(null),s=new ii(t);r[0]=s.snapTo(e,n);var c=new ii(e);return r[1]=c.snapTo(r[0],n),r};ii.computeOverlaySnapTolerance=function(){if(arguments.length===1){var t=arguments[0],e=ii.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===jn.FIXED){var r=1/n.getScale()*2/1.415;r>e&&(e=r)}return e}else if(arguments.length===2){var s=arguments[0],c=arguments[1];return Math.min(ii.computeOverlaySnapTolerance(s),ii.computeOverlaySnapTolerance(c))}};ii.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal(),n=Math.min(e.getHeight(),e.getWidth()),r=n*ii.SNAP_PRECISION_FACTOR;return r};ii.snapToSelf=function(t,e,n){var r=new ii(t);return r.snapToSelf(e,n)};M2.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(ii,M2);var L2=function(t){function e(n,r,s){t.call(this),this._snapTolerance=n||null,this._snapPts=r||null,this._isSelfSnap=s!==void 0?s:!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(n,r){var s=new Su(n,this._snapTolerance);return s.setAllowSnappingToSourceVertices(this._isSelfSnap),s.snapTo(r)},e.prototype.transformCoordinates=function(n,r){var s=n.toCoordinateArray(),c=this.snapLine(s,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(c)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ys),qo=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};qo.prototype.getCommon=function(){return cn.longBitsToDouble(this._commonBits)};qo.prototype.add=function(t){var e=cn.doubleToLongBits(t);if(this._isFirst)return this._commonBits=e,this._commonSignExp=qo.signExpBits(this._commonBits),this._isFirst=!1,null;var n=qo.signExpBits(e);if(n!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=qo.numCommonMostSigMantissaBits(this._commonBits,e),this._commonBits=qo.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};qo.prototype.toString=function(){if(arguments.length===1){var t=arguments[0],e=cn.longBitsToDouble(t),n=cn.toBinaryString(t),r="0000000000000000000000000000000000000000000000000000000000000000"+n,s=r.substring(r.length-64),c=s.substring(0,1)+"  "+s.substring(1,12)+"(exp) "+s.substring(12)+" [ "+e+" ]";return c}};qo.prototype.interfaces_=function(){return[]};qo.prototype.getClass=function(){return qo};qo.getBit=function(t,e){var n=1<<e;return t&n?1:0};qo.signExpBits=function(t){return t>>52};qo.zeroLowerBits=function(t,e){var n=(1<<e)-1,r=~n,s=t&r;return s};qo.numCommonMostSigMantissaBits=function(t,e){for(var n=0,r=52;r>=0;r--){if(qo.getBit(t,r)!==qo.getBit(e,r))return n;n++}return 52};var Kc=function(){this._commonCoord=null,this._ccFilter=new lf},bw={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Kc.prototype.addCommonBits=function(t){var e=new Jc(this._commonCoord);t.apply(e),t.geometryChanged()};Kc.prototype.removeCommonBits=function(t){if(this._commonCoord.x===0&&this._commonCoord.y===0)return t;var e=new Dt(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new Jc(e);return t.apply(n),t.geometryChanged(),t};Kc.prototype.getCommonCoordinate=function(){return this._commonCoord};Kc.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};Kc.prototype.interfaces_=function(){return[]};Kc.prototype.getClass=function(){return Kc};bw.CommonCoordinateFilter.get=function(){return lf};bw.Translater.get=function(){return Jc};Object.defineProperties(Kc,bw);var lf=function(){this._commonBitsX=new qo,this._commonBitsY=new qo};lf.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)};lf.prototype.getCommonCoordinate=function(){return new Dt(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};lf.prototype.interfaces_=function(){return[_u]};lf.prototype.getClass=function(){return lf};var Jc=function(){this.trans=null;var t=arguments[0];this.trans=t};Jc.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,r=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,r)};Jc.prototype.isDone=function(){return!1};Jc.prototype.isGeometryChanged=function(){return!0};Jc.prototype.interfaces_=function(){return[Ja]};Jc.prototype.getClass=function(){return Jc};var so=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};so.prototype.selfSnap=function(t){var e=new ii(t),n=e.snapTo(t,this._snapTolerance);return n};so.prototype.removeCommonBits=function(t){this._cbr=new Kc,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e};so.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t};so.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=gn.overlayOp(e[0],e[1],t);return this.prepareResult(n)};so.prototype.checkValid=function(t){t.isValid()||fo.out.println("Snapped geometry is invalid")};so.prototype.computeSnapTolerance=function(){this._snapTolerance=ii.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};so.prototype.snap=function(t){var e=this.removeCommonBits(t),n=ii.snap(e[0],e[1],this._snapTolerance);return n};so.prototype.interfaces_=function(){return[]};so.prototype.getClass=function(){return so};so.overlayOp=function(t,e,n){var r=new so(t,e);return r.getResultGeometry(n)};so.union=function(t,e){return so.overlayOp(t,e,gn.UNION)};so.intersection=function(t,e){return so.overlayOp(t,e,gn.INTERSECTION)};so.symDifference=function(t,e){return so.overlayOp(t,e,gn.SYMDIFFERENCE)};so.difference=function(t,e){return so.overlayOp(t,e,gn.DIFFERENCE)};var ts=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};ts.prototype.getResultGeometry=function(t){var e=null,n=!1,r=null;try{e=gn.overlayOp(this._geom[0],this._geom[1],t);var s=!0;s&&(n=!0)}catch(c){if(c instanceof tc)r=c;else throw c}finally{}if(!n)try{e=so.overlayOp(this._geom[0],this._geom[1],t)}catch(c){throw c instanceof tc?r:c}finally{}return e};ts.prototype.interfaces_=function(){return[]};ts.prototype.getClass=function(){return ts};ts.overlayOp=function(t,e,n){var r=new ts(t,e);return r.getResultGeometry(n)};ts.union=function(t,e){return ts.overlayOp(t,e,gn.UNION)};ts.intersection=function(t,e){return ts.overlayOp(t,e,gn.INTERSECTION)};ts.symDifference=function(t,e){return ts.overlayOp(t,e,gn.SYMDIFFERENCE)};ts.difference=function(t,e){return ts.overlayOp(t,e,gn.DIFFERENCE)};var km=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};km.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)};km.prototype.interfaces_=function(){return[]};km.prototype.getClass=function(){return km};var Ds=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];this._eventType=t.INSERT,this._label=r,this._xValue=s,this._obj=c}},Ew={INSERT:{configurable:!0},DELETE:{configurable:!0}};Ds.prototype.isDelete=function(){return this._eventType===Ds.DELETE};Ds.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t};Ds.prototype.getObject=function(){return this._obj};Ds.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0};Ds.prototype.getInsertEvent=function(){return this._insertEvent};Ds.prototype.isInsert=function(){return this._eventType===Ds.INSERT};Ds.prototype.isSameLabel=function(t){return this._label===null?!1:this._label===t._label};Ds.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};Ds.prototype.interfaces_=function(){return[ka]};Ds.prototype.getClass=function(){return Ds};Ew.INSERT.get=function(){return 1};Ew.DELETE.get=function(){return 2};Object.defineProperties(Ds,Ew);var G_=function(){};G_.prototype.interfaces_=function(){return[]};G_.prototype.getClass=function(){return G_};var yo=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};yo.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&this._li.getIntersectionNum()===1){if(yo.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var s=t.getNumPoints()-1;if(e===0&&r===s||r===0&&e===s)return!0}}return!1};yo.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};yo.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t};yo.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};yo.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next(),s=r.getCoordinate();if(t.isIntersection(s))return!0}return!1};yo.prototype.hasProperIntersection=function(){return this._hasProper};yo.prototype.hasIntersection=function(){return this._hasIntersection};yo.prototype.isDone=function(){return this._isDone};yo.prototype.isBoundaryPoint=function(t,e){return e===null?!1:!!(this.isBoundaryPointInternal(t,e[0])||this.isBoundaryPointInternal(t,e[1]))};yo.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e};yo.prototype.addIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var s=t.getCoordinates()[e],c=t.getCoordinates()[e+1],f=n.getCoordinates()[r],u=n.getCoordinates()[r+1];this._li.computeIntersection(s,c,f,u),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};yo.prototype.interfaces_=function(){return[]};yo.prototype.getClass=function(){return yo};yo.isAdjacentSegments=function(t,e){return Math.abs(t-e)===1};var LD=function(t){function e(){t.call(this),this.events=new be,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){var n=this;tl.sort(this.events);for(var r=0;r<this.events.size();r++){var s=n.events.get(r);s.isDelete()&&s.getInsertEvent().setDeleteEventIndex(r)}},e.prototype.computeIntersections=function(){var n=this;if(arguments.length===1){var r=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var s=0;s<this.events.size();s++){var c=n.events.get(s);if(c.isInsert()&&n.processOverlaps(s,c.getDeleteEventIndex(),c,r),r.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof yo&&an(arguments[0],Ha)&&an(arguments[1],Ha)){var f=arguments[0],u=arguments[1],w=arguments[2];this.addEdges(f,f),this.addEdges(u,u),this.computeIntersections(w)}else if(typeof arguments[2]=="boolean"&&an(arguments[0],Ha)&&arguments[1]instanceof yo){var S=arguments[0],A=arguments[1],N=arguments[2];N?this.addEdges(S,null):this.addEdges(S),this.computeIntersections(A)}}},e.prototype.addEdge=function(n,r){for(var s=this,c=n.getMonotoneChainEdge(),f=c.getStartIndexes(),u=0;u<f.length-1;u++){var w=new km(c,u),S=new Ds(r,c.getMinX(u),w);s.events.add(S),s.events.add(new Ds(c.getMaxX(u),S))}},e.prototype.processOverlaps=function(n,r,s,c){for(var f=this,u=s.getObject(),w=n;w<r;w++){var S=f.events.get(w);if(S.isInsert()){var A=S.getObject();s.isSameLabel(S)||(u.computeIntersections(A,c),f.nOverlaps++)}}},e.prototype.addEdges=function(){var n=this;if(arguments.length===1)for(var r=arguments[0],s=r.iterator();s.hasNext();){var c=s.next();n.addEdge(c,c)}else if(arguments.length===2)for(var f=arguments[0],u=arguments[1],w=f.iterator();w.hasNext();){var S=w.next();n.addEdge(S,u)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(G_),Iu=function(){this._min=cn.POSITIVE_INFINITY,this._max=cn.NEGATIVE_INFINITY},A2={NodeComparator:{configurable:!0}};Iu.prototype.getMin=function(){return this._min};Iu.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)};Iu.prototype.getMax=function(){return this._max};Iu.prototype.toString=function(){return Ka.toLineString(new Dt(this._min,0),new Dt(this._max,0))};Iu.prototype.interfaces_=function(){return[]};Iu.prototype.getClass=function(){return Iu};A2.NodeComparator.get=function(){return Nm};Object.defineProperties(Iu,A2);var Nm=function(){};Nm.prototype.compare=function(t,e){var n=t,r=e,s=(n._min+n._max)/2,c=(r._min+r._max)/2;return s<c?-1:s>c?1:0};Nm.prototype.interfaces_=function(){return[md]};Nm.prototype.getClass=function(){return Nm};var AD=function(t){function e(){t.call(this),this._item=null;var n=arguments[0],r=arguments[1],s=arguments[2];this._min=n,this._max=r,this._item=s}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(n,r,s){if(!this.intersects(n,r))return null;s.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Iu),kD=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var n=arguments[0],r=arguments[1];this._node1=n,this._node2=r,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(n,r){this._min=Math.min(n._min,r._min),this._max=Math.max(n._max,r._max)},e.prototype.query=function(n,r,s){if(!this.intersects(n,r))return null;this._node1!==null&&this._node1.query(n,r,s),this._node2!==null&&this._node2.query(n,r,s)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Iu),Cu=function(){this._leaves=new be,this._root=null,this._level=0};Cu.prototype.buildTree=function(){var t=this;tl.sort(this._leaves,new Iu.NodeComparator);for(var e=this._leaves,n=null,r=new be;;){if(t.buildLevel(e,r),r.size()===1)return r.get(0);n=e,e=r,r=n}};Cu.prototype.insert=function(t,e,n){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new AD(t,e,n))};Cu.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)};Cu.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};Cu.prototype.printNode=function(t){fo.out.println(Ka.toLineString(new Dt(t._min,this._level),new Dt(t._max,this._level)))};Cu.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};Cu.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var r=t.get(n),s=n+1<t.size()?t.get(n):null;if(s===null)e.add(r);else{var c=new kD(t.get(n),t.get(n+1));e.add(c)}}};Cu.prototype.interfaces_=function(){return[]};Cu.prototype.getClass=function(){return Cu};var Md=function(){this._items=new be};Md.prototype.visitItem=function(t){this._items.add(t)};Md.prototype.getItems=function(){return this._items};Md.prototype.interfaces_=function(){return[qc]};Md.prototype.getClass=function(){return Md};var Ld=function(){this._index=null;var t=arguments[0];if(!an(t,jc))throw new Nr("Argument must be Polygonal");this._index=new hp(t)},Sw={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Ld.prototype.locate=function(t){var e=new Nl(t),n=new Ad(e);return this._index.query(t.y,t.y,n),e.getLocation()};Ld.prototype.interfaces_=function(){return[Td]};Ld.prototype.getClass=function(){return Ld};Sw.SegmentVisitor.get=function(){return Ad};Sw.IntervalIndexedGeometry.get=function(){return hp};Object.defineProperties(Ld,Sw);var Ad=function(){this._counter=null;var t=arguments[0];this._counter=t};Ad.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))};Ad.prototype.interfaces_=function(){return[qc]};Ad.prototype.getClass=function(){return Ad};var hp=function(){this._index=new Cu;var t=arguments[0];this.init(t)};hp.prototype.init=function(t){for(var e=this,n=uo.getLines(t),r=n.iterator();r.hasNext();){var s=r.next(),c=s.getCoordinates();e.addLine(c)}};hp.prototype.addLine=function(t){for(var e=this,n=1;n<t.length;n++){var r=new Ye(t[n-1],t[n]),s=Math.min(r.p0.y,r.p1.y),c=Math.max(r.p0.y,r.p1.y);e._index.insert(s,c,r)}};hp.prototype.query=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],n=new Md;return this._index.query(t,e,n),n.getItems()}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];this._index.query(r,s,c)}};hp.prototype.interfaces_=function(){return[]};hp.prototype.getClass=function(){return hp};var Og=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new d2,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new nl,arguments.length===2){var n=arguments[0],r=arguments[1],s=Ma.OGC_SFS_BOUNDARY_RULE;this._argIndex=n,this._parentGeom=r,this._boundaryNodeRule=s,r!==null&&this.add(r)}else if(arguments.length===3){var c=arguments[0],f=arguments[1],u=arguments[2];this._argIndex=c,this._parentGeom=f,this._boundaryNodeRule=u,f!==null&&this.add(f)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(n,r){var s=this._nodes.addNode(r),c=s.getLabel(),f=1,u=Bt.NONE;u=c.getLocation(n,fe.ON),u===Bt.BOUNDARY&&f++;var w=e.determineBoundary(this._boundaryNodeRule,f);c.setLocation(n,w)},e.prototype.computeSelfNodes=function(){if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.computeSelfNodes(n,r,!1)}else if(arguments.length===3){var s=arguments[0],c=arguments[1],f=arguments[2],u=new yo(s,!0,!1);u.setIsDoneIfProperInt(f);var w=this.createEdgeSetIntersector(),S=this._parentGeom instanceof vu||this._parentGeom instanceof Ni||this._parentGeom instanceof gu,A=c||!S;return w.computeIntersections(this._edges,u,A),this.addSelfIntersectionNodes(this._argIndex),u}},e.prototype.computeSplitEdges=function(n){for(var r=this._edges.iterator();r.hasNext();){var s=r.next();s.eiList.addSplitEdges(n)}},e.prototype.computeEdgeIntersections=function(n,r,s){var c=new yo(r,s,!0);c.setBoundaryNodes(this.getBoundaryNodes(),n.getBoundaryNodes());var f=this.createEdgeSetIntersector();return f.computeIntersections(this._edges,n._edges,c),c},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof As){var n=arguments[0],r=n.getCoordinate();this.insertPoint(this._argIndex,r,Bt.INTERIOR)}else if(arguments[0]instanceof Dt){var s=arguments[0];this.insertPoint(this._argIndex,s,Bt.INTERIOR)}},e.prototype.addPolygon=function(n){var r=this;this.addPolygonRing(n.getExteriorRing(),Bt.EXTERIOR,Bt.INTERIOR);for(var s=0;s<n.getNumInteriorRing();s++){var c=n.getInteriorRingN(s);r.addPolygonRing(c,Bt.INTERIOR,Bt.EXTERIOR)}},e.prototype.addEdge=function(n){this.insertEdge(n);var r=n.getCoordinates();this.insertPoint(this._argIndex,r[0],Bt.BOUNDARY),this.insertPoint(this._argIndex,r[r.length-1],Bt.BOUNDARY)},e.prototype.addLineString=function(n){var r=Pn.removeRepeatedPoints(n.getCoordinates());if(r.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;var s=new $_(r,new er(this._argIndex,Bt.INTERIOR));this._lineEdgeMap.put(n,s),this.insertEdge(s),yn.isTrue(r.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,r[0]),this.insertBoundaryPoint(this._argIndex,r[r.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var n=this.getBoundaryNodes(),r=new Array(n.size()).fill(null),s=0,c=n.iterator();c.hasNext();){var f=c.next();r[s++]=f.getCoordinate().copy()}return r},e.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(n,r,s){if(this.isBoundaryNode(n,r))return null;s===Bt.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(n,r):this.insertPoint(n,r,s)},e.prototype.addPolygonRing=function(n,r,s){if(n.isEmpty())return null;var c=Pn.removeRepeatedPoints(n.getCoordinates());if(c.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=c[0],null;var f=r,u=s;Ne.isCCW(c)&&(f=s,u=r);var w=new $_(c,new er(this._argIndex,Bt.BOUNDARY,f,u));this._lineEdgeMap.put(n,w),this.insertEdge(w),this.insertPoint(this._argIndex,c[0],Bt.BOUNDARY)},e.prototype.insertPoint=function(n,r,s){var c=this._nodes.addNode(r),f=c.getLabel();f===null?c._label=new er(n,s):f.setLocation(n,s)},e.prototype.createEdgeSetIntersector=function(){return new LD},e.prototype.addSelfIntersectionNodes=function(n){for(var r=this,s=this._edges.iterator();s.hasNext();)for(var c=s.next(),f=c.getLabel().getLocation(n),u=c.eiList.iterator();u.hasNext();){var w=u.next();r.addSelfIntersectionNode(n,w.coord,f)}},e.prototype.add=function(){if(arguments.length===1){var n=arguments[0];if(n.isEmpty())return null;if(n instanceof gu&&(this._useBoundaryDeterminationRule=!1),n instanceof Ni)this.addPolygon(n);else if(n instanceof Hr)this.addLineString(n);else if(n instanceof As)this.addPoint(n);else if(n instanceof Ed)this.addCollection(n);else if(n instanceof ip)this.addCollection(n);else if(n instanceof gu)this.addCollection(n);else if(n instanceof Ko)this.addCollection(n);else throw new Error(n.getClass().getName())}else return t.prototype.add.apply(this,arguments)},e.prototype.addCollection=function(n){for(var r=this,s=0;s<n.getNumGeometries();s++){var c=n.getGeometryN(s);r.add(c)}},e.prototype.locate=function(n){return an(this._parentGeom,jc)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Ld(this._parentGeom)),this._areaPtLocator.locate(n)):this._ptLocator.locate(n,this._parentGeom)},e.prototype.findEdge=function(){if(arguments.length===1){var n=arguments[0];return this._lineEdgeMap.get(n)}else return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(n,r){return n.isInBoundary(r)?Bt.BOUNDARY:Bt.INTERIOR},e}(Gr),kd=function(){if(this._li=new vp,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Og(0,t)}else if(arguments.length===2){var e=arguments[0],n=arguments[1],r=Ma.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Og(0,e,r),this._arg[1]=new Og(1,n,r)}else if(arguments.length===3){var s=arguments[0],c=arguments[1],f=arguments[2];s.getPrecisionModel().compareTo(c.getPrecisionModel())>=0?this.setComputationPrecision(s.getPrecisionModel()):this.setComputationPrecision(c.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Og(0,s,f),this._arg[1]=new Og(1,c,f)}};kd.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()};kd.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)};kd.prototype.interfaces_=function(){return[]};kd.prototype.getClass=function(){return kd};var Jh=function(){};Jh.prototype.interfaces_=function(){return[]};Jh.prototype.getClass=function(){return Jh};Jh.map=function(){if(arguments[0]instanceof sn&&an(arguments[1],Jh.MapOp)){for(var t=arguments[0],e=arguments[1],n=new be,r=0;r<t.getNumGeometries();r++){var s=e.map(t.getGeometryN(r));s!==null&&n.add(s)}return t.getFactory().buildGeometry(n)}else if(an(arguments[0],Ci)&&an(arguments[1],Jh.MapOp)){for(var c=arguments[0],f=arguments[1],u=new be,w=c.iterator();w.hasNext();){var S=w.next(),A=f.map(S);A!==null&&u.add(A)}return u}};Jh.MapOp=function(){};var gn=function(t){function e(){var n=arguments[0],r=arguments[1];t.call(this,n,r),this._ptLocator=new nl,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new el,this._resultPolyList=new be,this._resultLineList=new be,this._resultPointList=new be,this._graph=new Gr(new b2),this._geomFact=n.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(n){var r=this._edgeList.findEqualEdge(n);if(r!==null){var s=r.getLabel(),c=n.getLabel();r.isPointwiseEqual(n)||(c=new er(n.getLabel()),c.flip());var f=r.getDepth();f.isNull()&&f.add(s),f.add(c),s.merge(c)}else this._edgeList.add(n)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var r=n.next(),s=r.getSym();r.isInResult()&&s.isInResult()&&(r.setInResult(!1),s.setInResult(!1))}},e.prototype.isCoveredByLA=function(n){return!!(this.isCovered(n,this._resultLineList)||this.isCovered(n,this._resultPolyList))},e.prototype.computeGeometry=function(n,r,s,c){var f=new be;return f.addAll(n),f.addAll(r),f.addAll(s),f.isEmpty()?e.createEmptyResult(c,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(f)},e.prototype.mergeSymLabels=function(){for(var n=this._graph.getNodes().iterator();n.hasNext();){var r=n.next();r.getEdges().mergeSymLabels()}},e.prototype.isCovered=function(n,r){for(var s=this,c=r.iterator();c.hasNext();){var f=c.next(),u=s._ptLocator.locate(n,f);if(u!==Bt.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var n=new be,r=this._edgeList.iterator();r.hasNext();){var s=r.next();s.isCollapsed()&&(r.remove(),n.add(s.getCollapsedEdge()))}this._edgeList.addAll(n)},e.prototype.updateNodeLabelling=function(){for(var n=this._graph.getNodes().iterator();n.hasNext();){var r=n.next(),s=r.getEdges().getLabel();r.getLabel().merge(s)}},e.prototype.getResultGeometry=function(n){return this.computeOverlay(n),this._resultGeom},e.prototype.insertUniqueEdges=function(n){for(var r=this,s=n.iterator();s.hasNext();){var c=s.next();r.insertUniqueEdge(c)}},e.prototype.computeOverlay=function(n){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var r=new be;this._arg[0].computeSplitEdges(r),this._arg[1].computeSplitEdges(r),this.insertUniqueEdges(r),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),cp.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(n),this.cancelDuplicateResultEdges();var s=new ks(this._geomFact);s.add(this._graph),this._resultPolyList=s.getPolygons();var c=new Zl(this,this._geomFact,this._ptLocator);this._resultLineList=c.build(n);var f=new af(this,this._geomFact,this._ptLocator);this._resultPointList=f.build(n),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,n)},e.prototype.labelIncompleteNode=function(n,r){var s=this._ptLocator.locate(n.getCoordinate(),this._arg[r].getGeometry());n.getLabel().setLocation(r,s)},e.prototype.copyPoints=function(n){for(var r=this,s=this._arg[n].getNodeIterator();s.hasNext();){var c=s.next(),f=r._graph.addNode(c.getCoordinate());f.setLabel(n,c.getLabel().getLocation(n))}},e.prototype.findResultAreaEdges=function(n){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var s=r.next(),c=s.getLabel();c.isArea()&&!s.isInteriorAreaEdge()&&e.isResultOfOp(c.getLocation(0,fe.RIGHT),c.getLocation(1,fe.RIGHT),n)&&s.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var n=this._edgeList.iterator();n.hasNext();){var r=n.next(),s=r.getLabel(),c=r.getDepth();if(!c.isNull()){c.normalize();for(var f=0;f<2;f++)!s.isNull(f)&&s.isArea()&&!c.isNull(f)&&(c.getDelta(f)===0?s.toLine(f):(yn.isTrue(!c.isNull(f,fe.LEFT),"depth of LEFT side has not been initialized"),s.setLocation(f,fe.LEFT,c.getLocation(f,fe.LEFT)),yn.isTrue(!c.isNull(f,fe.RIGHT),"depth of RIGHT side has not been initialized"),s.setLocation(f,fe.RIGHT,c.getLocation(f,fe.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var n=this,r=this._graph.getNodes().iterator();r.hasNext();){var s=r.next();s.getEdges().computeLabelling(n._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var n=this,r=this._graph.getNodes().iterator();r.hasNext();){var s=r.next(),c=s.getLabel();s.isIsolated()&&(c.isNull(0)?n.labelIncompleteNode(s,0):n.labelIncompleteNode(s,1)),s.getEdges().updateLabelling(c)}},e.prototype.isCoveredByA=function(n){return!!this.isCovered(n,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(kd);gn.overlayOp=function(t,e,n){var r=new gn(t,e),s=r.getResultGeometry(n);return s};gn.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return gn.createEmptyResult(gn.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return sf.map(t,{interfaces_:function(){return[Jh.MapOp]},map:function(r){return r.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ts.overlayOp(t,e,gn.INTERSECTION)};gn.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return gn.createEmptyResult(gn.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ts.overlayOp(t,e,gn.SYMDIFFERENCE)};gn.resultDimension=function(t,e,n){var r=e.getDimension(),s=n.getDimension(),c=-1;switch(t){case gn.INTERSECTION:c=Math.min(r,s);break;case gn.UNION:c=Math.max(r,s);break;case gn.DIFFERENCE:c=r;break;case gn.SYMDIFFERENCE:c=Math.max(r,s);break}return c};gn.createEmptyResult=function(t,e,n,r){var s=null;switch(gn.resultDimension(t,e,n)){case-1:s=r.createGeometryCollection(new Array(0).fill(null));break;case 0:s=r.createPoint();break;case 1:s=r.createLineString();break;case 2:s=r.createPolygon();break}return s};gn.difference=function(t,e){return t.isEmpty()?gn.createEmptyResult(gn.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ts.overlayOp(t,e,gn.DIFFERENCE))};gn.isResultOfOp=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return gn.isResultOfOp(n,r,e)}else if(arguments.length===3){var s=arguments[0],c=arguments[1],f=arguments[2];switch(s===Bt.BOUNDARY&&(s=Bt.INTERIOR),c===Bt.BOUNDARY&&(c=Bt.INTERIOR),f){case gn.INTERSECTION:return s===Bt.INTERIOR&&c===Bt.INTERIOR;case gn.UNION:return s===Bt.INTERIOR||c===Bt.INTERIOR;case gn.DIFFERENCE:return s===Bt.INTERIOR&&c!==Bt.INTERIOR;case gn.SYMDIFFERENCE:return s===Bt.INTERIOR&&c!==Bt.INTERIOR||s!==Bt.INTERIOR&&c===Bt.INTERIOR}return!1}};gn.INTERSECTION=1;gn.UNION=2;gn.DIFFERENCE=3;gn.SYMDIFFERENCE=4;var zc=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new nl,this._seg=new Ye;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};zc.prototype.isWithinToleranceOfBoundary=function(t){for(var e=this,n=0;n<this._linework.getNumGeometries();n++)for(var r=e._linework.getGeometryN(n),s=r.getCoordinateSequence(),c=0;c<s.size()-1;c++){s.getCoordinate(c,e._seg.p0),s.getCoordinate(c+1,e._seg.p1);var f=e._seg.distance(t);if(f<=e._boundaryDistanceTolerance)return!0}return!1};zc.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?Bt.BOUNDARY:this._ptLocator.locate(t,this._g)};zc.prototype.extractLinework=function(t){var e=new Nd;t.apply(e);var n=e.getLinework(),r=Tn.toLineStringArray(n);return t.getFactory().createMultiLineString(r)};zc.prototype.interfaces_=function(){return[]};zc.prototype.getClass=function(){return zc};var Nd=function(){this._linework=null,this._linework=new be};Nd.prototype.getLinework=function(){return this._linework};Nd.prototype.filter=function(t){var e=this;if(t instanceof Ni){var n=t;this._linework.add(n.getExteriorRing());for(var r=0;r<n.getNumInteriorRing();r++)e._linework.add(n.getInteriorRingN(r))}};Nd.prototype.interfaces_=function(){return[Bl]};Nd.prototype.getClass=function(){return Nd};var pp=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};pp.prototype.extractPoints=function(t,e,n){for(var r=this,s=t.getCoordinates(),c=0;c<s.length-1;c++)r.computeOffsetPoints(s[c],s[c+1],e,n)};pp.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e};pp.prototype.getPoints=function(t){for(var e=this,n=new be,r=uo.getLines(this._g),s=r.iterator();s.hasNext();){var c=s.next();e.extractPoints(c,t,n)}return n};pp.prototype.computeOffsetPoints=function(t,e,n,r){var s=e.x-t.x,c=e.y-t.y,f=Math.sqrt(s*s+c*c),u=n*s/f,w=n*c/f,S=(e.x+t.x)/2,A=(e.y+t.y)/2;if(this._doLeft){var N=new Dt(S-w,A+u);r.add(N)}if(this._doRight){var O=new Dt(S+w,A-u);r.add(O)}};pp.prototype.interfaces_=function(){return[]};pp.prototype.getClass=function(){return pp};var oa=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new be;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,r],this._locFinder=[new zc(this._geom[0],this._boundaryDistanceTolerance),new zc(this._geom[1],this._boundaryDistanceTolerance),new zc(this._geom[2],this._boundaryDistanceTolerance)]},k2={TOLERANCE:{configurable:!0}};oa.prototype.reportResult=function(t,e,n){fo.out.println("Overlay result invalid - A:"+Bt.toLocationSymbol(e[0])+" B:"+Bt.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+Bt.toLocationSymbol(e[2]))};oa.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var e=this.checkValid(t);return e};oa.prototype.checkValid=function(){var t=this;if(arguments.length===1){for(var e=arguments[0],n=0;n<this._testCoords.size();n++){var r=t._testCoords.get(n);if(!t.checkValid(e,r))return t._invalidLocation=r,!1}return!0}else if(arguments.length===2){var s=arguments[0],c=arguments[1];return this._location[0]=this._locFinder[0].getLocation(c),this._location[1]=this._locFinder[1].getLocation(c),this._location[2]=this._locFinder[2].getLocation(c),oa.hasLocation(this._location,Bt.BOUNDARY)?!0:this.isValidResult(s,this._location)}};oa.prototype.addTestPts=function(t){var e=new pp(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))};oa.prototype.isValidResult=function(t,e){var n=gn.isResultOfOp(e[0],e[1],t),r=e[2]===Bt.INTERIOR,s=!(n^r);return s||this.reportResult(t,e,n),s};oa.prototype.getInvalidLocation=function(){return this._invalidLocation};oa.prototype.interfaces_=function(){return[]};oa.prototype.getClass=function(){return oa};oa.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1};oa.computeBoundaryDistanceTolerance=function(t,e){return Math.min(ii.computeSizeBasedSnapTolerance(t),ii.computeSizeBasedSnapTolerance(e))};oa.isValid=function(t,e,n,r){var s=new oa(t,e,r);return s.isValid(n)};k2.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(oa,k2);var Ks=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Ks.prototype.extractElements=function(t,e){var n=this;if(t===null)return null;for(var r=0;r<t.getNumGeometries();r++){var s=t.getGeometryN(r);n._skipEmpty&&s.isEmpty()||e.add(s)}};Ks.prototype.combine=function(){for(var t=this,e=new be,n=this._inputGeoms.iterator();n.hasNext();){var r=n.next();t.extractElements(r,e)}return e.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(e)};Ks.prototype.interfaces_=function(){return[]};Ks.prototype.getClass=function(){return Ks};Ks.combine=function(){if(arguments.length===1){var t=arguments[0],e=new Ks(t);return e.combine()}else if(arguments.length===2){var n=arguments[0],r=arguments[1],s=new Ks(Ks.createList(n,r));return s.combine()}else if(arguments.length===3){var c=arguments[0],f=arguments[1],u=arguments[2],w=new Ks(Ks.createList(c,f,u));return w.combine()}};Ks.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()};Ks.createList=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],n=new be;return n.add(t),n.add(e),n}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2],f=new be;return f.add(r),f.add(s),f.add(c),f}};var yi=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,this._inputPolys===null&&(this._inputPolys=new be)},N2={STRTREE_NODE_CAPACITY:{configurable:!0}};yi.prototype.reduceToGeometries=function(t){for(var e=this,n=new be,r=t.iterator();r.hasNext();){var s=r.next(),c=null;an(s,Ha)?c=e.unionTree(s):s instanceof sn&&(c=s),n.add(c)}return n};yi.prototype.extractByEnvelope=function(t,e,n){for(var r=new be,s=0;s<e.getNumGeometries();s++){var c=e.getGeometryN(s);c.getEnvelopeInternal().intersects(t)?r.add(c):n.add(c)}return this._geomFactory.buildGeometry(r)};yi.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),r=e.getEnvelopeInternal();if(!n.intersects(r)){var s=Ks.combine(t,e);return s}if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var c=n.intersection(r);return this.unionUsingEnvelopeIntersection(t,e,c)};yi.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new _2(yi.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var r=t.itemsTree(),s=this.unionTree(r);return s};yi.prototype.binaryUnion=function(){if(arguments.length===1){var t=arguments[0];return this.binaryUnion(t,0,t.size())}else if(arguments.length===3){var e=arguments[0],n=arguments[1],r=arguments[2];if(r-n<=1){var s=yi.getGeometry(e,n);return this.unionSafe(s,null)}else{if(r-n===2)return this.unionSafe(yi.getGeometry(e,n),yi.getGeometry(e,n+1));var c=Math.trunc((r+n)/2),f=this.binaryUnion(e,n,c),u=this.binaryUnion(e,c,r);return this.unionSafe(f,u)}}};yi.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var r=n.next();e===null?e=r.copy():e=e.union(r)}return e};yi.prototype.unionSafe=function(t,e){return t===null&&e===null?null:t===null?e.copy():e===null?t.copy():this.unionOptimized(t,e)};yi.prototype.unionActual=function(t,e){return yi.restrictToPolygons(t.union(e))};yi.prototype.unionTree=function(t){var e=this.reduceToGeometries(t),n=this.binaryUnion(e);return n};yi.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var r=new be,s=this.extractByEnvelope(n,t,r),c=this.extractByEnvelope(n,e,r),f=this.unionActual(s,c);r.add(f);var u=Ks.combine(r);return u};yi.prototype.bufferUnion=function(){if(arguments.length===1){var t=arguments[0],e=t.get(0).getFactory(),n=e.buildGeometry(t),r=n.buffer(0);return r}else if(arguments.length===2){var s=arguments[0],c=arguments[1],f=s.getFactory(),u=f.createGeometryCollection([s,c]),w=u.buffer(0);return w}};yi.prototype.interfaces_=function(){return[]};yi.prototype.getClass=function(){return yi};yi.restrictToPolygons=function(t){if(an(t,jc))return t;var e=Ju.getPolygons(t);return e.size()===1?e.get(0):t.getFactory().createMultiPolygon(Tn.toPolygonArray(e))};yi.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)};yi.union=function(t){var e=new yi(t);return e.union()};N2.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(yi,N2);var j_=function(){};j_.prototype.interfaces_=function(){return[]};j_.prototype.getClass=function(){return j_};j_.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return gn.createEmptyResult(gn.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ts.overlayOp(t,e,gn.UNION)};function xp(){return new q_}function q_(){this.reset()}q_.prototype={constructor:q_,reset:function(){this.s=this.t=0},add:function(t){eI(Vy,t,this.t),eI(this,Vy.s,this.s),this.s?this.t+=Vy.t:this.s=Vy.t},valueOf:function(){return this.s}};var Vy=new q_;function eI(t,e,n){var r=t.s=e+n,s=r-e,c=r-s;t.t=e-c+(n-s)}var Xr=1e-6,cr=Math.PI,Hu=cr/2,nI=cr/4,oc=cr*2,Dh=180/cr,Sl=cr/180,Wo=Math.abs,ND=Math.atan,Dd=Math.atan2,Ti=Math.cos,Pi=Math.sin,jd=Math.sqrt;function D2(t){return t>1?0:t<-1?cr:Math.acos(t)}function uf(t){return t>1?Hu:t<-1?-Hu:Math.asin(t)}function Ug(){}function Z_(t,e){t&&iI.hasOwnProperty(t.type)&&iI[t.type](t,e)}var rI={Feature:function(t,e){Z_(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,s=n.length;++r<s;)Z_(n[r].geometry,e)}},iI={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,s=n.length;++r<s;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){i1(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,s=n.length;++r<s;)i1(n[r],e,0)},Polygon:function(t,e){oI(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,s=n.length;++r<s;)oI(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,s=n.length;++r<s;)Z_(n[r],e)}};function i1(t,e,n){var r=-1,s=t.length-n,c;for(e.lineStart();++r<s;)c=t[r],e.point(c[0],c[1],c[2]);e.lineEnd()}function oI(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)i1(t[n],e,1);e.polygonEnd()}function DD(t,e){t&&rI.hasOwnProperty(t.type)?rI[t.type](t,e):Z_(t,e)}xp();xp();function o1(t){return[Dd(t[1],t[0]),uf(t[2])]}function Rd(t){var e=t[0],n=t[1],r=Ti(n);return[r*Ti(e),r*Pi(e),Pi(n)]}function Uy(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function X_(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function W0(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function $y(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function s1(t){var e=jd(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}xp();function R2(t,e){function n(r,s){return r=t(r,s),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,s){return r=e.invert(r,s),r&&t.invert(r[0],r[1])}),n}function a1(t,e){return[t>cr?t-oc:t<-cr?t+oc:t,e]}a1.invert=a1;function RD(t,e,n){return(t%=oc)?e||n?R2(aI(t),lI(e,n)):aI(t):e||n?lI(e,n):a1}function sI(t){return function(e,n){return e+=t,[e>cr?e-oc:e<-cr?e+oc:e,n]}}function aI(t){var e=sI(t);return e.invert=sI(-t),e}function lI(t,e){var n=Ti(t),r=Pi(t),s=Ti(e),c=Pi(e);function f(u,w){var S=Ti(w),A=Ti(u)*S,N=Pi(u)*S,O=Pi(w),j=O*n+A*r;return[Dd(N*s-j*c,A*n-O*r),uf(j*s+N*c)]}return f.invert=function(u,w){var S=Ti(w),A=Ti(u)*S,N=Pi(u)*S,O=Pi(w),j=O*s-N*c;return[Dd(N*s+O*c,A*n+j*r),uf(j*n-A*r)]},f}function OD(t,e,n,r,s,c){if(n){var f=Ti(e),u=Pi(e),w=r*n;s==null?(s=e+r*oc,c=e-w/2):(s=uI(f,s),c=uI(f,c),(r>0?s<c:s>c)&&(s+=r*oc));for(var S,A=s;r>0?A>c:A<c;A-=w)S=o1([f,-u*Ti(A),-u*Pi(A)]),t.point(S[0],S[1])}}function uI(t,e){e=Rd(e),e[0]-=t,s1(e);var n=D2(-e[1]);return((-e[2]<0?-n:n)+oc-Xr)%oc}function O2(){var t=[],e;return{point:function(n,r){e.push([n,r])},lineStart:function(){t.push(e=[])},lineEnd:Ug,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function zD(t,e,n,r,s,c){var f=t[0],u=t[1],w=e[0],S=e[1],A=0,N=1,O=w-f,j=S-u,W;if(W=n-f,!(!O&&W>0)){if(W/=O,O<0){if(W<A)return;W<N&&(N=W)}else if(O>0){if(W>N)return;W>A&&(A=W)}if(W=s-f,!(!O&&W<0)){if(W/=O,O<0){if(W>N)return;W>A&&(A=W)}else if(O>0){if(W<A)return;W<N&&(N=W)}if(W=r-u,!(!j&&W>0)){if(W/=j,j<0){if(W<A)return;W<N&&(N=W)}else if(j>0){if(W>N)return;W>A&&(A=W)}if(W=c-u,!(!j&&W<0)){if(W/=j,j<0){if(W>N)return;W>A&&(A=W)}else if(j>0){if(W<A)return;W<N&&(N=W)}return A>0&&(t[0]=f+A*O,t[1]=u+A*j),N<1&&(e[0]=f+N*O,e[1]=u+N*j),!0}}}}}function u_(t,e){return Wo(t[0]-e[0])<Xr&&Wo(t[1]-e[1])<Xr}function Gy(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function z2(t,e,n,r,s){var c=[],f=[],u,w;if(t.forEach(function(W){if(!((nt=W.length-1)<=0)){var nt,pt=W[0],J=W[nt],tt;if(u_(pt,J)){for(s.lineStart(),u=0;u<nt;++u)s.point((pt=W[u])[0],pt[1]);s.lineEnd();return}c.push(tt=new Gy(pt,W,null,!0)),f.push(tt.o=new Gy(pt,null,tt,!1)),c.push(tt=new Gy(J,W,null,!1)),f.push(tt.o=new Gy(J,null,tt,!0))}}),!!c.length){for(f.sort(e),cI(c),cI(f),u=0,w=f.length;u<w;++u)f[u].e=n=!n;for(var S=c[0],A,N;;){for(var O=S,j=!0;O.v;)if((O=O.n)===S)return;A=O.z,s.lineStart();do{if(O.v=O.o.v=!0,O.e){if(j)for(u=0,w=A.length;u<w;++u)s.point((N=A[u])[0],N[1]);else r(O.x,O.n.x,1,s);O=O.n}else{if(j)for(A=O.p.z,u=A.length-1;u>=0;--u)s.point((N=A[u])[0],N[1]);else r(O.x,O.p.x,-1,s);O=O.p}O=O.o,A=O.z,j=!j}while(!O.v);s.lineEnd()}}}function cI(t){if(e=t.length){for(var e,n=0,r=t[0],s;++n<e;)r.n=s=t[n],s.p=r,r=s;r.n=s=t[0],s.p=r}}function F2(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function FD(t){return t.length===1&&(t=BD(t)),{left:function(e,n,r,s){for(r==null&&(r=0),s==null&&(s=e.length);r<s;){var c=r+s>>>1;t(e[c],n)<0?r=c+1:s=c}return r},right:function(e,n,r,s){for(r==null&&(r=0),s==null&&(s=e.length);r<s;){var c=r+s>>>1;t(e[c],n)>0?s=c:r=c+1}return r}}}function BD(t){return function(e,n){return F2(t(e),n)}}FD(F2);function B2(t){for(var e=t.length,n,r=-1,s=0,c,f;++r<e;)s+=t[r].length;for(c=new Array(s);--e>=0;)for(f=t[e],n=f.length;--n>=0;)c[--s]=f[n];return c}var $g=1e9,jy=-$g;function VD(t,e,n,r){function s(S,A){return t<=S&&S<=n&&e<=A&&A<=r}function c(S,A,N,O){var j=0,W=0;if(S==null||(j=f(S,N))!==(W=f(A,N))||w(S,A)<0^N>0)do O.point(j===0||j===3?t:n,j>1?r:e);while((j=(j+N+4)%4)!==W);else O.point(A[0],A[1])}function f(S,A){return Wo(S[0]-t)<Xr?A>0?0:3:Wo(S[0]-n)<Xr?A>0?2:1:Wo(S[1]-e)<Xr?A>0?1:0:A>0?3:2}function u(S,A){return w(S.x,A.x)}function w(S,A){var N=f(S,1),O=f(A,1);return N!==O?N-O:N===0?A[1]-S[1]:N===1?S[0]-A[0]:N===2?S[1]-A[1]:A[0]-S[0]}return function(S){var A=S,N=O2(),O,j,W,nt,pt,J,tt,Q,_t,Ot,zt,Rt={point:At,lineStart:ue,lineEnd:on,polygonStart:Xt,polygonEnd:De};function At(ye,Ue){s(ye,Ue)&&A.point(ye,Ue)}function Ht(){for(var ye=0,Ue=0,hn=j.length;Ue<hn;++Ue)for(var he=j[Ue],Fe=1,Qe=he.length,_n=he[0],mn,Ke,pn=_n[0],Xn=_n[1];Fe<Qe;++Fe)mn=pn,Ke=Xn,_n=he[Fe],pn=_n[0],Xn=_n[1],Ke<=r?Xn>r&&(pn-mn)*(r-Ke)>(Xn-Ke)*(t-mn)&&++ye:Xn<=r&&(pn-mn)*(r-Ke)<(Xn-Ke)*(t-mn)&&--ye;return ye}function Xt(){A=N,O=[],j=[],zt=!0}function De(){var ye=Ht(),Ue=zt&&ye,hn=(O=B2(O)).length;(Ue||hn)&&(S.polygonStart(),Ue&&(S.lineStart(),c(null,null,1,S),S.lineEnd()),hn&&z2(O,u,ye,c,S),S.polygonEnd()),A=S,O=j=W=null}function ue(){Rt.point=Gt,j&&j.push(W=[]),Ot=!0,_t=!1,tt=Q=NaN}function on(){O&&(Gt(nt,pt),J&&_t&&N.rejoin(),O.push(N.result())),Rt.point=At,_t&&A.lineEnd()}function Gt(ye,Ue){var hn=s(ye,Ue);if(j&&W.push([ye,Ue]),Ot)nt=ye,pt=Ue,J=hn,Ot=!1,hn&&(A.lineStart(),A.point(ye,Ue));else if(hn&&_t)A.point(ye,Ue);else{var he=[tt=Math.max(jy,Math.min($g,tt)),Q=Math.max(jy,Math.min($g,Q))],Fe=[ye=Math.max(jy,Math.min($g,ye)),Ue=Math.max(jy,Math.min($g,Ue))];zD(he,Fe,t,e,n,r)?(_t||(A.lineStart(),A.point(he[0],he[1])),A.point(Fe[0],Fe[1]),hn||A.lineEnd(),zt=!1):hn&&(A.lineStart(),A.point(ye,Ue),zt=!1)}tt=ye,Q=Ue,_t=hn}return Rt}}var H0=xp();function UD(t,e){var n=e[0],r=e[1],s=[Pi(n),-Ti(n),0],c=0,f=0;H0.reset();for(var u=0,w=t.length;u<w;++u)if(A=(S=t[u]).length)for(var S,A,N=S[A-1],O=N[0],j=N[1]/2+nI,W=Pi(j),nt=Ti(j),pt=0;pt<A;++pt,O=tt,W=_t,nt=Ot,N=J){var J=S[pt],tt=J[0],Q=J[1]/2+nI,_t=Pi(Q),Ot=Ti(Q),zt=tt-O,Rt=zt>=0?1:-1,At=Rt*zt,Ht=At>cr,Xt=W*_t;if(H0.add(Dd(Xt*Rt*Pi(At),nt*Ot+Xt*Ti(At))),c+=Ht?zt+Rt*oc:zt,Ht^O>=n^tt>=n){var De=X_(Rd(N),Rd(J));s1(De);var ue=X_(s,De);s1(ue);var on=(Ht^zt>=0?-1:1)*uf(ue[2]);(r>on||r===on&&(De[0]||De[1]))&&(f+=Ht^zt>=0?1:-1)}}return(c<-Xr||c<Xr&&H0<-Xr)^f&1}xp();function hI(t){return t}xp();xp();var Od=1/0,W_=Od,Dm=-Od,H_=Dm,pI={point:$D,lineStart:Ug,lineEnd:Ug,polygonStart:Ug,polygonEnd:Ug,result:function(){var t=[[Od,W_],[Dm,H_]];return Dm=H_=-(W_=Od=1/0),t}};function $D(t,e){t<Od&&(Od=t),t>Dm&&(Dm=t),e<W_&&(W_=e),e>H_&&(H_=e)}xp();function V2(t,e,n,r){return function(s,c){var f=e(c),u=s.invert(r[0],r[1]),w=O2(),S=e(w),A=!1,N,O,j,W={point:nt,lineStart:J,lineEnd:tt,polygonStart:function(){W.point=Q,W.lineStart=_t,W.lineEnd=Ot,O=[],N=[]},polygonEnd:function(){W.point=nt,W.lineStart=J,W.lineEnd=tt,O=B2(O);var zt=UD(N,u);O.length?(A||(c.polygonStart(),A=!0),z2(O,jD,zt,n,c)):zt&&(A||(c.polygonStart(),A=!0),c.lineStart(),n(null,null,1,c),c.lineEnd()),A&&(c.polygonEnd(),A=!1),O=N=null},sphere:function(){c.polygonStart(),c.lineStart(),n(null,null,1,c),c.lineEnd(),c.polygonEnd()}};function nt(zt,Rt){var At=s(zt,Rt);t(zt=At[0],Rt=At[1])&&c.point(zt,Rt)}function pt(zt,Rt){var At=s(zt,Rt);f.point(At[0],At[1])}function J(){W.point=pt,f.lineStart()}function tt(){W.point=nt,f.lineEnd()}function Q(zt,Rt){j.push([zt,Rt]);var At=s(zt,Rt);S.point(At[0],At[1])}function _t(){S.lineStart(),j=[]}function Ot(){Q(j[0][0],j[0][1]),S.lineEnd();var zt=S.clean(),Rt=w.result(),At,Ht=Rt.length,Xt,De,ue;if(j.pop(),N.push(j),j=null,!!Ht){if(zt&1){if(De=Rt[0],(Xt=De.length-1)>0){for(A||(c.polygonStart(),A=!0),c.lineStart(),At=0;At<Xt;++At)c.point((ue=De[At])[0],ue[1]);c.lineEnd()}return}Ht>1&&zt&2&&Rt.push(Rt.pop().concat(Rt.shift())),O.push(Rt.filter(GD))}}return W}}function GD(t){return t.length>1}function jD(t,e){return((t=t.x)[0]<0?t[1]-Hu-Xr:Hu-t[1])-((e=e.x)[0]<0?e[1]-Hu-Xr:Hu-e[1])}const fI=V2(function(){return!0},qD,XD,[-cr,-Hu]);function qD(t){var e=NaN,n=NaN,r=NaN,s;return{lineStart:function(){t.lineStart(),s=1},point:function(c,f){var u=c>0?cr:-cr,w=Wo(c-e);Wo(w-cr)<Xr?(t.point(e,n=(n+f)/2>0?Hu:-Hu),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),t.point(c,n),s=0):r!==u&&w>=cr&&(Wo(e-r)<Xr&&(e-=r*Xr),Wo(c-u)<Xr&&(c-=u*Xr),n=ZD(e,n,c,f),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),s=0),t.point(e=c,n=f),r=u},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-s}}}function ZD(t,e,n,r){var s,c,f=Pi(t-n);return Wo(f)>Xr?ND((Pi(e)*(c=Ti(r))*Pi(n)-Pi(r)*(s=Ti(e))*Pi(t))/(s*c*f)):(e+r)/2}function XD(t,e,n,r){var s;if(t==null)s=n*Hu,r.point(-cr,s),r.point(0,s),r.point(cr,s),r.point(cr,0),r.point(cr,-s),r.point(0,-s),r.point(-cr,-s),r.point(-cr,0),r.point(-cr,s);else if(Wo(t[0]-e[0])>Xr){var c=t[0]<e[0]?cr:-cr;s=n*c/2,r.point(-c,s),r.point(0,s),r.point(c,s)}else r.point(e[0],e[1])}function WD(t,e){var n=Ti(t),r=n>0,s=Wo(n)>Xr;function c(A,N,O,j){OD(j,t,e,O,A,N)}function f(A,N){return Ti(A)*Ti(N)>n}function u(A){var N,O,j,W,nt;return{lineStart:function(){W=j=!1,nt=1},point:function(pt,J){var tt=[pt,J],Q,_t=f(pt,J),Ot=r?_t?0:S(pt,J):_t?S(pt+(pt<0?cr:-cr),J):0;if(!N&&(W=j=_t)&&A.lineStart(),_t!==j&&(Q=w(N,tt),(!Q||u_(N,Q)||u_(tt,Q))&&(tt[0]+=Xr,tt[1]+=Xr,_t=f(tt[0],tt[1]))),_t!==j)nt=0,_t?(A.lineStart(),Q=w(tt,N),A.point(Q[0],Q[1])):(Q=w(N,tt),A.point(Q[0],Q[1]),A.lineEnd()),N=Q;else if(s&&N&&r^_t){var zt;!(Ot&O)&&(zt=w(tt,N,!0))&&(nt=0,r?(A.lineStart(),A.point(zt[0][0],zt[0][1]),A.point(zt[1][0],zt[1][1]),A.lineEnd()):(A.point(zt[1][0],zt[1][1]),A.lineEnd(),A.lineStart(),A.point(zt[0][0],zt[0][1])))}_t&&(!N||!u_(N,tt))&&A.point(tt[0],tt[1]),N=tt,j=_t,O=Ot},lineEnd:function(){j&&A.lineEnd(),N=null},clean:function(){return nt|(W&&j)<<1}}}function w(A,N,O){var j=Rd(A),W=Rd(N),nt=[1,0,0],pt=X_(j,W),J=Uy(pt,pt),tt=pt[0],Q=J-tt*tt;if(!Q)return!O&&A;var _t=n*J/Q,Ot=-n*tt/Q,zt=X_(nt,pt),Rt=$y(nt,_t),At=$y(pt,Ot);W0(Rt,At);var Ht=zt,Xt=Uy(Rt,Ht),De=Uy(Ht,Ht),ue=Xt*Xt-De*(Uy(Rt,Rt)-1);if(!(ue<0)){var on=jd(ue),Gt=$y(Ht,(-Xt-on)/De);if(W0(Gt,Rt),Gt=o1(Gt),!O)return Gt;var ye=A[0],Ue=N[0],hn=A[1],he=N[1],Fe;Ue<ye&&(Fe=ye,ye=Ue,Ue=Fe);var Qe=Ue-ye,_n=Wo(Qe-cr)<Xr,mn=_n||Qe<Xr;if(!_n&&he<hn&&(Fe=hn,hn=he,he=Fe),mn?_n?hn+he>0^Gt[1]<(Wo(Gt[0]-ye)<Xr?hn:he):hn<=Gt[1]&&Gt[1]<=he:Qe>cr^(ye<=Gt[0]&&Gt[0]<=Ue)){var Ke=$y(Ht,(-Xt+on)/De);return W0(Ke,Rt),[Gt,o1(Ke)]}}}function S(A,N){var O=r?t:cr-t,j=0;return A<-O?j|=1:A>O&&(j|=2),N<-O?j|=4:N>O&&(j|=8),j}return V2(f,u,c,r?[0,-t]:[-cr,t-cr])}function U2(t){return function(e){var n=new l1;for(var r in t)n[r]=t[r];return n.stream=e,n}}function l1(){}l1.prototype={constructor:l1,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function $2(t,e,n){var r=e[1][0]-e[0][0],s=e[1][1]-e[0][1],c=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),c!=null&&t.clipExtent(null),DD(n,t.stream(pI));var f=pI.result(),u=Math.min(r/(f[1][0]-f[0][0]),s/(f[1][1]-f[0][1])),w=+e[0][0]+(r-u*(f[1][0]+f[0][0]))/2,S=+e[0][1]+(s-u*(f[1][1]+f[0][1]))/2;return c!=null&&t.clipExtent(c),t.scale(u*150).translate([w,S])}function HD(t,e,n){return $2(t,[[0,0],e],n)}var dI=16,YD=Ti(30*Sl);function gI(t,e){return+e?JD(t,e):KD(t)}function KD(t){return U2({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function JD(t,e){function n(r,s,c,f,u,w,S,A,N,O,j,W,nt,pt){var J=S-r,tt=A-s,Q=J*J+tt*tt;if(Q>4*e&&nt--){var _t=f+O,Ot=u+j,zt=w+W,Rt=jd(_t*_t+Ot*Ot+zt*zt),At=uf(zt/=Rt),Ht=Wo(Wo(zt)-1)<Xr||Wo(c-N)<Xr?(c+N)/2:Dd(Ot,_t),Xt=t(Ht,At),De=Xt[0],ue=Xt[1],on=De-r,Gt=ue-s,ye=tt*on-J*Gt;(ye*ye/Q>e||Wo((J*on+tt*Gt)/Q-.5)>.3||f*O+u*j+w*W<YD)&&(n(r,s,c,f,u,w,De,ue,Ht,_t/=Rt,Ot/=Rt,zt,nt,pt),pt.point(De,ue),n(De,ue,Ht,_t,Ot,zt,S,A,N,O,j,W,nt,pt))}}return function(r){var s,c,f,u,w,S,A,N,O,j,W,nt,pt={point:J,lineStart:tt,lineEnd:_t,polygonStart:function(){r.polygonStart(),pt.lineStart=Ot},polygonEnd:function(){r.polygonEnd(),pt.lineStart=tt}};function J(At,Ht){At=t(At,Ht),r.point(At[0],At[1])}function tt(){N=NaN,pt.point=Q,r.lineStart()}function Q(At,Ht){var Xt=Rd([At,Ht]),De=t(At,Ht);n(N,O,A,j,W,nt,N=De[0],O=De[1],A=At,j=Xt[0],W=Xt[1],nt=Xt[2],dI,r),r.point(N,O)}function _t(){pt.point=J,r.lineEnd()}function Ot(){tt(),pt.point=zt,pt.lineEnd=Rt}function zt(At,Ht){Q(s=At,Ht),c=N,f=O,u=j,w=W,S=nt,pt.point=Q}function Rt(){n(N,O,A,j,W,nt,c,f,s,u,w,S,dI,r),pt.lineEnd=_t,_t()}return pt}}var QD=U2({point:function(t,e){this.stream.point(t*Sl,e*Sl)}});function tR(t){return eR(function(){return t})()}function eR(t){var e,n=150,r=480,s=250,c,f,u=0,w=0,S=0,A=0,N=0,O,j,W=null,nt=fI,pt=null,J,tt,Q,_t=hI,Ot=.5,zt=gI(De,Ot),Rt,At;function Ht(Gt){return Gt=j(Gt[0]*Sl,Gt[1]*Sl),[Gt[0]*n+c,f-Gt[1]*n]}function Xt(Gt){return Gt=j.invert((Gt[0]-c)/n,(f-Gt[1])/n),Gt&&[Gt[0]*Dh,Gt[1]*Dh]}function De(Gt,ye){return Gt=e(Gt,ye),[Gt[0]*n+c,f-Gt[1]*n]}Ht.stream=function(Gt){return Rt&&At===Gt?Rt:Rt=QD(nt(O,zt(_t(At=Gt))))},Ht.clipAngle=function(Gt){return arguments.length?(nt=+Gt?WD(W=Gt*Sl,6*Sl):(W=null,fI),on()):W*Dh},Ht.clipExtent=function(Gt){return arguments.length?(_t=Gt==null?(pt=J=tt=Q=null,hI):VD(pt=+Gt[0][0],J=+Gt[0][1],tt=+Gt[1][0],Q=+Gt[1][1]),on()):pt==null?null:[[pt,J],[tt,Q]]},Ht.scale=function(Gt){return arguments.length?(n=+Gt,ue()):n},Ht.translate=function(Gt){return arguments.length?(r=+Gt[0],s=+Gt[1],ue()):[r,s]},Ht.center=function(Gt){return arguments.length?(u=Gt[0]%360*Sl,w=Gt[1]%360*Sl,ue()):[u*Dh,w*Dh]},Ht.rotate=function(Gt){return arguments.length?(S=Gt[0]%360*Sl,A=Gt[1]%360*Sl,N=Gt.length>2?Gt[2]%360*Sl:0,ue()):[S*Dh,A*Dh,N*Dh]},Ht.precision=function(Gt){return arguments.length?(zt=gI(De,Ot=Gt*Gt),on()):jd(Ot)},Ht.fitExtent=function(Gt,ye){return $2(Ht,Gt,ye)},Ht.fitSize=function(Gt,ye){return HD(Ht,Gt,ye)};function ue(){j=R2(O=RD(S,A,N),e);var Gt=e(u,w);return c=r-Gt[0]*n,f=s+Gt[1]*n,on()}function on(){return Rt=At=null,Ht}return function(){return e=t.apply(this,arguments),Ht.invert=e.invert&&Xt,ue()}}function G2(t){return function(e,n){var r=Ti(e),s=Ti(n),c=t(r*s);return[c*s*Pi(e),c*Pi(n)]}}function j2(t){return function(e,n){var r=jd(e*e+n*n),s=t(r),c=Pi(s),f=Ti(s);return[Dd(e*c,r*f),uf(r&&n*c/r)]}}var nR=G2(function(t){return jd(2/(1+t))});nR.invert=j2(function(t){return 2*uf(t/2)});var q2=G2(function(t){return(t=D2(t))&&t/Pi(t)});q2.invert=j2(function(t){return t});function rR(){return tR(q2).scale(79.4188).clipAngle(180-.001)}function mI(t,e){return[t,e]}mI.invert=mI;function iR(t,e,n){n=n||{};var r=n.units||"kilometers",s=n.steps||8;if(!t)throw new Error("geojson is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof s!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(s<=0)throw new Error("steps must be greater than 0");var c=[];switch(t.type){case"GeometryCollection":return s2(t,function(f){var u=c_(f,e,r,s);u&&c.push(u)}),e1(c);case"FeatureCollection":return YS(t,function(f){var u=c_(f,e,r,s);u&&YS(u,function(w){w&&c.push(w)})}),e1(c)}return c_(t,e,r,s)}function c_(t,e,n,r){var s=t.properties||{},c=t.type==="Feature"?t.geometry:t;if(c.type==="GeometryCollection"){var f=[];return s2(t,function(nt){var pt=c_(nt,e,n,r);pt&&f.push(pt)}),e1(f)}var u=oR(c),w={type:c.type,coordinates:X2(c.coordinates,u)},S=new mw,A=S.read(w),N=pD(fD(e,n),"meters"),O=ho.bufferOp(A,N,r),j=new m2;if(O=j.write(O),!Z2(O.coordinates)){var W={type:O.type,coordinates:W2(O.coordinates,u)};return dv(W,s)}}function Z2(t){return Array.isArray(t[0])?Z2(t[0]):isNaN(t[0])}function X2(t,e){return typeof t[0]!="object"?e(t):t.map(function(n){return X2(n,e)})}function W2(t,e){return typeof t[0]!="object"?e.invert(t):t.map(function(n){return W2(n,e)})}function oR(t){var e=gD(t).geometry.coordinates,n=[-e[0],-e[1]];return rR().rotate(n).scale(Ws)}function sR(t,e){var n=B_(t),r=B_(e),s=t.properties||{},c=e2.difference(n.coordinates,r.coordinates);return c.length===0?null:c.length===1?r2(c[0],s):i2(c,s)}function yI(t){let e;for(const n of t)e&&n[0]-e[0]>=180?n[0]-=360:e&&n[0]-e[0]<-180&&(n[0]+=360),e=n}function _I(t,e){const n=sR({type:"Polygon",coordinates:[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]},t);if(!n)return;n.properties={isMask:"y"};const r=iR(t,0);if(r.geometry.type==="Polygon")for(const s of r.geometry.coordinates)yI(s);else for(const s of r.geometry.coordinates)for(const c of s)yI(c);e({type:"FeatureCollection",features:[r,n]})}let vI={type:"FeatureCollection",features:[]};function aR(t,e,n=!0,r=!0,s={},c={},f={fill:{paint:{"fill-color":"#000","fill-opacity":.1},filter:["all",["==",["geometry-type"],"Polygon"],["has","isMask"]]},line:{layout:{"line-cap":"square"},paint:{"line-width":["case",["==",["geometry-type"],"Polygon"],2,3],"line-dasharray":[1,1],"line-color":"#3170fe"},filter:["!",["has","isMask"]]}}){let u,w=[],S,A;function N(){(f!=null&&f.fill||f!=null&&f.line)&&t.addSource("full-geom",{type:"geojson",data:vI}),f!=null&&f.fill&&t.addLayer({...f==null?void 0:f.fill,id:"full-geom-fill",type:"fill",source:"full-geom"}),f!=null&&f.line&&t.addLayer({...f==null?void 0:f.line,id:"full-geom-line",type:"line",source:"full-geom"})}t.loaded()?N():t.once("load",()=>{N()});const O=W=>{u==null||u({type:"mapClick",coordinates:[W.lngLat.lng,W.lngLat.lat]})};function j(W=!1){if(!e)throw new Error;const nt=document.createElement("div");return W&&nt.classList.add("marker-interactive"),new MN({props:{displayIn:"maplibre"},target:nt}),new e.Marker({element:nt,offset:[1,-13]})}return{setEventHandler(W){W?(u=W,t.on("click",O)):(u=void 0,t.off("click",O))},flyTo(W,nt){t.flyTo({center:W,zoom:nt,...s})},fitBounds(W,nt,pt){t.fitBounds([[W[0],W[1]],[W[2],W[3]]],{padding:nt,maxZoom:pt,...c})},indicateReverse(W){t.getCanvasContainer().style.cursor=W?"crosshair":""},setReverseMarker(W){!e||!n||(A?W?A.setLngLat(W):(A.remove(),A=void 0):W&&(A=(typeof n=="object"?new e.Marker(n):j()).setLngLat(W).addTo(t),A.getElement().classList.add("marker-reverse")))},setMarkers(W,nt){if(!n)return;function pt(J){var tt;(tt=t.getSource("full-geom"))==null||tt.setData(J)}for(const J of w)J.remove();if(w.length=0,pt(vI),!!e){if(nt){let J=!1;if(nt.geometry.type==="GeometryCollection"){const tt=nt.geometry.geometries.filter(Q=>Q.type==="Polygon"||Q.type==="MultiPolygon");if(tt.length>0){let Q=tt.pop();for(const _t of tt)Q=dD(Q,_t);_I({...nt,geometry:Q},pt),J=!0}else{const Q=nt.geometry.geometries.filter(_t=>_t.type==="LineString"||_t.type==="MultiLineString");Q.length>0&&(pt({...nt,geometry:{type:"GeometryCollection",geometries:Q}}),J=!0)}}if(!J){if(nt.geometry.type==="Polygon"||nt.geometry.type==="MultiPolygon")_I(nt,pt);else if(nt.geometry.type==="LineString"||nt.geometry.type==="MultiLineString"){pt(nt);return}}n&&w.push((typeof n=="object"?new e.Marker(n):j()).setLngLat(nt.center).addTo(t))}if(r)for(const J of W??[]){if(J===nt)continue;const tt=(typeof r=="object"?new e.Marker(r):j(!0)).setLngLat(J.center).setPopup(new e.Popup({offset:[1,-27],closeButton:!1,closeOnMove:!0,className:"maptiler-gc-popup"}).setText(J.place_name.replace(/,.*/,""))).addTo(t),Q=tt.getElement();Q.addEventListener("click",_t=>{_t.stopPropagation(),u==null||u({type:"markerClick",id:J.id})}),Q.addEventListener("mouseenter",()=>{u==null||u({type:"markerMouseEnter",id:J.id}),tt.togglePopup()}),Q.addEventListener("mouseleave",()=>{u==null||u({type:"markerMouseLeave",id:J.id}),tt.togglePopup()}),w.push(tt)}}},setSelectedMarker(W){S&&S.getElement().classList.toggle("marker-selected",!1),S=W>-1?w[W]:void 0,S==null||S.getElement().classList.toggle("marker-selected",!0)},getCenterAndZoom(){const W=t.getCenter();return[t.getZoom(),W.lng,W.lat]}}}var bl,Uf;class lR extends EventTarget{constructor(e={}){super(),CS(this,bl,void 0),CS(this,Uf,void 0),j0(this,Uf,e)}onAdd(e){const n=document.createElement("div");n.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl mapboxgl-ctrl-group";const{marker:r,showResultMarkers:s,flyTo:c,fullGeometryStyle:f,...u}=au(this,Uf),w=typeof c=="boolean"?{}:c,S=this.getExtraProps(e,n),A={mapController:aR(e,this.getMapLibreGl(),r,s,w,w,f),flyTo:c===void 0?!0:!!c,apiKey:"",...S,...u};if(!A.apiKey)throw new Error("no apiKey provided");j0(this,bl,new $N({target:n,props:A}));for(const N of["select","pick","featuresListed","featuresMarked","response","optionsVisibilityChange","reverseToggle","queryChange"])au(this,bl).$on(N,O=>this.dispatchEvent(O));return n}setOptions(e){var n;j0(this,Uf,e);const{marker:r,showResultMarkers:s,flyTo:c,fullGeometryStyle:f,...u}=au(this,Uf);(n=au(this,bl))==null||n.$set(u)}setQuery(e,n=!0){var r;(r=au(this,bl))==null||r.setQuery(e,n)}clearMap(){var e;(e=au(this,bl))==null||e.clearMap()}clearList(){var e;(e=au(this,bl))==null||e.clearList()}setReverseMode(e){var n;(n=au(this,bl))==null||n.$set({reverseActive:e})}focus(){var e;(e=au(this,bl))==null||e.focus()}blur(){var e;(e=au(this,bl))==null||e.blur()}onRemove(){var e;(e=au(this,bl))==null||e.$destroy()}}bl=new WeakMap,Uf=new WeakMap;class uR extends lR{getMapLibreGl(){return _k}getExtraProps(e,n){return{}}}function cR({map:t}){return aw(()=>{const e=new uR({apiKey:"3s0f8momUZpYnD6bYw8L",limit:1});t.addControl(e)}),null}var qy,Y0,u1;function Iw(t,e){if(!qy)qy=e;else if(!Y0)Y0=e;else{var n="var sharedChunk = {}; ("+qy+")(sharedChunk); ("+Y0+")(sharedChunk);",r={};qy(r),u1=e(r),typeof window<"u"&&(u1.workerUrl=window.URL.createObjectURL(new Blob([n],{type:"text/javascript"})))}}Iw(["exports"],function(t){class e{constructor($,Y){this.start=$,this.end=Y,this.points=[],this.append=this.append.bind(this),this.prepend=this.prepend.bind(this)}append($,Y){this.points.push(Math.round($),Math.round(Y))}prepend($,Y){this.points.splice(0,0,Math.round($),Math.round(Y))}lineString(){return this.toArray()}isEmpty(){return this.points.length<2}appendFragment($){this.points.push(...$.points),this.end=$.end}toArray(){return this.points}}const n=[[],[[[1,2],[0,1]]],[[[2,1],[1,2]]],[[[2,1],[0,1]]],[[[1,0],[2,1]]],[[[1,2],[0,1]],[[1,0],[2,1]]],[[[1,0],[1,2]]],[[[1,0],[0,1]]],[[[0,1],[1,0]]],[[[1,2],[1,0]]],[[[0,1],[1,0]],[[2,1],[1,2]]],[[[2,1],[1,0]]],[[[0,1],[2,1]]],[[[1,2],[2,1]]],[[[0,1],[1,2]]],[]];function r(z,$,Y,yt){return $=$*2+yt[0],Y=Y*2+yt[1],$+Y*(z+1)*2}function s(z,$,Y){return($-z)/(Y-z)}function c(z,$,Y=4096,yt=1){if(!z)return{};const gt=Y/($.width-1);let Mt,Nt,Qt,Ut,ie,oe;const ze={},qe=new Map,fn=new Map;function vr(Hn,fr,In){Hn[0]===0?In(gt*(oe-1),gt*(ie-s(Qt,fr,Mt))):Hn[0]===2?In(gt*oe,gt*(ie-s(Ut,fr,Nt))):Hn[1]===0?In(gt*(oe-s(Nt,fr,Mt)),gt*(ie-1)):In(gt*(oe-s(Ut,fr,Qt)),gt*ie)}for(ie=1-yt;ie<$.height+yt;ie++){Nt=$.get(0,ie-1),Ut=$.get(0,ie);let Hn=Math.min(Nt,Ut),fr=Math.max(Nt,Ut);for(oe=1-yt;oe<$.width+yt;oe++){Mt=Nt,Qt=Ut,Nt=$.get(oe,ie-1),Ut=$.get(oe,ie);const In=Hn,Sn=fr;if(Hn=Math.min(Nt,Ut),fr=Math.max(Nt,Ut),isNaN(Mt)||isNaN(Nt)||isNaN(Ut)||isNaN(Qt))continue;const Or=Math.min(In,Hn),nr=Math.max(Sn,fr),Fn=Math.ceil(Or/z)*z,ui=Math.floor(nr/z)*z;for(let dr=Fn;dr<=ui;dr+=z){const jr=Mt>dr,qr=Nt>dr,Da=Qt>dr,la=Ut>dr;for(const ir of n[(jr?8:0)|(qr?4:0)|(la?2:0)|(Da?1:0)]){let xn=qe.get(dr);xn||qe.set(dr,xn=new Map);let Zi=fn.get(dr);Zi||fn.set(dr,Zi=new Map);const ar=ir[0],ua=ir[1],zi=r($.width,oe,ie,ar),zs=r($.width,oe,ie,ua);let Ir,ca;if(Ir=Zi.get(zi))if(Zi.delete(zi),ca=xn.get(zs))if(xn.delete(zs),Ir===ca){if(vr(ua,dr,Ir.append),!Ir.isEmpty()){let b=ze[dr];b||(ze[dr]=b=[]),b.push(Ir.lineString())}}else Ir.appendFragment(ca),Zi.set(Ir.end=ca.end,Ir);else vr(ua,dr,Ir.append),Zi.set(Ir.end=zs,Ir);else if(Ir=xn.get(zs))xn.delete(zs),vr(ar,dr,Ir.prepend),xn.set(Ir.start=zi,Ir);else{const b=new e(zi,zs);vr(ar,dr,b.append),vr(ua,dr,b.append),xn.set(zi,b),Zi.set(zs,b)}}}}}for(const[Hn,fr]of qe.entries()){let In=null;for(const Sn of fr.values())Sn.isEmpty()||(In==null&&(In=ze[Hn]||(ze[Hn]=[])),In.push(Sn.lineString()))}return ze}let f=0;class u{constructor($=100){this.size=()=>this.items.size,this.get=(Y,yt)=>this.getCancelable(Y,gt=>({value:yt(gt),cancel:()=>{}})).value,this.getCancelable=(Y,yt)=>{let gt=this.items.get(Y);if(gt)gt.lastUsed=++f,gt.waiting++;else{const Ut=yt(Y);gt={cancel:Ut.cancel,item:Ut.value,lastUsed:++f,waiting:1},this.items.set(Y,gt),this.prune()}const Mt=this.items,Nt=gt.item.then(Ut=>Ut,Ut=>(Mt.delete(Y),Promise.reject(Ut)));let Qt=!1;return{value:Nt,cancel:()=>{gt&&gt.cancel&&!Qt&&(Qt=!0,--gt.waiting<=0&&(gt.cancel(),Mt.delete(Y)))}}},this.clear=()=>this.items.clear(),this.maxSize=$,this.items=new Map}prune(){if(this.items.size>this.maxSize){let $,Y=1/0;this.items.forEach((yt,gt)=>{yt.lastUsed<Y&&(Y=yt.lastUsed,$=gt)}),typeof $<"u"&&this.items.delete($)}}}function w(z){const $=Object.entries(z);return $.sort(([Y],[yt])=>Y<yt?-1:Y>yt?1:0),$}function S(z){return w(z).map(([$,Y])=>[$,...typeof Y=="number"?[Y]:Y].join("*")).join("~")}function A(z){return Object.fromEntries(z.split("~").map($=>$.split("*").map(Number)).map(([$,...Y])=>[$,Y]))}function N({thresholds:z,...$}){return w({thresholds:S(z),...$}).map(([Y,yt])=>`${encodeURIComponent(Y)}=${encodeURIComponent(yt)}`).join("&")}function O(z){return Object.fromEntries(z.replace(/^.*\?/,"").split("&").map($=>{const Y=$.split("=").map(decodeURIComponent),yt=Y[0];let gt=Y[1];switch(yt){case"thresholds":gt=A(gt);break;case"extent":case"multiplier":case"overzoom":case"buffer":gt=Number(gt)}return[yt,gt]}))}function j(z){return w(z).map(([$,Y])=>`${encodeURIComponent($)}=${encodeURIComponent(Y)}`).join(",")}function W(z,$){const{thresholds:Y,...yt}=z;let gt=[],Mt=-1/0;return Object.entries(Y).forEach(([Nt,Qt])=>{const Ut=Number(Nt);Ut<=$&&Ut>Mt&&(Mt=Ut,gt=typeof Qt=="number"?[Qt]:Qt)}),{levels:gt,...yt}}function nt({cancel:z,value:$},Y){return{cancel:z,value:$.then(Y)}}function pt(z){const $=new ArrayBuffer(z.byteLength);return new Uint8Array($).set(new Uint8Array(z)),$}function J(z,$){return nt(z,({data:Y,...yt})=>{let gt=Y;return $&&(gt=new Float32Array(Y.length),gt.set(Y)),{...yt,data:gt,transferrables:[gt.buffer]}})}function tt(z){return nt(z,({arrayBuffer:$})=>{const Y=pt($);return{arrayBuffer:Y,transferrables:[Y]}})}let Q=null;function _t(){return Q==null&&(Q=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Q||!1}let Ot=null;function zt(){if(Ot==null&&(Ot=!1,_t()&&typeof VideoFrame<"u")){const Y=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(Y){for(let gt=0;gt<5*5;gt++){const Mt=gt*4;Y.fillStyle=`rgb(${Mt},${Mt+1},${Mt+2})`,Y.fillRect(gt%5,Math.floor(gt/5),1,1)}const yt=Y.getImageData(0,0,5,5).data;for(let gt=0;gt<5*5*4;gt++)if(gt%4!==3&&yt[gt]!==gt){Ot=!0;break}}}return Ot||!1}function Rt(z,{value:$,cancel:Y}){let yt=()=>{};const gt=setTimeout(()=>{Y(),yt(new Error("timed out"))},z),Mt=new Promise((Nt,Qt)=>{yt=Qt});return{value:Promise.race([Mt,(async()=>{try{return await $}finally{clearTimeout(gt)}})()]),cancel:()=>{clearTimeout(gt),Y()}}}let At,Ht,Xt,De;function ue(z,$){let Y=!1;return{value:createImageBitmap(z).then(gt=>Y?null:on(gt,$)),cancel:()=>{Y=!0}}}function on(z,$){return At||(At=new OffscreenCanvas(z.width,z.height),Ht=At.getContext("2d",{willReadFrequently:!0})),Fe(z,$,At,Ht)}function Gt(z,$){let Y=!1;return{value:createImageBitmap(z).then(async gt=>{var Mt,Nt,Qt;if(Y)return null;const Ut=new VideoFrame(gt,{timestamp:0});try{if(!(((Mt=Ut==null?void 0:Ut.format)===null||Mt===void 0?void 0:Mt.startsWith("BGR"))||((Nt=Ut==null?void 0:Ut.format)===null||Nt===void 0?void 0:Nt.startsWith("RGB"))))throw new Error(`Unrecognized format: ${Ut==null?void 0:Ut.format}`);const oe=(Qt=Ut==null?void 0:Ut.format)===null||Qt===void 0?void 0:Qt.startsWith("BGR"),ze=Ut.allocationSize(),qe=new Uint8ClampedArray(ze);if(await Ut.copyTo(qe),oe)for(let fn=0;fn<qe.length;fn+=4){const vr=qe[fn];qe[fn]=qe[fn+2],qe[fn+2]=vr}return Qe(gt.width,gt.height,$,qe)}catch{return Y?null:on(gt,$)}finally{Ut.close()}}),cancel:()=>{Y=!0}}}function ye(z,$){Xt||(Xt=document.createElement("canvas"),De=Xt.getContext("2d",{willReadFrequently:!0}));let Y=!1;const yt=new Image;return{value:new Promise((Mt,Nt)=>{yt.onload=()=>{Y||Mt(yt),URL.revokeObjectURL(yt.src),yt.onload=null},yt.onerror=()=>Nt(new Error("Could not load image.")),yt.src=z.size?URL.createObjectURL(z):""}).then(Mt=>Fe(Mt,$,Xt,De)),cancel:()=>{Y=!0,yt.src=""}}}function Ue(z,$){return self.actor.send("decodeImage",[],void 0,z,$)}function hn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}const he=zt()?Gt:_t()?ue:hn()?Ue:ye;function Fe(z,$,Y,yt){if(Y.width=z.width,Y.height=z.height,!yt)throw new Error("failed to get context");yt.drawImage(z,0,0,z.width,z.height);const gt=yt.getImageData(0,0,z.width,z.height).data;return Qe(z.width,z.height,$,gt)}function Qe(z,$,Y,yt){const gt=Y==="mapbox"?(Nt,Qt,Ut)=>-1e4+(Nt*256*256+Qt*256+Ut)*.1:(Nt,Qt,Ut)=>Nt*256+Qt+Ut/256-32768,Mt=new Float32Array(z*$);for(let Nt=0;Nt<yt.length;Nt+=4)Mt[Nt/4]=gt(yt[Nt],yt[Nt+1],yt[Nt+2]);return{width:z,height:$,data:Mt}}const _n=-12e3,mn=9e3;function Ke(z){return!isNaN(z)&&z>=_n&&z<=mn}class pn{constructor($,Y,yt){this.split=(gt,Mt,Nt)=>{if(gt===0)return this;const Qt=1<<gt,Ut=Mt*this.width/Qt,ie=Nt*this.height/Qt;return new pn(this.width/Qt,this.height/Qt,(oe,ze)=>this.get(oe+Ut,ze+ie))},this.subsamplePixelCenters=gt=>{const Mt=(Ut,ie,oe)=>isNaN(Ut)?ie:isNaN(ie)?Ut:Ut+(ie-Ut)*oe;if(gt<=1)return this;const Nt=.5-1/(2*gt),Qt=(Ut,ie)=>{const oe=Ut/gt-Nt,ze=ie/gt-Nt,qe=Math.floor(oe),fn=Math.floor(ze),vr=this.get(qe,fn),Hn=this.get(qe+1,fn),fr=this.get(qe,fn+1),In=this.get(qe+1,fn+1),Sn=oe-qe,Or=ze-fn,nr=Mt(vr,Hn,Sn),Fn=Mt(fr,In,Sn);return Mt(nr,Fn,Or)};return new pn(this.width*gt,this.height*gt,Qt)},this.averagePixelCentersToGrid=(gt=1)=>new pn(this.width+1,this.height+1,(Mt,Nt)=>{let Qt=0,Ut=0,ie=0;for(let oe=Mt-gt;oe<Mt+gt;oe++)for(let ze=Nt-gt;ze<Nt+gt;ze++)isNaN(ie=this.get(oe,ze))||(Ut++,Qt+=ie);return Ut===0?NaN:Qt/Ut}),this.scaleElevation=gt=>gt===1?this:new pn(this.width,this.height,(Mt,Nt)=>this.get(Mt,Nt)*gt),this.materialize=(gt=2)=>{const Mt=this.width+2*gt,Nt=new Float32Array(Mt*(this.height+2*gt));let Qt=0;for(let Ut=-gt;Ut<this.height+gt;Ut++)for(let ie=-gt;ie<this.width+gt;ie++)Nt[Qt++]=this.get(ie,Ut);return new pn(this.width,this.height,(Ut,ie)=>Nt[(ie+gt)*Mt+Ut+gt])},this.get=yt,this.width=$,this.height=Y}static fromRawDem($){return new pn($.width,$.height,(Y,yt)=>{const gt=$.data[yt*$.width+Y];return Ke(gt)?gt:NaN})}static combineNeighbors($){if($.length!==9)throw new Error("Must include a tile plus 8 neighbors");const Y=$[4];if(!Y)return;const yt=Y.width,gt=Y.height;return new pn(yt,gt,(Mt,Nt)=>{let Qt=0;Nt<0?Nt+=gt:Nt<gt?Qt+=3:(Nt-=gt,Qt+=6),Mt<0?Mt+=yt:Mt<yt?Qt+=1:(Mt-=yt,Qt+=2);const Ut=$[Qt];return Ut?Ut.get(Mt,Nt):NaN})}}function Xn(z){return z&&z.__esModule&&Object.prototype.hasOwnProperty.call(z,"default")?z.default:z}var Wn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Wn.read=function(z,$,Y,yt,gt){var Mt,Nt,Qt=gt*8-yt-1,Ut=(1<<Qt)-1,ie=Ut>>1,oe=-7,ze=Y?gt-1:0,qe=Y?-1:1,fn=z[$+ze];for(ze+=qe,Mt=fn&(1<<-oe)-1,fn>>=-oe,oe+=Qt;oe>0;Mt=Mt*256+z[$+ze],ze+=qe,oe-=8);for(Nt=Mt&(1<<-oe)-1,Mt>>=-oe,oe+=yt;oe>0;Nt=Nt*256+z[$+ze],ze+=qe,oe-=8);if(Mt===0)Mt=1-ie;else{if(Mt===Ut)return Nt?NaN:(fn?-1:1)*(1/0);Nt=Nt+Math.pow(2,yt),Mt=Mt-ie}return(fn?-1:1)*Nt*Math.pow(2,Mt-yt)},Wn.write=function(z,$,Y,yt,gt,Mt){var Nt,Qt,Ut,ie=Mt*8-gt-1,oe=(1<<ie)-1,ze=oe>>1,qe=gt===23?Math.pow(2,-24)-Math.pow(2,-77):0,fn=yt?0:Mt-1,vr=yt?1:-1,Hn=$<0||$===0&&1/$<0?1:0;for($=Math.abs($),isNaN($)||$===1/0?(Qt=isNaN($)?1:0,Nt=oe):(Nt=Math.floor(Math.log($)/Math.LN2),$*(Ut=Math.pow(2,-Nt))<1&&(Nt--,Ut*=2),Nt+ze>=1?$+=qe/Ut:$+=qe*Math.pow(2,1-ze),$*Ut>=2&&(Nt++,Ut/=2),Nt+ze>=oe?(Qt=0,Nt=oe):Nt+ze>=1?(Qt=($*Ut-1)*Math.pow(2,gt),Nt=Nt+ze):(Qt=$*Math.pow(2,ze-1)*Math.pow(2,gt),Nt=0));gt>=8;z[Y+fn]=Qt&255,fn+=vr,Qt/=256,gt-=8);for(Nt=Nt<<gt|Qt,ie+=gt;ie>0;z[Y+fn]=Nt&255,fn+=vr,Nt/=256,ie-=8);z[Y+fn-vr]|=Hn*128};var _o=Te,Dr=Wn;function Te(z){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(z)?z:new Uint8Array(z||0),this.pos=0,this.type=0,this.length=this.buf.length}Te.Varint=0,Te.Fixed64=1,Te.Bytes=2,Te.Fixed32=5;var Oe=65536*65536,bn=1/Oe,es=12,xi=typeof TextDecoder>"u"?null:new TextDecoder("utf8");Te.prototype={destroy:function(){this.buf=null},readFields:function(z,$,Y){for(Y=Y||this.length;this.pos<Y;){var yt=this.readVarint(),gt=yt>>3,Mt=this.pos;this.type=yt&7,z(gt,$,this),this.pos===Mt&&this.skip(yt)}return $},readMessage:function(z,$){return this.readFields(z,$,this.readVarint()+this.pos)},readFixed32:function(){var z=Kr(this.buf,this.pos);return this.pos+=4,z},readSFixed32:function(){var z=ce(this.buf,this.pos);return this.pos+=4,z},readFixed64:function(){var z=Kr(this.buf,this.pos)+Kr(this.buf,this.pos+4)*Oe;return this.pos+=8,z},readSFixed64:function(){var z=Kr(this.buf,this.pos)+ce(this.buf,this.pos+4)*Oe;return this.pos+=8,z},readFloat:function(){var z=Dr.read(this.buf,this.pos,!0,23,4);return this.pos+=4,z},readDouble:function(){var z=Dr.read(this.buf,this.pos,!0,52,8);return this.pos+=8,z},readVarint:function(z){var $=this.buf,Y,yt;return yt=$[this.pos++],Y=yt&127,yt<128||(yt=$[this.pos++],Y|=(yt&127)<<7,yt<128)||(yt=$[this.pos++],Y|=(yt&127)<<14,yt<128)||(yt=$[this.pos++],Y|=(yt&127)<<21,yt<128)?Y:(yt=$[this.pos],Y|=(yt&15)<<28,Dn(Y,z,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var z=this.readVarint();return z%2===1?(z+1)/-2:z/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var z=this.readVarint()+this.pos,$=this.pos;return this.pos=z,z-$>=es&&xi?pr(this.buf,$,z):Gi(this.buf,$,z)},readBytes:function(){var z=this.readVarint()+this.pos,$=this.buf.subarray(this.pos,z);return this.pos=z,$},readPackedVarint:function(z,$){if(this.type!==Te.Bytes)return z.push(this.readVarint($));var Y=hr(this);for(z=z||[];this.pos<Y;)z.push(this.readVarint($));return z},readPackedSVarint:function(z){if(this.type!==Te.Bytes)return z.push(this.readSVarint());var $=hr(this);for(z=z||[];this.pos<$;)z.push(this.readSVarint());return z},readPackedBoolean:function(z){if(this.type!==Te.Bytes)return z.push(this.readBoolean());var $=hr(this);for(z=z||[];this.pos<$;)z.push(this.readBoolean());return z},readPackedFloat:function(z){if(this.type!==Te.Bytes)return z.push(this.readFloat());var $=hr(this);for(z=z||[];this.pos<$;)z.push(this.readFloat());return z},readPackedDouble:function(z){if(this.type!==Te.Bytes)return z.push(this.readDouble());var $=hr(this);for(z=z||[];this.pos<$;)z.push(this.readDouble());return z},readPackedFixed32:function(z){if(this.type!==Te.Bytes)return z.push(this.readFixed32());var $=hr(this);for(z=z||[];this.pos<$;)z.push(this.readFixed32());return z},readPackedSFixed32:function(z){if(this.type!==Te.Bytes)return z.push(this.readSFixed32());var $=hr(this);for(z=z||[];this.pos<$;)z.push(this.readSFixed32());return z},readPackedFixed64:function(z){if(this.type!==Te.Bytes)return z.push(this.readFixed64());var $=hr(this);for(z=z||[];this.pos<$;)z.push(this.readFixed64());return z},readPackedSFixed64:function(z){if(this.type!==Te.Bytes)return z.push(this.readSFixed64());var $=hr(this);for(z=z||[];this.pos<$;)z.push(this.readSFixed64());return z},skip:function(z){var $=z&7;if($===Te.Varint)for(;this.buf[this.pos++]>127;);else if($===Te.Bytes)this.pos=this.readVarint()+this.pos;else if($===Te.Fixed32)this.pos+=4;else if($===Te.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+$)},writeTag:function(z,$){this.writeVarint(z<<3|$)},realloc:function(z){for(var $=this.length||16;$<this.pos+z;)$*=2;if($!==this.length){var Y=new Uint8Array($);Y.set(this.buf),this.buf=Y,this.length=$}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(z){this.realloc(4),wi(this.buf,z,this.pos),this.pos+=4},writeSFixed32:function(z){this.realloc(4),wi(this.buf,z,this.pos),this.pos+=4},writeFixed64:function(z){this.realloc(8),wi(this.buf,z&-1,this.pos),wi(this.buf,Math.floor(z*bn),this.pos+4),this.pos+=8},writeSFixed64:function(z){this.realloc(8),wi(this.buf,z&-1,this.pos),wi(this.buf,Math.floor(z*bn),this.pos+4),this.pos+=8},writeVarint:function(z){if(z=+z||0,z>268435455||z<0){Di(z,this);return}this.realloc(4),this.buf[this.pos++]=z&127|(z>127?128:0),!(z<=127)&&(this.buf[this.pos++]=(z>>>=7)&127|(z>127?128:0),!(z<=127)&&(this.buf[this.pos++]=(z>>>=7)&127|(z>127?128:0),!(z<=127)&&(this.buf[this.pos++]=z>>>7&127)))},writeSVarint:function(z){this.writeVarint(z<0?-z*2-1:z*2)},writeBoolean:function(z){this.writeVarint(!!z)},writeString:function(z){z=String(z),this.realloc(z.length*4),this.pos++;var $=this.pos;this.pos=Os(this.buf,z,this.pos);var Y=this.pos-$;Y>=128&&qt($,Y,this),this.pos=$-1,this.writeVarint(Y),this.pos+=Y},writeFloat:function(z){this.realloc(4),Dr.write(this.buf,z,this.pos,!0,23,4),this.pos+=4},writeDouble:function(z){this.realloc(8),Dr.write(this.buf,z,this.pos,!0,52,8),this.pos+=8},writeBytes:function(z){var $=z.length;this.writeVarint($),this.realloc($);for(var Y=0;Y<$;Y++)this.buf[this.pos++]=z[Y]},writeRawMessage:function(z,$){this.pos++;var Y=this.pos;z($,this);var yt=this.pos-Y;yt>=128&&qt(Y,yt,this),this.pos=Y-1,this.writeVarint(yt),this.pos+=yt},writeMessage:function(z,$,Y){this.writeTag(z,Te.Bytes),this.writeRawMessage($,Y)},writePackedVarint:function(z,$){$.length&&this.writeMessage(z,Ri,$)},writePackedSVarint:function(z,$){$.length&&this.writeMessage(z,Rr,$)},writePackedBoolean:function(z,$){$.length&&this.writeMessage(z,$i,$)},writePackedFloat:function(z,$){$.length&&this.writeMessage(z,Vn,$)},writePackedDouble:function(z,$){$.length&&this.writeMessage(z,En,$)},writePackedFixed32:function(z,$){$.length&&this.writeMessage(z,ao,$)},writePackedSFixed32:function(z,$){$.length&&this.writeMessage(z,vo,$)},writePackedFixed64:function(z,$){$.length&&this.writeMessage(z,Rs,$)},writePackedSFixed64:function(z,$){$.length&&this.writeMessage(z,No,$)},writeBytesField:function(z,$){this.writeTag(z,Te.Bytes),this.writeBytes($)},writeFixed32Field:function(z,$){this.writeTag(z,Te.Fixed32),this.writeFixed32($)},writeSFixed32Field:function(z,$){this.writeTag(z,Te.Fixed32),this.writeSFixed32($)},writeFixed64Field:function(z,$){this.writeTag(z,Te.Fixed64),this.writeFixed64($)},writeSFixed64Field:function(z,$){this.writeTag(z,Te.Fixed64),this.writeSFixed64($)},writeVarintField:function(z,$){this.writeTag(z,Te.Varint),this.writeVarint($)},writeSVarintField:function(z,$){this.writeTag(z,Te.Varint),this.writeSVarint($)},writeStringField:function(z,$){this.writeTag(z,Te.Bytes),this.writeString($)},writeFloatField:function(z,$){this.writeTag(z,Te.Fixed32),this.writeFloat($)},writeDoubleField:function(z,$){this.writeTag(z,Te.Fixed64),this.writeDouble($)},writeBooleanField:function(z,$){this.writeVarintField(z,!!$)}};function Dn(z,$,Y){var yt=Y.buf,gt,Mt;if(Mt=yt[Y.pos++],gt=(Mt&112)>>4,Mt<128||(Mt=yt[Y.pos++],gt|=(Mt&127)<<3,Mt<128)||(Mt=yt[Y.pos++],gt|=(Mt&127)<<10,Mt<128)||(Mt=yt[Y.pos++],gt|=(Mt&127)<<17,Mt<128)||(Mt=yt[Y.pos++],gt|=(Mt&127)<<24,Mt<128)||(Mt=yt[Y.pos++],gt|=(Mt&1)<<31,Mt<128))return vn(z,gt,$);throw new Error("Expected varint not more than 10 bytes")}function hr(z){return z.type===Te.Bytes?z.readVarint()+z.pos:z.pos+1}function vn(z,$,Y){return Y?$*4294967296+(z>>>0):($>>>0)*4294967296+(z>>>0)}function Di(z,$){var Y,yt;if(z>=0?(Y=z%4294967296|0,yt=z/4294967296|0):(Y=~(-z%4294967296),yt=~(-z/4294967296),Y^4294967295?Y=Y+1|0:(Y=0,yt=yt+1|0)),z>=18446744073709552e3||z<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");$.realloc(10),Ui(Y,yt,$),ko(yt,$)}function Ui(z,$,Y){Y.buf[Y.pos++]=z&127|128,z>>>=7,Y.buf[Y.pos++]=z&127|128,z>>>=7,Y.buf[Y.pos++]=z&127|128,z>>>=7,Y.buf[Y.pos++]=z&127|128,z>>>=7,Y.buf[Y.pos]=z&127}function ko(z,$){var Y=(z&7)<<4;$.buf[$.pos++]|=Y|((z>>>=3)?128:0),z&&($.buf[$.pos++]=z&127|((z>>>=7)?128:0),z&&($.buf[$.pos++]=z&127|((z>>>=7)?128:0),z&&($.buf[$.pos++]=z&127|((z>>>=7)?128:0),z&&($.buf[$.pos++]=z&127|((z>>>=7)?128:0),z&&($.buf[$.pos++]=z&127)))))}function qt(z,$,Y){var yt=$<=16383?1:$<=2097151?2:$<=268435455?3:Math.floor(Math.log($)/(Math.LN2*7));Y.realloc(yt);for(var gt=Y.pos-1;gt>=z;gt--)Y.buf[gt+yt]=Y.buf[gt]}function Ri(z,$){for(var Y=0;Y<z.length;Y++)$.writeVarint(z[Y])}function Rr(z,$){for(var Y=0;Y<z.length;Y++)$.writeSVarint(z[Y])}function Vn(z,$){for(var Y=0;Y<z.length;Y++)$.writeFloat(z[Y])}function En(z,$){for(var Y=0;Y<z.length;Y++)$.writeDouble(z[Y])}function $i(z,$){for(var Y=0;Y<z.length;Y++)$.writeBoolean(z[Y])}function ao(z,$){for(var Y=0;Y<z.length;Y++)$.writeFixed32(z[Y])}function vo(z,$){for(var Y=0;Y<z.length;Y++)$.writeSFixed32(z[Y])}function Rs(z,$){for(var Y=0;Y<z.length;Y++)$.writeFixed64(z[Y])}function No(z,$){for(var Y=0;Y<z.length;Y++)$.writeSFixed64(z[Y])}function Kr(z,$){return(z[$]|z[$+1]<<8|z[$+2]<<16)+z[$+3]*16777216}function wi(z,$,Y){z[Y]=$,z[Y+1]=$>>>8,z[Y+2]=$>>>16,z[Y+3]=$>>>24}function ce(z,$){return(z[$]|z[$+1]<<8|z[$+2]<<16)+(z[$+3]<<24)}function Gi(z,$,Y){for(var yt="",gt=$;gt<Y;){var Mt=z[gt],Nt=null,Qt=Mt>239?4:Mt>223?3:Mt>191?2:1;if(gt+Qt>Y)break;var Ut,ie,oe;Qt===1?Mt<128&&(Nt=Mt):Qt===2?(Ut=z[gt+1],(Ut&192)===128&&(Nt=(Mt&31)<<6|Ut&63,Nt<=127&&(Nt=null))):Qt===3?(Ut=z[gt+1],ie=z[gt+2],(Ut&192)===128&&(ie&192)===128&&(Nt=(Mt&15)<<12|(Ut&63)<<6|ie&63,(Nt<=2047||Nt>=55296&&Nt<=57343)&&(Nt=null))):Qt===4&&(Ut=z[gt+1],ie=z[gt+2],oe=z[gt+3],(Ut&192)===128&&(ie&192)===128&&(oe&192)===128&&(Nt=(Mt&15)<<18|(Ut&63)<<12|(ie&63)<<6|oe&63,(Nt<=65535||Nt>=1114112)&&(Nt=null))),Nt===null?(Nt=65533,Qt=1):Nt>65535&&(Nt-=65536,yt+=String.fromCharCode(Nt>>>10&1023|55296),Nt=56320|Nt&1023),yt+=String.fromCharCode(Nt),gt+=Qt}return yt}function pr(z,$,Y){return xi.decode(z.subarray($,Y))}function Os(z,$,Y){for(var yt=0,gt,Mt;yt<$.length;yt++){if(gt=$.charCodeAt(yt),gt>55295&&gt<57344)if(Mt)if(gt<56320){z[Y++]=239,z[Y++]=191,z[Y++]=189,Mt=gt;continue}else gt=Mt-55296<<10|gt-56320|65536,Mt=null;else{gt>56319||yt+1===$.length?(z[Y++]=239,z[Y++]=191,z[Y++]=189):Mt=gt;continue}else Mt&&(z[Y++]=239,z[Y++]=191,z[Y++]=189,Mt=null);gt<128?z[Y++]=gt:(gt<2048?z[Y++]=gt>>6|192:(gt<65536?z[Y++]=gt>>12|224:(z[Y++]=gt>>18|240,z[Y++]=gt>>12&63|128),z[Y++]=gt>>6&63|128),z[Y++]=gt&63|128)}return Y}var Oi=Xn(_o),pe;(function(z){z[z.UNKNOWN=0]="UNKNOWN",z[z.POINT=1]="POINT",z[z.LINESTRING=2]="LINESTRING",z[z.POLYGON=3]="POLYGON"})(pe||(pe={}));function ln(z){const $=new Oi;for(const Y in z.layers){const yt=z.layers[Y];yt.extent||(yt.extent=z.extent),$.writeMessage(3,tn,{...yt,id:Y})}return $.finish()}function tn(z,$){if(!$)throw new Error("pbf undefined");$.writeVarintField(15,2),$.writeStringField(1,z.id||""),$.writeVarintField(5,z.extent||4096);const Y={keys:[],values:[],keycache:{},valuecache:{}};for(const yt of z.features)Y.feature=yt,$.writeMessage(2,li,Y);for(const yt of Y.keys)$.writeStringField(3,yt);for(const yt of Y.values)$.writeMessage(4,V,yt)}function li(z,$){const Y=z.feature;if(!Y||!$)throw new Error;$.writeMessage(2,ji,z),$.writeVarintField(3,Y.type),$.writeMessage(4,q,Y)}function ji(z,$){const Y=z.feature;if(!Y||!$)throw new Error;const yt=z.keys,gt=z.values,Mt=z.keycache,Nt=z.valuecache;for(const Qt in Y.properties){let Ut=Y.properties[Qt],ie=Mt[Qt];if(Ut===null)continue;typeof ie>"u"&&(yt.push(Qt),ie=yt.length-1,Mt[Qt]=ie),$.writeVarint(ie);const oe=typeof Ut;oe!=="string"&&oe!=="boolean"&&oe!=="number"&&(Ut=JSON.stringify(Ut));const ze=`${oe}:${Ut}`;let qe=Nt[ze];typeof qe>"u"&&(gt.push(Ut),qe=gt.length-1,Nt[ze]=qe),$.writeVarint(qe)}}function Xe(z,$){return($<<3)+(z&7)}function qi(z){return z<<1^z>>31}function q(z,$){if(!$)throw new Error;const Y=z.geometry,yt=z.type;let gt=0,Mt=0;for(const Nt of Y){let Qt=1;yt===pe.POINT&&(Qt=Nt.length/2),$.writeVarint(Xe(1,Qt));const Ut=Nt.length/2,ie=yt===pe.POLYGON?Ut-1:Ut;for(let oe=0;oe<ie;oe++){oe===1&&yt!==1&&$.writeVarint(Xe(2,ie-1));const ze=Nt[oe*2]-gt,qe=Nt[oe*2+1]-Mt;$.writeVarint(qi(ze)),$.writeVarint(qi(qe)),gt+=ze,Mt+=qe}yt===pe.POLYGON&&$.writeVarint(Xe(7,1))}}function V(z,$){if(!$)throw new Error;typeof z=="string"?$.writeStringField(1,z):typeof z=="boolean"?$.writeBooleanField(7,z):typeof z=="number"&&(z%1!==0?$.writeDoubleField(3,z):z<0?$.writeSVarintField(6,z):$.writeVarintField(5,z))}class G{constructor($,Y,yt,gt,Mt){this.loaded=Promise.resolve(),this.decodeImage=he,this.fetchAndParseTile=(Nt,Qt,Ut,ie)=>{const oe=this,ze=this.demUrlPattern.replace("{z}",Nt.toString()).replace("{x}",Qt.toString()).replace("{y}",Ut.toString());return ie==null||ie.useTile(ze),this.parsedCache.getCancelable(ze,()=>{const qe=oe.fetchTile(Nt,Qt,Ut,ie);let fn=!1,vr=()=>{};return{value:qe.value.then(async Hn=>{if(fn)throw new Error("canceled");const fr=oe.decodeImage(Hn.data,oe.encoding);vr=fr.cancel;const In=ie==null?void 0:ie.marker("decode"),Sn=await fr.value;return In==null||In(),Sn}),cancel:()=>{fn=!0,vr(),qe.cancel()}}})},this.tileCache=new u(Y),this.parsedCache=new u(Y),this.contourCache=new u(Y),this.timeoutMs=Mt,this.demUrlPattern=$,this.encoding=yt,this.maxzoom=gt}fetchTile($,Y,yt,gt){const Mt=this.demUrlPattern.replace("{z}",$.toString()).replace("{x}",Y.toString()).replace("{y}",yt.toString());return gt==null||gt.useTile(Mt),this.tileCache.getCancelable(Mt,()=>{let Nt=()=>{};const Qt={};try{const ie=new AbortController;Qt.signal=ie.signal,Nt=()=>ie.abort()}catch{}gt==null||gt.fetchTile(Mt);const Ut=gt==null?void 0:gt.marker("fetch");return Rt(this.timeoutMs,{value:fetch(Mt,Qt).then(async ie=>{if(Ut==null||Ut(),!ie.ok)throw new Error(`Bad response: ${ie.status} for ${Mt}`);return{data:await ie.blob(),expires:ie.headers.get("expires")||void 0,cacheControl:ie.headers.get("cache-control")||void 0}}),cancel:Nt})})}fetchDem($,Y,yt,gt,Mt){const Nt=Math.min($-(gt.overzoom||0),this.maxzoom),Qt=$-Nt,Ut=1<<Qt,ie=Math.floor(Y/Ut),oe=Math.floor(yt/Ut),{value:ze,cancel:qe}=this.fetchAndParseTile(Nt,ie,oe,Mt),fn=Y%Ut,vr=yt%Ut;return{value:ze.then(Hn=>pn.fromRawDem(Hn).split(Qt,fn,vr)),cancel:qe}}fetchContourTile($,Y,yt,gt,Mt){const{levels:Nt,multiplier:Qt=1,buffer:Ut=1,extent:ie=4096,contourLayer:oe="contours",elevationKey:ze="ele",levelKey:qe="level",subsampleBelow:fn=100}=gt;if(!Nt||Nt.length===0)return{cancel(){},value:Promise.resolve({arrayBuffer:new ArrayBuffer(0)})};const vr=[$,Y,yt,j(gt)].join("/");return this.contourCache.getCancelable(vr,()=>{const Hn=1<<$;let fr=!1;const In=[];for(let Or=yt-1;Or<=yt+1;Or++)for(let nr=Y-1;nr<=Y+1;nr++)In.push(Or<0||Or>=Hn?null:this.fetchDem($,(nr+Hn)%Hn,Or,gt,Mt));return{value:Promise.all(In.map(Or=>Or==null?void 0:Or.value)).then(async Or=>{let nr=pn.combineNeighbors(Or);if(!nr||fr)return{arrayBuffer:new Uint8Array().buffer};const Fn=Mt==null?void 0:Mt.marker("isoline");if(nr.width>=fn)nr=nr.materialize(2);else for(;nr.width<fn;)nr=nr.subsamplePixelCenters(2).materialize(2);nr=nr.averagePixelCentersToGrid().scaleElevation(Qt).materialize(1);const ui=c(Nt[0],nr,ie,Ut);Fn==null||Fn();const dr=ln({extent:ie,layers:{[oe]:{features:Object.entries(ui).map(([jr,qr])=>{const Da=Number(jr);return{type:pe.LINESTRING,geometry:qr,properties:{[ze]:Da,[qe]:Math.max(...Nt.map((la,ir)=>Da%la===0?ir:0))}}})}}});return Fn==null||Fn(),{arrayBuffer:dr.buffer}}),cancel(){fr=!0,In.forEach(Or=>Or&&Or.cancel())}}})}}const et=typeof performance<"u"?performance:void 0,at=et?et.timeOrigin||new Date().getTime()-et.now():new Date().getTime();function lt(z){var $;return JSON.parse(JSON.stringify((($=et==null?void 0:et.getEntriesByName)===null||$===void 0?void 0:$.call(et,z))||[]))}function It(){return et?et.now():new Date().getTime()}function vt(z){const $=[];for(const Y of z)$.push(...Y);return $}class dt{constructor($){this.marks={},this.urls=[],this.fetched=[],this.resources=[],this.tilesFetched=0,this.timeOrigin=at,this.finish=Y=>{this.markFinish();const yt=Ut=>{const ie=this.marks[Ut]||[],oe=Math.max(...ie.map(qe=>Math.max(...qe))),ze=Math.min(...ie.map(qe=>Math.min(...qe)));return Number.isFinite(oe)?oe-ze:void 0},gt=yt("main")||0,Mt=yt("fetch"),Nt=yt("decode"),Qt=yt("isoline");return{url:Y,tilesUsed:this.tilesFetched,origin:this.timeOrigin,marks:this.marks,resources:[...this.resources,...vt(this.fetched.map(lt))],duration:gt,fetch:Mt,decode:Nt,process:Qt,wait:gt-(Mt||0)-(Nt||0)-(Qt||0)}},this.error=Y=>({...this.finish(Y),error:!0}),this.marker=Y=>{var yt;this.marks[Y]||(this.marks[Y]=[]);const gt=[It()];return(yt=this.marks[Y])===null||yt===void 0||yt.push(gt),()=>gt.push(It())},this.useTile=Y=>{this.urls.indexOf(Y)<0&&(this.urls.push(Y),this.tilesFetched++)},this.fetchTile=Y=>{this.fetched.indexOf(Y)<0&&this.fetched.push(Y)},this.addAll=Y=>{var yt;this.tilesFetched+=Y.tilesUsed;const gt=Y.origin-this.timeOrigin;for(const Mt in Y.marks){const Nt=Mt;(this.marks[Nt]||(this.marks[Nt]=[])).push(...((yt=Y.marks[Nt])===null||yt===void 0?void 0:yt.map(Ut=>Ut.map(ie=>ie+gt)))||[])}this.resources.push(...Y.resources.map(Mt=>Yt(Mt,gt)))},this.markFinish=this.marker($)}}const bt=/(Start$|End$|^start|^end)/;function Yt(z,$){const Y={};for(const yt in z)z[yt]!==0&&bt.test(yt)?Y[yt]=Number(z[yt])+$:Y[yt]=z[yt];return Y}let Kt=0;class Jt{constructor($,Y,yt=2e4){this.callbacks={},this.cancels={},this.dest=$,this.timeoutMs=yt,this.dest.onmessage=async({data:gt})=>{const Mt=gt;if(Mt.type==="cancel"){const Nt=this.cancels[Mt.id];delete this.cancels[Mt.id],Nt&&Nt()}else if(Mt.type==="response"){const Nt=this.callbacks[Mt.id];delete this.callbacks[Mt.id],Nt&&Nt(Mt.error?new Error(Mt.error):void 0,Mt.response,Mt.timings)}else if(Mt.type==="request"){const Nt=new dt("worker"),Qt=Y[Mt.name],Ut=Qt.apply(Qt,[...Mt.args,Nt]),ie=`${Mt.name}_${Mt.id}`;if(Mt.id&&Ut){this.cancels[Mt.id]=Ut.cancel;try{const oe=await Ut.value,ze=oe==null?void 0:oe.transferrables;this.postMessage({id:Mt.id,type:"response",response:oe,timings:Nt.finish(ie)},ze)}catch(oe){this.postMessage({id:Mt.id,type:"response",error:(oe==null?void 0:oe.toString())||"error",timings:Nt.finish(ie)})}delete this.cancels[Mt.id]}}}}postMessage($,Y){this.dest.postMessage($,Y||[])}send($,Y,yt,...gt){const Mt=++Kt,Nt=new Promise((Qt,Ut)=>{this.postMessage({id:Mt,type:"request",name:$,args:gt},Y),this.callbacks[Mt]=(ie,oe,ze)=>{yt==null||yt.addAll(ze),ie?Ut(ie):Qt(oe)}});return Rt(this.timeoutMs,{value:Nt,cancel:()=>{delete this.callbacks[Mt],this.postMessage({id:Mt,type:"cancel"})}})}}t.Actor=Jt,t.HeightTile=pn,t.LocalDemManager=G,t.Timer=dt,t.decodeOptions=O,t.decodeParsedImage=Qe,t.defaultDecoder=he,t.encodeOptions=N,t.generateIsolines=c,t.getOptionsForZoom=W,t.prepareContourTile=tt,t.prepareDemTile=J});Iw(["./shared"],function(t){const e=s=>({cancel(){},value:Promise.reject(new Error(`No manager registered for ${s}`))});class n{constructor(){this.managers={},this.init=c=>(this.managers[c.managerId]=new t.LocalDemManager(c.demUrlPattern,c.cacheSize,c.encoding,c.maxzoom,c.timeoutMs),{cancel(){},value:Promise.resolve()}),this.fetchTile=(c,f,u,w,S)=>{var A;return((A=this.managers[c])===null||A===void 0?void 0:A.fetchTile(f,u,w,S))||e(c)},this.fetchAndParseTile=(c,f,u,w,S)=>{var A;return t.prepareDemTile(((A=this.managers[c])===null||A===void 0?void 0:A.fetchAndParseTile(f,u,w,S))||e(c),!0)},this.fetchContourTile=(c,f,u,w,S,A)=>{var N;return t.prepareContourTile(((N=this.managers[c])===null||N===void 0?void 0:N.fetchContourTile(f,u,w,S,A))||e(c))}}}const r=typeof self<"u"?self:typeof window<"u"?window:global;r.actor=new t.Actor(r,new n)});Iw(["./shared"],function(t){const e={workerUrl:""};let n,r=0;class s{constructor(){this.decodeImage=(N,O)=>t.prepareDemTile(t.defaultDecoder(N,O),!1)}}function c(){if(!n){const A=new Worker(e.workerUrl),N=new s;n=new t.Actor(A,N)}return n}class f{constructor(N,O,j,W,nt,pt){this.fetchTile=(tt,Q,_t,Ot)=>this.actor.send("fetchTile",[],Ot,this.managerId,tt,Q,_t),this.fetchAndParseTile=(tt,Q,_t,Ot)=>this.actor.send("fetchAndParseTile",[],Ot,this.managerId,tt,Q,_t),this.fetchContourTile=(tt,Q,_t,Ot,zt)=>this.actor.send("fetchContourTile",[],zt,this.managerId,tt,Q,_t,Ot);const J=this.managerId=++r;this.actor=pt||c(),this.loaded=this.actor.send("init",[],void 0,{cacheSize:O,demUrlPattern:N,encoding:j,maxzoom:W,managerId:J,timeoutMs:nt}).value}}Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Promise((N,O)=>{const j=new FileReader;j.onload=W=>{var nt;return N((nt=W.target)===null||nt===void 0?void 0:nt.result)},j.onerror=O,j.readAsArrayBuffer(this)})});const u=new Set;class w{constructor({url:N,cacheSize:O=100,id:j="dem",encoding:W="terrarium",maxzoom:nt=12,worker:pt=!0,timeoutMs:J=1e4,actor:tt}){this.timingCallbacks=[],this.onTiming=zt=>{this.timingCallbacks.push(zt)},this.setupMaplibre=zt=>{zt.addProtocol(this.sharedDemProtocolId,this.sharedDemProtocol),zt.addProtocol(this.contourProtocolId,this.contourProtocol)},this.sharedDemProtocol=(zt,Rt)=>{const[At,Ht,Xt]=this.parseUrl(zt.url),De=new t.Timer("main"),ue=this.manager.fetchTile(At,Ht,Xt,De);let on=!1;return(async()=>{let Gt;try{const ye=await ue.value;if(Gt=De.finish(zt.url),on)return;const Ue=await ye.data.arrayBuffer();if(on)return;Rt(void 0,Ue,ye.cacheControl,ye.expires)}catch(ye){if(Gt=De.error(zt.url),on)return;Rt(ye)}this.timingCallbacks.forEach(ye=>ye(Gt))})(),{cancel:()=>{on=!1,ue.cancel()}}},this.contourProtocol=(zt,Rt)=>{const At=new t.Timer("main"),[Ht,Xt,De]=this.parseUrl(zt.url),ue=t.decodeOptions(zt.url),on=this.manager.fetchContourTile(Ht,Xt,De,t.getOptionsForZoom(ue,Ht),At);let Gt=!1;return(async()=>{let ye;try{const Ue=await on.value;if(ye=At.finish(zt.url),Gt)return;Rt(void 0,Ue.arrayBuffer)}catch(Ue){if(Gt)return;ye=At.error(zt.url),Rt(Ue)}this.timingCallbacks.forEach(Ue=>Ue(ye))})(),{cancel:()=>{Gt=!0,on.cancel()}}},this.contourProtocolUrl=zt=>`${this.contourProtocolUrlBase}?${t.encodeOptions(zt)}`;let Q=j,_t=1;for(;u.has(Q);)Q=j+_t++;u.add(Q),this.sharedDemProtocolId=`${Q}-shared`,this.contourProtocolId=`${Q}-contour`,this.sharedDemProtocolUrl=`${this.sharedDemProtocolId}://{z}/{x}/{y}`,this.contourProtocolUrlBase=`${this.contourProtocolId}://{z}/{x}/{y}`;const Ot=pt?f:t.LocalDemManager;this.manager=new Ot(N,O,W,nt,J,tt)}getDemTile(N,O,j){return this.manager.fetchAndParseTile(N,O,j).value}parseUrl(N){const[,O,j,W]=/\/\/(\d+)\/(\d+)\/(\d+)/.exec(N)||[];return[Number(O),Number(j),Number(W)]}}return{generateIsolines:t.generateIsolines,DemSource:w,HeightTile:t.HeightTile,LocalDemManager:t.LocalDemManager,decodeParsedImage:t.decodeParsedImage,set workerUrl(A){e.workerUrl=A},get workerUrl(){return e.workerUrl}}});var hR=u1;const{DemSource:pR}=hR,fR="https://api.maptiler.com/tiles/terrain-rgb-v2/{z}/{x}/{y}.webp?key=3s0f8momUZpYnD6bYw8L",H2=new pR({url:fR,encoding:"mapbox",maxzoom:13,worker:!0});H2.setupMaplibre(RT);function dR({map:t}){return aw(()=>{t.on("load",()=>{t.addSource("contourSourceFeet",{type:"vector",tiles:[H2.contourProtocolUrl({multiplier:3.28084,overzoom:1,thresholds:{11:[200,1e3],12:[100,500],13:[100,500],14:[50,200],15:[20,100],16:[10,20],17:[1,10]},elevationKey:"ele",levelKey:"level",contourLayer:"contours"})],maxzoom:30}),t.addLayer({id:"contours",type:"line",source:"contourSourceFeet","source-layer":"contours",paint:{"line-opacity":.2,"line-width":["match",["get","level"],1,1,.5]}}),t.addLayer({id:"contour-text",type:"symbol",source:"contourSourceFeet","source-layer":"contours",filter:[">",["get","level"],0],paint:{"text-halo-color":"white","text-halo-width":1},layout:{"symbol-placement":"line","text-size":10,"text-field":["concat",["number-format",["get","ele"],{}],"'"],"text-font":["Noto Sans Bold"]}})})}),null}const Cw=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{top.window.document._=0}catch{return!1}return"showOpenFilePicker"in self})(),gR=Cw?Promise.resolve().then(function(){return wR}):Promise.resolve().then(function(){return TR});async function mR(...t){return(await gR).default(...t)}Cw?Promise.resolve().then(function(){return ER}):Promise.resolve().then(function(){return MR});const yR=Cw?Promise.resolve().then(function(){return IR}):Promise.resolve().then(function(){return AR});async function _R(...t){return(await yR).default(...t)}const vR=async t=>{const e=await t.getFile();return e.handle=t,e};var xR=async(t=[{}])=>{Array.isArray(t)||(t=[t]);const e=[];t.forEach((s,c)=>{e[c]={description:s.description||"Files",accept:{}},s.mimeTypes?s.mimeTypes.map(f=>{e[c].accept[f]=s.extensions||[]}):e[c].accept["*/*"]=s.extensions||[]});const n=await window.showOpenFilePicker({id:t[0].id,startIn:t[0].startIn,types:e,multiple:t[0].multiple||!1,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1}),r=await Promise.all(n.map(vR));return t[0].multiple?r:r[0]},wR={__proto__:null,default:xR};function h_(t){function e(n){if(Object(n)!==n)return Promise.reject(new TypeError(n+" is not an object."));var r=n.done;return Promise.resolve(n.value).then(function(s){return{value:s,done:r}})}return h_=function(n){this.s=n,this.n=n.next},h_.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(n){var r=this.s.return;return r===void 0?Promise.resolve({value:n,done:!0}):e(r.apply(this.s,arguments))},throw:function(n){var r=this.s.return;return r===void 0?Promise.reject(n):e(r.apply(this.s,arguments))}},new h_(t)}const Y2=async(t,e,n=t.name,r)=>{const s=[],c=[];var f,u=!1,w=!1;try{for(var S,A=function(N){var O,j,W,nt=2;for(typeof Symbol<"u"&&(j=Symbol.asyncIterator,W=Symbol.iterator);nt--;){if(j&&(O=N[j])!=null)return O.call(N);if(W&&(O=N[W])!=null)return new h_(O.call(N));j="@@asyncIterator",W="@@iterator"}throw new TypeError("Object is not async iterable")}(t.values());u=!(S=await A.next()).done;u=!1){const N=S.value,O=`${n}/${N.name}`;N.kind==="file"?c.push(N.getFile().then(j=>(j.directoryHandle=t,j.handle=N,Object.defineProperty(j,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>O})))):N.kind!=="directory"||!e||r&&r(N)||s.push(Y2(N,e,O,r))}}catch(N){w=!0,f=N}finally{try{u&&A.return!=null&&await A.return()}finally{if(w)throw f}}return[...(await Promise.all(s)).flat(),...await Promise.all(c)]};var bR=async(t={})=>{t.recursive=t.recursive||!1,t.mode=t.mode||"read";const e=await window.showDirectoryPicker({id:t.id,startIn:t.startIn,mode:t.mode});return(await(await e.values()).next()).done?[e]:Y2(e,t.recursive,void 0,t.skipDirectory)},ER={__proto__:null,default:bR},SR=async(t,e=[{}],n=null,r=!1,s=null)=>{Array.isArray(e)||(e=[e]),e[0].fileName=e[0].fileName||"Untitled";const c=[];let f=null;if(t instanceof Blob&&t.type?f=t.type:t.headers&&t.headers.get("content-type")&&(f=t.headers.get("content-type")),e.forEach((S,A)=>{c[A]={description:S.description||"Files",accept:{}},S.mimeTypes?(A===0&&f&&S.mimeTypes.push(f),S.mimeTypes.map(N=>{c[A].accept[N]=S.extensions||[]})):f?c[A].accept[f]=S.extensions||[]:c[A].accept["*/*"]=S.extensions||[]}),n)try{await n.getFile()}catch(S){if(n=null,r)throw S}const u=n||await window.showSaveFilePicker({suggestedName:e[0].fileName,id:e[0].id,startIn:e[0].startIn,types:c,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1});!n&&s&&s(u);const w=await u.createWritable();return"stream"in t?(await t.stream().pipeTo(w),u):"body"in t?(await t.body.pipeTo(w),u):(await w.write(await t),await w.close(),u)},IR={__proto__:null,default:SR},CR=async(t=[{}])=>(Array.isArray(t)||(t=[t]),new Promise((e,n)=>{const r=document.createElement("input");r.type="file";const s=[...t.map(w=>w.mimeTypes||[]),...t.map(w=>w.extensions||[])].join();r.multiple=t[0].multiple||!1,r.accept=s||"",r.style.display="none",document.body.append(r);const c=w=>{typeof f=="function"&&f(),e(w)},f=t[0].legacySetup&&t[0].legacySetup(c,()=>f(n),r),u=()=>{window.removeEventListener("focus",u),r.remove()};r.addEventListener("click",()=>{window.addEventListener("focus",u)}),r.addEventListener("change",()=>{window.removeEventListener("focus",u),r.remove(),c(r.multiple?Array.from(r.files):r.files[0])}),"showPicker"in HTMLInputElement.prototype?r.showPicker():r.click()})),TR={__proto__:null,default:CR},PR=async(t=[{}])=>(Array.isArray(t)||(t=[t]),t[0].recursive=t[0].recursive||!1,new Promise((e,n)=>{const r=document.createElement("input");r.type="file",r.webkitdirectory=!0;const s=f=>{typeof c=="function"&&c(),e(f)},c=t[0].legacySetup&&t[0].legacySetup(s,()=>c(n),r);r.addEventListener("change",()=>{let f=Array.from(r.files);t[0].recursive?t[0].recursive&&t[0].skipDirectory&&(f=f.filter(u=>u.webkitRelativePath.split("/").every(w=>!t[0].skipDirectory({name:w,kind:"directory"})))):f=f.filter(u=>u.webkitRelativePath.split("/").length===2),s(f)}),"showPicker"in HTMLInputElement.prototype?r.showPicker():r.click()})),MR={__proto__:null,default:PR},LR=async(t,e={})=>{Array.isArray(e)&&(e=e[0]);const n=document.createElement("a");let r=t;"body"in t&&(r=await async function(f,u){const w=f.getReader(),S=new ReadableStream({start:O=>async function j(){return w.read().then(({done:W,value:nt})=>{if(!W)return O.enqueue(nt),j();O.close()})}()}),A=new Response(S),N=await A.blob();return w.releaseLock(),new Blob([N],{type:u})}(t.body,t.headers.get("content-type"))),n.download=e.fileName||"Untitled",n.href=URL.createObjectURL(await r);const s=()=>{typeof c=="function"&&c()},c=e.legacySetup&&e.legacySetup(s,()=>c(),n);return n.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(n.href),3e4),s()}),n.click(),null},AR={__proto__:null,default:LR};function kR(){const[t,e]=Ml.useState("");return Io.jsxs(Io.Fragment,{children:[Io.jsxs("div",{className:"buttons",children:[Io.jsx("button",{onClick:async()=>{const r=await(await mR({mimeTypes:["image/svg+xml"]})).text();e(r)},children:"Load"}),Io.jsx("button",{onClick:async()=>{const n=new Blob([t],{type:"image/svg+xml"});_R(n,{fileName:"Constant-Culture.svg",extensions:[".svg"]})},children:"Save"})]}),Io.jsxs("div",{className:"create-document",children:[Io.jsx(vk,{svg:t,style:{width:"50vw",height:"100vh"},children:(n,r)=>Io.jsxs(Io.Fragment,{children:[Io.jsx(dR,{map:n}),Io.jsx(jk,{map:n,svg:r,onCreate:()=>e(Uk(n))}),Io.jsx(cR,{map:n})]})}),Io.jsx("div",{style:{width:"50vw",height:"100vh"},dangerouslySetInnerHTML:{__html:t}})]})]})}function NR(){return Io.jsx(Io.Fragment,{children:Io.jsx(kR,{})})}K0.createRoot(document.getElementById("root")).render(Io.jsx(aL.StrictMode,{children:Io.jsx(NR,{})}));
